<!DOCTYPE html>
<html lang="zh" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python è„šæœ¬å¼€å‘ | é¹¤å±¿ç¼–ç¨‹å­¦ä¹ ç¬”è®°</title>
    <meta name="description" content="è½¯ä»¶å¼€å‘è®¡ï¼šå¼€å‘æ–‡æ¡£å’Œå¼€å‘è®¡åˆ’ï¼Œå®ŒæˆåŠŸèƒ½å·¥å…·ï¼Œå’Œå¾…å¼€å‘çš„åŠŸèƒ½å’Œå·¥å…·">
    <meta name="generator" content="VitePress v1.2.2">
    <link rel="preload stylesheet" href="/ProgramLearnNotes/assets/style.Dv0iXHtT.css" as="style">
    
    <script type="module" src="/ProgramLearnNotes/assets/app.DsZYQv49.js"></script>
    <link rel="preload" href="/ProgramLearnNotes/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/ProgramLearnNotes/assets/chunks/framework.zGi9i9Bf.js">
    <link rel="modulepreload" href="/ProgramLearnNotes/assets/chunks/theme.DxkSzMoL.js">
    <link rel="modulepreload" href="/ProgramLearnNotes/assets/Document_Python_Pythonè„šæœ¬å¼€å‘.md.BJWtgfI7.lean.js">
    <link rel="icon" href="https://avatars.githubusercontent.com/u/48587992?v=4">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-41e8be72><!--[--><!--]--><!--[--><span tabindex="-1" data-v-403b34f4></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-403b34f4> Skip to content </a><!--]--><!----><header class="VPNav" data-v-41e8be72 data-v-e75c828d><div class="VPNavBar has-sidebar top" data-v-e75c828d data-v-8dd71d78><div class="wrapper" data-v-8dd71d78><div class="container" data-v-8dd71d78><div class="title" data-v-8dd71d78><div class="VPNavBarTitle has-sidebar" data-v-8dd71d78 data-v-f6236270><a class="title" href="/ProgramLearnNotes/" data-v-f6236270><!--[--><!--]--><!--[--><img class="VPImage logo" src="/ProgramLearnNotes/img/buding.svg" alt data-v-8444dd17><!--]--><span data-v-f6236270>é¹¤å±¿ç¼–ç¨‹å­¦ä¹ ç¬”è®°</span><!--[--><!--]--></a></div></div><div class="content" data-v-8dd71d78><div class="content-body" data-v-8dd71d78><!--[--><!--]--><div class="VPNavBarSearch search" data-v-8dd71d78><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢æ–‡æ¡£"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-8dd71d78 data-v-fd4c8781><span id="main-nav-aria-label" class="visually-hidden" data-v-fd4c8781>Main Navigation</span><!--[--><!--[--><span class="VPLink VPNavBarMenuLink" tabindex="0" data-v-fd4c8781 data-v-ca770222><!--[--><span data-v-ca770222>ğŸŒæˆ‘çš„ä¸ªäººç½‘ç«™</span><!--]--></span><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-8dd71d78 data-v-31419d3d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-31419d3d data-v-97b1538b data-v-10ac9a07><span class="check" data-v-10ac9a07><span class="icon" data-v-10ac9a07><!--[--><span class="vpi-sun sun" data-v-97b1538b></span><span class="vpi-moon moon" data-v-97b1538b></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-8dd71d78 data-v-4aea72c8 data-v-c48a77dc><!--[--><a class="VPSocialLink no-icon" href="https://github.com/muyaCode/ProgramLearnNotes" aria-label="github" target="_blank" rel="noopener" data-v-c48a77dc data-v-4f038324><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://gitee.com/muyaCode/program-learn-notes" aria-label target="_blank" rel="noopener" data-v-c48a77dc data-v-4f038324><svg t="1690871772610" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="987" width="256" height="256">
        <path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z" fill="#C71D23" p-id="988"></path>
      </svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-8dd71d78 data-v-7a5a60f5 data-v-da01661c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-da01661c><span class="vpi-more-horizontal icon" data-v-da01661c></span></button><div class="menu" data-v-da01661c><div class="VPMenu" data-v-da01661c data-v-4656436b><!----><!--[--><!--[--><!----><div class="group" data-v-7a5a60f5><div class="item appearance" data-v-7a5a60f5><p class="label" data-v-7a5a60f5>Appearance</p><div class="appearance-action" data-v-7a5a60f5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-7a5a60f5 data-v-97b1538b data-v-10ac9a07><span class="check" data-v-10ac9a07><span class="icon" data-v-10ac9a07><!--[--><span class="vpi-sun sun" data-v-97b1538b></span><span class="vpi-moon moon" data-v-97b1538b></span><!--]--></span></span></button></div></div></div><div class="group" data-v-7a5a60f5><div class="item social-links" data-v-7a5a60f5><div class="VPSocialLinks social-links-list" data-v-7a5a60f5 data-v-c48a77dc><!--[--><a class="VPSocialLink no-icon" href="https://github.com/muyaCode/ProgramLearnNotes" aria-label="github" target="_blank" rel="noopener" data-v-c48a77dc data-v-4f038324><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://gitee.com/muyaCode/program-learn-notes" aria-label target="_blank" rel="noopener" data-v-c48a77dc data-v-4f038324><svg t="1690871772610" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="987" width="256" height="256">
        <path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z" fill="#C71D23" p-id="988"></path>
      </svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-8dd71d78 data-v-8b1b27ae><span class="container" data-v-8b1b27ae><span class="top" data-v-8b1b27ae></span><span class="middle" data-v-8b1b27ae></span><span class="bottom" data-v-8b1b27ae></span></span></button></div></div></div></div><div class="divider" data-v-8dd71d78><div class="divider-line" data-v-8dd71d78></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-41e8be72 data-v-13941054><div class="container" data-v-13941054><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-13941054><span class="vpi-align-left menu-icon" data-v-13941054></span><span class="menu-text" data-v-13941054>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-13941054 data-v-b5f027b0><button data-v-b5f027b0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-41e8be72 data-v-b99191f1><div class="curtain" data-v-b99191f1></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b99191f1><span class="visually-hidden" id="sidebar-aria-label" data-v-b99191f1> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸæ–‡æ¡£æŒ‡å—</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/order/%E6%96%87%E6%A1%A3%E6%8C%87%E5%8D%97" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ–‡æ¡£æŒ‡å—</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/order/markdown%E5%9B%BE%E6%A0%87" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>markdownå›¾æ ‡</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0" data-v-b99191f1 data-v-46adc9ff><!----><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç¼–ç¨‹è¯­è¨€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BC%96%E8%AF%91%E5%99%A8%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç¼–è¯‘å™¨åŸç†å’Œå®ç°</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%89%8B%E6%90%93CPU" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ‰‹æ“CPU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%A0%87%E5%87%86%E5%8C%96API%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ ‡å‡†åŒ–APIè®¾è®¡æµç¨‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E5%BC%80%E6%BA%90%E5%B0%8F%E6%8A%84" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¼€æºå°æŠ„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å‘½ä»¤è¡Œå·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>åŒ…ç®¡ç†å™¨é…ç½®ä»£ç†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E5%88%AB%E4%BA%BA%E6%97%A0%E6%B3%95%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¦‚ä½•å†™å‡ºåˆ«äººæ— æ³•ç»´æŠ¤çš„ä»£ç </p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸæœåŠ¡å™¨ç›¸å…³</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/Nginx%E9%85%8D%E7%BD%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Nginxé…ç½®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸJava</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Java/Java%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Javaå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Java/Java%E6%A1%86%E6%9E%B6" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Javaæ¡†æ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Java/Java%E9%9D%A2%E8%AF%95%E7%9B%B8%E5%85%B3" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Javaé¢è¯•ç›¸å…³</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸC#</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-Sharp/C-Sharp%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>C-Sharpå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>ğŸŒŸdotnet</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-Sharp/dotnet/dotnet%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>dotnetå…¥é—¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-Sharp/dotnet/dotnet%E7%9B%B8%E5%85%B3%E7%BD%91%E5%9D%80" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>dotnetç›¸å…³ç½‘å€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-Sharp/dotnet/dotnet%E7%9B%B8%E5%85%B3%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>dotnetç›¸å…³å¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸGo</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Go/Go%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3%E7%BD%91%E7%AB%99%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Goè¯­è¨€ç›¸å…³ç½‘ç«™èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Go/Go%E5%BC%80%E6%BA%90%E5%BA%94%E7%94%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Goå¼€æºåº”ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Go/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Goè¯­è¨€å­¦ä¹ è·¯çº¿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Go/Go%E6%A1%86%E6%9E%B6" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Goæ¡†æ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible has-active" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸPython</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonå­¦ä¹ çº¿è·¯</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E7%89%88%E6%9C%AC%E5%92%8C%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonç‰ˆæœ¬å’Œç¯å¢ƒç®¡ç†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E7%9A%84Conda%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonçš„Condaç®¡ç†è½¯ä»¶å‘½ä»¤</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonå…¥é—¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E6%A1%86%E6%9E%B6" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonæ¡†æ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E5%BA%93" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonåº“</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonè„šæœ¬å¼€å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E5%AE%9E%E6%88%98%E5%BC%80%E5%8F%91" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonå®æˆ˜å¼€å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E7%88%AC%E8%99%AB" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonçˆ¬è™«</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonå¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E4%B8%8E%E5%85%B6%E4%BB%96%E8%AF%AD%E8%A8%80%E7%BB%93%E5%90%88" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythonä¸å…¶ä»–è¯­è¨€ç»“åˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Python/Python%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Pythoné¢è¯•é¢˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸMojo</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Mojo/Mojo%E8%AF%AD%E8%A8%80%E7%AE%80%E4%BB%8B%E5%92%8C%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Mojoè¯­è¨€ç®€ä»‹å’Œèµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Mojo/Mojo%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Mojoå¼€å‘ç¯å¢ƒæ­å»º</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸPHP</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/PHP/PHP%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>PHPå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸSwift</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Swift/Swift%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Swiftå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸC/C++</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-C++/C-C++%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>C-C++å­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-C++/%E5%BC%80%E6%BA%90%E7%9A%84C-C+%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¼€æºçš„C-C+åŒ…ç®¡ç†å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/C-C++/C-C++%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>C-C++è¯­è¨€ç›¸å…³å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸRust</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/Rust%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Rustå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/Rust%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Rustå­¦ä¹ è·¯çº¿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/0.Rust%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%BA%94%E7%94%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>0.Rustä»‹ç»å’Œåº”ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/1.Rust%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>1.Rustå¼€å‘ç¯å¢ƒæ­å»º</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/2.Rust%E5%9F%BA%E7%A1%80%E7%AF%87" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>2.RuståŸºç¡€ç¯‡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/3.Rust%E8%BF%9B%E9%98%B6%E7%AF%87" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>3.Rustè¿›é˜¶ç¯‡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/4.Rust%E6%A1%86%E6%9E%B6%E7%AF%87" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>4.Rustæ¡†æ¶ç¯‡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/5.Rust%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98%E7%AF%87" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>5.Rusté¡¹ç›®å®æˆ˜ç¯‡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/6.Rust%E4%B8%8EWebAssembly" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>6.Rustä¸WebAssembly</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/7.Rust%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>7.Rustè®¾è®¡æ¨¡å¼</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/8.Rust%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>8.Rustæ¸¸æˆå¼€å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/9.Rust%E7%A8%8B%E5%BA%8F%E8%B0%83%E8%AF%95" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>9.Rustç¨‹åºè°ƒè¯•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/10.Rust%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>10.Rustæ€§èƒ½åˆ†æä¸ä¼˜åŒ–å®æˆ˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/11.Rust%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>11.Rusté¢è¯•é¢˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/Rust%E6%A1%86%E6%9E%B6%E5%92%8C%E5%BA%93" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Rustæ¡†æ¶å’Œåº“</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/Rust%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Rustå¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/Rust%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Rustç§»åŠ¨ç«¯å¼€å‘ä½“éªŒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Rust/Rust%E5%92%8C%E5%85%B6%E4%BB%96%E8%AF%AD%E8%A8%80%E7%BB%93%E5%90%88" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Rustå’Œå…¶ä»–è¯­è¨€ç»“åˆ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸLua</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Luaè¯­è¨€å­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>LuaåŸºç¡€å…¥é—¨</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>LuaåŸºç¡€è¯­æ³•å…¥é—¨</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/1.%E5%BC%80%E5%A7%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>1.å¼€å§‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/2.%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%80%BC" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>2.ç±»å‹å’Œå€¼</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/3.%E8%A1%A8%E8%BE%BE%E5%BC%8F" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>3.è¡¨è¾¾å¼</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/4.%E8%AF%AD%E5%8F%A5" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>4.è¯­å¥</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%AE%9E%E6%88%98" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Luaå®æˆ˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Lua/Lua%E5%BC%80%E5%8F%91%E5%AE%89%E5%8D%93%E5%BA%94%E7%94%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Luaå¼€å‘å®‰å“åº”ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸZig</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Zig/Zig%E4%BB%8B%E7%BB%8D" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Zigä»‹ç»</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Zig/Zig%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Zigç›¸å…³å­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Zig/Zig%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Zigå…¥é—¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸæ±‡ç¼–</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96%E7%AE%80%E4%BB%8B%E5%92%8C%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ±‡ç¼–ç®€ä»‹å’Œèµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ±‡ç¼–å…¥é—¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ±‡ç¼–å¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Harmony%E9%B8%BF%E8%92%99%E7%B3%BB%E7%BB%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Harmony%E9%B8%BF%E8%92%99%E7%B3%BB%E7%BB%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E7%AE%80%E4%BB%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘ç®€ä»‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Harmony%E9%B8%BF%E8%92%99%E7%B3%BB%E7%BB%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Harmony%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Harmonyå¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>AIå¤§è¯­è¨€æ¨¡å‹</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/AI%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/AI%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>AIå¤§è¯­è¨€æ¨¡å‹å­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/AI%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/AI%E6%A8%A1%E5%9E%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>AIæ¨¡å‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>æ•°æ®åº“</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¸¸ç”¨æ•°æ®åº“</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ•°æ®åº“å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ•°æ®åº“å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%85%E6%A0%B8%E5%AE%9E%E7%8E%B0" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ•°æ®åº“å†…æ ¸å®ç°</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>MySQL</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/MySQL%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>MySQLå­¦ä¹ èµ„æº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/MySQL%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>MySQLå­¦ä¹ è·¯çº¿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/MySQL%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>MySQLå…¥é—¨</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>SQLite</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E6%95%B0%E6%8D%AE%E5%BA%93/SQLite" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>SQLite</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸLinux</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Linux/Linux%E5%91%BD%E4%BB%A4" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Linuxå‘½ä»¤</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Linux/Linux%E5%86%85%E6%A0%B8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Linuxå†…æ ¸</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Linux/Linux%E8%84%9A%E6%9C%AC" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Linuxè„šæœ¬</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸDocker</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%85%A5%E9%97%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Dockerå…¥é—¨</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>ğŸŒŸDockeråº”ç”¨</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/Docker%E5%BA%94%E7%94%A8%E6%94%B6%E9%9B%86" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Dockeråº”ç”¨æ”¶é›†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/Docker%E8%87%AA%E5%BB%BA%E4%BA%91%E6%89%8B%E6%9C%BA" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Dockerè‡ªå»ºäº‘æ‰‹æœº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/Docker%20%E5%8A%A0%E6%8C%81%E7%9A%84%E5%AE%89%E5%8D%93%E6%89%8B%E6%9C%BA%EF%BC%9A%E9%9A%8F%E8%BA%AB%E6%90%BA%E5%B8%A6%E7%9A%84%E7%9F%A5%E8%AF%86%E5%BA%93" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Docker åŠ æŒçš„å®‰å“æ‰‹æœºï¼šéšèº«æºå¸¦çš„çŸ¥è¯†åº“</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/NAS%E8%87%AA%E6%89%98%E7%AE%A1%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1APP%E7%AB%AF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>NASè‡ªæ‰˜ç®¡åº”ç”¨æœåŠ¡APPç«¯</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/Webman%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B_%E8%BD%BB%E6%9D%BE%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Webman%E9%A1%B9%E7%9B%AE%E2%80%94%E6%89%93%E9%80%A0%E4%B8%93%E5%B1%9E%E4%BD%A0%E7%9A%84Web%E5%BA%94%E7%94%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Webmanå®æˆ˜æ•™ç¨‹_è½»æ¾ä½¿ç”¨Dockeréƒ¨ç½²Webmané¡¹ç›®â€”æ‰“é€ ä¸“å±ä½ çš„Webåº”ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/Docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E5%92%8C%E9%83%A8%E7%BD%B2%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Dockerå¿«é€Ÿå…¥é—¨å’Œéƒ¨ç½²ä½¿ç”¨æ•™ç¨‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/Docker-Desktop%E5%BC%80%E5%90%AF%E5%86%85%E7%BD%AE%E7%9A%84K8S%E5%B9%B6%E5%AE%89%E8%A3%85kuboard%E8%BF%9B%E8%A1%8C%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Docker-Desktopå¼€å¯å†…ç½®çš„K8Så¹¶å®‰è£…kuboardè¿›è¡Œå¾®æœåŠ¡ç®¡ç†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E4%BD%BF%E7%94%A8Watchtower%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0Docker%E9%95%9C%E5%83%8F%E4%B8%8E%E5%AE%B9%E5%99%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ä½¿ç”¨Watchtowerè‡ªåŠ¨æ›´æ–°Dockeré•œåƒä¸å®¹å™¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%8F%98%E6%9B%B4Docker-Desktop%E7%9A%84%E9%95%9C%E5%83%8F%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¦‚ä½•ä¼˜é›…çš„å˜æ›´Docker-Desktopçš„é•œåƒå­˜å‚¨è·¯å¾„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20GitHub%20Actions%20%E6%9E%84%E5%BB%BA%20Docker%20%E9%95%9C%E5%83%8F" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¦‚ä½•ä½¿ç”¨ GitHub Actions æ„å»º Docker é•œåƒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E5%BC%80%E6%BA%90Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E9%9D%A2%E6%9D%BF1Panel%E6%9E%84%E5%BB%BAPHP%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8Cwebman%E6%A1%86%E6%9E%B6" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¼€æºLinuxæœåŠ¡å™¨è¿ç»´é¢æ¿1Panelæ„å»ºPHPå®¹å™¨è¿è¡Œwebmanæ¡†æ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E5%B0%86Docker%E9%95%9C%E5%83%8F%E7%BC%96%E8%AF%91%E6%88%90%E7%8B%AC%E7%AB%8B%E5%8F%AF%E7%A7%BB%E6%A4%8D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å°†Dockeré•œåƒç¼–è¯‘æˆç‹¬ç«‹å¯ç§»æ¤äºŒè¿›åˆ¶æ–‡ä»¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E5%91%8A%E5%88%ABDockerfile,%E6%8B%A5%E6%8A%B1%20docker%20init%20%E6%9E%84%E5%BB%BADocker%E9%95%9C%E5%83%8F" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å‘Šåˆ«Dockerfile,æ‹¥æŠ± docker init æ„å»ºDockeré•œåƒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/Docker%E5%BA%94%E7%94%A8/%E8%91%AB%E8%8A%A6%E5%A8%83%E5%B9%B3%E5%8F%B0%E8%87%AA%E5%8A%A8%E9%A2%84%E7%BA%A6%E8%8C%85%E5%8F%B0" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>è‘«èŠ¦å¨ƒå¹³å°è‡ªåŠ¨é¢„çº¦èŒ…å°</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>ğŸŒŸNAS</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/NAS/NAS%E7%A1%AC%E4%BB%B6%E6%8E%A8%E8%8D%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>NASç¡¬ä»¶æ¨è</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/NAS/NAS%E7%B3%BB%E7%BB%9F%E6%8E%A8%E8%8D%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>NASç³»ç»Ÿæ¨è</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/NAS/NAS%E5%A5%BD%E5%B7%A5%E5%85%B7%E6%8E%A8%E8%8D%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>NASå¥½å·¥å…·æ¨è</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/NAS/%E7%A1%AC%E4%BB%B6%E8%AE%BE%E5%A4%87%E6%94%B9%E9%80%A0%E6%88%90NAS" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç¡¬ä»¶è®¾å¤‡æ”¹é€ æˆNAS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/Docker/NAS/%E9%AD%94%E4%BA%91%E8%85%BEZeusC1%E2%80%94%E2%80%94%E4%BA%91%E6%89%8B%E6%9C%BA%E5%BD%9312%E4%B8%AA%E6%89%8B%E6%9C%BA%E7%94%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>é­”äº‘è…¾ZeusC1â€”â€”äº‘æ‰‹æœºå½“12ä¸ªæ‰‹æœºç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>ğŸŒŸç½‘ç»œå®‰å…¨</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%BB%91%E5%AE%A2%E5%B7%A5%E5%85%B7%E7%B3%BB%E5%88%97" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>é»‘å®¢å·¥å…·ç³»åˆ—</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%A4%BE%E5%8C%BA%E8%AE%BA%E5%9D%9B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç½‘ç»œå®‰å…¨ç¤¾åŒºè®ºå›</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%BB%91%E5%AE%A2%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>é»‘å®¢è¾…åŠ©å·¥å…·</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E5%92%8C%E4%BD%BF%E7%94%A8%E3%80%91/Venom-Crawler%E8%BD%AC%E4%B8%BA%E6%8D%A1%E6%B4%9E%E8%80%8C%E7%94%9F%E7%9A%84%E7%88%AC%E8%99%AB%E7%A5%9E%E5%99%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Venom-Crawlerè½¬ä¸ºæ¡æ´è€Œç”Ÿçš„çˆ¬è™«ç¥å™¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E5%92%8C%E4%BD%BF%E7%94%A8%E3%80%91/%E5%AF%86%E6%8E%A2%E5%B7%A5%E5%85%B7%E9%9B%86GUI%E6%B8%97%E9%80%8F%E7%89%88" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¯†æ¢å·¥å…·é›†GUIæ¸—é€ç‰ˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E5%92%8C%E4%BD%BF%E7%94%A8%E3%80%91/Aoman%E5%8E%BB%E6%8C%87%E7%BA%B9%E6%B5%8F%E8%A7%88%E5%99%A8%E2%80%94%E4%BC%AA%E9%80%A0%E4%B8%80%E4%B8%AA%E5%AE%89%E5%85%A8%E7%9A%84%E6%B8%97%E9%80%8F%E7%8E%AF%E5%A2%83" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Aomanå»æŒ‡çº¹æµè§ˆå™¨â€”ä¼ªé€ ä¸€ä¸ªå®‰å…¨çš„æ¸—é€ç¯å¢ƒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>æ€è·¯</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E9%98%B2%E8%BA%AB%E7%A7%98%E7%B1%8D" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç½‘ç»œå®‰å…¨é˜²èº«ç§˜ç±</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E4%B8%80%E7%A7%8D%E5%88%A9%E7%94%A8%E5%90%88%E6%B3%95%E5%B7%A5%E5%85%B7%E6%B8%97%E9%80%8F%E7%9A%84%E6%96%B0%E5%9E%8B%E6%96%B9%E6%B3%95" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ä¸€ç§åˆ©ç”¨åˆæ³•å·¥å…·æ¸—é€çš„æ–°å‹æ–¹æ³•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/HFish_%E6%B0%B8%E4%B9%85%E5%85%8D%E8%B4%B9%E2%80%94%E5%B7%A7%E8%AE%BE%E8%9C%9C%E7%BD%90%E8%BF%B7%E5%B1%80" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>HFish_æ°¸ä¹…å…è´¹â€”å·§è®¾èœœç½è¿·å±€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/App%E6%B8%97%E9%80%8F_%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Appæ¸—é€_äººè„¸è¯†åˆ«ç™»å½•ç»•è¿‡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E8%BF%BD%E8%B8%AA%E6%94%BB%E5%87%BB%E6%BA%90%E5%A4%B4%20%E4%BB%8EIP%E5%9C%B0%E5%9D%80%E5%88%B0%E6%94%BB%E5%87%BB%E8%80%85%E8%BA%AB%E4%BB%BD%E7%9A%84%E6%BA%AF%E6%BA%90%E4%B9%8B%E6%97%85" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>è¿½è¸ªæ”»å‡»æºå¤´ ä»IPåœ°å€åˆ°æ”»å‡»è€…èº«ä»½çš„æº¯æºä¹‹æ—…</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E5%9C%A8%E5%AE%B6%E6%89%93%E5%8D%A1%E7%9A%84%E6%96%B9%E6%B3%95" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>åœ¨å®¶æ‰“å¡çš„æ–¹æ³•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E7%BD%91%E7%BB%9C%E6%B0%B4%E5%86%9B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç½‘ç»œæ°´å†›</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BC%80%E6%BA%90%E6%83%85%E6%8A%A5%E8%B7%9F%E8%B8%AA%E4%B8%80%E4%B8%AA%E4%BA%BA" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¦‚ä½•ä½¿ç”¨å¼€æºæƒ…æŠ¥è·Ÿè¸ªä¸€ä¸ªäºº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E4%BD%A0%E6%98%AF%E5%90%A6%E5%9C%A8%E6%AD%A3%E7%A1%AE%E7%9A%84%E4%BD%BF%E7%94%A8vpn" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ä½ æ˜¯å¦åœ¨æ­£ç¡®çš„ä½¿ç”¨vpn</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E5%8F%AF%E7%9B%91%E5%90%ACVPN%E7%9A%84%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¯ç›‘å¬VPNçš„é»‘å®¢æŠ€æœ¯</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E5%9F%BA%E4%BA%8ELinux%E5%86%85%E6%A0%B8%E7%9A%84VPN%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>åŸºäºLinuxå†…æ ¸çš„VPNå·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E2%80%94ModHeader_%E5%8A%A9%E4%BD%A0%E7%BB%95%E8%BF%87%E5%BE%AE%E4%BF%A1%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E9%99%90%E5%88%B6" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æµè§ˆå™¨æ’ä»¶â€”ModHeader_åŠ©ä½ ç»•è¿‡å¾®ä¿¡æˆæƒç™»å½•é™åˆ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%80%9D%E8%B7%AF%E3%80%91/%E6%A3%80%E6%B5%8B%E8%87%AA%E5%AE%B6%E6%91%84%E5%83%8F%E5%A4%B4%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%BC%8F%E6%B4%9E" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ£€æµ‹è‡ªå®¶æ‘„åƒå¤´æ˜¯å¦å­˜åœ¨æ¼æ´</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>KaliLinux</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90KaliLinux%E3%80%91/%E5%AE%9E%E4%BD%93%E6%9C%BA%E5%AE%89%E8%A3%85kali%E6%95%99%E7%A8%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å®ä½“æœºå®‰è£…kaliæ•™ç¨‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90KaliLinux%E3%80%91/%E6%89%8B%E6%9C%BA%E5%AE%89%E8%A3%85Kali%20Linux" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ‰‹æœºå®‰è£…Kali Linux</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90KaliLinux%E3%80%91/KaliLinux%E5%B7%A5%E5%85%B7%E8%84%91%E5%9B%BE_%E5%AE%89%E5%85%A8%E4%B8%93%E5%AE%B6%E7%9A%84%E5%86%9B%E6%A2%B0%E5%BA%93" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>KaliLinuxå·¥å…·è„‘å›¾_å®‰å…¨ä¸“å®¶çš„å†›æ¢°åº“</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90KaliLinux%E3%80%91/kali%20Linux%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E9%9B%86%E5%90%88" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>kali Linuxå®‰å…¨å·¥å…·é›†åˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90KaliLinux%E3%80%91/KaliLinux%E4%B8%8B%E7%BC%96%E5%86%99%E5%AE%89%E5%8D%93%E6%9C%A8%E9%A9%AC" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>KaliLinuxä¸‹ç¼–å†™å®‰å“æœ¨é©¬</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>æŠ“åŒ…é…ç½®</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE%E3%80%91/%E5%AE%89%E5%8D%93%E9%AB%98%E7%89%88%E6%9C%ACHTTPS%E6%8A%93%E5%8C%85%E7%BB%88%E6%9E%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å®‰å“é«˜ç‰ˆæœ¬HTTPSæŠ“åŒ…ç»ˆæè§£å†³æ–¹æ¡ˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>æ¸—é€æµ‹è¯•å·¥å…·</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E3%80%91/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ¸—é€æµ‹è¯•å·¥å…·</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>é€†å‘ç ´è§£</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/Magisk-Lsposed%20%E8%A7%A3%E5%86%B3%E6%9F%90%E9%9F%B3APP%E6%8A%93%E5%8C%85%E9%97%AE%E9%A2%98" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Magisk-Lsposed è§£å†³æŸéŸ³APPæŠ“åŒ…é—®é¢˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/%E6%8A%96%E9%9F%B3abogus%E9%80%86%E5%90%91%E5%88%86%E6%9E%90" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æŠ–éŸ³abogusé€†å‘åˆ†æ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/JS%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7%E6%B8%85%E5%8D%95" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>JSé€†å‘å·¥å…·æ¸…å•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/js%E9%80%86%E5%90%91" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>jsé€†å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/frida%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>fridaå…¥é—¨ä½¿ç”¨ä»‹ç»</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/Electron%E5%BA%94%E7%94%A8%E9%AA%8C%E8%AF%81%E7%A0%B4%E8%A7%A3" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>Electronåº”ç”¨éªŒè¯ç ´è§£</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/clash+yakt%E6%8A%93%E5%8C%85%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>clash+yaktæŠ“åŒ…å¾®ä¿¡å°ç¨‹åº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/APP%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E6%95%99%E7%A8%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>APPé€†å‘ç ´è§£æ•™ç¨‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/APK%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>APKé€†å‘å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç½‘ç»œå—…æ¢çš„åŸç†å’Œå¸¸ç”¨å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/%E5%BC%80%E6%BA%90%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å¼€æºé€†å‘å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/%E3%80%90%E8%BD%A6%E8%81%94%E7%BD%91%E3%80%91%E8%BD%A6%E8%BD%BD%20Android%20%E5%BA%94%E7%94%A8%E6%94%BB%E5%87%BB-%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ã€è½¦è”ç½‘ã€‘è½¦è½½ Android åº”ç”¨æ”»å‡»-é€†å‘å·¥å…·</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/%E3%80%90%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E3%80%91%E6%B7%98%E7%B3%BB%E6%8A%93%E5%8C%85%E6%B1%87%E6%80%BB(%E9%B1%BC%20%E9%BA%A6%20%E7%8C%AB%20%E9%A5%BF%20%E5%AE%9D)" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ã€å®‰å“é€†å‘ã€‘æ·˜ç³»æŠ“åŒ…æ±‡æ€»(é±¼ éº¦ çŒ« é¥¿ å®)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3%E3%80%91/%E3%80%90%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E3%80%91%E6%9F%90%E9%9F%B3%E6%B5%B7%E5%A4%96%E7%89%88tiktok%E6%8A%93%E5%8C%85" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ã€å®‰å“é€†å‘ã€‘æŸéŸ³æµ·å¤–ç‰ˆtiktokæŠ“åŒ…</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46adc9ff data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h3 class="text" data-v-46adc9ff>é»‘å®¢æŠ€æœ¯</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF%E3%80%91/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AE%97%E6%B3%95%E7%9A%84%E5%BA%94%E7%94%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ•°æ®ç»“æ„ç®—æ³•çš„åº”ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF%E3%80%91/%E4%B8%8D%E5%88%B7%E5%9B%BA%E4%BB%B6%E6%AD%A6%E8%A3%85%E5%AE%B6%E7%94%A8%E8%B7%AF%E7%94%B1%E5%99%A8" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ä¸åˆ·å›ºä»¶æ­¦è£…å®¶ç”¨è·¯ç”±å™¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF%E3%80%91/%E5%90%8E%E9%97%A8%E6%8A%80%E6%9C%AF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>åé—¨æŠ€æœ¯</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E3%80%90%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF%E3%80%91/%E5%9C%A8Windows%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%8F%90%E6%9D%83%E7%9A%848%E7%A7%8D%E4%B8%BB%E8%A6%81%E5%A7%BF%E5%8A%BF" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>åœ¨Windowsç³»ç»Ÿä¸‹ææƒçš„8ç§ä¸»è¦å§¿åŠ¿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%95%99%E7%A8%8B" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç½‘ç»œå®‰å…¨æ•™ç¨‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3%E7%8E%AF%E5%A2%83" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>ç½‘ç»œå®‰å…¨ç›¸å…³ç¯å¢ƒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%BB%91%E5%AE%A2%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>é»‘å®¢å¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3%E7%9A%84%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>å®‰å…¨ç›¸å…³çš„å¼€æºé¡¹ç›®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><div class="group" data-v-b99191f1><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b99191f1 data-v-46adc9ff><div class="item" role="button" tabindex="0" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><h2 class="text" data-v-46adc9ff>å¼€æºç›¸å…³</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46adc9ff><span class="vpi-chevron-right caret-icon" data-v-46adc9ff></span></div></div><div class="items" data-v-46adc9ff><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><div class="item" data-v-46adc9ff><div class="indicator" data-v-46adc9ff></div><a class="VPLink link link" href="/ProgramLearnNotes/Document/%E5%BC%80%E6%BA%90%E7%9B%B8%E5%85%B3/%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E8%8A%B1%E9%87%8C%E8%83%A1%E5%93%A8%E7%9A%84Github%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5" data-v-46adc9ff><!--[--><p class="text" data-v-46adc9ff>æ‰“é€ ä¸€ä¸ªèŠ±é‡Œèƒ¡å“¨çš„Githubä¸ªäººä¸»é¡µ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><div class="VPSidebarItem level-1 is-link" data-v-46adc9ff data-v-46adc9ff><!----><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-41e8be72 data-v-4c7856c6><div class="VPDoc has-sidebar has-aside" data-v-4c7856c6 data-v-54e61e03><!--[--><!--]--><div class="container" data-v-54e61e03><div class="aside" data-v-54e61e03><div class="aside-curtain" data-v-54e61e03></div><div class="aside-container" data-v-54e61e03><div class="aside-content" data-v-54e61e03><div class="VPDocAside" data-v-54e61e03 data-v-f245b7e5><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-f245b7e5 data-v-e57a11cf><div class="content" data-v-e57a11cf><div class="outline-marker" data-v-e57a11cf></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-e57a11cf>âš¡ï¸æ–‡æ¡£å†…å®¹å¤§çº²</div><ul class="VPDocOutlineItem root" data-v-e57a11cf data-v-1c0a706d><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-f245b7e5></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-54e61e03><div class="content-container" data-v-54e61e03><!--[--><!--]--><main class="main" data-v-54e61e03><div style="position:relative;" class="vp-doc _ProgramLearnNotes_Document_Python_Python%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91" data-v-54e61e03><div><h1 id="python-è„šæœ¬å¼€å‘" tabindex="-1">Python è„šæœ¬å¼€å‘ <a class="header-anchor" href="#python-è„šæœ¬å¼€å‘" aria-label="Permalink to &quot;Python è„šæœ¬å¼€å‘&quot;">â€‹</a></h1><h2 id="ç©è½¬-python30-ä¸ªå®ç”¨è„šæœ¬è§£é”è‡ªåŠ¨åŒ–å¤§æ³•" tabindex="-1">ç©è½¬ Python30 ä¸ªå®ç”¨è„šæœ¬è§£é”è‡ªåŠ¨åŒ–å¤§æ³• <a class="header-anchor" href="#ç©è½¬-python30-ä¸ªå®ç”¨è„šæœ¬è§£é”è‡ªåŠ¨åŒ–å¤§æ³•" aria-label="Permalink to &quot;ç©è½¬ Python30 ä¸ªå®ç”¨è„šæœ¬è§£é”è‡ªåŠ¨åŒ–å¤§æ³•&quot;">â€‹</a></h2><p>è®©æˆ‘ä»¬ä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œä¸€æ­¥æ­¥æ¥å­¦ä¹ è¿™äº›ç¥å¥‡çš„ä»£ç ç‰‡æ®µå§ã€‚</p><p><strong>1.</strong> <code>hello_world.py</code>: è¿™æ˜¯ Python å…¥é—¨çš„ç¬¬ä¸€è¯¾ï¼Œæ‰“å°å‡º&quot;Hello, World!&quot;ï¼Œè®©ä½ çŸ¥é“ä½ å·²ç»ä¸Šè·¯äº†ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> print_hello</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Hello, World!&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">print_hello</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>2.</strong> <code>countdown.py</code>: è®©æˆ‘ä»¬æ¥ä¸ªå€’è®¡æ—¶ï¼Œè¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œç„¶åä»å¤§åˆ°å°æ•°æ•°ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> countdown</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">n</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(n)</span></span>
<span class="line"><span style="color:#ABB2BF;">        n </span><span style="color:#56B6C2;">-=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;">countdown</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>3.</strong> <code>file_reader.py</code>: æ‰“å¼€æ–‡ä»¶ï¼Œè¯»å–å†…å®¹ï¼Œè½»æ¾æŸ¥çœ‹æ–‡æœ¬ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> read_file</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_name</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_name, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        content </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> content</span></span>
<span class="line"><span style="color:#ABB2BF;">content </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> read_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.txt&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>4.</strong> <code>email_sender.py</code>: å‘é€ä¸€å°ç®€å•çš„é‚®ä»¶é€šçŸ¥ï¼Œç”¨èµ·æ¥å°±åƒå‘çŸ­ä¿¡ä¸€æ ·ç®€å•ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">to</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">subject</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">message</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å®ä¾‹åŒ–SMTPæœåŠ¡å™¨...</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(from_addr, to, message)</span></span>
<span class="line"><span style="color:#61AFEF;">send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;you@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;è‡ªåŠ¨é‚®ä»¶&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;è¿™æ˜¯ä½ çš„æé†’é‚®ä»¶ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>5.</strong> <code>web_scraper.py</code>: çˆ¬è™«åˆä½“éªŒï¼ŒæŠ“å–ç½‘é¡µæ•°æ®ï¼Œæ¯”å¦‚æ–°é—»æ ‡é¢˜ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_news_titles</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url)</span></span>
<span class="line"><span style="color:#ABB2BF;">    titles </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.html.</span><span style="color:#61AFEF;">find_all</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;h2&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> [title.text </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> title </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> titles]</span></span>
<span class="line"><span style="color:#ABB2BF;">titles </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_news_titles</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;https://news.example.com&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>6.</strong> <code>csv_sorter.py</code>: è¯»å– CSV æ–‡ä»¶ï¼ŒæŒ‰ç‰¹å®šåˆ—æ’åºï¼Œä¿æŒæ•°æ®æ•´æ´ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> sort_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">column</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(input_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sorted_df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df.</span><span style="color:#61AFEF;">sort_values</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">column)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sorted_df.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sorted_&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> input_file, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">sort_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;date&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>7.</strong> <code>image_resizer.py</code>: å›¾ç‰‡å¤„ç†å°èƒ½æ‰‹ï¼Œè°ƒæ•´å›¾ç‰‡å¤§å°ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> resize_image</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">image_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">new_size</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(image_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">    resized_img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> img.</span><span style="color:#61AFEF;">resize</span><span style="color:#ABB2BF;">(new_size)</span></span>
<span class="line"><span style="color:#ABB2BF;">    resized_img.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;resized_&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> image_path)</span></span>
<span class="line"><span style="color:#61AFEF;">resize_image</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;pic.jpg&#39;</span><span style="color:#ABB2BF;">, (</span><span style="color:#D19A66;">800</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>8.</strong> <code>password_generator.py</code>: è‡ªåŠ¨åˆ›å»ºéšæœºå¯†ç ï¼Œå®‰å…¨åˆå¤šæ ·ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> string</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> generate_password</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">length</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    chars </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> string.ascii_letters </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> string.digits </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> string.punctuation</span></span>
<span class="line"><span style="color:#ABB2BF;">    password </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">choice</span><span style="color:#ABB2BF;">(chars) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> _ </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(length))</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> password</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">generate_password</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>9.</strong> <code>daily_weather.py</code>: è·å–å¹¶æ˜¾ç¤ºå½“åœ°å¤©æ°”ï¼Œæ¯å¤©éƒ½ä¸ä¸€æ ·ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_weather</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">city</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # APIè¯·æ±‚...</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> weather_data[</span><span style="color:#98C379;">&#39;description&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">city_weather </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_weather</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;New York&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>10.</strong> <code>task_scheduler.py</code>: è®¾å®šå®šæ—¶ä»»åŠ¡ï¼Œè‡ªåŠ¨å®Œæˆæ¯æ—¥ä¾‹è¡Œå…¬äº‹ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> schedule, time</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> job_function</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä½ çš„ä»»åŠ¡...</span></span>
<span class="line"><span style="color:#ABB2BF;">schedule.</span><span style="color:#61AFEF;">every</span><span style="color:#ABB2BF;">().day.</span><span style="color:#61AFEF;">at</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;10:00&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">do</span><span style="color:#ABB2BF;">(job_function)</span></span>
<span class="line"><span style="color:#C678DD;">while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    schedule.</span><span style="color:#61AFEF;">run_pending</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>11.</strong> <code>excel_data_analyzer.py</code>: åˆ†æ Excel æ•°æ®ï¼Œæ‰¾å‡ºè¶‹åŠ¿å’Œå¼‚å¸¸å€¼ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> analyze_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ•°æ®åˆ†æ...</span></span>
<span class="line"><span style="color:#ABB2BF;">    summary </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">describe</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> summary</span></span>
<span class="line"><span style="color:#ABB2BF;">report </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> analyze_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sales_data.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>12.</strong> <code>csv_to_json.py</code>: å°† CSV è½¬æ¢ä¸º JSONï¼Œæ–¹ä¾¿æ•°æ®äº¤æ¢ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> csv</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> csv_to_json</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">csv_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">json_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(csv_file, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> csv_data, </span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(json_file, </span><span style="color:#98C379;">&#39;w&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> json_data:</span></span>
<span class="line"><span style="color:#ABB2BF;">        reader </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> csv.</span><span style="color:#61AFEF;">DictReader</span><span style="color:#ABB2BF;">(csv_data)</span></span>
<span class="line"><span style="color:#ABB2BF;">        json_data.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;[</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> reader:</span></span>
<span class="line"><span style="color:#ABB2BF;">            json_data.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">{{</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">()[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;: &quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row[row.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">()[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">}}\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        json_data.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;]</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">csv_to_json</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;input.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;output.json&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>13.</strong> <code>email_attachment_sender.py</code>: å‘é€å¸¦é™„ä»¶çš„ç”µå­é‚®ä»¶ï¼Œæ–‡ä»¶ç®¡ç†å˜å¾—æ›´ç®€å•ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> send_email_with_attachment</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">to</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">subject</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">attachment_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ·»åŠ é™„ä»¶...</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(from_addr, to, </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;Subject: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">subject</span><span style="color:#D19A66;">}</span><span style="color:#56B6C2;">\n\n</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">msg</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å‘é€...</span></span>
<span class="line"><span style="color:#61AFEF;">send_email_with_attachment</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;recipient@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;é™„ä»¶é‚®ä»¶&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;é‚®ä»¶æ­£æ–‡&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;document.pdf&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>14.</strong> <code>text_summary_generator.py</code>: è‡ªåŠ¨ç”Ÿæˆæ–‡æœ¬æ‘˜è¦ï¼ŒèŠ‚çœé˜…è¯»æ—¶é—´ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> gensim.summarization </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> summarize</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> create_summary</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">text</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#61AFEF;"> summarize</span><span style="color:#ABB2BF;">(text)</span></span>
<span class="line"><span style="color:#ABB2BF;">summary </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> create_summary</span><span style="color:#ABB2BF;">(long_text)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>15.</strong> <code>git_tracker.py</code>: è‡ªåŠ¨è·Ÿè¸ªå¹¶è®°å½• Git æäº¤ä¿¡æ¯ï¼Œæ•´ç†é¡¹ç›®å†å²ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> subprocess</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> git_log</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">repo_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    log </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> subprocess.</span><span style="color:#61AFEF;">check_output</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;git&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;log&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;--oneline&#39;</span><span style="color:#ABB2BF;">, repo_path])</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> log.</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">commit_history </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> git_log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>16.</strong> <code>pdf_watermarker.py</code>: åœ¨ PDF ä¸Šæ·»åŠ æ°´å°ï¼Œä¿æŠ¤ç‰ˆæƒæˆ–ä¸ªæ€§åŒ–ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> PyPDF2 </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> PdfWriter, PdfReader</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> add_watermark</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_pdf</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_pdf</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">watermark</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    pdf_writer </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> PdfWriter</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    pdf_reader </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> PdfReader</span><span style="color:#ABB2BF;">(input_pdf)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> page_num </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(pdf_reader.numPages):</span></span>
<span class="line"><span style="color:#ABB2BF;">        page </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pdf_reader.</span><span style="color:#61AFEF;">getPage</span><span style="color:#ABB2BF;">(page_num)</span></span>
<span class="line"><span style="color:#ABB2BF;">        page.</span><span style="color:#61AFEF;">mergePage</span><span style="color:#ABB2BF;">(watermark)</span></span>
<span class="line"><span style="color:#ABB2BF;">        pdf_writer.</span><span style="color:#61AFEF;">addPage</span><span style="color:#ABB2BF;">(page)</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(output_pdf, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> out:</span></span>
<span class="line"><span style="color:#ABB2BF;">        pdf_writer.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(out)</span></span>
<span class="line"><span style="color:#ABB2BF;">watermark_pdf </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> add_watermark</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;original.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;watermarked.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;COPYRIGHT&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>17.</strong> <code>webhook_handler.py</code>: ç›‘å¬ API webhookï¼Œè‡ªåŠ¨åŒ–å¤„ç†å¤–éƒ¨äº‹ä»¶ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> handle_webhook</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è§£ææ•°æ®...</span></span>
<span class="line"><span style="color:#61AFEF;">    process_data</span><span style="color:#ABB2BF;">(data)</span></span>
<span class="line"><span style="color:#61AFEF;">handle_webhook</span><span style="color:#ABB2BF;">(requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;http://your-webhook-url.com&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">())</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>18.</strong> <code>database_connector.py</code>: è¿æ¥æ•°æ®åº“ï¼Œæ‰§è¡Œ SQL æŸ¥è¯¢æˆ–æ“ä½œã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> sqlite3</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> query_database</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">query</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    conn </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sqlite3.</span><span style="color:#61AFEF;">connect</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;database.db&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    cursor </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> conn.</span><span style="color:#61AFEF;">cursor</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    cursor.</span><span style="color:#61AFEF;">execute</span><span style="color:#ABB2BF;">(query)</span></span>
<span class="line"><span style="color:#ABB2BF;">    results </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cursor.</span><span style="color:#61AFEF;">fetchall</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    conn.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> results</span></span>
<span class="line"><span style="color:#ABB2BF;">query_results </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> query_database</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;SELECT * FROM users&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>19.</strong> <code>csv_splitter.py</code>: å°†å¤§æ–‡ä»¶åˆ‡åˆ†æˆå¤šä¸ªå°æ–‡ä»¶ï¼Œæ–¹ä¾¿ç®¡ç†å’Œå¤„ç†ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> csv</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> split_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">chunk_size</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(input_file, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> csv_in, \</span></span>
<span class="line"><span style="color:#56B6C2;">         open</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;split_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">input_file</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;w&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">newline</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> csv_out:</span></span>
<span class="line"><span style="color:#ABB2BF;">        reader </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> csv.</span><span style="color:#61AFEF;">reader</span><span style="color:#ABB2BF;">(csv_in)</span></span>
<span class="line"><span style="color:#ABB2BF;">        writer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> csv.</span><span style="color:#61AFEF;">writer</span><span style="color:#ABB2BF;">(csv_out)</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> i, chunk </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(reader, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> i </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;"> chunk_size </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                csv_out.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                csv_in.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                new_file </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;split_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">i</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.csv&#39;</span></span>
<span class="line"><span style="color:#C678DD;">                with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(new_file, </span><span style="color:#98C379;">&#39;a&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">newline</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> new_csv_out:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    writer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> csv.</span><span style="color:#61AFEF;">writer</span><span style="color:#ABB2BF;">(new_csv_out)</span></span>
<span class="line"><span style="color:#ABB2BF;">            writer.</span><span style="color:#61AFEF;">writerow</span><span style="color:#ABB2BF;">(chunk)</span></span>
<span class="line"><span style="color:#61AFEF;">split_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;large_data.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>20.</strong> <code>csv_combiner.py</code>: åˆå¹¶å¤šä¸ª CSV æ–‡ä»¶ä¸ºä¸€ä¸ªï¼Œç®€åŒ–æ•°æ®é›†æˆè¿‡ç¨‹ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> glob</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> combine_csvs</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    dfs </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> glob.</span><span style="color:#61AFEF;">glob</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">directory</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/*.csv&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        dfs.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    combined_df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(dfs, </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    combined_df.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;combined_data.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">combine_csvs</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;split_data/&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>21.</strong> <code>csv_cleaner.py</code>: è‡ªåŠ¨æ¸…ç† CSV ä¸­çš„é‡å¤é¡¹å’Œç¼ºå¤±å€¼ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> clean_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(input_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df.</span><span style="color:#61AFEF;">drop_duplicates</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df.</span><span style="color:#61AFEF;">dropna</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    df.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;cleaned_&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> input_file, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">clean_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;dirty_data.csv&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>22.</strong> <code>file_uploader.py</code>: ä¸Šä¼ æ–‡ä»¶åˆ°äº‘å­˜å‚¨æœåŠ¡ï¼Œå¦‚ Google Drive æˆ– Dropboxã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> google.oauth2.credentials </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Credentials</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> googleapiclient.discovery </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> build</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> upload_to_drive</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">credentials_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    service </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> build</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;drive&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;v3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">credentials</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">Credentials.</span><span style="color:#61AFEF;">from_authorized_user_file</span><span style="color:#ABB2BF;">(credentials_path))</span></span>
<span class="line"><span style="color:#ABB2BF;">    file_metadata </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">: file_path}</span></span>
<span class="line"><span style="color:#ABB2BF;">    media </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MediaFileUpload</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#E06C75;font-style:italic;">resumable</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;">    file</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> service.</span><span style="color:#61AFEF;">files</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">body</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">file_metadata, </span><span style="color:#E06C75;font-style:italic;">media_body</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">media, </span><span style="color:#E06C75;font-style:italic;">fields</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;id&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">execute</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">upload_to_drive</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;uploaded_file.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;credentials.json&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>23.</strong> <code>time_tracker.py</code>: è®°å½•å’Œåˆ†æå·¥ä½œæ—¶é—´ï¼Œæå‡ç”Ÿäº§åŠ›ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> start_stop_timer</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">task_name</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    start_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ...å¼€å§‹è®¡æ—¶...</span></span>
<span class="line"><span style="color:#ABB2BF;">    end_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    total_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> end_time </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> start_time</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">task_name</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> completed in </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">total_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">start_stop_timer</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Writing code&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>24.</strong> <code>data_visualizer.py</code>: ç”Ÿæˆå›¾è¡¨ï¼Œè®©å¤æ‚æ•°æ®å¯è§†åŒ–ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> matplotlib.pyplot </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> plt</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> plot_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">x</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">y</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">plot</span><span style="color:#ABB2BF;">(x, y)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">xlabel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;X-axis&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">ylabel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Y-axis&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Data Visualization&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">show</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">x </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">y </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">50</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#61AFEF;">plot_data</span><span style="color:#ABB2BF;">(x, y)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>25.</strong> <code>webpage_screenshot.py</code>: è‡ªåŠ¨æŠ“å–ç½‘é¡µæˆªå›¾ï¼Œç”¨äºæŠ¥å‘Šæˆ–å­˜æ¡£ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pyautogui</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> take_screenshot</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ...ä½¿ç”¨Seleniumæˆ–ç±»ä¼¼å·¥å…·...</span></span>
<span class="line"><span style="color:#ABB2BF;">    pyautogui.</span><span style="color:#61AFEF;">screenshot</span><span style="color:#ABB2BF;">(output_path)</span></span>
<span class="line"><span style="color:#61AFEF;">take_screenshot</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;https://example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;screenshot.png&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>26.</strong> <code>csv_split_by_date.py</code>: æ ¹æ®æ—¥æœŸèŒƒå›´åˆ†å‰² CSV æ–‡ä»¶ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> split_by_date</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">start_date</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">end_date</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(input_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sliced_df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[(df[</span><span style="color:#98C379;">&#39;date&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> start_date) </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;"> (df[</span><span style="color:#98C379;">&#39;date&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#ABB2BF;"> end_date)]</span></span>
<span class="line"><span style="color:#ABB2BF;">    sliced_df.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;split_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">start_date</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">end_date</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">split_by_date</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sales_data.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2022-01-01&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2022-03-31&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>27.</strong> <code>email_report_generator.py</code>: è‡ªåŠ¨ç”Ÿæˆå¹¶å‘é€å®šæœŸé”€å”®æŠ¥å‘Šã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib, xlsxwriter</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> generate_sales_report</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">report_data</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> xlsxwriter.</span><span style="color:#61AFEF;">Workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sales_report.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ...ç”ŸæˆæŠ¥å‘Š...</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">    send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;team@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Sales Report&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Please find attached the latest sales report.&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sales_report.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        attach </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;sales_report.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">...</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">attach</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">attach)</span></span>
<span class="line"><span style="color:#61AFEF;">generate_sales_report</span><span style="color:#ABB2BF;">(sales_data)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>28.</strong> <code>file_encryptor.py</code>: åŠ å¯†æ–‡ä»¶ï¼Œä¿æŠ¤æ•æ„Ÿä¿¡æ¯ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> cryptography.fernet </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Fernet</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> encrypt_file</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">key</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    cipher_suite </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Fernet</span><span style="color:#ABB2BF;">(key)</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(input_file, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        original_data </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    encrypted_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cipher_suite.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(original_data)</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;encrypted_&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> input_file, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> encrypted_file:</span></span>
<span class="line"><span style="color:#ABB2BF;">        encrypted_file.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(encrypted_data)</span></span>
<span class="line"><span style="color:#61AFEF;">encrypt_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;confidential.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;your_secret_key&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>29.</strong> <code>csv_data_validation.py</code>: æ£€æŸ¥ CSV æ•°æ®ä¸€è‡´æ€§ï¼Œé¿å…é”™è¯¯ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> validate_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">validation_rules</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(input_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    errors </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">lambda</span><span style="color:#D19A66;font-style:italic;"> row</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">all</span><span style="color:#ABB2BF;">(row[col]ç¬¦åˆéªŒè¯è§„åˆ™ </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> col </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> validation_rules), </span><span style="color:#E06C75;font-style:italic;">axis</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> errors.</span><span style="color:#61AFEF;">value_counts</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">validation_results </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> validate_data</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data.csv&#39;</span><span style="color:#ABB2BF;">, {</span><span style="color:#98C379;">&#39;email&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;^</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\w</span><span style="color:#56B6C2;">\.</span><span style="color:#D19A66;">-]+</span><span style="color:#E06C75;">@</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\w</span><span style="color:#56B6C2;">\.</span><span style="color:#D19A66;">-]+</span><span style="color:#56B6C2;">\.</span><span style="color:#E06C75;">\w</span><span style="color:#D19A66;">+</span><span style="color:#E06C75;">$&#39;</span><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>30.</strong> <code>web_crawler_and_scraper.py</code>: çˆ¬å–ç½‘ç«™ä¿¡æ¯å¹¶å­˜å‚¨åˆ° CSV æˆ–æ•°æ®åº“ä¸­ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> scrapy</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> MySpider</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">scrapy</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">Spider</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    name </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;myspider&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    start_urls </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;http://example.com&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> parse</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">response</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ...è§£æHTML...</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;title&#39;</span><span style="color:#ABB2BF;">: response.</span><span style="color:#61AFEF;">css</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;h1::text&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;description&#39;</span><span style="color:#ABB2BF;">: response.</span><span style="color:#61AFEF;">css</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;p::text&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        yield</span><span style="color:#ABB2BF;"> {k: v </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> k, v </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">()}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> store_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">item</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ...å­˜å‚¨åˆ°CSVæˆ–æ•°æ®åº“...</span></span>
<span class="line"><span style="color:#ABB2BF;">spider </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MySpider</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">spider.</span><span style="color:#61AFEF;">crawl</span><span style="color:#ABB2BF;">(spider)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>è¿™äº›è„šæœ¬æ¶µç›–äº†ä»åŸºæœ¬æ“ä½œåˆ°æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œç°åœ¨ä½ å·²ç»æŒæ¡äº† 30 ä¸ª Python è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå¯ä»¥å¼€å§‹åœ¨å®é™…é¡¹ç›®ä¸­å¤§å±•èº«æ‰‹äº†ï¼è®°å¾—ä¸æ–­å®è·µï¼Œä½ çš„ Python æŠ€èƒ½ä¼šè¶Šæ¥è¶Šæ£’ï¼</p><h1 id="äº¬ä¸œè‡ªåŠ¨é¢„çº¦å’ŒæŠ¢è´­æŸå°è„šæœ¬" tabindex="-1">äº¬ä¸œè‡ªåŠ¨é¢„çº¦å’ŒæŠ¢è´­æŸå°è„šæœ¬ <a class="header-anchor" href="#äº¬ä¸œè‡ªåŠ¨é¢„çº¦å’ŒæŠ¢è´­æŸå°è„šæœ¬" aria-label="Permalink to &quot;äº¬ä¸œè‡ªåŠ¨é¢„çº¦å’ŒæŠ¢è´­æŸå°è„šæœ¬&quot;">â€‹</a></h1><p>ä»£ç </p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> functools</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pickle</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> lxml </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> etree</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> jd_logger </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logger</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> timer </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Timer</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> config </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> global_config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> concurrent.futures </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ProcessPoolExecutor</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> exception </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> SKException</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> util </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">    parse_json,</span></span>
<span class="line"><span style="color:#ABB2BF;">    send_wechat,</span></span>
<span class="line"><span style="color:#ABB2BF;">    wait_some_time,</span></span>
<span class="line"><span style="color:#ABB2BF;">    response_status,</span></span>
<span class="line"><span style="color:#ABB2BF;">    save_image,</span></span>
<span class="line"><span style="color:#ABB2BF;">    open_image</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> SpiderSession</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    Sessionç›¸å…³æ“ä½œ</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.cookies_dir_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;./cookies/&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.user_agent </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;config&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;DEFAULT_USER_AGENT&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_init_session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _init_session</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        session </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        session.headers </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_headers</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> session</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_headers</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;User-Agent&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;Accept&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;text/html,application/xhtml+xml,application/xml;&quot;</span></span>
<span class="line"><span style="color:#98C379;">                          &quot;q=0.9,image/webp,image/apng,*/*;&quot;</span></span>
<span class="line"><span style="color:#98C379;">                          &quot;q=0.8,application/signed-exchange;&quot;</span></span>
<span class="line"><span style="color:#98C379;">                          &quot;v=b3&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;Connection&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;keep-alive&quot;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_user_agent</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_session</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–å½“å‰Session</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_cookies</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–å½“å‰Cookies</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_session</span><span style="color:#ABB2BF;">().cookies</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> set_cookies</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">cookies</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session.cookies.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(cookies)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> load_cookies_from_local</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ä»æœ¬åœ°åŠ è½½Cookie</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        cookies_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cookies_dir_path):</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cookies_dir_path):</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> name.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.cookies&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                cookies_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;</span><span style="color:#D19A66;">{}{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cookies_dir_path, name)</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> cookies_file </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(cookies_file, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">            local_cookies </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pickle.</span><span style="color:#61AFEF;">load</span><span style="color:#ABB2BF;">(f)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">set_cookies</span><span style="color:#ABB2BF;">(local_cookies)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> save_cookies_to_local</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">cookie_file_name</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ä¿å­˜Cookieåˆ°æœ¬åœ°</span></span>
<span class="line"><span style="color:#98C379;">        :param cookie_file_name: å­˜æ”¾Cookieçš„æ–‡ä»¶åç§°</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        cookies_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;</span><span style="color:#D19A66;">{}{}</span><span style="color:#98C379;">.cookies&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cookies_dir_path, cookie_file_name)</span></span>
<span class="line"><span style="color:#ABB2BF;">        directory </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">dirname</span><span style="color:#ABB2BF;">(cookies_file)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(directory):</span></span>
<span class="line"><span style="color:#ABB2BF;">            os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(directory)</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(cookies_file, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">            pickle.</span><span style="color:#61AFEF;">dump</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_cookies</span><span style="color:#ABB2BF;">(), f)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> QrLogin</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    æ‰«ç ç™»å½•</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">spider_session</span><span style="color:#ABB2BF;">: SpiderSession):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        åˆå§‹åŒ–æ‰«ç ç™»å½•</span></span>
<span class="line"><span style="color:#98C379;">        å¤§è‡´æµç¨‹ï¼š</span></span>
<span class="line"><span style="color:#98C379;">            1ã€è®¿é—®ç™»å½•äºŒç»´ç é¡µé¢ï¼Œè·å–Token</span></span>
<span class="line"><span style="color:#98C379;">            2ã€ä½¿ç”¨Tokenè·å–ç¥¨æ®</span></span>
<span class="line"><span style="color:#98C379;">            3ã€æ ¡éªŒç¥¨æ®</span></span>
<span class="line"><span style="color:#98C379;">        :param spider_session:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.qrcode_img_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;qr_code.png&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.spider_session </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> spider_session</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.is_login </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_login_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> refresh_login_status</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        åˆ·æ–°æ˜¯å¦ç™»å½•çŠ¶æ€</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.is_login </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_validate_cookies</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _validate_cookies</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        éªŒè¯cookiesæ˜¯å¦æœ‰æ•ˆï¼ˆæ˜¯å¦ç™»é™†ï¼‰</span></span>
<span class="line"><span style="color:#98C379;">        é€šè¿‡è®¿é—®ç”¨æˆ·è®¢å•åˆ—è¡¨é¡µè¿›è¡Œåˆ¤æ–­ï¼šè‹¥æœªç™»å½•ï¼Œå°†ä¼šé‡å®šå‘åˆ°ç™»é™†é¡µé¢ã€‚</span></span>
<span class="line"><span style="color:#98C379;">        :return: cookiesæ˜¯å¦æœ‰æ•ˆ True/False</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://order.jd.com/center/list.action&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;rid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload, </span><span style="color:#E06C75;font-style:italic;">allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> resp.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> requests.codes.</span><span style="color:#D19A66;">OK</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;éªŒè¯cookiesæ˜¯å¦æœ‰æ•ˆå‘ç”Ÿå¼‚å¸¸&quot;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _get_login_page</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–PCç«¯ç™»å½•é¡µé¢</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;https://passport.jd.com/new/login.aspx&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        page </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_headers</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> page</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _get_qrcode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ç¼“å­˜å¹¶å±•ç¤ºç™»å½•äºŒç»´ç </span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://qr.m.jd.com/show&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;appid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">133</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;size&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">147</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;t&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_user_agent</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://passport.jd.com/new/login.aspx&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#61AFEF;"> response_status</span><span style="color:#ABB2BF;">(resp):</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è·å–äºŒç»´ç å¤±è´¥&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">        save_image</span><span style="color:#ABB2BF;">(resp, </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.qrcode_img_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;äºŒç»´ç è·å–æˆåŠŸï¼Œè¯·æ‰“å¼€äº¬ä¸œAPPæ‰«æ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        open_image</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.qrcode_img_file)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _get_qrcode_ticket</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        é€šè¿‡ token è·å–ç¥¨æ®</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://qr.m.jd.com/check&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;appid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;133&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;callback&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;jQuery</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000000</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9999999</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;token&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.session.cookies.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;wlfstk_smdl&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;_&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_user_agent</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://passport.jd.com/new/login.aspx&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#61AFEF;"> response_status</span><span style="color:#ABB2BF;">(resp):</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è·å–äºŒç»´ç æ‰«æç»“æœå¼‚å¸¸&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> parse_json</span><span style="color:#ABB2BF;">(resp.text)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> resp_json[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Code: </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">, Message: </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">, resp_json[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">], resp_json[</span><span style="color:#98C379;">&#39;msg&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å·²å®Œæˆæ‰‹æœºå®¢æˆ·ç«¯ç¡®è®¤&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> resp_json[</span><span style="color:#98C379;">&#39;ticket&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _validate_qrcode_ticket</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">ticket</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        é€šè¿‡å·²è·å–çš„ç¥¨æ®è¿›è¡Œæ ¡éªŒ</span></span>
<span class="line"><span style="color:#98C379;">        :param ticket: å·²è·å–çš„ç¥¨æ®</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://passport.jd.com/uc/qrCodeTicketValidation&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_user_agent</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://passport.jd.com/uc/login?ltype=logout&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;t&#39;</span><span style="color:#ABB2BF;">: ticket})</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#61AFEF;"> response_status</span><span style="color:#ABB2BF;">(resp):</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(resp.text)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> resp_json[</span><span style="color:#98C379;">&#39;returnCode&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(resp_json)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login_by_qrcode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        äºŒç»´ç ç™»é™†</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_get_login_page</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # download QR code</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_get_qrcode</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#61AFEF;"> SKException</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;äºŒç»´ç ä¸‹è½½å¤±è´¥&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # get QR code ticket</span></span>
<span class="line"><span style="color:#ABB2BF;">        ticket </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        retry_times </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 85</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> _ </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(retry_times):</span></span>
<span class="line"><span style="color:#ABB2BF;">            ticket </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_get_qrcode_ticket</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> ticket:</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#61AFEF;"> SKException</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;äºŒç»´ç è¿‡æœŸï¼Œè¯·é‡æ–°è·å–æ‰«æ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # validate QR code ticket</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_validate_qrcode_ticket</span><span style="color:#ABB2BF;">(ticket):</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#61AFEF;"> SKException</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;äºŒç»´ç ä¿¡æ¯æ ¡éªŒå¤±è´¥&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_login_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;äºŒç»´ç ç™»å½•æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> JdSeckill</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">object</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.spider_session </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> SpiderSession</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">load_cookies_from_local</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.qrlogin </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> QrLogin</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.spider_session)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # åˆå§‹åŒ–ä¿¡æ¯</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.sku_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;config&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;sku_id&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_num </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_init_info </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_url </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_order_data </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.timers </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Timer</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.user_agent </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.spider_session.user_agent</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.nick_name </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login_by_qrcode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        äºŒç»´ç ç™»é™†</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.qrlogin.is_login:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç™»å½•æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.qrlogin.</span><span style="color:#61AFEF;">login_by_qrcode</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.qrlogin.is_login:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.nick_name </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_username</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">save_cookies_to_local</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.nick_name)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#61AFEF;"> SKException</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;äºŒç»´ç ç™»å½•å¤±è´¥ï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> check_login</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">func</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ç”¨æˆ·ç™»é™†æ€æ ¡éªŒè£…é¥°å™¨ã€‚è‹¥ç”¨æˆ·æœªç™»é™†ï¼Œåˆ™è°ƒç”¨æ‰«ç ç™»é™†</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">        @functools</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">wraps</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">func</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        def</span><span style="color:#61AFEF;"> new_func</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, *</span><span style="color:#D19A66;font-style:italic;">args</span><span style="color:#ABB2BF;">, **</span><span style="color:#D19A66;font-style:italic;">kwargs</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.qrlogin.is_login:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{0}</span><span style="color:#98C379;"> éœ€ç™»é™†åè°ƒç”¨ï¼Œå¼€å§‹æ‰«ç ç™»é™†&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(func.</span><span style="color:#E06C75;">__name__</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login_by_qrcode</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#61AFEF;"> func</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">, *args, **kwargs)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> new_func</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @check_login</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> reserve</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        é¢„çº¦</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_reserve</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @check_login</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> seckill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        æŠ¢è´­</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_seckill</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @check_login</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> seckill_by_proc_pool</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">work_count</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        å¤šè¿›ç¨‹è¿›è¡ŒæŠ¢è´­</span></span>
<span class="line"><span style="color:#98C379;">        work_countï¼šè¿›ç¨‹æ•°é‡</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#61AFEF;"> ProcessPoolExecutor</span><span style="color:#ABB2BF;">(work_count) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pool:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(work_count):</span></span>
<span class="line"><span style="color:#ABB2BF;">                pool.</span><span style="color:#61AFEF;">submit</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _reserve</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        é¢„çº¦</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">make_reserve</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é¢„çº¦å‘ç”Ÿå¼‚å¸¸!&#39;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"><span style="color:#61AFEF;">            wait_some_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _seckill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        æŠ¢è´­</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">request_seckill_url</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">request_seckill_checkout_page</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">submit_seckill_order</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å‘ç”Ÿå¼‚å¸¸ï¼Œç¨åç»§ç»­æ‰§è¡Œï¼&#39;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"><span style="color:#61AFEF;">            wait_some_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> make_reserve</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;å•†å“é¢„çº¦&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å•†å“åç§°:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_sku_title</span><span style="color:#ABB2BF;">()))</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://yushou.jd.com/youshouinfo.action?&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;callback&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;fetchJSON&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;sku&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;_&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://item.jd.com/</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">.html&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> parse_json</span><span style="color:#ABB2BF;">(resp.text)</span></span>
<span class="line"><span style="color:#ABB2BF;">        reserve_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;url&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.timers.</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;https:&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> reserve_url)</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é¢„çº¦æˆåŠŸï¼Œå·²è·å¾—æŠ¢è´­èµ„æ ¼ / æ‚¨å·²æˆåŠŸé¢„çº¦è¿‡äº†ï¼Œæ— éœ€é‡å¤é¢„çº¦&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;messenger&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;enable&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;true&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    success_message </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;é¢„çº¦æˆåŠŸï¼Œå·²è·å¾—æŠ¢è´­èµ„æ ¼ / æ‚¨å·²æˆåŠŸé¢„çº¦è¿‡äº†ï¼Œæ— éœ€é‡å¤é¢„çº¦&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">                    send_wechat</span><span style="color:#ABB2BF;">(success_message)</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é¢„çº¦å¤±è´¥æ­£åœ¨é‡è¯•...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_username</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://passport.jd.com/user/petName/getUserInfoForMiniJd.action&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;callback&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;jQuery</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000000</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9999999</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;_&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://order.jd.com/center/list.action&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        try_count </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 5</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> resp.text.</span><span style="color:#61AFEF;">startswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;jQuery&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            try_count </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> try_count </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> try_count </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#61AFEF;">            wait_some_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å“åº”ä¸­åŒ…å«äº†è®¸å¤šç”¨æˆ·ä¿¡æ¯ï¼Œç°åœ¨åœ¨å…¶ä¸­è¿”å›æ˜µç§°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # jQuery2381773({&quot;imgUrl&quot;:&quot;//storage.360buyimg.com/i.imageUpload/xxx.jpg&quot;,&quot;lastLoginTime&quot;:&quot;&quot;,&quot;nickName&quot;:&quot;xxx&quot;,&quot;plusStatus&quot;:&quot;0&quot;,&quot;realName&quot;:&quot;xxx&quot;,&quot;userLevel&quot;:x,&quot;userScoreVO&quot;:{&quot;accountScore&quot;:xx,&quot;activityScore&quot;:xx,&quot;consumptionScore&quot;:xxxxx,&quot;default&quot;:false,&quot;financeScore&quot;:xxx,&quot;pin&quot;:&quot;xxx&quot;,&quot;riskScore&quot;:x,&quot;totalScore&quot;:xxxxx}})</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#61AFEF;"> parse_json</span><span style="color:#ABB2BF;">(resp.text).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;nickName&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_sku_title</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;è·å–å•†å“åç§°&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://item.jd.com/</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">.html&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;config&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;sku_id&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url).content</span></span>
<span class="line"><span style="color:#ABB2BF;">        x_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> etree.</span><span style="color:#61AFEF;">HTML</span><span style="color:#ABB2BF;">(resp)</span></span>
<span class="line"><span style="color:#ABB2BF;">        sku_title </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> x_data.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/head/title/text()&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> sku_title[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_seckill_url</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;è·å–å•†å“çš„æŠ¢è´­é“¾æ¥</span></span>
<span class="line"><span style="color:#98C379;">        ç‚¹å‡»&quot;æŠ¢è´­&quot;æŒ‰é’®åï¼Œä¼šæœ‰ä¸¤æ¬¡302è·³è½¬ï¼Œæœ€ååˆ°è¾¾è®¢å•ç»“ç®—é¡µé¢</span></span>
<span class="line"><span style="color:#98C379;">        è¿™é‡Œè¿”å›ç¬¬ä¸€æ¬¡è·³è½¬åçš„é¡µé¢urlï¼Œä½œä¸ºå•†å“çš„æŠ¢è´­é“¾æ¥</span></span>
<span class="line"><span style="color:#98C379;">        :return: å•†å“çš„æŠ¢è´­é“¾æ¥</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://itemko.jd.com/itemShowBtn&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;callback&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;jQuery</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000000</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9999999</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;skuId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;from&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;pc&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;_&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Host&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;itemko.jd.com&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://item.jd.com/</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">.html&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#ABB2BF;">            resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> parse_json</span><span style="color:#ABB2BF;">(resp.text)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;url&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # https://divide.jd.com/user_routing?skuId=8654289&amp;sn=c3f4ececd8461f0e4d7267e96a91e0e0&amp;from=pc</span></span>
<span class="line"><span style="color:#ABB2BF;">                router_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https:&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;url&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # https://marathon.jd.com/captcha.html?skuId=8654289&amp;sn=c3f4ececd8461f0e4d7267e96a91e0e0&amp;from=pc</span></span>
<span class="line"><span style="color:#ABB2BF;">                seckill_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> router_url.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;divide&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;marathon&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;user_routing&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;captcha.html&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢è´­é“¾æ¥è·å–æˆåŠŸ: </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, seckill_url)</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#ABB2BF;"> seckill_url</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢è´­é“¾æ¥è·å–å¤±è´¥ï¼Œç¨åè‡ªåŠ¨é‡è¯•&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">                wait_some_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> request_seckill_url</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;è®¿é—®å•†å“çš„æŠ¢è´­é“¾æ¥ï¼ˆç”¨äºè®¾ç½®cookieç­‰&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç”¨æˆ·:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_username</span><span style="color:#ABB2BF;">()))</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å•†å“åç§°:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_sku_title</span><span style="color:#ABB2BF;">()))</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.timers.</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_url[</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_seckill_url</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è®¿é—®å•†å“çš„æŠ¢è´­è¿æ¥...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Host&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;marathon.jd.com&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://item.jd.com/</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">.html&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            url</span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_url.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.sku_id),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> request_seckill_checkout_page</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;è®¿é—®æŠ¢è´­è®¢å•ç»“ç®—é¡µé¢&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è®¿é—®æŠ¢è´­è®¢å•ç»“ç®—é¡µé¢...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://marathon.jd.com/seckill/seckill.action&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;skuId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;num&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_num,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;rid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Host&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;marathon.jd.com&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://item.jd.com/</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">.html&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _get_seckill_init_info</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;è·å–ç§’æ€åˆå§‹åŒ–ä¿¡æ¯ï¼ˆåŒ…æ‹¬ï¼šåœ°å€ï¼Œå‘ç¥¨ï¼Œtokenï¼‰</span></span>
<span class="line"><span style="color:#98C379;">        :return: åˆå§‹åŒ–ä¿¡æ¯ç»„æˆçš„dict</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è·å–ç§’æ€åˆå§‹åŒ–ä¿¡æ¯...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://marathon.jd.com/seckillnew/orderService/pc/init.action&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;sku&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;num&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_num,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;isModifyAddress&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;false&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Host&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;marathon.jd.com&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> parse_json</span><span style="color:#ABB2BF;">(resp.text)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#61AFEF;"> SKException</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å¤±è´¥ï¼Œè¿”å›ä¿¡æ¯:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(resp.text[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">128</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> resp_json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _get_seckill_order_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;ç”Ÿæˆæäº¤æŠ¢è´­è®¢å•æ‰€éœ€çš„è¯·æ±‚ä½“å‚æ•°</span></span>
<span class="line"><span style="color:#98C379;">        :return: è¯·æ±‚ä½“å‚æ•°ç»„æˆçš„dict</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç”Ÿæˆæäº¤æŠ¢è´­è®¢å•æ‰€éœ€å‚æ•°...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è·å–ç”¨æˆ·ç§’æ€åˆå§‹åŒ–ä¿¡æ¯</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_init_info[</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_get_seckill_init_info</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        init_info </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.seckill_init_info.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id)</span></span>
<span class="line"><span style="color:#ABB2BF;">        default_address </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> init_info[</span><span style="color:#98C379;">&#39;addressList&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]  </span><span style="color:#7F848E;font-style:italic;"># é»˜è®¤åœ°å€dict</span></span>
<span class="line"><span style="color:#ABB2BF;">        invoice_info </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> init_info.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;invoiceInfo&#39;</span><span style="color:#ABB2BF;">, {})  </span><span style="color:#7F848E;font-style:italic;"># é»˜è®¤å‘ç¥¨ä¿¡æ¯dict, æœ‰å¯èƒ½ä¸è¿”å›</span></span>
<span class="line"><span style="color:#ABB2BF;">        token </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> init_info[</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;skuId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;num&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_num,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;addressId&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;id&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;yuShou&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;true&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;isModifyAddress&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;false&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;name&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;provinceId&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;provinceId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;cityId&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;cityId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;countyId&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;countyId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;townId&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;townId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;addressDetail&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;addressDetail&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;mobile&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;mobile&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;mobileKey&#39;</span><span style="color:#ABB2BF;">: default_address[</span><span style="color:#98C379;">&#39;mobileKey&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;email&#39;</span><span style="color:#ABB2BF;">: default_address.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;email&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;postCode&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceTitle&#39;</span><span style="color:#ABB2BF;">: invoice_info.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;invoiceTitle&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceCompanyName&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceContent&#39;</span><span style="color:#ABB2BF;">: invoice_info.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;invoiceContentType&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceTaxpayerNO&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceEmail&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoicePhone&#39;</span><span style="color:#ABB2BF;">: invoice_info.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;invoicePhone&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoicePhoneKey&#39;</span><span style="color:#ABB2BF;">: invoice_info.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;invoicePhoneKey&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoice&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;true&#39;</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> invoice_info </span><span style="color:#C678DD;">else</span><span style="color:#98C379;"> &#39;false&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;password&#39;</span><span style="color:#ABB2BF;">: global_config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;account&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;payment_pwd&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;codTimeType&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;paymentType&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;areaCode&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;overseas&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;phone&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;eid&#39;</span><span style="color:#ABB2BF;">: global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;config&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;eid&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;fp&#39;</span><span style="color:#ABB2BF;">: global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;config&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;fp&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">            &#39;token&#39;</span><span style="color:#ABB2BF;">: token,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;pru&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> submit_seckill_order</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;æäº¤æŠ¢è´­ï¼ˆç§’æ€ï¼‰è®¢å•</span></span>
<span class="line"><span style="color:#98C379;">        :return: æŠ¢è´­ç»“æœ True/False</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://marathon.jd.com/seckillnew/orderService/pc/submitOrder.action&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;skuId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.seckill_order_data[</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sku_id] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_get_seckill_order_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å¤±è´¥ï¼Œæ— æ³•è·å–ç”Ÿæˆè®¢å•çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¥å£è¿”å›:ã€</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">ã€‘&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)))</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æäº¤æŠ¢è´­è®¢å•...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Host&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;marathon.jd.com&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://marathon.jd.com/seckill/seckill.action?skuId=</span><span style="color:#D19A66;">{0}</span><span style="color:#98C379;">&amp;num=</span><span style="color:#D19A66;">{1}</span><span style="color:#98C379;">&amp;rid=</span><span style="color:#D19A66;">{2}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.sku_id, </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_num, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">())),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">url,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            data</span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_order_data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.sku_id),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">            headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#ABB2BF;">        resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            resp_json </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> parse_json</span><span style="color:#ABB2BF;">(resp.text)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å¤±è´¥ï¼Œè¿”å›ä¿¡æ¯:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(resp.text[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">128</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è¿”å›ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æŠ¢è´­å¤±è´¥ï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # {&#39;errorMessage&#39;: &#39;å¾ˆé—æ†¾æ²¡æœ‰æŠ¢åˆ°ï¼Œå†æ¥å†å‰å“¦ã€‚&#39;, &#39;orderId&#39;: 0, &#39;resultCode&#39;: 60074, &#39;skuId&#39;: 0, &#39;success&#39;: False}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # {&#39;errorMessage&#39;: &#39;æŠ±æ­‰ï¼Œæ‚¨æäº¤è¿‡å¿«ï¼Œè¯·ç¨åå†æäº¤è®¢å•ï¼&#39;, &#39;orderId&#39;: 0, &#39;resultCode&#39;: 60017, &#39;skuId&#39;: 0, &#39;success&#39;: False}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # {&#39;errorMessage&#39;: &#39;ç³»ç»Ÿæ­£åœ¨å¼€å°å·®ï¼Œè¯·é‡è¯•~~&#39;, &#39;orderId&#39;: 0, &#39;resultCode&#39;: 90013, &#39;skuId&#39;: 0, &#39;success&#39;: False}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æŠ¢è´­æˆåŠŸï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # {&quot;appUrl&quot;:&quot;xxxxx&quot;,&quot;orderId&quot;:820227xxxxx,&quot;pcUrl&quot;:&quot;xxxxx&quot;,&quot;resultCode&quot;:0,&quot;skuId&quot;:0,&quot;success&quot;:true,&quot;totalMoney&quot;:&quot;xxxxx&quot;}</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;success&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            order_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;orderId&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            total_money </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;totalMoney&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            pay_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https:&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> resp_json.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;pcUrl&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­æˆåŠŸï¼Œè®¢å•å·:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">, æ€»ä»·:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">, ç”µè„‘ç«¯ä»˜æ¬¾é“¾æ¥:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(order_id, total_money, pay_url))</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;messenger&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;enable&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;true&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                success_message </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;æŠ¢è´­æˆåŠŸï¼Œè®¢å•å·:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">, æ€»ä»·:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">, ç”µè„‘ç«¯ä»˜æ¬¾é“¾æ¥:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(order_id, total_money, pay_url)</span></span>
<span class="line"><span style="color:#61AFEF;">                send_wechat</span><span style="color:#ABB2BF;">(success_message)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å¤±è´¥ï¼Œè¿”å›ä¿¡æ¯:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(resp_json))</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;messenger&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;enable&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;true&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                error_message </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;æŠ¢è´­å¤±è´¥ï¼Œè¿”å›ä¿¡æ¯:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(resp_json)</span></span>
<span class="line"><span style="color:#61AFEF;">                send_wechat</span><span style="color:#ABB2BF;">(error_message)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br><span class="line-number">494</span><br><span class="line-number">495</span><br><span class="line-number">496</span><br><span class="line-number">497</span><br><span class="line-number">498</span><br><span class="line-number">499</span><br><span class="line-number">500</span><br><span class="line-number">501</span><br><span class="line-number">502</span><br><span class="line-number">503</span><br><span class="line-number">504</span><br><span class="line-number">505</span><br><span class="line-number">506</span><br><span class="line-number">507</span><br><span class="line-number">508</span><br><span class="line-number">509</span><br><span class="line-number">510</span><br><span class="line-number">511</span><br><span class="line-number">512</span><br><span class="line-number">513</span><br><span class="line-number">514</span><br><span class="line-number">515</span><br><span class="line-number">516</span><br><span class="line-number">517</span><br><span class="line-number">518</span><br><span class="line-number">519</span><br><span class="line-number">520</span><br><span class="line-number">521</span><br><span class="line-number">522</span><br><span class="line-number">523</span><br><span class="line-number">524</span><br><span class="line-number">525</span><br><span class="line-number">526</span><br><span class="line-number">527</span><br><span class="line-number">528</span><br><span class="line-number">529</span><br><span class="line-number">530</span><br><span class="line-number">531</span><br><span class="line-number">532</span><br><span class="line-number">533</span><br><span class="line-number">534</span><br><span class="line-number">535</span><br><span class="line-number">536</span><br><span class="line-number">537</span><br><span class="line-number">538</span><br><span class="line-number">539</span><br><span class="line-number">540</span><br><span class="line-number">541</span><br><span class="line-number">542</span><br><span class="line-number">543</span><br><span class="line-number">544</span><br><span class="line-number">545</span><br><span class="line-number">546</span><br><span class="line-number">547</span><br><span class="line-number">548</span><br><span class="line-number">549</span><br><span class="line-number">550</span><br><span class="line-number">551</span><br><span class="line-number">552</span><br><span class="line-number">553</span><br><span class="line-number">554</span><br><span class="line-number">555</span><br><span class="line-number">556</span><br><span class="line-number">557</span><br><span class="line-number">558</span><br><span class="line-number">559</span><br><span class="line-number">560</span><br><span class="line-number">561</span><br><span class="line-number">562</span><br><span class="line-number">563</span><br><span class="line-number">564</span><br><span class="line-number">565</span><br><span class="line-number">566</span><br><span class="line-number">567</span><br><span class="line-number">568</span><br><span class="line-number">569</span><br><span class="line-number">570</span><br><span class="line-number">571</span><br><span class="line-number">572</span><br><span class="line-number">573</span><br><span class="line-number">574</span><br><span class="line-number">575</span><br><span class="line-number">576</span><br><span class="line-number">577</span><br><span class="line-number">578</span><br><span class="line-number">579</span><br><span class="line-number">580</span><br><span class="line-number">581</span><br><span class="line-number">582</span><br><span class="line-number">583</span><br><span class="line-number">584</span><br><span class="line-number">585</span><br><span class="line-number">586</span><br><span class="line-number">587</span><br><span class="line-number">588</span><br><span class="line-number">589</span><br><span class="line-number">590</span><br><span class="line-number">591</span><br><span class="line-number">592</span><br><span class="line-number">593</span><br><span class="line-number">594</span><br><span class="line-number">595</span><br><span class="line-number">596</span><br><span class="line-number">597</span><br><span class="line-number">598</span><br><span class="line-number">599</span><br><span class="line-number">600</span><br><span class="line-number">601</span><br><span class="line-number">602</span><br><span class="line-number">603</span><br><span class="line-number">604</span><br><span class="line-number">605</span><br><span class="line-number">606</span><br><span class="line-number">607</span><br><span class="line-number">608</span><br><span class="line-number">609</span><br><span class="line-number">610</span><br><span class="line-number">611</span><br><span class="line-number">612</span><br><span class="line-number">613</span><br><span class="line-number">614</span><br><span class="line-number">615</span><br><span class="line-number">616</span><br><span class="line-number">617</span><br><span class="line-number">618</span><br><span class="line-number">619</span><br><span class="line-number">620</span><br><span class="line-number">621</span><br></div></div><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äº¬ä¸œè´­ç‰©çš„ Python è„šæœ¬ï¼Œä¸»è¦åŒ…æ‹¬ç™»å½•ã€é¢„çº¦å’ŒæŠ¢è´­åŠŸèƒ½ã€‚</p><p><strong>æ³¨æ„äº‹é¡¹</strong></p><ol><li>å¼•å…¥å¿…è¦çš„åº“ï¼šä»£ç å¼€å§‹å¤„å¼•å…¥äº†æ“ä½œç½‘ç»œè¯·æ±‚ã€æ—¶é—´ã€æ–‡ä»¶å’Œå›¾ç‰‡ç­‰çš„åº“ã€‚</li><li>å®šä¹‰ç±»å’Œå‡½æ•°ï¼š</li></ol><p>- SpiderSession ç±»ï¼šç®¡ç†ä¸æœåŠ¡å™¨ä¼šè¯çš„ç±»ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–ä¼šè¯ã€è·å–å’Œè®¾ç½®ç”¨æˆ·ä»£ç†å’Œ cookies ç­‰ã€‚</p><p>- QrLogin ç±»ï¼šå¤„ç†æ‰«ç ç™»å½•é€»è¾‘çš„ç±»ï¼ŒåŒ…æ‹¬è·å–ç™»å½•é¡µé¢ã€ä¸‹è½½äºŒç»´ç ã€éªŒè¯äºŒç»´ç å’Œç™»å½•çŠ¶æ€ç­‰ã€‚</p><p>- JdSeckill ç±»ï¼šä¸»è¦å¤„ç†é¢„çº¦å’ŒæŠ¢è´­çš„é€»è¾‘ï¼Œä»¥åŠé€šè¿‡å¤šè¿›ç¨‹æ”¯æŒå¹¶å‘æŠ¢è´­ã€‚</p><ol start="3"><li>ä¸»è¦åŠŸèƒ½å’Œæµç¨‹ï¼š</li></ol><p>- ç™»å½•ï¼šç”¨æˆ·é€šè¿‡æ‰«æäºŒç»´ç ç™»å½•ã€‚</p><p>- é¢„çº¦ï¼šåœ¨æŠ¢è´­å‰ï¼Œç”¨æˆ·éœ€è¦é¢„çº¦å•†å“ã€‚</p><p>- æŠ¢è´­ï¼šåœ¨é¢„çº¦åï¼Œç”¨æˆ·å¯ä»¥å‚ä¸å•†å“çš„æŠ¢è´­ã€‚</p><p>- å¤šè¿›ç¨‹æŠ¢è´­ï¼šä½¿ç”¨<code>ProcessPoolExecutor</code>æ¥å¯åŠ¨å¤šä¸ªè¿›ç¨‹è¿›è¡ŒæŠ¢è´­ï¼Œä»¥å¢åŠ æˆåŠŸç‡ã€‚</p><ol start="4"><li>å¼‚å¸¸å’ŒçŠ¶æ€å¤„ç†ï¼š</li></ol><p>- ç¨‹åºé€šè¿‡è®°å½•æ—¥å¿—å’Œå‘é€å¾®ä¿¡æ¶ˆæ¯çš„æ–¹å¼æ¥åé¦ˆç¨‹åºçš„è¿è¡ŒçŠ¶æ€å’Œå¼‚å¸¸ä¿¡æ¯ã€‚</p><p>- ä½¿ç”¨äº†è£…é¥°å™¨@check_login æ¥ç¡®ä¿æ‰§è¡ŒæŸäº›æ“ä½œå‰ç”¨æˆ·å·²ç»ç™»å½•ã€‚</p><ol start="5"><li>è¾…åŠ©åŠŸèƒ½ï¼š</li></ol><p>- ä¿å­˜å’ŒåŠ è½½ cookiesï¼šå…è®¸ç¨‹åºåœ¨å¤šæ¬¡è¿è¡Œé—´ä¿æŒç™»å½•çŠ¶æ€ã€‚</p><p>- è·å–ç”¨æˆ·ä¿¡æ¯å’Œå•†å“ä¿¡æ¯ï¼šé€šè¿‡è§£æç½‘é¡µå†…å®¹æˆ– API å“åº”æ¥è·å–æ‰€éœ€ä¿¡æ¯ã€‚</p><p><strong>ç‰¹åˆ«æé†’</strong></p><p>ä¸»è¦é¢å‘æœ‰ä¸€å®š Python åŸºç¡€å’Œç†è§£ HTTP è¯·æ±‚å¤„ç†çš„ç”¨æˆ·ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åœ¨ Python ä¸­ä½¿ç”¨ç½‘ç»œè¯·æ±‚ã€å¤„ç†ä¼šè¯ã€è§£æ HTML/XMLã€ä»¥åŠå¦‚ä½•ä½¿ç”¨å¤šçº¿ç¨‹/å¤šè¿›ç¨‹æ¥æé«˜ä»»åŠ¡æ‰§è¡Œæ•ˆç‡çš„åŸºæœ¬æ–¹æ³•ã€‚</p><p><strong>è§£æå¦‚ä¸‹</strong></p><p>è¿™ä¸ª Python è„šæœ¬æ˜¯ä¸ºäº†è‡ªåŠ¨å®ŒæˆèŒ…å°é¢„çº¦ï¼Œå…·ä½“åŠŸèƒ½åŒ…æ‹¬ä»ç¯å¢ƒå˜é‡ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå‘æŒ‡å®šçš„ API å‘é€é¢„çº¦è¯·æ±‚ï¼Œå¹¶å¤„ç†å“åº”ã€‚ä»¥ä¸‹æ˜¯è„šæœ¬æ‰§è¡Œçš„ä¸»è¦æ­¥éª¤ï¼š</p><ol><li>ç¯å¢ƒå˜é‡å’Œé…ç½®ï¼šé€šè¿‡é’é¾™é¢æ¿ï¼ˆä¸€ä¸ªè‡ªåŠ¨åŒ–è¿è¡Œè„šæœ¬çš„å·¥å…·ï¼‰æ·»åŠ ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬ç”¨æˆ·çš„ tokenã€è®¾å¤‡ ID ç­‰ä¿¡æ¯ï¼Œä»¥åŠ app ç‰ˆæœ¬å·<code>Mt_Version</code>ã€‚</li><li>å‡½æ•°å®šä¹‰ï¼š</li></ol><p>- <code>mt_add</code>ï¼šå‘æœåŠ¡å™¨å‘é€é¢„çº¦è¯·æ±‚ã€‚</p><p>- <code>tongzhi</code>ï¼šå‘é€é€šçŸ¥åˆ°æŒ‡å®šç”¨æˆ·ã€‚</p><p>- <code>get_session_id</code>ï¼šè·å–ä¼šè¯ IDã€‚</p><p>- <code>get_shop_item</code>ï¼šè·å–å•†åº—å’Œå•†å“ä¿¡æ¯ã€‚</p><p>- <code>get_user_id</code>ï¼šè·å–ç”¨æˆ· IDã€‚</p><p>- <code>getUserEnergyAward</code>ï¼šé¢†å–è€åŠ›ï¼ˆå¯èƒ½æ˜¯æŸç§æ¸¸æˆæœºåˆ¶æˆ–æ´»åŠ¨çš„å¥–åŠ±ï¼‰ã€‚</p><p>- <code>get_map</code>ï¼šè·å–çœä»½å’ŒåŸå¸‚çš„æ˜ å°„ä¿¡æ¯ã€‚</p><p>- <code>login</code>ï¼šç™»å½•å¹¶è·å– token å’Œ cookieã€‚</p><ol start="3"><li>é¢„çº¦æµç¨‹å®ç°ï¼šè„šæœ¬ä¸»ä½“é€šè¿‡è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ç”¨æˆ· token ç­‰ä¿¡æ¯ï¼Œé€ä¸ªæ‰§è¡Œé¢„çº¦æµç¨‹ï¼ŒåŒ…æ‹¬ç™»å½•ã€è·å–ç”¨æˆ·ä¿¡æ¯ã€é€‰æ‹©å•†å“å’Œå•†åº—ã€å‘é€é¢„çº¦è¯·æ±‚ç­‰ã€‚</li><li>ç»“æœé€šçŸ¥ï¼šé¢„çº¦ç»“æœé€šè¿‡<code>send</code>å‡½æ•°å‘é€é€šçŸ¥ã€‚</li><li>ä¸»å‡½æ•°ï¼šè„šæœ¬çš„å…¥å£ç‚¹ï¼Œè¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ç”¨æˆ· token åˆ—è¡¨ï¼Œéå†æ¯ä¸ª token æ‰§è¡Œé¢„çº¦æµç¨‹ã€‚</li></ol><p>è„šæœ¬ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“<code>requests</code>æ¥å‘é€ HTTP è¯·æ±‚ï¼Œ<code>base64</code>å’Œ<code>json</code>è¿›è¡Œæ•°æ®ç¼–ç å’Œè§£ç ã€‚é€šè¿‡ç¯å¢ƒå˜é‡<code>MTTokenD</code>è¯»å–ç”¨æˆ·çš„é¢„çº¦å‚æ•°ï¼Œ<code>Mt_Version</code>è¯»å– app ç‰ˆæœ¬å·ã€‚è„šæœ¬æ”¯æŒå¤šè´¦å·æ“ä½œï¼Œå¯¹äºæ¯ä¸ªè´¦å·ï¼Œè§£æå…¶é¢„çº¦å‚æ•°ï¼ˆåŒ…æ‹¬çœä»½ã€åŸå¸‚ã€ç»çº¬åº¦ã€è®¾å¤‡ IDã€token ç­‰ï¼‰ï¼Œå¹¶æ ¹æ®è¿™äº›å‚æ•°å‘èŒ…å°é¢„çº¦ API å‘é€è¯·æ±‚ã€‚</p><p>æ­¤è„šæœ¬é€‚ç”¨äºè‡ªåŠ¨åŒ–èŒ…å°é…’é¢„çº¦æµç¨‹ï¼Œå‡å°‘æ‰‹åŠ¨æ“ä½œï¼Œæé«˜é¢„çº¦æˆåŠŸç‡ã€‚åŒæ—¶ï¼Œè„šæœ¬è¿˜åŒ…å«äº†ä¸€äº›é™„åŠ åŠŸèƒ½ï¼Œå¦‚é¢†å–è€åŠ›å¥–åŠ±ç­‰ã€‚</p><h2 id="é‡ç½®ç‰ˆ" tabindex="-1">é‡ç½®ç‰ˆ <a class="header-anchor" href="#é‡ç½®ç‰ˆ" aria-label="Permalink to &quot;é‡ç½®ç‰ˆ&quot;">â€‹</a></h2><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> urllib </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> parse</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> JniSign</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> getUrlParams</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    res </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">(parse.</span><span style="color:#61AFEF;">parse_qsl</span><span style="color:#ABB2BF;">(url))</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> res</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_cookie_string</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">cookie</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    cookie_string </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> cookie_key </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> cookie.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">        cookie_string </span><span style="color:#56B6C2;">+=</span><span style="color:#98C379;"> &#39;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">=</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">;&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> (cookie_key, cookie[cookie_key])</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> cookie_string</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_jd_time</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;https://api.m.jd.com/client.action?functionId=queryMaterialProducts&amp;client=wh5&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_sk</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [val </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> val </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">values</span><span style="color:#ABB2BF;">()]</span></span>
<span class="line"><span style="color:#ABB2BF;">    n, o, p, q, r, s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_val[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">], data_val[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">], data_val[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">], data_val[</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">], data_val[</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">], data_val[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;cca&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> p[</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">19</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> o[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;ab&#39;</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># check ok</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> r[</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> s[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;ch&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> q.</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> r[</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;cbc&#39;</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># check ok</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> q[</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> p[</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">19</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;by&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> o[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">sub</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;a&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;c&#39;</span><span style="color:#ABB2BF;">, p, </span><span style="color:#E06C75;font-style:italic;">flags</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">re.</span><span style="color:#D19A66;">IGNORECASE</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;xa&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> o[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> s[</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;cza&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> q[</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">19</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> s[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">11</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> n </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;cb&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> s[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> p[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> sk_val</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> JDSecKillAPI</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">login_cookie</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.skuId </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;100012043978&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.token_cookie </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> login_cookie</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.token_cookie_string </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_cookie_string</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">cookie</span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token_cookie)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.aid </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.eid </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.uuid </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.uts </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.wifiBssid </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.user_agent </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> reserve_maotai</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;okhttp/3.12.&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;content-type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/x-www-form-urlencoded&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;content-length&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;3081&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;cookie&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token_cookie_string,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;jdc-backup&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token_cookie_string,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        query_params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;functionId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;appoint&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;clientVersion&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;9.3.4&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;build&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;85134&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;client&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;android&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;d_brand&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;maotai&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;d_model&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;LIO-AN00&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;osVersion&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;7.1.2&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;screen&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1920*1080&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;partner&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;hhqj02&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;aid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.aid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;eid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.eid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;sdkVersion&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;25&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;lang&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;zh_CN&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;uuid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.uuid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;area&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;15_1213_3411_59341&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;networkType&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;wifi&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;wifiBssid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.wifiBssid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;uts&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.uts</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        reserve_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://api.m.jd.com/client.action?&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> parse.</span><span style="color:#61AFEF;">urlencode</span><span style="color:#ABB2BF;">(query_params) </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;&amp;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        body_string </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;{&quot;autoAddCart&quot;:&quot;0&quot;,&quot;bsid&quot;:&quot;&quot;,&quot;check&quot;:&quot;0&quot;,&quot;ctext&quot;:&quot;&quot;,&quot;isShowCode&quot;:&quot;0&quot;,&quot;mad&quot;:&quot;0&quot;,&quot;skuId&quot;:&quot;100012043978&quot;,&quot;type&quot;:&quot;1&quot;}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;body&#39;</span><span style="color:#ABB2BF;">: body_string}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        plainTextDic </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;functionId&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;functionId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;clientVersion&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;clientVersion&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;client&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;client&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;uuid&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;uuid&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;body&#39;</span><span style="color:#ABB2BF;">: body_string,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;st&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        sign </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JniSign.</span><span style="color:#61AFEF;">JDencrypt_version0</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">plainTextDic</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">plainTextDic, </span><span style="color:#E06C75;font-style:italic;">ran1</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">reserve_url </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> sign, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_token_key</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;okhttp/3.12.&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;content-type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/x-www-form-urlencoded&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;content-length&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;3081&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;cookie&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token_cookie_string,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;jdc-backup&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token_cookie_string,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        body_string </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;{&quot;action&quot;:&quot;to&quot;,&quot;to&quot;:&quot;https%3A</span><span style="color:#D19A66;">%2F%2F</span><span style="color:#98C379;">divide.jd.com</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">user_routing</span><span style="color:#D19A66;">%3F</span><span style="color:#98C379;">skuId%3D100012043978&quot;}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        query_params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;functionId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;genToken&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;clientVersion&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;9.2.0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;build&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;85134&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;client&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;android&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;d_brand&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;maotai&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;d_model&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;LIO-AN00&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;osVersion&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;7.1.2&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;screen&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1920*1080&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;partner&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;hhqj02&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;aid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.aid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;eid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.eid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;sdkVersion&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;25&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;lang&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;zh_CN&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;uuid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.uuid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;area&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;15_1213_3411_59341&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;networkType&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;wifi&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;wifiBssid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.wifiBssid,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;uts&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.uts</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        token_key_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://api.m.jd.com/client.action?&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> parse.</span><span style="color:#61AFEF;">urlencode</span><span style="color:#ABB2BF;">(query_params) </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;&amp;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;body&#39;</span><span style="color:#ABB2BF;">: body_string}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        plainTextDic </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;functionId&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;functionId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;clientVersion&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;clientVersion&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;client&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;client&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;uuid&#39;</span><span style="color:#ABB2BF;">: query_params[</span><span style="color:#98C379;">&#39;uuid&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;body&#39;</span><span style="color:#ABB2BF;">: data[</span><span style="color:#98C379;">&#39;body&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;st&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        sign </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JniSign.</span><span style="color:#61AFEF;">JDencrypt_version0</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">plainTextDic</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">plainTextDic, </span><span style="color:#E06C75;font-style:italic;">ran1</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">token_key_url </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> sign, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # token_key = response.json()[&#39;tokenKey&#39;]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # print(&#39;Token Key: ----------&gt; %s&#39; % response.json())</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # print(response.status_code)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_appjmp</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">token_params</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        appjmp_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> token_params[</span><span style="color:#98C379;">&#39;url&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;to&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://divide.jd.com/user_routing?skuId=</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.skuId,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;tokenKey&#39;</span><span style="color:#ABB2BF;">: token_params[</span><span style="color:#98C379;">&#39;tokenKey&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;lbs&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;{&quot;lat&quot;:&quot;39.904585&quot;,&quot;lng&quot;:&quot;116.407018&quot;,&quot;provinceId&quot;:&quot;1&quot;,&quot;cityId&quot;:&quot;2802&quot;,&quot;districtId&quot;:&quot;54741&quot;,&quot;provinceName&quot;:&quot;åŒ—äº¬&quot;,&quot;cityName&quot;:&quot;ä¸œåŸåŒº&quot;,&quot;districtName&quot;:&quot;ä¸œåé—¨è¡—é“&quot;}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">appjmp_url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params, </span><span style="color:#E06C75;font-style:italic;">allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # print(&#39;Get Appjmpè·³è½¬é“¾æ¥--------------&gt;%s&#39; % response.headers[&#39;Location&#39;])</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.headers[</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_divide</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">divide_url</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">divide_url, </span><span style="color:#E06C75;font-style:italic;">allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Get Divideè·³è½¬é“¾æ¥--------------&gt;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> response.headers[</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.headers[</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_captcha</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">captcha_url</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">captcha_url, </span><span style="color:#E06C75;font-style:italic;">allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Get Captchaè·³è½¬é“¾æ¥--------------&gt;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> response.headers[</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.headers[</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_seckill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">seckill_url</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">seckill_url, </span><span style="color:#E06C75;font-style:italic;">allow_redirects</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> init_action</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">num</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        init_action_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://marathon.jd.com/seckillnew/orderService/init.action&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;sku&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.skuId,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;num&#39;</span><span style="color:#ABB2BF;">: num,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;isModifyAddress&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">init_action_url, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;init actionè¿”å›æ•°æ®ï¼š</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> response.text)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_tak</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        tak_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://tak.jd.com/t/41CD2?_t=</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">tak_url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#ABB2BF;">        sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_sk</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> sk_val</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> submit_order</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">order_data</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">sk</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        submit_order_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://marathon.jd.com/seckillnew/orderService/submitOrder.action?skuId=</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.skuId</span></span>
<span class="line"><span style="color:#ABB2BF;">        address_info </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> order_data[</span><span style="color:#98C379;">&#39;addressList&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        invoice_info </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> order_data[</span><span style="color:#98C379;">&#39;invoiceInfo&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;num&#39;</span><span style="color:#ABB2BF;">: order_data[</span><span style="color:#98C379;">&#39;seckillSkuVO&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;num&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;addressId&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;id&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;yuShou&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;isModifyAddress&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;name&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;provinceId&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;provinceId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;provinceName&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;provinceName&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;cityId&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;cityId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;cityName&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;cityName&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;countyId&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;countyId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;countyName&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;countyName&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;townId&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;townId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;townName&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;townName&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;addressDetail&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;addressDetail&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;mobile&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;mobile&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;mobileKey&#39;</span><span style="color:#ABB2BF;">: address_info[</span><span style="color:#98C379;">&#39;mobileKey&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;email&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceTitle&#39;</span><span style="color:#ABB2BF;">: invoice_info[</span><span style="color:#98C379;">&#39;invoiceTitle&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoiceContent&#39;</span><span style="color:#ABB2BF;">: invoice_info[</span><span style="color:#98C379;">&#39;invoiceContentType&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoicePhone&#39;</span><span style="color:#ABB2BF;">: invoice_info[</span><span style="color:#98C379;">&#39;invoicePhone&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoicePhoneKey&#39;</span><span style="color:#ABB2BF;">: invoice_info[</span><span style="color:#98C379;">&#39;invoicePhoneKey&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;invoice&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;codTimeType&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;paymentType&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;4&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;overseas&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;token&#39;</span><span style="color:#ABB2BF;">: order_data[</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">            &#39;sk&#39;</span><span style="color:#ABB2BF;">: sk,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # print(&#39;submitæäº¤æ•°æ®ï¼š %s&#39; % data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.s.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">submit_order_url, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            submit_result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;"> submit orderè¿”å›æ•°æ®ï¼šçŠ¶æ€ï¼š</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">ï¼Œä¿¡æ¯ï¼š</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(datetime.datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()),</span></span>
<span class="line"><span style="color:#ABB2BF;">                                                       submit_result[</span><span style="color:#98C379;">&#39;success&#39;</span><span style="color:#ABB2BF;">], submit_result))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;"> submit orderè¿”å›æ•°æ®-éjsonæ ¼å¼ï¼š</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(datetime.datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()), response.content))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # return response</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    login_cookie_186 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">        &#39;pin&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;wskey&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;whwswswws&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;unionwsws&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    JDska </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> JDSecKillAPI</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">login_cookie</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">login_cookie_186)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(JDska.</span><span style="color:#61AFEF;">reserve_maotai</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    token_params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JDska.</span><span style="color:#61AFEF;">get_token_key</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    divide_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JDska.</span><span style="color:#61AFEF;">get_appjmp</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">token_params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">token_params)</span></span>
<span class="line"><span style="color:#ABB2BF;">    captcha_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JDska.</span><span style="color:#61AFEF;">get_divide</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">divide_url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">divide_url)</span></span>
<span class="line"><span style="color:#ABB2BF;">    seckill_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JDska.</span><span style="color:#61AFEF;">get_captcha</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">captcha_url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">captcha_url)</span></span>
<span class="line"><span style="color:#ABB2BF;">    JDska.</span><span style="color:#61AFEF;">get_seckill</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">seckill_url</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">seckill_url)</span></span>
<span class="line"><span style="color:#ABB2BF;">    order_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JDska.</span><span style="color:#61AFEF;">init_action</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    sk_val </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> JDska.</span><span style="color:#61AFEF;">get_tak</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;pythonè®¡ç®—skå‚æ•°ï¼š</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> sk_val)</span></span>
<span class="line"><span style="color:#ABB2BF;">    JDska.</span><span style="color:#61AFEF;">submit_order</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">order_data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">order_data, </span><span style="color:#E06C75;font-style:italic;">sk</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">sk_val)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(JDska.s.cookies)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # get_jd_time()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µè„šæœ¬æ˜¯ä¸ºäº†è‡ªåŠ¨åŒ–äº¬ä¸œçš„ç§’æ€æ´»åŠ¨è€Œç¼–å†™çš„ã€‚å®ƒæ¶µç›–äº†é¢„çº¦ã€è·å–ä»¤ç‰Œã€è·³è½¬ã€ä»¥åŠæœ€ç»ˆçš„æäº¤è®¢å•ç­‰å¤šä¸ªæ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯è„šæœ¬å„éƒ¨åˆ†çš„è¯¦ç»†è§£æï¼š</p><p><strong>å‡½æ•°å’Œç±»è§£é‡Š</strong></p><ol><li>getUrlParams(url):</li></ol><p>- è§£æ URL ä¸­çš„æŸ¥è¯¢å‚æ•°å¹¶è¿”å›å­—å…¸æ ¼å¼ã€‚</p><ol start="2"><li>get_cookie_string(cookie):</li></ol><p>- å°† cookie å­—å…¸è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼ï¼Œä»¥ä¾¿åœ¨ HTTP è¯·æ±‚ä¸­ä½¿ç”¨ã€‚</p><ol start="3"><li>get_jd_time():</li></ol><p>- è¯·æ±‚äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ï¼Œä¸»è¦ç”¨äºåŒæ­¥æ“ä½œæ—¶é—´ã€‚</p><ol start="4"><li>get_sk(data):</li></ol><p>- é€šè¿‡ç‰¹å®šçš„åŠ å¯†å’Œå¤„ç†é€»è¾‘ç”Ÿæˆ<code>sk</code>å€¼ï¼Œæ­¤å€¼å¯èƒ½ç”¨äºæäº¤è®¢å•æ—¶éªŒè¯ã€‚</p><ol start="5"><li>JDSecKillAPI:</li></ol><p>- ä¸»è¦ç±»ï¼Œå°è£…äº†é¢„çº¦ã€è·å–ä»¤ç‰Œã€æäº¤è®¢å•ç­‰åŠŸèƒ½ã€‚</p><p><strong>ç±»æ–¹æ³•è§£é‡Š</strong></p><p>- reserve_maotai():</p><p>- å‘èµ·é¢„çº¦è¯·æ±‚ï¼Œè®¾ç½®å¿…è¦çš„ HTTP å¤´å’Œè¯·æ±‚å‚æ•°ã€‚</p><p>- get_token_key():</p><p>- è·å–ç”¨äºåç»­æ“ä½œçš„ä»¤ç‰Œã€‚</p><p>- get_appjmp(token_params):</p><p>- ä½¿ç”¨è·å–åˆ°çš„ä»¤ç‰Œç”Ÿæˆè·³è½¬é“¾æ¥ã€‚</p><p>- get_divide(divide_url):</p><p>- è®¿é—®è·³è½¬é“¾æ¥å¹¶è·å–å¯èƒ½çš„ä¸‹ä¸€è·³è½¬é“¾æ¥ã€‚</p><p>- get_captcha(captcha_url):</p><p>- å¤„ç†éªŒè¯ç è·³è½¬é“¾æ¥ï¼Œè¿™å¯èƒ½æ˜¯ç§’æ€æ´»åŠ¨çš„ä¸€éƒ¨åˆ†ã€‚</p><p>- get_seckill(seckill_url):</p><p>- è®¿é—®æœ€ç»ˆçš„ç§’æ€é“¾æ¥ã€‚</p><p>- init_action():</p><p>- åˆå§‹åŒ–è®¢å•æ“ä½œï¼Œå¯èƒ½æ˜¯è·å–å¿…è¦çš„è®¢å•æ•°æ®ã€‚</p><p>- get_tak():</p><p>- è·å–<code>tak</code>å€¼ï¼Œå¯èƒ½æ˜¯ç”¨äºè®¢å•æäº¤çš„å¦ä¸€ç§éªŒè¯ã€‚</p><p>- submit_order(order_data, sk):</p><p>- æäº¤è®¢å•ï¼Œä½¿ç”¨è·å–åˆ°çš„æ‰€æœ‰å¿…è¦æ•°æ®ã€‚</p><p><strong>è„šæœ¬æµç¨‹</strong></p><ol><li>å®ä¾‹åŒ–<code>JDSecKillAPI</code>ç±»ã€‚</li><li>è°ƒç”¨<code>reserve_maotai()</code>å‡½æ•°è¿›è¡Œé¢„çº¦ã€‚</li><li>è·å–ä»¤ç‰Œã€‚</li><li>é€šè¿‡ä»¤ç‰Œè·å–è·³è½¬é“¾æ¥ã€‚</li><li>å¤„ç†è·³è½¬ï¼Œè·å–å’Œå¤„ç†éªŒè¯ç ã€‚</li><li>åˆå§‹åŒ–è®¢å•æ“ä½œã€‚</li><li>è·å–<code>sk</code>å€¼ã€‚</li><li>æäº¤è®¢å•ã€‚</li></ol><p><strong>é¢å¤–çš„æ³¨æ„ç‚¹</strong></p><p>- ä½¿ç”¨äº†å¤–éƒ¨æ¨¡å—<code>JniSign</code>è¿›è¡Œç­¾åï¼Œè¿™æ˜¯ä¸€ç§ä¿æŠ¤æªæ–½ä»¥ç¬¦åˆäº¬ä¸œçš„ API å®‰å…¨è¦æ±‚ã€‚</p><p>- è„šæœ¬æ¶‰åŠå¤šæ¬¡è·³è½¬å’Œè¯·æ±‚ï¼Œåæ˜ äº†äº¬ä¸œé˜²åˆ·æªæ–½çš„å¤æ‚æ€§ã€‚</p><p>- è„šæœ¬è¿è¡Œä¾èµ–äºæ­£ç¡®çš„ cookie å’Œå…¶ä»–éªŒè¯ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯éœ€è¦äº‹å…ˆè·å–ã€‚</p><p>è¿™ä¸ªè„šæœ¬ç”¨äºè‡ªåŠ¨åŒ–äº¬ä¸œçš„ç§’æ€è¿‡ç¨‹ï¼Œç‰¹åˆ«æ˜¯å¯¹äºé«˜éœ€æ±‚å•†å“å¦‚èŒ…å°ã€‚å®ƒå±•ç¤ºäº†é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·æ¨¡æ‹Ÿç”¨æˆ·è¡Œä¸ºçš„èƒ½åŠ›ï¼Œä½†åŒæ—¶ä¹Ÿæ¶‰åŠåˆ°äº†ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬å¯èƒ½è¿åç½‘ç«™ä½¿ç”¨æ¡æ¬¾çš„é—®é¢˜ã€‚ä½¿ç”¨æ­¤ç±»è„šæœ¬å‰åº”ç¡®ä¿åˆè§„ï¼Œäº†è§£å¯èƒ½çš„é£é™©ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h2 id="ä»£ç æ–‡ä»¶æ¦‚è§ˆ" tabindex="-1">ä»£ç æ–‡ä»¶æ¦‚è§ˆ <a class="header-anchor" href="#ä»£ç æ–‡ä»¶æ¦‚è§ˆ" aria-label="Permalink to &quot;ä»£ç æ–‡ä»¶æ¦‚è§ˆ&quot;">â€‹</a></h2><p>åœ¨æœ¬æ¬¡è¡¥å……ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»ä»¥ä¸‹å››ä¸ªå…³é”®ä»£ç æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½åœ¨è‡ªåŠ¨åŒ–è¿‡ç¨‹ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼š</p><ol><li>jd_logger.py - è´Ÿè´£æ—¥å¿—è®°å½•ï¼Œå¸®åŠ©è¿½è¸ªè„šæœ¬æ‰§è¡Œæƒ…å†µã€‚</li><li>timer.py - åŒ…å«è®¡æ—¶å™¨åŠŸèƒ½ï¼Œç¡®ä¿åœ¨æ­£ç¡®çš„æ—¶é—´ç‚¹è§¦å‘æ“ä½œã€‚</li><li>config.py - å­˜å‚¨è„šæœ¬è¿è¡Œæ‰€éœ€çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚ç™»å½•å‡­è¯ã€‚</li><li>util.py - æä¾›æ”¯æŒæ—¥å¿—ã€æ—¶é—´å¤„ç†çš„å®ç”¨å·¥å…·å‡½æ•°ã€‚</li></ol><p><strong>çˆ¬è™«æŠ€å·§ä¸ç”¨æˆ·ä»£ç†çš„è¡¥å……</strong></p><p>è¡¥å……ä»£ç ä¸­ç‰¹åˆ«å±•ç¤ºäº†çˆ¬è™«é€šç”¨æŠ€å·§å’Œå¤§é‡çš„ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²ã€‚æ­£ç¡®åº”ç”¨ç”¨æˆ·ä»£ç†ä¸ä»…å¯ä»¥æé«˜è¯·æ±‚çš„æˆåŠŸç‡ï¼Œä¹Ÿæ˜¯åº”å¯¹ç½‘ç«™å®‰å…¨ç­–ç•¥çš„æœ‰æ•ˆç­–ç•¥ã€‚è¿™æœ‰åŠ©äºæ¨¡æ‹Ÿå¤šæ ·åŒ–çš„ç”¨æˆ·ç¯å¢ƒï¼Œå‡å°‘è¢«æ£€æµ‹çš„æ¦‚ç‡ã€‚</p><p><strong>å‘å¸ƒåŸå› ä¸ä½¿ç”¨è­¦å‘Š</strong></p><p>è™½ç„¶æœ‰é¡¾è™‘ï¼Œä½†æˆ‘ä»¬æ„è¯†åˆ°æä¾›è¿™äº›ä¿¡æ¯å¯¹äºä¿ƒè¿›æŠ€æœ¯äº¤æµå’Œæ”¯æŒå­¦æœ¯ç ”ç©¶å…·æœ‰é‡è¦ä»·å€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†³å®šåˆ†äº«è¿™äº›è¡¥å……å†…å®¹ï¼Œä½†<strong>ä¸¥æ ¼é™å®šç”¨äºæµ‹è¯•å’Œå­¦æœ¯ç ”ç©¶ç›®çš„</strong>ï¼Œç»å¯¹<strong>ç¦æ­¢ç”¨äºä»»ä½•å•†ä¸šç”¨é€”</strong>ã€‚ä½¿ç”¨è¿™äº›è„šæœ¬å¯èƒ½è¿åæœåŠ¡æ¡æ¬¾ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ç›¸å…³é£é™©ã€‚</p><p>æœ‰ç²‰ä¸åé¦ˆå¯¼åŒ…æŠ¥é”™ï¼Œç°é‡å‘ config.ini å’Œ config.py è„šæœ¬ï¼Œè¯·æŸ¥æ”¶ã€‚</p><h3 id="config-ini-æ–‡ä»¶" tabindex="-1">config.ini æ–‡ä»¶ <a class="header-anchor" href="#config-ini-æ–‡ä»¶" aria-label="Permalink to &quot;config.ini æ–‡ä»¶&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">[config]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># eid, fpå‚æ•°å¿…é¡»å¡«å†™ï¼Œå…·ä½“è¯·å‚è€ƒ wiki-å¸¸è§é—®é¢˜</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># éšæ„å¡«å†™å¯èƒ½å¯¼è‡´è®¢å•æ— æ³•æäº¤ç­‰é—®é¢˜</span></span>
<span class="line"><span style="color:#61AFEF;">eid</span><span style="color:#98C379;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">fp</span><span style="color:#98C379;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># cookieç°åœ¨ä¸éœ€è¦å¡«å†™äº†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># cookies_String = &quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å•†å“id</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å·²ç»æ˜¯èŒ…å°çš„sku_idäº†</span></span>
<span class="line"><span style="color:#61AFEF;">sku_id</span><span style="color:#98C379;"> =</span><span style="color:#D19A66;"> 100012043978</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾å®šæ—¶é—´ # 2024-04-19 10:00:00.100000</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¿®æ”¹æˆæ¯å¤©çš„å‡ ç‚¹å‡ åˆ†å‡ ç§’å‡ æ¯«ç§’</span></span>
<span class="line"><span style="color:#61AFEF;">buy_time</span><span style="color:#98C379;"> =</span><span style="color:#98C379;"> 09:59:59.500</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># é»˜è®¤UA</span></span>
<span class="line"><span style="color:#61AFEF;">DEFAULT_USER_AGENT</span><span style="color:#98C379;"> =</span><span style="color:#98C379;"> &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦ä½¿ç”¨éšæœº useragentï¼Œé»˜è®¤ä¸º false</span></span>
<span class="line"><span style="color:#61AFEF;">random_useragent</span><span style="color:#98C379;"> =</span><span style="color:#D19A66;"> false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">[account]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ”¯ä»˜å¯†ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœä½ çš„è´¦æˆ·ä¸­æœ‰å¯ç”¨çš„äº¬åˆ¸ï¼ˆæ³¨æ„ä¸æ˜¯ä¸œåˆ¸ï¼‰æˆ– åœ¨ä¸Šæ¬¡è´­ä¹°è®¢å•ä¸­ä½¿ç”¨äº†äº¬è±†ï¼Œ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># é‚£ä¹ˆäº¬ä¸œå¯èƒ½ä¼šåœ¨ä¸‹å•æ—¶è‡ªåŠ¨é€‰æ‹©äº¬åˆ¸æ”¯ä»˜ æˆ– è‡ªåŠ¨å‹¾é€‰äº¬è±†æ”¯ä»˜ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ­¤æ—¶ä¸‹å•ä¼šè¦æ±‚è¾“å…¥å…­ä½æ•°å­—çš„æ”¯ä»˜å¯†ç ã€‚è¯·åœ¨ä¸‹æ–¹é…ç½®ä½ çš„æ”¯ä»˜å¯†ç ï¼Œå¦‚ 123456 ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ²¡æœ‰ä¸Šè¿°æƒ…å†µï¼Œä¸‹æ–¹è¯·ç•™ç©ºã€‚</span></span>
<span class="line"><span style="color:#61AFEF;">payment_pwd</span><span style="color:#98C379;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">[messenger]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨äº†Serveré…±çš„æ¨é€æœåŠ¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœæƒ³å¼€å¯ä¸‹å•æˆåŠŸåæ¶ˆæ¯æ¨é€ï¼Œåˆ™å°† enable è®¾ç½®ä¸º trueï¼Œé»˜è®¤ä¸º false ä¸å¼€å¯æ¨é€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¼€å¯æ¶ˆæ¯æ¨é€å¿…é¡»å¡«å…¥ sckeyï¼Œå¦‚ä½•è·å–è¯·æœç´¢ç™¾åº¦</span></span>
<span class="line"><span style="color:#61AFEF;">enable</span><span style="color:#98C379;"> =</span><span style="color:#D19A66;"> false</span></span>
<span class="line"><span style="color:#61AFEF;">sckey</span><span style="color:#98C379;"> =</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>config.py</strong>æ–‡ä»¶</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> configparser</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Config</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">object</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">config_file</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;config.ini&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">._path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.</span><span style="color:#61AFEF;">getcwd</span><span style="color:#ABB2BF;">(), config_file)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._path):</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> FileNotFoundError(</span><span style="color:#98C379;">&quot;No such file: config.ini&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">._config </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> configparser.</span><span style="color:#61AFEF;">ConfigParser</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">._config.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._path, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8-sig&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">._configRaw </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> configparser.</span><span style="color:#61AFEF;">RawConfigParser</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">._configRaw.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._path, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8-sig&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">section</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">name</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">._config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(section, name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">section</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">name</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">._configRaw.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(section, name)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">global_config </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Config</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="æˆåŠŸç‡é«˜ç‰ˆæœ¬æ¨è" tabindex="-1">æˆåŠŸç‡é«˜ç‰ˆæœ¬æ¨è <a class="header-anchor" href="#æˆåŠŸç‡é«˜ç‰ˆæœ¬æ¨è" aria-label="Permalink to &quot;æˆåŠŸç‡é«˜ç‰ˆæœ¬æ¨è&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> math</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> encrypt </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Encrypt</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> hashlib</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logging</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pytz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">AES_KEY</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;xxxxxxxxxxxxxxxxxx&#39;</span></span>
<span class="line"><span style="color:#D19A66;">AES_IV</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;xxxxxxxxxx&#39;</span></span>
<span class="line"><span style="color:#D19A66;">SALT</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;xxxxxxxxxxxxxxxxxxxx&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># AMAP_KEY = &#39;9449339b6c4aee04d69481e6e6c84a84&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">current_time </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;">mt_version </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(re.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;latest__version&quot;&gt;(.*?)&lt;/p&gt;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;https://apps.apple.com/cn/app/i</span><span style="color:#D19A66;">%E</span><span style="color:#98C379;">8%8C</span><span style="color:#D19A66;">%85%</span><span style="color:#98C379;">E5</span><span style="color:#D19A66;">%8F</span><span style="color:#98C379;">%B0/id1600482450&#39;</span><span style="color:#ABB2BF;">).text,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                re.S)).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">header_context </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#98C379;">MT-Lat: 28.499562</span></span>
<span class="line"><span style="color:#98C379;">MT-K: 1675213490331</span></span>
<span class="line"><span style="color:#98C379;">MT-Lng: 102.182324</span></span>
<span class="line"><span style="color:#98C379;">Host: app.moutai519.com.cn</span></span>
<span class="line"><span style="color:#98C379;">MT-User-Tag: 0</span></span>
<span class="line"><span style="color:#98C379;">Accept: */*</span></span>
<span class="line"><span style="color:#98C379;">MT-Network-Type: WIFI</span></span>
<span class="line"><span style="color:#98C379;">MT-Token: 1</span></span>
<span class="line"><span style="color:#98C379;">MT-Team-ID:</span></span>
<span class="line"><span style="color:#98C379;">MT-Info: 028e7f96f6369cafe1d105579c5b9377</span></span>
<span class="line"><span style="color:#98C379;">MT-Device-ID: 2F2075D0-B66C-4287-A903-DBFF6358342A</span></span>
<span class="line"><span style="color:#98C379;">MT-Bundle-ID: com.moutai.mall</span></span>
<span class="line"><span style="color:#98C379;">Accept-Language: en-CN;q=1, zh-Hans-CN;q=0.9</span></span>
<span class="line"><span style="color:#98C379;">MT-Request-ID: 167560018873318465</span></span>
<span class="line"><span style="color:#98C379;">MT-APP-Version: 1.3.7</span></span>
<span class="line"><span style="color:#98C379;">User-Agent: iOS;16.3;Apple;?unrecognized?</span></span>
<span class="line"><span style="color:#98C379;">MT-R: clips_OlU6TmFRag5rCXwbNAQ/Tz1SKlN8THcecBp/HGhHdw==</span></span>
<span class="line"><span style="color:#98C379;">Content-Length: 93</span></span>
<span class="line"><span style="color:#98C379;">Accept-Encoding: gzip, deflate, br</span></span>
<span class="line"><span style="color:#98C379;">Connection: keep-alive</span></span>
<span class="line"><span style="color:#98C379;">Content-Type: application/json</span></span>
<span class="line"><span style="color:#98C379;">userId: 2</span></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> init_headers</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">user_id</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;1&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">token</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;2&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">lat</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;28.499562&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">lng</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;102.182324&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> k </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> header_context.</span><span style="color:#61AFEF;">rstrip</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">lstrip</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        temp_l </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> k.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;: &#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">        dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {temp_l[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]: temp_l[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]})</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&quot;userId&quot;</span><span style="color:#ABB2BF;">: user_id})</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&quot;MT-Token&quot;</span><span style="color:#ABB2BF;">: token})</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&quot;MT-Lat&quot;</span><span style="color:#ABB2BF;">: lat})</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&quot;MT-Lng&quot;</span><span style="color:#ABB2BF;">: lng})</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&quot;MT-APP-Version&quot;</span><span style="color:#ABB2BF;">: mt_version})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> signature</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    keys </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> sorted</span><span style="color:#ABB2BF;">(data.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    temp_v </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> keys:</span></span>
<span class="line"><span style="color:#ABB2BF;">        temp_v </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> data[item]</span></span>
<span class="line"><span style="color:#ABB2BF;">    text </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> SALT</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> temp_v </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> current_time</span></span>
<span class="line"><span style="color:#ABB2BF;">    hl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> hashlib.</span><span style="color:#61AFEF;">md5</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    hl.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(text.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf8&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    md5 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> hl.</span><span style="color:#61AFEF;">hexdigest</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> md5</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_vcode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">mobile</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;mobile&#39;</span><span style="color:#ABB2BF;">: mobile}</span></span>
<span class="line"><span style="color:#ABB2BF;">    md5 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> signature</span><span style="color:#ABB2BF;">(params)</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(params, {</span><span style="color:#98C379;">&#39;md5&#39;</span><span style="color:#ABB2BF;">: md5, </span><span style="color:#98C379;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: current_time, </span><span style="color:#98C379;">&#39;MT-APP-Version&#39;</span><span style="color:#ABB2BF;">: mt_version})</span></span>
<span class="line"><span style="color:#ABB2BF;">    responses </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://app.moutai519.com.cn/xhr/front/user/register/vcode&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                              headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    logging.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">        f</span><span style="color:#98C379;">&#39;get v_code : params : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">params</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response code : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response body : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> login</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">mobile</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">v_code</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;mobile&#39;</span><span style="color:#ABB2BF;">: mobile, </span><span style="color:#98C379;">&#39;vCode&#39;</span><span style="color:#ABB2BF;">: v_code, </span><span style="color:#98C379;">&#39;ydToken&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ydLogId&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">    md5 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> signature</span><span style="color:#ABB2BF;">(params)</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(params, {</span><span style="color:#98C379;">&#39;md5&#39;</span><span style="color:#ABB2BF;">: md5, </span><span style="color:#98C379;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: current_time, </span><span style="color:#98C379;">&#39;MT-APP-Version&#39;</span><span style="color:#ABB2BF;">: mt_version})</span></span>
<span class="line"><span style="color:#ABB2BF;">    responses </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://app.moutai519.com.cn/xhr/front/user/register/login&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                              headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> responses.status_code </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">            f</span><span style="color:#98C379;">&#39;login : params : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">params</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response code : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response body : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&#39;MT-Token&#39;</span><span style="color:#ABB2BF;">: responses.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">]})</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&#39;userId&#39;</span><span style="color:#ABB2BF;">: responses.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;userId&#39;</span><span style="color:#ABB2BF;">]})</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> responses.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">], responses.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;userId&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_current_session_id</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    day_time </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_day_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    responses </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;https://static.moutai519.com.cn/mt-backend/xhr/front/mall/index/session/get/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">day_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> responses.status_code </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">            f</span><span style="color:#98C379;">&#39;get_current_session_id : params : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">day_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response code : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response body : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    current_session_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> responses.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;sessionId&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#56B6C2;">    dict</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(headers, {</span><span style="color:#98C379;">&#39;current_session_id&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(current_session_id)})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_day_time</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åˆ›å»ºä¸€ä¸ªä¸œå…«åŒºï¼ˆåŒ—äº¬æ—¶é—´ï¼‰çš„æ—¶åŒºå¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">    beijing_tz </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pytz.</span><span style="color:#61AFEF;">timezone</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Asia/Shanghai&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è·å–å½“å‰åŒ—äº¬æ—¶é—´çš„æ—¥æœŸå’Œæ—¶é—´å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">    beijing_dt </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">(beijing_tz)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è®¾ç½®æ—¶é—´ä¸º0ç‚¹</span></span>
<span class="line"><span style="color:#ABB2BF;">    beijing_dt </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> beijing_dt.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">hour</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">minute</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">second</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">microsecond</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è·å–æ—¶é—´æˆ³ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">    timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(beijing_dt.</span><span style="color:#61AFEF;">timestamp</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> timestamp</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_location_count</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">province</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                       city</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                       item_code</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                       p_c_map</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                       source_data</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                       lat</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;28.499562&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                       lng</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;102.182324&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    day_time </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_day_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    session_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> headers[</span><span style="color:#98C379;">&#39;current_session_id&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    responses </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">        f</span><span style="color:#98C379;">&quot;https://static.moutai519.com.cn/mt-backend/xhr/front/mall/shop/list/slim/v3/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">session_id</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">province</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">item_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">day_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> responses.status_code </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">            f</span><span style="color:#98C379;">&#39;get_location_count : params : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">day_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response code : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response body : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    shops </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> responses.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;shops&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> config.</span><span style="color:#D19A66;">MAX_ENABLED</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#61AFEF;"> max_shop</span><span style="color:#ABB2BF;">(city, item_code, p_c_map, province, shops)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> config.</span><span style="color:#D19A66;">DISTANCE_ENABLED</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#61AFEF;"> distance_shop</span><span style="color:#ABB2BF;">(city, item_code, p_c_map, province, shops, source_data, lat, lng)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> distance_shop</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">city</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  item_code</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  p_c_map</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  province</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  shops</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  source_data</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  lat</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;28.499562&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                  lng</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;102.182324&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # shop_ids = p_c_map[province][city]</span></span>
<span class="line"><span style="color:#ABB2BF;">    temp_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> shop </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> shops:</span></span>
<span class="line"><span style="color:#ABB2BF;">        shopId </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> shop[</span><span style="color:#98C379;">&#39;shopId&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        items </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> shop[</span><span style="color:#98C379;">&#39;items&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        item_ids </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [i[</span><span style="color:#98C379;">&#39;itemId&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> items]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # if shopId not in shop_ids:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     continue</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(item_code) </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> item_ids:</span></span>
<span class="line"><span style="color:#C678DD;">            continue</span></span>
<span class="line"><span style="color:#ABB2BF;">        shop_info </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> source_data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(shopId)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # d = geodesic((lat, lng), (shop_info[&#39;lat&#39;], shop_info[&#39;lng&#39;])).km</span></span>
<span class="line"><span style="color:#ABB2BF;">        d </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> math.</span><span style="color:#61AFEF;">sqrt</span><span style="color:#ABB2BF;">((</span><span style="color:#56B6C2;">float</span><span style="color:#ABB2BF;">(lat) </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> shop_info[</span><span style="color:#98C379;">&#39;lat&#39;</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">**</span><span style="color:#D19A66;"> 2</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">float</span><span style="color:#ABB2BF;">(lng) </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> shop_info[</span><span style="color:#98C379;">&#39;lng&#39;</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">**</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # print(f&quot;è·ç¦»ï¼š{d}&quot;)</span></span>
<span class="line"><span style="color:#ABB2BF;">        temp_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">((d, shopId))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # sorted(a,key=lambda x:x[0])</span></span>
<span class="line"><span style="color:#ABB2BF;">    temp_list </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> sorted</span><span style="color:#ABB2BF;">(temp_list, </span><span style="color:#E06C75;font-style:italic;">key</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">lambda</span><span style="color:#D19A66;font-style:italic;"> x</span><span style="color:#ABB2BF;">: x[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # logging.info(f&quot;æ‰€æœ‰é—¨åº—è·ç¦»:{temp_list}&quot;)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(temp_list) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> temp_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#98C379;"> &#39;0&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> max_shop</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">city</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">item_code</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">p_c_map</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">province</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">shops</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    max_count </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">    max_shop_id </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;0&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    shop_ids </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> p_c_map[province][city]</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> shop </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> shops:</span></span>
<span class="line"><span style="color:#ABB2BF;">        shopId </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> shop[</span><span style="color:#98C379;">&#39;shopId&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        items </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> shop[</span><span style="color:#98C379;">&#39;items&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> shopId </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> shop_ids:</span></span>
<span class="line"><span style="color:#C678DD;">            continue</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> items:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> item[</span><span style="color:#98C379;">&#39;itemId&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(item_code):</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> item[</span><span style="color:#98C379;">&#39;inventory&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> max_count:</span></span>
<span class="line"><span style="color:#ABB2BF;">                max_count </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> item[</span><span style="color:#98C379;">&#39;inventory&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                max_shop_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> shopId</span></span>
<span class="line"><span style="color:#ABB2BF;">    logging.</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;item code </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">item_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, max shop id : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_shop_id</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, max count : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_count</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> max_shop_id</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">encrypt </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Encrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">key</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">AES_KEY</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">iv</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">AES_IV</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> act_params</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">shop_id</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">item_id</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #     &quot;actParam&quot;: &quot;a/v0XjWK/a/a+ZyaSlKKZViJHuh8tLw==&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #     &quot;itemInfoList&quot;: [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #         {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #             &quot;count&quot;: 1,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #             &quot;itemId&quot;: &quot;2478&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #         }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #     ],</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #     &quot;shopId&quot;: &quot;151510100019&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #     &quot;sessionId&quot;: 508</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # }</span></span>
<span class="line"><span style="color:#ABB2BF;">    session_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> headers[</span><span style="color:#98C379;">&#39;current_session_id&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    userId </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> headers[</span><span style="color:#98C379;">&#39;userId&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;itemInfoList&quot;</span><span style="color:#ABB2BF;">: [{</span><span style="color:#98C379;">&quot;count&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;itemId&quot;</span><span style="color:#ABB2BF;">: item_id}],</span></span>
<span class="line"><span style="color:#98C379;">              &quot;sessionId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(session_id),</span></span>
<span class="line"><span style="color:#98C379;">              &quot;userId&quot;</span><span style="color:#ABB2BF;">: userId,</span></span>
<span class="line"><span style="color:#98C379;">              &quot;shopId&quot;</span><span style="color:#ABB2BF;">: shop_id</span></span>
<span class="line"><span style="color:#ABB2BF;">              }</span></span>
<span class="line"><span style="color:#ABB2BF;">    s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(params)</span></span>
<span class="line"><span style="color:#ABB2BF;">    act </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> encrypt.</span><span style="color:#61AFEF;">aes_encrypt</span><span style="color:#ABB2BF;">(s)</span></span>
<span class="line"><span style="color:#ABB2BF;">    params.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">({</span><span style="color:#98C379;">&quot;actParam&quot;</span><span style="color:#ABB2BF;">: act})</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> params</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">msg</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> config.</span><span style="color:#D19A66;">PUSH_TOKEN</span><span style="color:#C678DD;"> is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span></span>
<span class="line"><span style="color:#ABB2BF;">    title </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;imoutaié¢„çº¦å¤±è´¥&#39;</span><span style="color:#7F848E;font-style:italic;">  # æ”¹æˆä½ è¦çš„æ ‡é¢˜å†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">    content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> msg  </span><span style="color:#7F848E;font-style:italic;"># æ”¹æˆä½ è¦çš„æ­£æ–‡å†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">    url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;http://www.pushplus.plus/send&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    r </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">: config.</span><span style="color:#D19A66;">PUSH_TOKEN</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                                  &#39;title&#39;</span><span style="color:#ABB2BF;">: title,</span></span>
<span class="line"><span style="color:#98C379;">                                  &#39;content&#39;</span><span style="color:#ABB2BF;">: content})</span></span>
<span class="line"><span style="color:#ABB2BF;">    logging.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;é€šçŸ¥æ¨é€ç»“æœï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">r.status_code, r.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> reservation</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">params</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">mobile</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    params.</span><span style="color:#61AFEF;">pop</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;userId&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    responses </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://app.moutai519.com.cn/xhr/front/mall/reservation/add&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                              headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> responses.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 401</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">        send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;[</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mobile</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">],ç™»å½•tokenå¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç™»å½•&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        raise</span><span style="color:#ABB2BF;"> RuntimeError</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#98C379;"> &#39;æ‚¨çš„å®åä¿¡æ¯æœªå®Œå–„æˆ–æœªé€šè¿‡è®¤è¯&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> responses.text:</span></span>
<span class="line"><span style="color:#61AFEF;">        send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;[</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mobile</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">],</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        raise</span><span style="color:#ABB2BF;"> RuntimeError</span></span>
<span class="line"><span style="color:#ABB2BF;">    logging.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">        f</span><span style="color:#98C379;">&#39;é¢„çº¦ : mobile:</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mobile</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> :  response code : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response body : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">responses.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> select_geo</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">i</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # https://www.piliang.tech/geocoding-amap</span></span>
<span class="line"><span style="color:#ABB2BF;">    resp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;https://www.piliang.tech/api/amap/geocode?address=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">i</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    geocodes: </span><span style="color:#56B6C2;">list</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> resp.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;geocodes&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> geocodes</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_map</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">lat</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;28.499562&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">lng</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;102.182324&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    p_c_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;">    url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://static.moutai519.com.cn/mt-backend/xhr/front/mall/resource/get&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">        &#39;X-Requested-With&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;XMLHttpRequest&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Mozilla/5.0 (iPhone; CPU iPhone OS 15_0_1 like Mac OS X)&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;Referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://h5.moutai519.com.cn/gux/game/main?appConfig=2_1_2&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;Client-User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;iOS;16.0.1;Apple;iPhone 14 ProMax&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;MT-R&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;clips_OlU6TmFRag5rCXwbNAQ/Tz1SKlN8THcecBp/HGhHdw==&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;Origin&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://h5.moutai519.com.cn&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;MT-APP-Version&#39;</span><span style="color:#ABB2BF;">: mt_version,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;MT-Request-ID&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}{</span><span style="color:#ABB2BF;">random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1111111</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">999999999</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;Accept-Language&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;zh-CN,zh-Hans;q=1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;MT-Device-ID&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}{</span><span style="color:#ABB2BF;">random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1111111</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">999999999</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;Accept&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/json, text/javascript, */*; q=0.01&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;mt-lng&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">lng</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;mt-lat&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">lat</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    res </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, )</span></span>
<span class="line"><span style="color:#ABB2BF;">    mtshops </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> res.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">, {}).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;mtshops_pc&#39;</span><span style="color:#ABB2BF;">, {})</span></span>
<span class="line"><span style="color:#ABB2BF;">    urls </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mtshops.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;url&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    r </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(urls)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> k, v </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">(r.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()).</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">        provinceName </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> v.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;provinceName&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        cityName </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> v.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;cityName&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> p_c_map.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(provinceName):</span></span>
<span class="line"><span style="color:#ABB2BF;">            p_c_map[provinceName] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> p_c_map[provinceName].</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(cityName, </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            p_c_map[provinceName][cityName] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [k]</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            p_c_map[provinceName][cityName].</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(k)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> p_c_map, </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">(r.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> getUserEnergyAward</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">mobile</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    cookies </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">        &#39;MT-Device-ID-Wap&#39;</span><span style="color:#ABB2BF;">: headers[</span><span style="color:#98C379;">&#39;MT-Device-ID&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">        &#39;MT-Token-Wap&#39;</span><span style="color:#ABB2BF;">: headers[</span><span style="color:#98C379;">&#39;MT-Token&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">        &#39;YX_SUPPORT_WEBP&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;https://h5.moutai519.com.cn/game/isolationPage/getUserEnergyAward&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">cookies</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">cookies,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                             headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{})</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # response.json().get(&#39;message&#39;) if &#39;æ— æ³•é¢†å–å¥–åŠ±&#39; in response.text else &quot;é¢†å–å¥–åŠ±æˆåŠŸ&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    logging.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">        f</span><span style="color:#98C379;">&#39; : mobile:</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mobile</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> :  response code : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">response.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, response body : </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">response.text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç ä¸»è¦å…³è”äº†è®¸å¤šç½‘ç»œè¯·æ±‚å’Œå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œç”¨äºå¤„ç†ä¸ä¸€ä¸ªåä¸ºâ€œèŒ…å°å•†åŸâ€çš„åº”ç”¨ç›¸å…³çš„ç½‘ç»œæ“ä½œã€‚ä¸»è¦åŠŸèƒ½å’Œå…³é”®ç»„ä»¶çš„è¯¦ç»†è¯´æ˜å¦‚ä¸‹ï¼š</p><p><strong>1. å…¨å±€å˜é‡å’Œé…ç½®</strong>ï¼š</p><p>- ä½¿ç”¨ AES åŠ å¯†å¯†é’¥(<code>AES_KEY</code>)ã€åˆå§‹å‘é‡(<code>AES_IV</code>)å’Œä¸€ä¸ªç›å€¼(<code>SALT</code>)ç”¨äºåŠ å¯†ç›¸å…³æ“ä½œã€‚</p><p>- å®šä¹‰äº†å½“å‰æ—¶é—´æˆ³<code>current_time</code>å’Œä¸€ç»„è¯·æ±‚å¤´<code>headers</code>ã€‚</p><p>- ä»è‹¹æœåº”ç”¨å•†åº—æ‹‰å–å¹¶è§£æåº”ç”¨çš„å½“å‰ç‰ˆæœ¬å·ã€‚</p><p><strong>2. åˆå§‹åŒ–è¯·æ±‚å¤´</strong>ï¼š</p><p>- <code>init_headers</code>å‡½æ•°é€šè¿‡è§£æä¸€ä¸ªå¤šè¡Œçš„å­—ç¬¦ä¸²<code>header_context</code>æ¥åˆå§‹åŒ–è¯·æ±‚å¤´ã€‚</p><p><strong>3. ç­¾åç”Ÿæˆï¼š</strong></p><p>- <code>signature</code>å‡½æ•°ä½¿ç”¨ MD5 ç®—æ³•ç”Ÿæˆè¯·æ±‚çš„ç­¾åï¼Œç­¾åç”¨äºåç»­çš„ç½‘ç»œè¯·æ±‚éªŒè¯ã€‚</p><p><strong>4. ç”¨æˆ·äº¤äº’å‡½æ•°ï¼š</strong></p><p>- <code>get_vcode</code>ç”¨äºè·å–çŸ­ä¿¡éªŒè¯ç ã€‚</p><p>- <code>login</code>ç”¨äºç”¨æˆ·ç™»å½•ï¼Œä½¿ç”¨æ‰‹æœºå·å’ŒéªŒè¯ç ã€‚</p><p>- <code>get_current_session_id</code>å’Œ<code>get_day_time</code>ç”¨äºè·å–å½“å‰çš„ä¼šè¯ ID å’Œå‡†ç¡®çš„æ—¶é—´æˆ³ã€‚</p><p><strong>5. åœ°ç†ä½ç½®å’Œå•†åº—å¤„ç†ï¼š</strong></p><p>- <code>get_location_count</code>æŸ¥è¯¢ç‰¹å®šçœå¸‚ä¸‹çš„å•†åº—åº“å­˜ã€‚</p><p>- <code>distance_shop</code>å’Œ<code>max_shop</code>ç”¨äºåŸºäºä¸åŒæ ‡å‡†ï¼ˆå¦‚è·ç¦»å’Œåº“å­˜æœ€å¤§åŒ–ï¼‰é€‰æ‹©å•†åº—ã€‚</p><p>- <code>select_geo</code>ç”¨äºåœ°ç†ç¼–ç ï¼Œå°†åœ°å€è½¬æ¢æˆåœ°ç†åæ ‡ã€‚</p><p><strong>6. åŠ å¯†å’ŒåŠ¨ä½œå‚æ•°æ„å»ºï¼š</strong></p><p>- ä½¿ç”¨<code>Encrypt</code>ç±»ï¼ˆä»<code>encrypt</code>æ¨¡å—å¯¼å…¥ï¼‰å¯¹å‚æ•°è¿›è¡Œ AES åŠ å¯†ã€‚</p><p>- <code>act_params</code>ç”¨äºæ„å»ºæ´»åŠ¨å‚æ•°ï¼Œè¿™äº›å‚æ•°åŒ…æ‹¬äº†ç”¨æˆ·ã€å•†å“å’Œåº—é“ºçš„ ID ç­‰ã€‚</p><p><strong>7. é€šçŸ¥å’Œé¢„çº¦åŠŸèƒ½ï¼š</strong></p><p>- <code>send_email</code>å‡½æ•°é€šè¿‡ Pushplus æœåŠ¡å‘é€é€šçŸ¥ã€‚</p><p>- <code>reservation</code>ç”¨äºæäº¤å•†å“é¢„çº¦è¯·æ±‚ã€‚</p><p><strong>8. å®ç”¨åŠŸèƒ½ï¼š</strong></p><p>- <code>get_map</code>ç”¨äºè·å–å•†åº—çš„åœ°ç†ä½ç½®æ•°æ®ã€‚</p><p>- <code>getUserEnergyAward</code>ç”¨äºé¢†å–ç”¨æˆ·èƒ½é‡å¥–åŠ±ï¼Œè¿™å¯èƒ½æ˜¯åº”ç”¨å†…çš„æŸç§ç§¯åˆ†æˆ–å¥–åŠ±ç³»ç»Ÿã€‚</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h1 id="èŒ…å°è‘«èŠ¦å¨ƒè‡ªåŠ¨é¢„çº¦è„šæœ¬" tabindex="-1">èŒ…å°è‘«èŠ¦å¨ƒè‡ªåŠ¨é¢„çº¦è„šæœ¬ <a class="header-anchor" href="#èŒ…å°è‘«èŠ¦å¨ƒè‡ªåŠ¨é¢„çº¦è„šæœ¬" aria-label="Permalink to &quot;èŒ…å°è‘«èŠ¦å¨ƒè‡ªåŠ¨é¢„çº¦è„šæœ¬&quot;">â€‹</a></h1><p>å…¨ä»£ç å¦‚ä¸‹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#56B6C2;">/**</span></span>
<span class="line"><span style="color:#ABB2BF;"> è‘«èŠ¦å¨ƒé¢„çº¦ v1.06</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"> cron: </span><span style="color:#D19A66;">30</span><span style="color:#D19A66;"> 8</span><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> *</span></span>
<span class="line"><span style="color:#ABB2BF;"> const </span><span style="color:#FFFFFF;">$</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> new </span><span style="color:#61AFEF;">Env</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è‘«èŠ¦å¨ƒé¢„çº¦&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;"> è‡ªè¡ŒæŠ“åŒ…æŠŠtoken</span><span style="color:#ABB2BF;">(ä¸€èˆ¬åœ¨è¯·æ±‚å¤´é‡Œ)å¡«åˆ°å˜é‡ä¸­, å¤šè´¦å·ç”¨æ¢è¡Œéš”å¼€ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">XLTH_COOKIE</span><span style="color:#ABB2BF;"> æ–°è”æƒ è´­</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">GLYP_COOKIE</span><span style="color:#ABB2BF;"> è´µæ—…ä¼˜å“</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">KGLG_COOKIE</span><span style="color:#ABB2BF;"> ç©ºæ¸¯ä¹è´­</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">HLQG_COOKIE</span><span style="color:#ABB2BF;"> èˆªæ—…é»”è´­</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">ZHCS_COOKIE</span><span style="color:#ABB2BF;"> éµè¡Œå‡ºå±±</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">GYQP_COOKIE</span><span style="color:#ABB2BF;"> è´µç›é»”å“</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">LLSC_COOKIE</span><span style="color:#ABB2BF;"> ä¹æ—…å•†åŸ</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">YLQX_COOKIE</span><span style="color:#ABB2BF;"> é©¿è·¯é»”å¯»</span></span>
<span class="line"><span style="color:#56B6C2;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">SPLIT</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> åˆ†å‰²ç¬¦ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const axios </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;axios&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const crypto </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;crypto&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const moment </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;moment&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const notify </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;./sendNotify&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">XLTH_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wxded2e7e6d60ac09d&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> æ–°è”æƒ è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">GLYP_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx61549642d715f361&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µæ—…ä¼˜å“</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">KGLG_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx613ba8ea6a002aa8&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ç©ºæ¸¯ä¹è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">HLQG_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx936aa5357931e226&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> èˆªæ—…é»”è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">ZHCS_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx624149b74233c99a&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> éµèˆªå‡ºå±±</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">GYQP_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx5508e31ffe9366b8&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µç›é»”å“</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">LLSC_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx821fb4d8604ed4d6&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ä¹æ—…å•†åŸ</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">YLQX_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wxee0ce83ab4b26f9c&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> é©¿è·¯é»”å¯»</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;https://gw.huiqunchina.com&#39;</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">AK</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;00670fb03584fbf44dd6b136e534f495&#39;</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">SK</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;0d65f24dbe2bc1ede3c3ceeb96ef71bb&#39;</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">let sendMessage </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">delay</span><span style="color:#ABB2BF;">(time) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> new </span><span style="color:#61AFEF;">Promise</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#61AFEF;"> setTimeout</span><span style="color:#ABB2BF;">(resolve, time));</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">calculateDigest</span><span style="color:#ABB2BF;">(body, sk) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const hmac = crypto.</span><span style="color:#61AFEF;">createHmac</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sha256&#39;</span><span style="color:#ABB2BF;">, sk);</span></span>
<span class="line"><span style="color:#ABB2BF;">    hmac.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(body);</span></span>
<span class="line"><span style="color:#ABB2BF;">    const signature = hmac.</span><span style="color:#61AFEF;">digest</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;base64&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> signature;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">calculateSignature</span><span style="color:#ABB2BF;">(method, url, ak, sk, date) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const strToSign = </span><span style="color:#FFFFFF;">`${method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toUpperCase</span><span style="color:#ABB2BF;">()</span><span style="color:#FFFFFF;">}\n${url}\n\n${ak}\n${date}\n`;</span></span>
<span class="line"><span style="color:#FFFFFF;">    const hmac = crypto</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createHmac</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sha256&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#FFFFFF;"> sk</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    hmac.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(strToSign);</span></span>
<span class="line"><span style="color:#ABB2BF;">    const signature = hmac.</span><span style="color:#61AFEF;">digest</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;base64&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> signature;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, body) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const date = </span><span style="color:#61AFEF;">moment</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">utc</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ddd, DD MMM YYYY HH:mm:ss [GMT]&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    const signature = </span><span style="color:#61AFEF;">calculateSignature</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">AK</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">SK</span><span style="color:#ABB2BF;">, date);</span></span>
<span class="line"><span style="color:#ABB2BF;">    const digest = </span><span style="color:#61AFEF;">calculateDigest</span><span style="color:#ABB2BF;">(body, </span><span style="color:#D19A66;">SK</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    const headers = {</span></span>
<span class="line"><span style="color:#98C379;">        &#39;Content-Type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/json&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;X-HMAC-SIGNATURE&#39;</span><span style="color:#ABB2BF;">: signature,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;X-HMAC-ACCESS-KEY&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">AK</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;X-HMAC-ALGORITHM&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;hmac-sha256&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;X-HMAC-DIGEST&#39;</span><span style="color:#ABB2BF;">: digest,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;X-HMAC-Date&#39;</span><span style="color:#ABB2BF;">: date,</span></span>
<span class="line"><span style="color:#98C379;">        &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 MicroMessenger/7.0.20.1781(0x6700143B) NetType/WIFI MiniProgramEnv/Windows WindowsWechat/WMPF XWEB/6945&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    };</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> headers;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">getUserInfo</span><span style="color:#ABB2BF;">(appId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/queryById/token&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const data = {appId};</span></span>
<span class="line"><span style="color:#ABB2BF;">    const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    let resData;</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, {method: method, data: data, headers: headers})</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        });</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">getChannelActivity</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">id</span><span style="color:#ABB2BF;">, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/promotion/channelActivity&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const data = {</span><span style="color:#56B6C2;">id</span><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#ABB2BF;">    const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    let resData;</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, {method: method, data: data, headers: headers})</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        });</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">getChannelInfoId</span><span style="color:#ABB2BF;">(appId) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const url = </span><span style="color:#98C379;">&#39;/front-manager/api/get/getChannelInfoId&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const data = {appId};</span></span>
<span class="line"><span style="color:#ABB2BF;">    const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    let resData;</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, {method: method, data: data, headers: headers})</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        });</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">appoint</span><span style="color:#ABB2BF;">(activityId, channelId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/promotion/appoint&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const data = {activityId, channelId};</span></span>
<span class="line"><span style="color:#ABB2BF;">    const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    let resData;</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, {method: method, data: data, headers: headers})</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        });</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">checkCustomerInQianggou</span><span style="color:#ABB2BF;">(activityId, channelId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/promotion/checkCustomerInQianggou&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const data = {activityId, channelId};</span></span>
<span class="line"><span style="color:#ABB2BF;">    const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    let resData;</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, {method: method, data: data, headers: headers})</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">        });</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">autoSubmit</span><span style="color:#ABB2BF;">(appId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    let channelId = </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    let channelName = </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">XLTH_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;8&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">GLYP_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;7&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">KGLG_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">HLQG_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;6&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">ZHCS_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;5&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">GYQP_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;è´µç›é»”å“&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">LLSC_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸ&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">YLQX_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelId = </span><span style="color:#98C379;">&#39;9&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        channelName = </span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        const res1 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> getUserInfo</span><span style="color:#ABB2BF;">(appId, token);</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (res1.code </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;10000&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(res1.message);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(res1.message);</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        const realName = res1.data.realName;</span></span>
<span class="line"><span style="color:#ABB2BF;">        const phone = res1.data.phone;</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`å½“å‰ç”¨æˆ·</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${phone}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`å½“å‰ç”¨æˆ·</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${phone}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        const res2 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> getChannelActivity</span><span style="color:#ABB2BF;">(channelId, token);</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (res2.code </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;10000&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(res2.message);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(res2.message);</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        const activityId = res2.data.id;</span></span>
<span class="line"><span style="color:#ABB2BF;">        const activityName = res2.data.name;</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`æ´»åŠ¨åç§°</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${activityName}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`æ´»åŠ¨åç§°</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${activityName}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        const res3 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> checkCustomerInQianggou</span><span style="color:#ABB2BF;">(activityId, channelId, token);</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (res3.code </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;10000&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(res3.message);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(res3.message);</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        const data = res3.data;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        let message = </span><span style="color:#98C379;">&#39;ç”¨æˆ·å·²ç»é¢„çº¦æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (data </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> false) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            const res4 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> appoint</span><span style="color:#ABB2BF;">(activityId, channelId, token);</span></span>
<span class="line"><span style="color:#ABB2BF;">            this.sendMessage = res4.message;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`é¢„çº¦ç»“æœ</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${message}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`é¢„çº¦ç»“æœ</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${message}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;"> (err) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`è¿è¡Œå¼‚å¸¸</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${err</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">message}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`è¿è¡Œå¼‚å¸¸</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${err</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">message}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">XLTH_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">XLTH_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> æ–°è”æƒ è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">GLYP_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">GLYP_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µæ—…ä¼˜å“</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">KGLG_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">KGLG_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ç©ºæ¸¯ä¹è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">HLQG_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">HLQG_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> èˆªæ—…é»”è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">ZHCS_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">ZHCS_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> éµè¡Œå‡ºå±±</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">GYQP_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">GYQP_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µç›é»”å“</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">LLSC_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">LLSC_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ä¹æ—…å•†åŸ</span></span>
<span class="line"><span style="color:#ABB2BF;">    const </span><span style="color:#D19A66;">YLQX_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">YLQX_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> é©¿è·¯é»”å¯»</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">XLTH_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">XLTH_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">XLTH_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">GLYP_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">GLYP_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">GLYP_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">KGLG_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">KGLG_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">KGLG_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">HLQG_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">HLQG_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HLQG_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">ZHCS_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">ZHCS_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">ZHCS_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">GYQP_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">GYQP_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">GYQP_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">LLSC_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸé¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸé¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">LLSC_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">LLSC_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸé¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸé¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">YLQX_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»é¢„çº¦å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">YLQX_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">YLQX_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»é¢„çº¦ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> notify.</span><span style="color:#61AFEF;">sendNotify</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`è‘«èŠ¦å¨ƒé¢„çº¦`</span><span style="color:#ABB2BF;">, sendMessage.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">), {}, </span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n\n</span><span style="color:#98C379;">æœ¬é€šçŸ¥ Byï¼šä¸€æ³½&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br></div></div><p>è§£æï¼š</p><p>è¿™æ®µ JavaScript ä»£ç æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–é¢„çº¦è„šæœ¬ï¼Œç‰ˆæœ¬ä¸º 1.06ï¼Œè®¾è®¡ç”¨äºåœ¨å¤šä¸ªå¹³å°ä¸Šæ ¹æ®ç”¨æˆ·æä¾›çš„ token è‡ªåŠ¨å®Œæˆé¢„çº¦æ´»åŠ¨ã€‚å®ƒä¸»è¦é’ˆå¯¹å‡ ä¸ªç‰¹å®šçš„è´­ç‰©å¹³å°ï¼Œé€šè¿‡è°ƒç”¨è¿™äº›å¹³å°çš„ API æ¥å£å®ç°è‡ªåŠ¨é¢„çº¦ã€‚ä»¥ä¸‹æ˜¯è„šæœ¬çš„ä¸»è¦åŠŸèƒ½å’Œæ­¥éª¤ï¼š</p><ol><li>ç¯å¢ƒå˜é‡è®¾ç½®ï¼šè„šæœ¬é€šè¿‡ç¯å¢ƒå˜é‡è·å–ç”¨æˆ·çš„ tokenï¼Œæ”¯æŒå¤šè´¦å·æ“ä½œã€‚é’ˆå¯¹ä¸åŒçš„è´­ç‰©å¹³å°ï¼Œå¦‚æ–°è”æƒ è´­ã€è´µæ—…ä¼˜å“ã€ç©ºæ¸¯ä¹è´­ç­‰ï¼Œè®¾ç½®äº†ä¸åŒçš„ç¯å¢ƒå˜é‡ï¼ˆå¦‚<code>XLTH_COOKIE</code>ã€<code>GLYP_COOKIE</code>ç­‰ï¼‰æ¥å­˜å‚¨ tokenã€‚</li><li>è¯·æ±‚å’ŒåŠ å¯†å¤„ç†ï¼šä½¿ç”¨<code>axios</code>åº“å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œ<code>crypto</code>åº“è¿›è¡Œç­¾ååŠ å¯†ï¼Œä»¥æ»¡è¶³ API è°ƒç”¨æ—¶çš„å®‰å…¨è¦æ±‚ã€‚<code>moment</code>åº“ç”¨äºå¤„ç†æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ï¼Œä»¥ç¬¦åˆ API è¯·æ±‚çš„æ ‡å‡†ã€‚</li><li>æ„å»ºè¯·æ±‚å¤´ï¼š<code>buildHeader</code>å‡½æ•°ç”¨äºæ„å»º API è¯·æ±‚æ‰€éœ€çš„å¤´éƒ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬å†…å®¹ç±»å‹ã€ç­¾åã€è®¿é—®å¯†é’¥ç­‰ä¿¡æ¯ã€‚</li><li>ç”¨æˆ·ä¿¡æ¯å’Œæ´»åŠ¨æŸ¥è¯¢ï¼šé€šè¿‡<code>getUserInfo</code>å’Œ<code>getChannelActivity</code>å‡½æ•°æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å’Œæ¸ é“æ´»åŠ¨è¯¦æƒ…ã€‚</li><li>é¢„çº¦æ´»åŠ¨ï¼š<code>appoint</code>å‡½æ•°ç”¨äºæ‰§è¡Œé¢„çº¦æ“ä½œï¼Œè°ƒç”¨ç‰¹å®šçš„ API æ¥å£è¿›è¡Œæ´»åŠ¨é¢„çº¦ã€‚</li><li>æ£€æŸ¥å’Œæäº¤é¢„çº¦ï¼š<code>checkCustomerInQianggou</code>å‡½æ•°ç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²åœ¨æŠ¢è´­æ´»åŠ¨ä¸­ï¼Œ<code>autoSubmit</code>å‡½æ•°è´Ÿè´£è‡ªåŠ¨æäº¤é¢„çº¦è¯·æ±‚ã€‚</li><li>ä¸»å‡½æ•°ï¼š<code>main</code>å‡½æ•°æ˜¯è„šæœ¬çš„å…¥å£ï¼Œå¤„ç†ç¯å¢ƒå˜é‡ä¸­çš„ tokenï¼Œéå†æ¯ä¸ªè´¦å·ï¼Œå¹¶å¯¹æ¯ä¸ªè´­ç‰©å¹³å°è¿›è¡Œé¢„çº¦å°è¯•ã€‚</li><li>é€šçŸ¥ï¼šé€šè¿‡<code>notify.sendNotify</code>å‡½æ•°å‘é€é¢„çº¦ç»“æœçš„é€šçŸ¥ã€‚</li></ol><p>æ•´ä¸ªè„šæœ¬åˆ©ç”¨äº†ç¯å¢ƒå˜é‡ä¸­çš„ token æ¥ä¸ºä¸åŒçš„ç”¨æˆ·åœ¨å¤šä¸ªè´­ç‰©å¹³å°ä¸Šè‡ªåŠ¨å®Œæˆé¢„çº¦ï¼Œå‡å°‘äº†æ‰‹åŠ¨æ“ä½œçš„éœ€è¦ï¼Œå¹¶é€šè¿‡å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚<code>cron</code>è®¾ç½®ï¼‰è‡ªåŠ¨æ‰§è¡Œï¼Œä»¥æé«˜æŠ¢è´­æ´»åŠ¨çš„æˆåŠŸç‡ã€‚</p><h1 id="å®šæ—¶è½®è¯¢é¢„çº¦ç”³è´­-mao-å°è„šæœ¬" tabindex="-1">å®šæ—¶è½®è¯¢é¢„çº¦ç”³è´­ mao å°è„šæœ¬ <a class="header-anchor" href="#å®šæ—¶è½®è¯¢é¢„çº¦ç”³è´­-mao-å°è„šæœ¬" aria-label="Permalink to &quot;å®šæ—¶è½®è¯¢é¢„çº¦ç”³è´­ mao å°è„šæœ¬&quot;">â€‹</a></h1><p><strong>ä»£ç å¦‚ä¸‹</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> appium </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> webdriver</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.common.exceptions </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> NoSuchElementException</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> appium.webdriver.common.touch_action </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> TouchAction</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> appium.webdriver.connectiontype </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ConnectionType</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">daily_subscribe </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">daily_tour </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">luck_day </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">daily_check </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps[</span><span style="color:#98C379;">&#39;platformName&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;Android&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps[</span><span style="color:#98C379;">&#39;platformversion&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;7.1.1&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps[</span><span style="color:#98C379;">&#39;deviceName&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;192.168.0.105:5555&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># desired_caps[&#39;udid&#39;] = &#39;192.168.0.101:5556&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#desired_caps[&#39;appPackage&#39;] = &#39;com.moutai.mall&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#desired_caps[&#39;appActivity&#39;] = &#39;.MainActivity&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps[</span><span style="color:#98C379;">&#39;noReset&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;True&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps[</span><span style="color:#98C379;">&#39;unicodeKeyboard&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#ABB2BF;">desired_caps[</span><span style="color:#98C379;">&#39;resetKeyboard&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">driver </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># print(driver.current_package)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># print(driver.current_activity)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> handleException</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç™»å½•&#39;]&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/etPhone&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">clear</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/etPhone&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;15895919875&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        flag </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_class_name</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;android.widget.CheckBox&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;checked&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> flag </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;false&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            driver.</span><span style="color:#61AFEF;">find_element_by_class_name</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;android.widget.CheckBox&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;è·å–éªŒè¯ç &#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">start_activity</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;com.tencent.mobileqq&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.activity.SplashActivity&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[contains(@content-desc, &#39;phil&#39;)]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_class_name</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;android.widget.EditText&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ièŒ…å°ç™»å½•è¿‡æœŸï¼Œè¯·è¾“å…¥éªŒè¯ç &quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;å‘é€&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">50</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        string </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        eles </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_class_name</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;android.widget.TextView&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(eles)</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> eles[i].text.</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;yzm&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                string </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> eles[i].text[</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">:]</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(string)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># back</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># back</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/etVerifyCode&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">clear</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/etVerifyCode&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(string)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç™»å½•&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> NoSuchElementException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> daily_subcribe</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #driver.start_activity(&#39;com.moutai.mall&#39;, &#39;.MainActivity&#39;)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;ièŒ…å°&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/ivLeft&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;é¢„çº¦ç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç¡®å®šç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç»§ç»­ç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">swipe</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">530</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1700</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">530</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">swipe</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">530</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1700</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">530</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;é¢„çº¦ç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;ç¡®å®šç”³è´­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #check</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æŸ¥çœ‹è¯¦æƒ…&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/date_time&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/draw_status&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        string </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">min</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(date))):</span></span>
<span class="line"><span style="color:#ABB2BF;">            string </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> date[i].text </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> status[i].text</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(string)</span></span>
<span class="line"><span style="color:#ABB2BF;">        current_date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#56B6C2;">        str</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> current_date </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;é™å€™ç”³è´­ç»“æœ&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> current_date </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;é™å€™ç”³è´­ç»“æœ&quot;</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># return</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> string </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> NoSuchElementException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#61AFEF;">        handleException</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> check_daily_subcribe</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;ièŒ…å°&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æˆ‘çš„&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æˆ‘çš„ç”³è´­å•&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/date_time&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.moutai.mall:id/draw_status&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    string </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(date)):</span></span>
<span class="line"><span style="color:#ABB2BF;">        string </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> date[i].text </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;:&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> status[i].text </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(string)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">start_activity</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;com.tencent.mobileqq&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.activity.SplashActivity&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[contains(@content-desc, &#39;phil&#39;)]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_class_name</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;android.widget.EditText&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(string)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;å‘é€&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># back</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># back</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> xiao_mao_yun</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;ièŒ…å°&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;å°èŒ…è¿&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æ—…è¡Œ&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[contains(@text, &#39;100è€åŠ›å»æ—…è¡Œ&#39;)]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;1650539651c20999&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># exit</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> NoSuchElementException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;å°èŒ…è¿&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æ—…è¡Œ&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;é¢†å–å¥–åŠ±&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æˆ‘çŸ¥é“äº†&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # driver.find_element_by_xpath(&quot;//*[@text=&#39;æˆ‘çŸ¥é“å•¦&#39;]&quot;).click()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        TouchAction</span><span style="color:#ABB2BF;">(driver).</span><span style="color:#61AFEF;">tap</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">315</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1704</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">perform</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;1650539651c20999&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># exit</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> NoSuchElementException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # driver.find_element_by_xpath(&quot;//*[@text=&#39;60è€åŠ› åŠ é€Ÿå®Œæˆ&#39;]&quot;).click()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # driver.find_element_by_xpath(&quot;//*[@text=&#39;40è€åŠ› åŠ é€Ÿå®Œæˆ&#39;]&quot;).click()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # driver.find_element_by_xpath(&quot;//*[@text=&#39;20è€åŠ› åŠ é€Ÿå®Œæˆ&#39;]&quot;).click()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # driver.find_element_by_xpath(&quot;//*[@text=&#39;å°èŒ…ç´¯äº†ï¼Œæ˜æ—¥ç»§ç»­&#39;]&quot;).click()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # TouchAction(driver).tap(x=544, y=1620).perform()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> catch_jong_dong</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;äº¬ä¸œ&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;æˆ‘çš„&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;å•†å“æ”¶è—&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@resource-id=&#39;com.jd.lib.favourites.feature:id/b7&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> catch_tian_mao</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;æ‰‹æœºå¤©çŒ«&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@text=&#39;è´­ç‰©è½¦&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;å¤©çŒ«è¶…å¸‚åº—é“ºå‹¾é€‰æŒ‰é’®æœªé€‰ä¸­&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;ç»“ç®—,æŒ‰é’®&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;//*[@content-desc=&#39;æäº¤è®¢å•&#39;]&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> unlock</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> driver</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Remote</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;http://localhost:4723/wd/hub&#39;</span><span style="color:#ABB2BF;">, desired_caps)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">implicitly_wait</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">swipe</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">530</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1700</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">530</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        TouchAction</span><span style="color:#ABB2BF;">(driver).</span><span style="color:#61AFEF;">press</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">536</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">993</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">move_to</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">247</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1283</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">move_to</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">536</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1283</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">move_to</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">828</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1283</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">release</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">perform</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># home</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> lock</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># back</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># back</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># home</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">close_app</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">press_keycode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">26</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># power</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        current_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> current_time.tm_hour </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(current_time)</span></span>
<span class="line"><span style="color:#ABB2BF;">            daily_subscribe </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">            daily_tour </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">            luck_day </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">            daily_check </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#ABB2BF;"> current_time.tm_hour </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 9</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> daily_subscribe </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(current_time)</span></span>
<span class="line"><span style="color:#61AFEF;">            unlock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#61AFEF;"> daily_subcribe</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                daily_subscribe </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;">            lock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#ABB2BF;"> current_time.tm_hour </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 10</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> daily_tour </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(current_time)</span></span>
<span class="line"><span style="color:#61AFEF;">            unlock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#61AFEF;"> xiao_mao_yun</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                daily_tour </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;">            lock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#D19A66;"> 0</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;"> current_time.tm_min </span><span style="color:#56B6C2;">&lt;</span><span style="color:#D19A66;"> 50</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(current_time)</span></span>
<span class="line"><span style="color:#61AFEF;">            unlock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">            lock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # elif current_time.tm_hour == 18 and 20 &lt; current_time.tm_min &lt; 50 and daily_check is 0:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     print(current_time)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     unlock()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     check_daily_subcribe()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     lock()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     daily_check = 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç ä½¿ç”¨ Appium æ¡†æ¶æ¥è‡ªåŠ¨åŒ–æ§åˆ¶å®‰å“è®¾å¤‡ï¼Œä¸»è¦æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œå¦‚ç™»å½•ã€é¢„çº¦ç”³è´­ã€è‡ªåŠ¨æ—…è¡Œç­‰ã€‚ä¸‹é¢æ˜¯ä»£ç çš„è¯¦ç»†è§£æï¼š</p><p><strong>å¯¼å…¥æ¨¡å—å’Œåˆå§‹åŒ–å˜é‡</strong></p><p>- ä½¿ç”¨ <code>appium.webdriver</code> æ¥é©±åŠ¨å®‰å“è®¾å¤‡ã€‚</p><p>- <code>selenium.common.exceptions.NoSuchElementException</code> ç”¨äºå¤„ç†å…ƒç´ æœªæ‰¾åˆ°çš„å¼‚å¸¸ã€‚</p><p>- å®šä¹‰äº†å‡ ä¸ªå…¨å±€å˜é‡ï¼ˆ<code>daily_subscribe</code>, <code>daily_tour</code>, <code>luck_day</code>, <code>daily_check</code>ï¼‰æ¥è·Ÿè¸ªæ¯æ—¥ä»»åŠ¡çš„å®ŒæˆçŠ¶æ€ã€‚</p><p><strong>Appium é…ç½®</strong></p><p>- è®¾ç½® <code>desired_caps</code> å­—å…¸æ¥é…ç½® Appiumï¼ŒåŒ…æ‹¬è®¾å¤‡åç§°ã€å¹³å°ã€ç‰ˆæœ¬ç­‰ä¿¡æ¯ã€‚</p><p><strong>Appium é©±åŠ¨å®ä¾‹</strong></p><p>- <code>driver</code> æ˜¯ç”¨äºæ§åˆ¶è®¾å¤‡çš„ webdriver å®ä¾‹ã€‚</p><p><strong>åŠŸèƒ½å‡½æ•°</strong></p><p>- <code>handleException()</code>ï¼šå¼‚å¸¸å¤„ç†ï¼Œå°è¯•ç™»å½•å¹¶è·å–éªŒè¯ç ï¼Œç„¶åè¿”å›åˆ°ç™»å½•ç•Œé¢ã€‚</p><p>- <code>daily_subcribe()</code>ï¼šå°è¯•è¿›è¡Œæ¯æ—¥é¢„çº¦ç”³è´­æ“ä½œã€‚</p><p>- <code>check_daily_subcribe()</code>ï¼šæ£€æŸ¥é¢„çº¦ç”³è´­çš„çŠ¶æ€ã€‚</p><p>- <code>xiao_mao_yun()</code>ï¼šè‡ªåŠ¨å®Œæˆæ—…è¡Œä»»åŠ¡ã€‚</p><p>- <code>catch_jong_dong()</code> å’Œ <code>catch_tian_mao()</code>ï¼šæ¨¡æ‹Ÿåœ¨äº¬ä¸œå’Œå¤©çŒ«çš„è´­ç‰©è¡Œä¸ºã€‚</p><p>- <code>unlock()</code> å’Œ <code>lock()</code>ï¼šè§£é”å’Œé”å®šè®¾å¤‡ï¼Œæ‰§è¡Œæ“ä½œå‰åçš„å‡†å¤‡å’Œæ”¶å°¾å·¥ä½œã€‚</p><p><strong>ä¸»é€»è¾‘</strong></p><p>- åœ¨ä¸»å‡½æ•°ä¸­ï¼Œç¨‹åºè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œæ¯ 10 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ—¶é—´ï¼Œæ ¹æ®å½“å‰çš„å°æ—¶æ•°æ¥å†³å®šæ‰§è¡Œå“ªäº›ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œåœ¨ 9 ç‚¹æ—¶å°è¯•æ‰§è¡Œ <code>daily_subcribe()</code> å‡½æ•°è¿›è¡Œç”³è´­æ“ä½œï¼Œè€Œåœ¨ 10 ç‚¹æ—¶æ‰§è¡Œ <code>xiao_mao_yun()</code> è¿›è¡Œæ—…è¡Œä»»åŠ¡ã€‚</p><p><strong>ç‰¹ç‚¹å’Œç”¨é€”</strong></p><p>- æ­¤è„šæœ¬é€‚ç”¨äºéœ€è¦å®šæ—¶è‡ªåŠ¨åŒ–æ‰§è¡Œä¸€ç³»åˆ—æ‰‹æœºæ“ä½œçš„åœºæ™¯ï¼Œå¦‚è‡ªåŠ¨ç™»å½•ã€é¢„çº¦ã€è´­ç‰©ç­‰ã€‚</p><p>- é€šè¿‡ä¿®æ”¹æ—¶é—´æ¡ä»¶å’Œå¯¹åº”çš„ä»»åŠ¡å‡½æ•°ï¼Œå¯ä»¥çµæ´»é…ç½®å…¶è‡ªåŠ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p><p>- æ­¤è„šæœ¬ä¾èµ–äºå…·ä½“çš„åº”ç”¨å…ƒç´ å’Œå¸ƒå±€ï¼ˆå¦‚å…ƒç´  ID å’Œ XPathï¼‰ï¼Œå¯èƒ½éœ€è¦é’ˆå¯¹ä¸åŒçš„åº”ç”¨å’Œå®‰å“ç‰ˆæœ¬è¿›è¡Œé€‚å½“è°ƒæ•´ã€‚</p><p>- éœ€è¦æœ‰é€‚å½“çš„è®¾å¤‡å’Œ Appium æœåŠ¡å™¨é…ç½®æ‰èƒ½è¿è¡Œæ­¤è„šæœ¬ã€‚</p><p>è¿™ä¸ªè„šæœ¬çš„ä½¿ç”¨åœºæ™¯ä¸»è¦æ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•æˆ–è‡ªåŠ¨æ‰§è¡Œæ—¥å¸¸ä»»åŠ¡ï¼Œå‡å°‘é‡å¤æ€§å·¥ä½œçš„äººå·¥æ“ä½œéœ€æ±‚ã€‚å¦‚æœæœ‰å…·ä½“çš„ä½¿ç”¨åœºæ™¯æˆ–è€…é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¢è®¨å¦‚ä½•è°ƒæ•´å’Œä¼˜åŒ–ä»£ç ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h1 id="è‘«èŠ¦å¨ƒèŒ…å°ä¸­ç­¾è„šæœ¬" tabindex="-1">è‘«èŠ¦å¨ƒèŒ…å°ä¸­ç­¾è„šæœ¬ <a class="header-anchor" href="#è‘«èŠ¦å¨ƒèŒ…å°ä¸­ç­¾è„šæœ¬" aria-label="Permalink to &quot;è‘«èŠ¦å¨ƒèŒ…å°ä¸­ç­¾è„šæœ¬&quot;">â€‹</a></h1><p><strong>ä»£ç å¦‚ä¸‹</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#56B6C2;">/**</span></span>
<span class="line"><span style="color:#ABB2BF;"> è‘«èŠ¦å¨ƒä¸­ç­¾æŸ¥è¯¢ v4.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"> cron: </span><span style="color:#D19A66;">30</span><span style="color:#D19A66;"> 8</span><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> *</span></span>
<span class="line"><span style="color:#ABB2BF;"> const </span><span style="color:#FFFFFF;">$</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> new </span><span style="color:#61AFEF;">Env</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è‘«èŠ¦å¨ƒä¸­ç­¾æŸ¥è¯¢&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;"> è‡ªè¡ŒæŠ“åŒ…æŠŠtoken</span><span style="color:#ABB2BF;">(ä¸€èˆ¬åœ¨è¯·æ±‚å¤´é‡Œ)å¡«åˆ°å˜é‡ä¸­, å¤šè´¦å·ç”¨æ¢è¡Œéš”å¼€ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">XLTH_COOKIE</span><span style="color:#ABB2BF;"> æ–°è”æƒ è´­</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">GLYP_COOKIE</span><span style="color:#ABB2BF;"> è´µæ—…ä¼˜å“</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">KGLG_COOKIE</span><span style="color:#ABB2BF;"> ç©ºæ¸¯ä¹è´­</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">HLQG_COOKIE</span><span style="color:#ABB2BF;"> èˆªæ—…é»”è´­</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">ZHCS_COOKIE</span><span style="color:#ABB2BF;"> éµè¡Œå‡ºå±±</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">GYQP_COOKIE</span><span style="color:#ABB2BF;"> è´µç›é»”å“</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">LLSC_COOKIE</span><span style="color:#ABB2BF;"> ä¹æ—…å•†åŸ</span></span>
<span class="line"><span style="color:#ABB2BF;"> ç¯å¢ƒå˜é‡ </span><span style="color:#D19A66;">YLQX_COOKIE</span><span style="color:#ABB2BF;"> é©¿è·¯é»”å¯»</span></span>
<span class="line"><span style="color:#56B6C2;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">SPLIT</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> åˆ†å‰²ç¬¦ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const axios </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;axios&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const crypto </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;crypto&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const moment </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;moment&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const notify </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;./sendNotify&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">XLTH_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wxded2e7e6d60ac09d&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> æ–°è”æƒ è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">GLYP_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx61549642d715f361&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µæ—…ä¼˜å“</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">KGLG_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx613ba8ea6a002aa8&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ç©ºæ¸¯ä¹è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">HLQG_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx936aa5357931e226&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> èˆªæ—…é»”è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">ZHCS_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx624149b74233c99a&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> éµèˆªå‡ºå±±</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">GYQP_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx5508e31ffe9366b8&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µç›é»”å“</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">LLSC_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wx821fb4d8604ed4d6&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ä¹æ—…å•†åŸ</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">YLQX_APPID</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;wxee0ce83ab4b26f9c&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> é©¿è·¯é»”å¯»</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;https://gw.huiqunchina.com&#39;</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">AK</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;00670fb03584fbf44dd6b136e534f495&#39;</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">const </span><span style="color:#D19A66;">SK</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;0d65f24dbe2bc1ede3c3ceeb96ef71bb&#39;</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">let sendMessage </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">delay</span><span style="color:#ABB2BF;"> (time) {</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> new </span><span style="color:#61AFEF;">Promise</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#61AFEF;"> setTimeout</span><span style="color:#ABB2BF;">(resolve, time));</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">calculateDigest</span><span style="color:#ABB2BF;"> (body, sk) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const hmac = crypto.</span><span style="color:#61AFEF;">createHmac</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sha256&#39;</span><span style="color:#ABB2BF;">, sk);</span></span>
<span class="line"><span style="color:#ABB2BF;">  hmac.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(body);</span></span>
<span class="line"><span style="color:#ABB2BF;">  const signature = hmac.</span><span style="color:#61AFEF;">digest</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;base64&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> signature;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">calculateSignature</span><span style="color:#ABB2BF;"> (method, url, ak, sk, date) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const strToSign = </span><span style="color:#FFFFFF;">`${method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toUpperCase</span><span style="color:#ABB2BF;">()</span><span style="color:#FFFFFF;">}\n${url}\n\n${ak}\n${date}\n`;</span></span>
<span class="line"><span style="color:#FFFFFF;">  const hmac = crypto</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createHmac</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sha256&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#FFFFFF;"> sk</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  hmac.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(strToSign);</span></span>
<span class="line"><span style="color:#ABB2BF;">  const signature = hmac.</span><span style="color:#61AFEF;">digest</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;base64&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> signature;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;"> (method, url, body) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const date = </span><span style="color:#61AFEF;">moment</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">utc</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ddd, DD MMM YYYY HH:mm:ss [GMT]&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  const signature = </span><span style="color:#61AFEF;">calculateSignature</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">AK</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">SK</span><span style="color:#ABB2BF;">, date);</span></span>
<span class="line"><span style="color:#ABB2BF;">  const digest = </span><span style="color:#61AFEF;">calculateDigest</span><span style="color:#ABB2BF;">(body, </span><span style="color:#D19A66;">SK</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  const headers = {</span></span>
<span class="line"><span style="color:#98C379;">    &#39;Content-Type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/json&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &#39;X-HMAC-SIGNATURE&#39;</span><span style="color:#ABB2BF;">: signature,</span></span>
<span class="line"><span style="color:#98C379;">    &#39;X-HMAC-ACCESS-KEY&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">AK</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &#39;X-HMAC-ALGORITHM&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;hmac-sha256&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &#39;X-HMAC-DIGEST&#39;</span><span style="color:#ABB2BF;">: digest,</span></span>
<span class="line"><span style="color:#98C379;">    &#39;X-HMAC-Date&#39;</span><span style="color:#ABB2BF;">: date,</span></span>
<span class="line"><span style="color:#98C379;">    &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 MicroMessenger/7.0.20.1781(0x6700143B) NetType/WIFI MiniProgramEnv/Windows WindowsWechat/WMPF XWEB/6945&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> headers;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">getUserInfo</span><span style="color:#ABB2BF;"> (appId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/queryById/token&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  const data = { appId };</span></span>
<span class="line"><span style="color:#ABB2BF;">  const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">  headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  let resData;</span></span>
<span class="line"><span style="color:#C678DD;">  await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, { method: method, data: data, headers: headers })</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">getChannelActivity</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">id</span><span style="color:#ABB2BF;">, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/promotion/channelActivity&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  const data = { </span><span style="color:#56B6C2;">id</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#ABB2BF;">  const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">  headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  let resData;</span></span>
<span class="line"><span style="color:#C678DD;">  await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, { method: method, data: data, headers: headers })</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">/**</span><span style="color:#ABB2BF;"> æŸ¥è¯¢ </span><span style="color:#56B6C2;">*/</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">getWinningCustomers</span><span style="color:#ABB2BF;"> (activityId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const url = </span><span style="color:#98C379;">&#39;/front-manager/api/customer/promotion/getWinningCustomers&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  const method = </span><span style="color:#98C379;">&#39;post&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  const data = { activityId };</span></span>
<span class="line"><span style="color:#ABB2BF;">  const headers = </span><span style="color:#61AFEF;">buildHeader</span><span style="color:#ABB2BF;">(method, url, </span><span style="color:#D19A66;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringify</span><span style="color:#ABB2BF;">(data));</span></span>
<span class="line"><span style="color:#ABB2BF;">  headers[</span><span style="color:#98C379;">&#39;X-access-token&#39;</span><span style="color:#ABB2BF;">] = token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  let resData;</span></span>
<span class="line"><span style="color:#C678DD;">  await</span><span style="color:#61AFEF;"> axios</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HOST</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> url, { method: method, data: data, headers: headers })</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      resData = res.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#56B6C2;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      resData = err.response.data;</span></span>
<span class="line"><span style="color:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> resData;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">autoSubmit</span><span style="color:#ABB2BF;"> (appId, token) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  let channelId = </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  let channelName = </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">XLTH_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;8&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">GLYP_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;7&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">KGLG_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">HLQG_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;6&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">ZHCS_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;5&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">GYQP_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;è´µç›é»”å“&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">LLSC_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸ&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (appId </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">= </span><span style="color:#D19A66;">YLQX_APPID</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelId = </span><span style="color:#98C379;">&#39;9&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    channelName = </span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    const res1 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> getUserInfo</span><span style="color:#ABB2BF;">(appId, token);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (res1.code </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;10000&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(res1.message);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(res1.message);</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    const realName = res1.data.realName;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const phone = res1.data.phone;</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`å½“å‰ç”¨æˆ·</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${phone}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`å½“å‰ç”¨æˆ·</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${phone}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    const res2 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> getChannelActivity</span><span style="color:#ABB2BF;">(channelId, token);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (res2.code </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;10000&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(res2.message);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(res2.message);</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    const activityId = res2.data.id;</span></span>
<span class="line"><span style="color:#ABB2BF;">    const activityName = res2.data.name;</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`æ´»åŠ¨åç§°</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${activityName}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`æ´»åŠ¨åç§°</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${activityName}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    const res5 = </span><span style="color:#C678DD;">await</span><span style="color:#61AFEF;"> getWinningCustomers</span><span style="color:#ABB2BF;">(activityId, token)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (res5.code </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;10000&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(res5.message);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(res5.message);</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`å°ç¨‹åºï¼š${channelName}ï¼Œæ´»åŠ¨åç§°ã€Œ${activityName}ã€ï¼Œä¸­ç­¾ç»“æœï¼š${res5</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">message ?? </span><span style="color:#98C379;">&#39;--&#39;</span><span style="color:#FFFFFF;">}`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`å°ç¨‹åºï¼š${channelName}ï¼Œæ´»åŠ¨åç§°ã€Œ${activityName}ã€ï¼Œä¸­ç­¾ç»“æœï¼š${res5</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">message ?? </span><span style="color:#98C379;">&#39;--&#39;</span><span style="color:#FFFFFF;">}`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;"> å‘é€é£ä¹¦æœºå™¨äºº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;"> (err) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`è¿è¡Œå¼‚å¸¸</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${err</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">message}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`è¿è¡Œå¼‚å¸¸</span><span style="color:#ABB2BF;">[</span><span style="color:#FFFFFF;">${err</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">message}</span><span style="color:#ABB2BF;">]</span><span style="color:#FFFFFF;">`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> function </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">XLTH_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">XLTH_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> æ–°è”æƒ è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">GLYP_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">GLYP_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µæ—…ä¼˜å“</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">KGLG_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">KGLG_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ç©ºæ¸¯ä¹è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">HLQG_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">HLQG_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> èˆªæ—…é»”è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">ZHCS_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">ZHCS_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> éµè¡Œå‡ºå±±</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">GYQP_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">GYQP_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> è´µç›é»”å“</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">LLSC_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">LLSC_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> ä¹æ—…å•†åŸ</span></span>
<span class="line"><span style="color:#ABB2BF;">  const </span><span style="color:#D19A66;">YLQX_COOKIE_ARR</span><span style="color:#ABB2BF;"> = process.env.</span><span style="color:#D19A66;">YLQX_COOKIE</span><span style="color:#ABB2BF;">; </span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;"> é©¿è·¯é»”å¯»</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">XLTH_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">XLTH_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">XLTH_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">GLYP_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">GLYP_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">GLYP_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µæ—…ä¼˜å“æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">KGLG_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">KGLG_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">KGLG_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç©ºæ¸¯ä¹è´­æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">HLQG_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">HLQG_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">HLQG_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;èˆªæ—…é»”è´­æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">ZHCS_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–°è”æƒ è´­æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">ZHCS_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">ZHCS_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éµè¡Œå‡ºå±±æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">GYQP_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">GYQP_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">GYQP_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è´µç›é»”å“æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">LLSC_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸæŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸæŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">LLSC_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">LLSC_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸæŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¹æ—…å•†åŸæŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">YLQX_COOKIE_ARR</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»æŸ¥è¯¢å¼€å§‹&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (let [index, item] of </span><span style="color:#D19A66;">YLQX_COOKIE_ARR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">SPLIT</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">entries</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`----ç¬¬${index </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#FFFFFF;">}ä¸ªå·----`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> autoSubmit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">YLQX_APPID</span><span style="color:#ABB2BF;">, item);</span></span>
<span class="line"><span style="color:#C678DD;">      await</span><span style="color:#61AFEF;"> delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    sendMessage.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é©¿è·¯é»”å¯»æŸ¥è¯¢ç»“æŸ</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  await</span><span style="color:#ABB2BF;"> notify.</span><span style="color:#61AFEF;">sendNotify</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">`è‘«èŠ¦å¨ƒä¸­ç­¾æŸ¥è¯¢`</span><span style="color:#ABB2BF;">, sendMessage.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">), {},);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç”¨äºæŸ¥è¯¢ä¸­ç­¾ç»“æœçš„è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œä¸“é—¨é’ˆå¯¹å¤šä¸ªä¸åŒçš„å¹³å°ï¼ˆå¦‚æ–°è”æƒ è´­ã€è´µæ—…ä¼˜å“ç­‰ï¼‰ã€‚å®ƒæ˜¯ä¸ºäº†è¿è¡Œåœ¨ Node.js ç¯å¢ƒä¸­è®¾è®¡çš„ï¼Œä¸»è¦é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œç„¶åè‡ªåŠ¨æŸ¥è¯¢ä¸­ç­¾ç»“æœã€‚</p><p><strong>ä¸»è¦ç»„ä»¶å’ŒåŠŸèƒ½</strong></p><ol><li>ç¯å¢ƒå˜é‡: åˆ©ç”¨ç¯å¢ƒå˜é‡æ¥å­˜å‚¨å„ä¸ªå¹³å°çš„ Cookie ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ç”¨äºç”¨æˆ·èº«ä»½éªŒè¯ã€‚</li><li>Axios: ä½¿ç”¨ axios åº“æ¥å‘é€ HTTP è¯·æ±‚ï¼Œä¸å„å¹³å°çš„ API è¿›è¡Œäº¤äº’ã€‚</li><li>Crypto: ä½¿ç”¨ crypto åº“æ¥è¿›è¡ŒåŠ å¯†æ“ä½œï¼Œä¸»è¦ç”¨äºç”Ÿæˆè¯·æ±‚ç­¾åï¼Œç¡®ä¿è¯·æ±‚çš„å®‰å…¨æ€§ã€‚</li><li>Moment: ä½¿ç”¨ moment åº“æ¥å¤„ç†æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿™åœ¨ç”Ÿæˆç­¾åå’Œè®¾ç½®è¯·æ±‚å¤´ä¸­å°¤ä¸ºé‡è¦ã€‚</li><li>Notify: å‡è®¾æœ‰ä¸€ä¸ª notify æ¨¡å—ç”¨äºå‘é€é€šçŸ¥ï¼Œå¯èƒ½æ˜¯é€šè¿‡é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ã€‚</li></ol><p><strong>ä¸»è¦é€»è¾‘</strong></p><ol><li>é…ç½®ä¿¡æ¯: å®šä¹‰äº†å¤šä¸ªå¹³å°çš„ AppIDã€API å¯†é’¥ç­‰ä¿¡æ¯ã€‚</li><li>HTTP è¯·æ±‚å¤´ç”Ÿæˆ: <code>buildHeader</code>å‡½æ•°è´Ÿè´£æ ¹æ®æä¾›çš„å‚æ•°æ„å»ºæ¯ä¸ªè¯·æ±‚æ‰€éœ€çš„ç‰¹å®šå¤´ä¿¡æ¯ï¼ŒåŒ…æ‹¬å†…å®¹ç±»å‹ã€æ—¥æœŸã€ç­¾åç­‰ã€‚</li><li>ç”¨æˆ·ä¿¡æ¯å’Œæ´»åŠ¨ä¿¡æ¯æŸ¥è¯¢: <code>getUserInfo</code>å’Œ<code>getChannelActivity</code>å‡½æ•°ç”¨äºè·å–ç”¨æˆ·ä¿¡æ¯å’Œæ´»åŠ¨è¯¦æƒ…ã€‚</li><li>ä¸­ç­¾æŸ¥è¯¢: <code>getWinningCustomers</code>å‡½æ•°æŸ¥è¯¢ç‰¹å®šæ´»åŠ¨çš„ä¸­ç­¾æƒ…å†µã€‚</li></ol><p><strong>æ‰§è¡Œæµç¨‹</strong></p><ol><li>Cookie è§£æ: è„šæœ¬é¦–å…ˆä»ç¯å¢ƒå˜é‡ä¸­è¯»å–ä¸åŒå¹³å°çš„ Cookieã€‚</li><li>æŒ‰å¹³å°æ‰§è¡ŒæŸ¥è¯¢: å¯¹äºæ¯ä¸ªå¹³å°ï¼Œè„šæœ¬é€šè¿‡<code>autoSubmit</code>å‡½æ•°æ‰§è¡ŒæŸ¥è¯¢æ“ä½œã€‚æ­¤å‡½æ•°å°†è°ƒç”¨å‰è¿°çš„è·å–ç”¨æˆ·ä¿¡æ¯ã€è·å–æ´»åŠ¨ä¿¡æ¯å’ŒæŸ¥è¯¢ä¸­ç­¾ç»“æœçš„å‡½æ•°ã€‚</li><li>ç»“æœå¤„ç†: æŸ¥è¯¢ç»“æœä¼šè¢«æ•´ç†å¹¶é€šè¿‡é€šçŸ¥æ¨¡å—å‘é€å‡ºå»ã€‚</li></ol><p><strong>è‡ªåŠ¨åŒ–å’Œå¼‚æ­¥å¤„ç†</strong></p><p>- è„šæœ¬å¤§é‡ä½¿ç”¨äº†<code>async</code>å’Œ<code>await</code>æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œç¡®ä¿åœ¨å‘é€è¯·æ±‚æˆ–ç­‰å¾…å“åº”æ—¶ä¸ä¼šé˜»å¡å…¶ä»–æ“ä½œã€‚</p><p>- é€šè¿‡è®¾ç½®å»¶æ—¶ï¼ˆ<code>delay</code>å‡½æ•°ï¼‰æ¥é¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚ã€‚</p><p><strong>å®šæœŸæ‰§è¡Œ</strong></p><p>- è„šæœ¬é¡¶éƒ¨çš„æ³¨é‡Šæåˆ°äº† Cron è¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€è„šæœ¬æ˜¯è®¾è®¡ä¸ºå®šæ—¶æ‰§è¡Œçš„ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒè¢«è®¾ç½®ä¸ºæ¯å¤©çš„ 8 ç‚¹ 30 åˆ†æ‰§è¡Œã€‚</p><p><strong>å®‰å…¨æ€§</strong></p><p>- ä½¿ç”¨ HMAC SHA256 ç®—æ³•æ¥ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆç­¾åï¼Œå¢åŠ äº† API è°ƒç”¨çš„å®‰å…¨æ€§ã€‚</p><p>è¿™ä¸ªè„šæœ¬é€‚åˆç”¨åœ¨éœ€è¦è‡ªåŠ¨åŒ–æŸ¥è¯¢ä¸­ç­¾ç»“æœçš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠå¤šä¸ªè´¦å·å’Œå¹³å°æ—¶ã€‚å®ƒé€šè¿‡ç¯å¢ƒå˜é‡çµæ´»é…ç½®ï¼Œåˆ©ç”¨ç°ä»£ JavaScript å¼‚æ­¥ç‰¹æ€§æ¥é«˜æ•ˆå¤„ç†ç½‘ç»œè¯·æ±‚ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h1 id="chrome-æ’ä»¶-å¤©çŒ«æ´»åŠ¨è‡ªåŠ¨æŠ¢è´­èŒ…å°è„šæœ¬" tabindex="-1">Chrome æ’ä»¶ï¼šå¤©çŒ«æ´»åŠ¨è‡ªåŠ¨æŠ¢è´­èŒ…å°è„šæœ¬ <a class="header-anchor" href="#chrome-æ’ä»¶-å¤©çŒ«æ´»åŠ¨è‡ªåŠ¨æŠ¢è´­èŒ…å°è„šæœ¬" aria-label="Permalink to &quot;Chrome æ’ä»¶ï¼šå¤©çŒ«æ´»åŠ¨è‡ªåŠ¨æŠ¢è´­èŒ…å°è„šæœ¬&quot;">â€‹</a></h1><h2 id="æ­¥éª¤-1-å‡†å¤‡æ–‡ä»¶" tabindex="-1">æ­¥éª¤ 1: å‡†å¤‡æ–‡ä»¶ <a class="header-anchor" href="#æ­¥éª¤-1-å‡†å¤‡æ–‡ä»¶" aria-label="Permalink to &quot;æ­¥éª¤ 1: å‡†å¤‡æ–‡ä»¶&quot;">â€‹</a></h2><p>é¦–å…ˆï¼Œç¡®ä¿æ‚¨çš„é¡¹ç›®ç›®å½•åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š</p><p>- manifest.json</p><p>- maotai.js</p><p>- icon.pngï¼ˆéœ€è¦åˆ›å»ºæˆ–ä¸‹è½½ä¸€ä¸ªå›¾æ ‡æ–‡ä»¶ä½œä¸ºæ‰©å±•çš„å›¾æ ‡ï¼‰</p><h2 id="æ­¥éª¤-2-ä¿®æ”¹å’Œç¡®è®¤è¿™ä¸‰ä¸ªæ–‡ä»¶" tabindex="-1">æ­¥éª¤ 2: ä¿®æ”¹å’Œç¡®è®¤è¿™ä¸‰ä¸ªæ–‡ä»¶ <a class="header-anchor" href="#æ­¥éª¤-2-ä¿®æ”¹å’Œç¡®è®¤è¿™ä¸‰ä¸ªæ–‡ä»¶" aria-label="Permalink to &quot;æ­¥éª¤ 2: ä¿®æ”¹å’Œç¡®è®¤è¿™ä¸‰ä¸ªæ–‡ä»¶&quot;">â€‹</a></h2><h3 id="manifest-json" tabindex="-1">manifest.json <a class="header-anchor" href="#manifest-json" aria-label="Permalink to &quot;manifest.json&quot;">â€‹</a></h3><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;manifest_version&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Tmall-tickets&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;version&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;1.0&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;description&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©çŒ«è¶…å¸‚æŠ¢è´­èŒ…å°&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;icons&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;48&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;icon.png&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;browser_action&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;default_icon&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;icon.png&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;permissions&quot;</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&quot;tabs&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&lt;all_urls&gt;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;storage&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;content_scripts&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#E06C75;">			&quot;matches&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#98C379;">				&quot;https://chaoshi.detail.tmall.com/*&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">				&quot;https://cart.tmall.com/*&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">				&quot;https://buy.tmall.com/*&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">			],</span></span>
<span class="line"><span style="color:#E06C75;">			&quot;js&quot;</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&quot;maotai.js&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;">			&quot;run_at&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;document_idle&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	]</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="maotai-js" tabindex="-1">maotai.js <a class="header-anchor" href="#maotai-js" aria-label="Permalink to &quot;maotai.js&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">//å®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//æ£€æµ‹çŠ¶æ€</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> checkElementState</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">callback</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> ele</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">path</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">ele</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		callback</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#61AFEF;"> callback</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼‚æ­¥åŠ è½½å…ƒç´ ä¸­....&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> path</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#61AFEF;">			checkElementState</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">path</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">callback</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//ç‚¹å‡»è´­ä¹°æŒ‰é’®</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> clickBuy</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¹°ï¼&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//ç¥¨çš„æ•°é‡  å¦‚æœè¿˜ä¸å¯ä»¥è´­ä¹°ï¼Œè¿™ä¸ªåœ°æ–¹è·å–ä¼šå¤±è´¥</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> amount</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementsByClassName</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;mui-amount-increase&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">	amount</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> amount</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">//+1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> btnBuy</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.buy-button-selector&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//ç»“ç®—</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> checkOut</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»“ç®—å¼€å§‹....&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> btn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;J_Go&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">btn</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		btn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»“ç®—æŒ‰é’®æ²¡æ‰¾åˆ°&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> checkOutAsync</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;">	checkElementState</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;#J_Go&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">checkOut</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//æäº¤è®¢å•</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> submitOrder</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æäº¤è®¢å•å¼€å§‹....&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">	checkElementState</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.go-btn&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#C678DD;">		var</span><span style="color:#E06C75;"> btn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.go-btn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">btn</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">			btn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">		} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æäº¤è®¢å•æŒ‰é’®æ²¡æ‰¾åˆ°&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//ç›®æ ‡æ—¶é—´</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> dDate</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Date</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">//10ç‚¹å’Œ20ç‚¹å¼€æŠ¢</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">dDate</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getHours</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">&lt;</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	dDate</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setHours</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">59</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">59.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	dDate</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setHours</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">19</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">59</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">59.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//dDate.setSeconds( dDate.getSeconds() + 10 );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//è¿›å…¥æ—¶é—´åˆ¤æ–­å¾ªç¯</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> enterTimeCheckLoop</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">callback</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> date</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Date</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> diff</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Date</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">parse</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">dDate</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;"> Date</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">parse</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">date</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">diff</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">diff</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">900</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ—¶é—´è¿‡äº†ï¼&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">diff</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 500</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		callback</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#61AFEF;"> callback</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ—¶é—´åˆ°äº†ï¼ï¼ï¼&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#61AFEF;">			enterTimeCheckLoop</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callback</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}, </span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//console.log(&#39;--&#39;);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//ä¸»è¦å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">		&quot;############################å¼€å§‹æŠ¢è´­èŒ…å°############################&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//debugger;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> href</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> window</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">location</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">href</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">href</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">indexOf</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;cart.tmall.com&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//ç»“ç®—é¡µé¢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//è¿›å…¥æ—¶é—´åˆ¤æ–­</span></span>
<span class="line"><span style="color:#61AFEF;">		enterTimeCheckLoop</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">checkOutAsync</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">href</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">indexOf</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;buy.tmall.com&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//æäº¤è®¢å•é¡µé¢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">		submitOrder</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br></div></div><p><strong>icon.png</strong></p><p>æ³¨æ„: è´­ä¹°æŒ‰é’®å’Œå…¶ä»–æŒ‰é’®çš„å®é™…é€‰æ‹©å™¨éœ€è¦æ‚¨é€šè¿‡æµè§ˆå¤©çŒ«è¶…å¸‚çš„ç›¸åº”é¡µé¢ï¼Œä½¿ç”¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰æ¥ç¡®å®šæ­£ç¡®çš„ CSS é€‰æ‹©å™¨ã€‚</p><h2 id="æ­¥éª¤-3-åŠ è½½æ‰©å±•åˆ°-chrome-æµè§ˆå™¨" tabindex="-1">æ­¥éª¤ 3: åŠ è½½æ‰©å±•åˆ° Chrome æµè§ˆå™¨ <a class="header-anchor" href="#æ­¥éª¤-3-åŠ è½½æ‰©å±•åˆ°-chrome-æµè§ˆå™¨" aria-label="Permalink to &quot;æ­¥éª¤ 3: åŠ è½½æ‰©å±•åˆ° Chrome æµè§ˆå™¨&quot;">â€‹</a></h2><ol><li>æ‰“å¼€ Chromeã€‚</li><li>è¾“å…¥ <code>chrome://extensions/</code> åœ¨åœ°å€æ å¹¶å›è½¦ã€‚</li><li>å¼€å¯å³ä¸Šè§’çš„ &quot;å¼€å‘è€…æ¨¡å¼&quot;ã€‚</li><li>ç‚¹å‡» &quot;åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº&quot;ï¼Œé€‰æ‹©åŒ…å«æ‚¨çš„ <code>manifest.json</code> å’Œå…¶ä»–æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚</li></ol><h2 id="æ­¥éª¤-4-æµ‹è¯•æ‰©å±•" tabindex="-1">æ­¥éª¤ 4: æµ‹è¯•æ‰©å±• <a class="header-anchor" href="#æ­¥éª¤-4-æµ‹è¯•æ‰©å±•" aria-label="Permalink to &quot;æ­¥éª¤ 4: æµ‹è¯•æ‰©å±•&quot;">â€‹</a></h2><ul><li><p>æ‰“å¼€å¤©çŒ«è¶…å¸‚çš„ç›¸å…³é¡µé¢ï¼ˆå¦‚èŒ…å°é…’é¡µé¢ï¼‰ä»¥æ£€æŸ¥æ‰©å±•æ˜¯å¦æŒ‰é¢„æœŸè§¦å‘ã€‚</p></li><li><p>è§‚å¯Ÿæ§åˆ¶å°ï¼ˆConsole tabï¼‰ä¸­çš„è¾“å‡ºï¼Œä»¥ç¡®è®¤è„šæœ¬æ˜¯å¦åœ¨æ­£ç¡®çš„æ—¶é—´æ‰§è¡Œäº†é¢„æœŸçš„æ“ä½œã€‚</p></li></ul><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨åº”è¯¥èƒ½å¤ŸæˆåŠŸéƒ¨ç½²å¹¶æµ‹è¯•æ‚¨çš„ Chrome æ‰©å±•ã€‚è¿™ä¸ªæ‰©å±•ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´å°è¯•è‡ªåŠ¨å®Œæˆè´­ä¹°è¿‡ç¨‹ï¼Œå¸®åŠ©æ‚¨æé«˜åœ¨å¤©çŒ«è¶…å¸‚ä¸ŠæˆåŠŸè´­ä¹°èŒ…å°é…’çš„æœºä¼šã€‚</p><h1 id="æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å°" tabindex="-1">æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å° <a class="header-anchor" href="#æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å°" aria-label="Permalink to &quot;æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å°&quot;">â€‹</a></h1><h2 id="æ²¹çŒ´è·å–å’Œéƒ¨ç½²å…¨è®²è§£" tabindex="-1">æ²¹çŒ´è·å–å’Œéƒ¨ç½²å…¨è®²è§£ <a class="header-anchor" href="#æ²¹çŒ´è·å–å’Œéƒ¨ç½²å…¨è®²è§£" aria-label="Permalink to &quot;æ²¹çŒ´è·å–å’Œéƒ¨ç½²å…¨è®²è§£&quot;">â€‹</a></h2><p>åˆ›å»ºå’Œéƒ¨ç½²ä¸€ä¸ªç®€å•çš„æ²¹çŒ´è„šæœ¬éœ€è¦éµå¾ªå‡ ä¸ªåŸºæœ¬æ­¥éª¤ï¼Œæœ¬ç¤ºä¾‹è„šæœ¬çš„åŠŸèƒ½æ˜¯è‡ªåŠ¨æ›´æ”¹ Google ä¸»é¡µçš„èƒŒæ™¯è‰²ã€‚</p><h3 id="æ­¥éª¤-1-å®‰è£…æ²¹çŒ´æ‰©å±•" tabindex="-1">æ­¥éª¤ 1: å®‰è£…æ²¹çŒ´æ‰©å±• <a class="header-anchor" href="#æ­¥éª¤-1-å®‰è£…æ²¹çŒ´æ‰©å±•" aria-label="Permalink to &quot;æ­¥éª¤ 1: å®‰è£…æ²¹çŒ´æ‰©å±•&quot;">â€‹</a></h3><p>è¯·æ ¹æ®ä½ ä½¿ç”¨çš„æµè§ˆå™¨ï¼Œå‚ç…§ä¸Šä¸€ä¸ªå›ç­”ä¸­çš„æŒ‡å¼•å®‰è£…æ²¹çŒ´æ‰©å±•ï¼ˆTampermonkey æˆ– Greasemonkeyï¼‰ã€‚</p><p>Google Chromeï¼šåœ¨ Chrome Web Store æœç´¢â€œTampermonkeyâ€ï¼Œæ‰¾åˆ°æ‰©å±•ç¨‹åºå¹¶ç‚¹å‡»â€œæ·»åŠ åˆ° Chromeâ€ã€‚</p><p>Mozilla Firefoxï¼šåœ¨ Firefox Add-ons æœç´¢â€œGreasemonkeyâ€æˆ–â€œTampermonkeyâ€ï¼Œé€‰æ‹©ç›¸åº”çš„æ‰©å±•ç‚¹å‡»â€œæ·»åŠ åˆ° Firefoxâ€ã€‚</p><p>Microsoft Edgeï¼šåœ¨ Microsoft Edge Add-ons æœç´¢â€œTampermonkeyâ€ï¼Œç„¶åå®‰è£…ã€‚</p><p>Safariï¼šåœ¨ Safari Extensions ä¸­æœç´¢â€œTampermonkeyâ€ï¼Œç„¶åä¸‹è½½å¹¶å®‰è£…ã€‚</p><h4 id="æŸ¥æ‰¾è„šæœ¬" tabindex="-1"><em>æŸ¥æ‰¾è„šæœ¬</em> <a class="header-anchor" href="#æŸ¥æ‰¾è„šæœ¬" aria-label="Permalink to &quot;_æŸ¥æ‰¾è„šæœ¬_&quot;">â€‹</a></h4><p>ä¸€æ—¦å®‰è£…äº†æ²¹çŒ´æ‰©å±•ï¼Œä½ å°±å¯ä»¥å¼€å§‹å¯»æ‰¾éœ€è¦çš„è„šæœ¬äº†ã€‚æœ‰å‡ ä¸ªè‘—åçš„ç½‘ç«™å¯ä»¥æ‰¾åˆ°ç”¨æˆ·å…±äº«çš„æ²¹çŒ´è„šæœ¬ï¼Œå¦‚ï¼š</p><p>Greasy Fork (<a href="https://greasyfork.org/" target="_blank" rel="noreferrer">https://greasyfork.org/</a>)</p><p>OpenUserJS (<a href="https://openuserjs.org/" target="_blank" rel="noreferrer">https://openuserjs.org/</a>)</p><p>åœ¨è¿™äº›ç½‘ç«™ä¸Šï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦æœç´¢æˆ–æµè§ˆä¸åŒçš„è„šæœ¬ã€‚</p><h3 id="æ­¥éª¤-2-åˆ›å»ºæ–°è„šæœ¬" tabindex="-1">æ­¥éª¤ 2: åˆ›å»ºæ–°è„šæœ¬ <a class="header-anchor" href="#æ­¥éª¤-2-åˆ›å»ºæ–°è„šæœ¬" aria-label="Permalink to &quot;æ­¥éª¤ 2: åˆ›å»ºæ–°è„šæœ¬&quot;">â€‹</a></h3><ol><li>ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„æ²¹çŒ´æ‰©å±•å›¾æ ‡ã€‚</li><li>åœ¨å¼¹å‡ºçš„èœå•ä¸­é€‰æ‹©â€œæ·»åŠ æ–°è„šæœ¬â€ï¼ˆæˆ–â€œCreate a new scriptâ€ï¼‰ã€‚</li><li>è¿™å°†æ‰“å¼€ä¸€ä¸ªæ–°çš„è„šæœ¬ç¼–è¾‘å™¨æ ‡ç­¾é¡µï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œç¼–å†™æˆ–ç²˜è´´ä½ çš„è„šæœ¬ä»£ç ã€‚</li></ol><h3 id="æ­¥éª¤-3-ç¼–å†™è„šæœ¬" tabindex="-1">æ­¥éª¤ 3: ç¼–å†™è„šæœ¬ <a class="header-anchor" href="#æ­¥éª¤-3-ç¼–å†™è„šæœ¬" aria-label="Permalink to &quot;æ­¥éª¤ 3: ç¼–å†™è„šæœ¬&quot;">â€‹</a></h3><p>åœ¨è„šæœ¬ç¼–è¾‘å™¨ä¸­ï¼Œç²˜è´´ä¸‹é¢çš„è„šæœ¬ä»£ç ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ==UserScript==</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @name         Change Google Background Color</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @namespace    http://tampermonkey.net/</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @version      0.1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @description  try to take over the world!</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @author       You</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @match        https://www.google.com/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @grant        none</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ==/UserScript==</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#98C379;">	&quot;use strict&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// Your code here...</span></span>
<span class="line"><span style="color:#E5C07B;">	document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">backgroundColor</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;lightblue&quot;</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">//æ›´æ”¹èƒŒæ™¯è‰²ä¸ºæµ…è“è‰²</span></span>
<span class="line"><span style="color:#ABB2BF;">})();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>è¿™æ®µè„šæœ¬çš„åŠŸèƒ½æ˜¯æ›´æ”¹ Google ä¸»é¡µçš„èƒŒæ™¯é¢œè‰²ä¸ºæµ…è“è‰²ã€‚<code>@match</code> æŒ‡ä»¤å‘Šè¯‰æ²¹çŒ´è¿™ä¸ªè„šæœ¬åº”å½“åœ¨å“ªäº›é¡µé¢ä¸Šè¿è¡Œï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒå°†åœ¨æ‰€æœ‰ Google ä¸»é¡µçš„ URL ä¸Šè¿è¡Œã€‚</p><h3 id="æ­¥éª¤-4-ä¿å­˜å¹¶è¿è¡Œè„šæœ¬" tabindex="-1">æ­¥éª¤ 4: ä¿å­˜å¹¶è¿è¡Œè„šæœ¬ <a class="header-anchor" href="#æ­¥éª¤-4-ä¿å­˜å¹¶è¿è¡Œè„šæœ¬" aria-label="Permalink to &quot;æ­¥éª¤ 4: ä¿å­˜å¹¶è¿è¡Œè„šæœ¬&quot;">â€‹</a></h3><ol><li>åœ¨è„šæœ¬ç¼–è¾‘å™¨çš„ç•Œé¢ä¸Šæ‰¾åˆ°ä¿å­˜æŒ‰é’®ï¼ˆé€šå¸¸åœ¨ç•Œé¢ä¸Šæ–¹ï¼‰ï¼Œç‚¹å‡»ä¿å­˜ä½ çš„è„šæœ¬ã€‚</li><li>å…³é—­ç¼–è¾‘å™¨æ ‡ç­¾é¡µã€‚</li><li>è½¬åˆ°ï¼š<a href="https://www.google.com" target="_blank" rel="noreferrer">https://www.google.com</a>ï¼Œä½ ä¼šçœ‹åˆ°èƒŒæ™¯è‰²å·²ç»æ›´æ”¹ã€‚</li></ol><h3 id="æ­¥éª¤-5-ç®¡ç†è„šæœ¬" tabindex="-1">æ­¥éª¤ 5: ç®¡ç†è„šæœ¬ <a class="header-anchor" href="#æ­¥éª¤-5-ç®¡ç†è„šæœ¬" aria-label="Permalink to &quot;æ­¥éª¤ 5: ç®¡ç†è„šæœ¬&quot;">â€‹</a></h3><p>ä½ å¯ä»¥éšæ—¶ç‚¹å‡»æ²¹çŒ´æ‰©å±•å›¾æ ‡ï¼ŒæŸ¥çœ‹å’Œç®¡ç†ä½ çš„è„šæœ¬ã€‚åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥å¯ç”¨æˆ–ç¦ç”¨å·²å®‰è£…çš„è„šæœ¬ï¼Œç¼–è¾‘å®ƒä»¬ï¼Œæˆ–è€…æŸ¥çœ‹æ¯ä¸ªè„šæœ¬çš„è¯¦æƒ…ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1">æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h3><ul><li><p>å½“ä½ è®¿é—®ç›®æ ‡ç½‘é¡µæ—¶ï¼Œç¡®ä¿æ²¹çŒ´æ‰©å±•å·²å¯ç”¨ï¼Œä¸”ä½ çš„è„šæœ¬ä¹Ÿå¤„äºå¯ç”¨çŠ¶æ€ã€‚</p></li><li><p>å¦‚æœè„šæœ¬æ²¡æœ‰æŒ‰é¢„æœŸè¿è¡Œï¼Œæ£€æŸ¥å®ƒçš„<code>@match</code>æŒ‡ä»¤æ˜¯å¦æ­£ç¡®è¦†ç›–äº†ç›®æ ‡é¡µé¢çš„ URLã€‚</p></li><li><p>ä¸ºäº†é˜²æ­¢å¯èƒ½çš„å®‰å…¨é£é™©ï¼Œåªåº”ä»ä¿¡ä»»çš„æ¥æºå®‰è£…æˆ–è¿è¡Œæ²¹çŒ´è„šæœ¬ã€‚</p></li></ul><p>ç¤ºä¾‹äºŒï¼šåœ¨è®¿é—®ç™¾åº¦æœç´¢æ—¶ï¼Œè‡ªåŠ¨å°†é¡µé¢èƒŒæ™¯é¢œè‰²æ›´æ”¹ä¸ºæ·¡ç»¿è‰²ï¼Œä»¥æä¾›æ›´èˆ’é€‚çš„é˜…è¯»ä½“éªŒã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ==UserScript==</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @name         ç™¾åº¦èƒŒæ™¯é¢œè‰²æ›´æ”¹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @namespace    http://tampermonkey.net/</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @version      1.0</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @description  è®©ä½ çš„ç™¾åº¦æœç´¢ä½“éªŒæ›´åŠ èˆ’é€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @author       you</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @match        *://*baidu.com/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @grant        none</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ==/UserScript==</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#98C379;">	&quot;use strict&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ›´æ”¹èƒŒæ™¯è‰²ä¸ºæ·¡ç»¿è‰²</span></span>
<span class="line"><span style="color:#E5C07B;">	document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">backgroundColor</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;#ccffcc&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">})();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†åŒ¹é…<code>*://*baidu.com/*</code>æ¨¡å¼çš„ç½‘é¡µï¼ˆå³æ‰€æœ‰ç™¾åº¦çš„ç½‘é¡µï¼‰çš„èƒŒæ™¯è‰²æ›´æ”¹ä¸ºæ·¡ç»¿è‰²ï¼ˆ<code>#ccffcc</code>ï¼‰ã€‚</p><p>ç‚¹å‡»ç¼–è¾‘å™¨ç•Œé¢çš„ä¿å­˜æŒ‰é’®ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªç£ç›˜å›¾æ ‡æˆ–è€…ç›´æ¥å†™ç€â€œä¿å­˜â€ï¼‰ã€‚ä¿å­˜åï¼Œå…³é—­è„šæœ¬ç¼–è¾‘å™¨æ ‡ç­¾é¡µã€‚å‰å¾€ï¼š<a href="https://www.baidu.com" target="_blank" rel="noreferrer">https://www.baidu.com</a> æµ‹è¯•è„šæœ¬æ•ˆæœã€‚ä½ ä¼šçœ‹åˆ°èƒŒæ™¯è‰²å·²ç»æ”¹å˜ã€‚</p><h2 id="æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å°-1" tabindex="-1">æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å° <a class="header-anchor" href="#æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å°-1" aria-label="Permalink to &quot;æ‰‹æœºä¸Šç”¨æ²¹çŒ´å®ç°è‡ªåŠ¨æŠ¢è´­èŒ…å°&quot;">â€‹</a></h2><p>è¦åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨æ²¹çŒ´è„šæœ¬å®ç°è‡ªåŠ¨åŒ–æ“ä½œï¼ˆæ¯”å¦‚æŠ¢è´­èŒ…å°ï¼‰æ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œå› ä¸ºä¸»æµçš„ç§»åŠ¨æµè§ˆå™¨ï¼ˆå¦‚ Chrome å’Œ Safariï¼‰é€šå¸¸ä¸æ”¯æŒæ²¹çŒ´è„šæœ¬ã€‚ä¸è¿‡ï¼Œæœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥ç»•è¿‡è¿™ä¸€é™åˆ¶ï¼Œé‚£å°±æ˜¯ä½¿ç”¨æ”¯æŒç”¨æˆ·è„šæœ¬çš„ç§»åŠ¨æµè§ˆå™¨ã€‚å¯¹äº Android ç”¨æˆ·ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¦‚ <strong>Kiwi Browser</strong> æˆ– <strong>Yandex Browser</strong>ï¼Œè¿™äº›æµè§ˆå™¨åŸºäº Chromiumï¼Œæ”¯æŒ Chrome æ‰©å±•ï¼ŒåŒ…æ‹¬æ²¹çŒ´ï¼ˆTampermonkeyï¼‰ã€‚</p><h3 id="æ­¥éª¤-1-åœ¨-android-è®¾å¤‡ä¸Šå®‰è£…æ”¯æŒæ‰©å±•çš„æµè§ˆå™¨" tabindex="-1">æ­¥éª¤ 1: åœ¨ Android è®¾å¤‡ä¸Šå®‰è£…æ”¯æŒæ‰©å±•çš„æµè§ˆå™¨ <a class="header-anchor" href="#æ­¥éª¤-1-åœ¨-android-è®¾å¤‡ä¸Šå®‰è£…æ”¯æŒæ‰©å±•çš„æµè§ˆå™¨" aria-label="Permalink to &quot;æ­¥éª¤ 1: åœ¨ Android è®¾å¤‡ä¸Šå®‰è£…æ”¯æŒæ‰©å±•çš„æµè§ˆå™¨&quot;">â€‹</a></h3><ol><li>ä¸‹è½½å¹¶å®‰è£… Kiwi Browser æˆ– Yandex Browser:</li></ol><p>- æ‰“å¼€ Google Play Storeã€‚</p><p>- æœç´¢ â€œKiwi Browserâ€ æˆ– â€œYandex Browserâ€ã€‚</p><p>- é€‰æ‹©æµè§ˆå™¨å¹¶å®‰è£…ã€‚</p><h3 id="æ­¥éª¤-2-å®‰è£…-tampermonkey-æ‰©å±•" tabindex="-1">æ­¥éª¤ 2: å®‰è£… Tampermonkey æ‰©å±• <a class="header-anchor" href="#æ­¥éª¤-2-å®‰è£…-tampermonkey-æ‰©å±•" aria-label="Permalink to &quot;æ­¥éª¤ 2: å®‰è£… Tampermonkey æ‰©å±•&quot;">â€‹</a></h3><ol><li>åœ¨å®‰è£…å¥½çš„æµè§ˆå™¨ä¸­ï¼Œæ‰“å¼€æ‰©å±•é¡µé¢ï¼ˆé€šå¸¸åœ¨èœå•ä¸­æœ‰â€œæ‰©å±•â€é€‰é¡¹ï¼‰ã€‚</li><li>æœç´¢ Tampermonkey å®˜ç½‘æˆ–åœ¨ Google ä¸Šæœç´¢ Tampermonkey çš„ Chrome Web Store é¡µé¢ï¼Œä¸‹è½½å¹¶å®‰è£… Tampermonkey æ‰©å±•ã€‚</li></ol><h3 id="æ­¥éª¤-3-åˆ›å»ºå¹¶ç¼–è¾‘æ²¹çŒ´è„šæœ¬" tabindex="-1">æ­¥éª¤ 3: åˆ›å»ºå¹¶ç¼–è¾‘æ²¹çŒ´è„šæœ¬ <a class="header-anchor" href="#æ­¥éª¤-3-åˆ›å»ºå¹¶ç¼–è¾‘æ²¹çŒ´è„šæœ¬" aria-label="Permalink to &quot;æ­¥éª¤ 3: åˆ›å»ºå¹¶ç¼–è¾‘æ²¹çŒ´è„šæœ¬&quot;">â€‹</a></h3><ol><li>ç‚¹å‡»æµè§ˆå™¨ä¸­ Tampermonkey å›¾æ ‡ï¼Œé€‰æ‹©â€œæ·»åŠ æ–°è„šæœ¬â€ã€‚</li><li>åœ¨è„šæœ¬ç¼–è¾‘å™¨ä¸­ï¼Œåˆ é™¤é»˜è®¤æ¨¡æ¿ï¼Œç²˜è´´ä»¥ä¸‹ç¤ºä¾‹è„šæœ¬ï¼š</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ==UserScript==</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @name         è‡ªåŠ¨è´­ä¹°èŒ…å°ç§»åŠ¨ç‰ˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @namespace    http://tampermonkey.net/</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @version      0.1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @description  è‡ªåŠ¨åŒ–åœ¨ç§»åŠ¨ç«¯å¤©çŒ«è´­ä¹°èŒ…å°é…’</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @author       You</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @match        *://*/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @grant        none</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// @run-at       document-end</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ==/UserScript==</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#98C379;">	&quot;use strict&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ¯æ¬¡é¡µé¢åŠ è½½åæ£€æŸ¥æ˜¯å¦ä¸ºèŒ…å°çš„è´­ä¹°é¡µé¢</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">location</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">href</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;chaoshi.detail.tmall.com&quot;</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#61AFEF;">		setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å°è¯•æ‰¾åˆ°è´­ä¹°æŒ‰é’®å¹¶ç‚¹å‡»</span></span>
<span class="line"><span style="color:#C678DD;">			const</span><span style="color:#E5C07B;"> buyButton</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;button.buy&quot;</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// æ ¹æ®å®é™…é¡µé¢è°ƒæ•´é€‰æ‹©å™¨</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">buyButton</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">				buyButton</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">				console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è´­ä¹°æŒ‰é’®æœªæ‰¾åˆ°&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}, </span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// å»¶è¿Ÿ3ç§’é’Ÿæ‰§è¡Œï¼Œç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">})();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ol start="3"><li>ä¿®æ”¹è„šæœ¬ä¸­çš„ <code>@match</code> ä»¥é€‚åº”å®é™…çš„ URLï¼Œä¿®æ”¹é€‰æ‹©å™¨ä»¥é€‚åº”å®é™…çš„æŒ‰é’®ã€‚</li></ol><h3 id="æ­¥éª¤-4-æµ‹è¯•å’Œè°ƒæ•´è„šæœ¬" tabindex="-1">æ­¥éª¤ 4: æµ‹è¯•å’Œè°ƒæ•´è„šæœ¬ <a class="header-anchor" href="#æ­¥éª¤-4-æµ‹è¯•å’Œè°ƒæ•´è„šæœ¬" aria-label="Permalink to &quot;æ­¥éª¤ 4: æµ‹è¯•å’Œè°ƒæ•´è„šæœ¬&quot;">â€‹</a></h3><p>- æ‰“å¼€ç›®æ ‡è´­ä¹°é¡µé¢ï¼Œè§‚å¯Ÿè„šæœ¬æ˜¯å¦èƒ½æ­£ç¡®æ‰§è¡Œã€‚</p><p>- æ ¹æ®éœ€è¦è°ƒæ•´å»¶è¿Ÿæ—¶é—´æˆ–æŒ‰é’®é€‰æ‹©å™¨ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1">æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h3><ul><li><p>è‡ªåŠ¨åŒ–è´­ä¹°è„šæœ¬å¯èƒ½è¿åå¤©çŒ«æˆ–å…¶ä»–å¹³å°çš„æœåŠ¡æ¡æ¬¾ï¼Œä½¿ç”¨æ—¶éœ€è°¨æ…ã€‚</p></li><li><p>ç¡®ä¿è„šæœ¬ä¸ä¼šæ— æ„ä¸­è§¦å‘ä¸éœ€è¦çš„è´­ä¹°ã€‚</p></li><li><p>è¯¥æ–¹æ³•å¯èƒ½ä¸é€‚ç”¨äº iOS è®¾å¤‡ï¼Œå› ä¸º iOS çš„æµè§ˆå™¨æ¶æ„é™åˆ¶äº†æ­¤ç±»æ‰©å±•ã€‚</p></li></ul><p>é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæ‚¨å¯ä»¥åœ¨æ”¯æŒæ‰©å±•çš„ç§»åŠ¨æµè§ˆå™¨ä¸Šå®ç°ç±»ä¼¼ PC æµè§ˆå™¨æ²¹çŒ´è„šæœ¬çš„åŠŸèƒ½ï¼Œä»è€Œåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè‡ªåŠ¨åŒ–ä¸€äº›æ“ä½œã€‚è¿™ä¸ºç§»åŠ¨ç«¯ç½‘é¡µè‡ªåŠ¨åŒ–æä¾›äº†ä¸€ç§å¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="åšäº›ä¼˜åŒ–" tabindex="-1">åšäº›ä¼˜åŒ– <a class="header-anchor" href="#åšäº›ä¼˜åŒ–" aria-label="Permalink to &quot;åšäº›ä¼˜åŒ–&quot;">â€‹</a></h3><p>å¯¹äºåœ¨ç§»åŠ¨ç«¯ä½¿ç”¨æ²¹çŒ´è„šæœ¬è¿›è¡Œè‡ªåŠ¨åŒ–çš„åœºæ™¯ï¼Œä»¥ä¸‹ä¼˜åŒ–å¸®åŠ©æ‚¨æ›´å®‰å…¨ã€æ›´æœ‰æ•ˆåœ°å®æ–½è‡ªåŠ¨åŒ–ç­–ç•¥ï¼š</p><h4 id="_1-ç›‘æµ‹å’Œè°ƒè¯•" tabindex="-1">1.ç›‘æµ‹å’Œè°ƒè¯• <a class="header-anchor" href="#_1-ç›‘æµ‹å’Œè°ƒè¯•" aria-label="Permalink to &quot;1.ç›‘æµ‹å’Œè°ƒè¯•&quot;">â€‹</a></h4><ul><li><p>è°ƒè¯•è„šæœ¬ï¼šä½¿ç”¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·è¿›è¡Œè°ƒè¯•ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ JavaScript é”™è¯¯æˆ–è€…æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ç­‰ã€‚è™½ç„¶åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿›è¡Œè°ƒè¯•æ¯”è¾ƒå¤æ‚ï¼Œä½†ä½¿ç”¨åŸºäº Chromium çš„æµè§ˆå™¨å¦‚ Kiwi æˆ– Yandex å¯ä»¥è®©è¿™ä¸ªè¿‡ç¨‹æ›´æ¥è¿‘æ¡Œé¢ä½“éªŒã€‚</p></li><li><p>æ—¥å¿—è®°å½•ï¼šåœ¨ä½ çš„è„šæœ¬ä¸­å¢åŠ é€‚å½“çš„æ—¥å¿—è®°å½•ï¼Œè¿™å¯ä»¥å¸®åŠ©ä½ ç†è§£è„šæœ¬åœ¨å®é™…ç¯å¢ƒä¸­çš„è¡Œä¸ºï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¼‚æ­¥äº‹ä»¶å’Œå“åº”æ—¶ã€‚</p></li></ul><h4 id="_2-ç”¨æˆ·ç•Œé¢å‹å¥½æ€§" tabindex="-1">2.ç”¨æˆ·ç•Œé¢å‹å¥½æ€§ <a class="header-anchor" href="#_2-ç”¨æˆ·ç•Œé¢å‹å¥½æ€§" aria-label="Permalink to &quot;2.ç”¨æˆ·ç•Œé¢å‹å¥½æ€§&quot;">â€‹</a></h4><ul><li><p>åé¦ˆæœºåˆ¶ï¼šç¡®ä¿è„šæœ¬åœ¨æ‰§è¡Œæ“ä½œæ—¶æœ‰æ¸…æ™°çš„ç”¨æˆ·åé¦ˆã€‚ä¾‹å¦‚ï¼Œå½“ç‚¹å‡»æŒ‰é’®æˆ–å®Œæˆè´­ä¹°æ—¶ï¼Œå¯ä»¥æ˜¾ç¤ºä¸€äº›æç¤ºä¿¡æ¯ï¼Œè®©ç”¨æˆ·çŸ¥é“è„šæœ¬å·²ç»æ‰§è¡Œã€‚</p></li><li><p>é”™è¯¯å¤„ç†ï¼šå¢å¼ºè„šæœ¬çš„é”™è¯¯å¤„ç†èƒ½åŠ›ï¼Œç¡®ä¿åœ¨é‡åˆ°æ„å¤–æƒ…å†µï¼ˆå¦‚å…ƒç´ æœªæ‰¾åˆ°ã€ç½‘ç»œè¯·æ±‚å¤±è´¥ç­‰ï¼‰æ—¶ï¼Œè„šæœ¬èƒ½ç»™å‡ºé”™è¯¯æç¤ºå¹¶ä¼˜é›…åœ°ç»ˆæ­¢æˆ–é‡è¯•ã€‚</p></li></ul><h4 id="_3-æ€§èƒ½è€ƒè™‘" tabindex="-1">3.æ€§èƒ½è€ƒè™‘ <a class="header-anchor" href="#_3-æ€§èƒ½è€ƒè™‘" aria-label="Permalink to &quot;3.æ€§èƒ½è€ƒè™‘&quot;">â€‹</a></h4><ul><li><p>é¿å…è¿‡åº¦è½®è¯¢ï¼šä½¿ç”¨<code>setTimeout</code>æˆ–<code>setInterval</code>è¿›è¡Œå…ƒç´ æ£€æŸ¥æˆ–æ“ä½œæ—¶ï¼Œè®¾ç½®åˆç†çš„é—´éš”æ—¶é—´ï¼Œé¿å…å¯¹è®¾å¤‡æ€§èƒ½é€ æˆå½±å“æˆ–å¢åŠ ä¸å¿…è¦çš„æœåŠ¡å™¨è¯·æ±‚ã€‚</p></li><li><p>èµ„æºæ¸…ç†ï¼šç¡®ä¿è„šæœ¬åœ¨å®Œæˆä»»åŠ¡åèƒ½æ­£ç¡®æ¸…ç†å·²å ç”¨çš„èµ„æºï¼Œå¦‚å…³é—­ä¸å†éœ€è¦çš„å®šæ—¶å™¨ï¼Œåˆ é™¤ä¸å¿…è¦çš„å…¨å±€å˜é‡ç­‰ã€‚</p></li></ul><h1 id="auto-js-å”®ç¥¨å¹³å°è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬" tabindex="-1">Auto.jsï¼šå”®ç¥¨å¹³å°è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬ <a class="header-anchor" href="#auto-js-å”®ç¥¨å¹³å°è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬" aria-label="Permalink to &quot;Auto.jsï¼šå”®ç¥¨å¹³å°è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬&quot;">â€‹</a></h1><p><strong>è¯´æ˜</strong>ï¼š</p><p>åœ¨æ‰‹æœºä¸Šè¿è¡Œ JavaScript æŠ¢ç¥¨è„šæœ¬ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå¤§å¤šæ•°æ‰‹æœºæµè§ˆå™¨ä¸æ”¯æŒç›´æ¥åŠ è½½å’Œæ‰§è¡Œè‡ªå®šä¹‰ JavaScript ä»£ç ã€‚æœ‰å‡ ä¸ªå¸¸ç”¨é€‰æ‹©å¯ä»¥å°è¯•ï¼š</p><h3 id="_1-ä½¿ç”¨-kiwi-browser-tampermonkey-æ‰©å±•-android" tabindex="-1">1. ä½¿ç”¨ Kiwi Browser + Tampermonkey æ‰©å±•ï¼ˆAndroidï¼‰ <a class="header-anchor" href="#_1-ä½¿ç”¨-kiwi-browser-tampermonkey-æ‰©å±•-android" aria-label="Permalink to &quot;1. ä½¿ç”¨ Kiwi Browser + Tampermonkey æ‰©å±•ï¼ˆAndroidï¼‰&quot;">â€‹</a></h3><p>Kiwi Browser æ˜¯ä¸€æ¬¾åŸºäº Chromium çš„ Android æµè§ˆå™¨ï¼Œå®ƒæ”¯æŒ Chrome æ‰©å±•ã€‚é€šè¿‡åœ¨ Kiwi Browser ä¸­å®‰è£… Tampermonkey æ‰©å±•ï¼Œä½ å¯ä»¥è¿è¡Œè‡ªå®šä¹‰çš„ JavaScript è„šæœ¬ã€‚</p><p>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>åœ¨ Google Play å•†åº—ä¸‹è½½å¹¶å®‰è£… Kiwi Browserã€‚</li><li>æ‰“å¼€ Kiwi Browserï¼Œè®¿é—® Chrome ç½‘ä¸Šåº”ç”¨åº—ï¼Œæœç´¢å¹¶å®‰è£… Tampermonkey æ‰©å±•ã€‚</li><li>å®‰è£…å®Œæ¯•åï¼Œç‚¹å‡» Tampermonkey æ‰©å±•å›¾æ ‡ï¼Œé€‰æ‹©â€œæ·»åŠ æ–°è„šæœ¬â€ã€‚</li><li>åœ¨ç¼–è¾‘å™¨ä¸­ç²˜è´´ä½ çš„æŠ¢ç¥¨ JavaScript ä»£ç ï¼Œä¿å­˜è„šæœ¬ã€‚</li><li>è®¿é—®ç›®æ ‡ç½‘ç«™æ—¶ï¼ŒTampermonkey å°†è‡ªåŠ¨æ‰§è¡Œä½ çš„è„šæœ¬ã€‚</li></ul><h3 id="_2-ä½¿ç”¨-via-æµè§ˆå™¨çš„è‡ªå®šä¹‰è„šæœ¬åŠŸèƒ½-android" tabindex="-1">2. ä½¿ç”¨ Via æµè§ˆå™¨çš„è‡ªå®šä¹‰è„šæœ¬åŠŸèƒ½ï¼ˆAndroidï¼‰ <a class="header-anchor" href="#_2-ä½¿ç”¨-via-æµè§ˆå™¨çš„è‡ªå®šä¹‰è„šæœ¬åŠŸèƒ½-android" aria-label="Permalink to &quot;2. ä½¿ç”¨ Via æµè§ˆå™¨çš„è‡ªå®šä¹‰è„šæœ¬åŠŸèƒ½ï¼ˆAndroidï¼‰&quot;">â€‹</a></h3><p>Via æµè§ˆå™¨æ˜¯ä¸€æ¬¾è½»é‡çº§çš„ Android æµè§ˆå™¨ï¼Œæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ JavaScript è„šæœ¬ã€‚</p><p>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>ä» Google Play å•†åº—ä¸‹è½½å¹¶å®‰è£… Via æµè§ˆå™¨ã€‚</li><li>æ‰“å¼€ Via æµè§ˆå™¨ï¼Œè¿›å…¥è®¾ç½® &gt; é€šç”¨è®¾ç½® &gt; è„šæœ¬ï¼Œå¼€å¯ç”¨æˆ·è„šæœ¬åŠŸèƒ½ã€‚</li><li>ç‚¹å‡»â€œæ–°å»ºè„šæœ¬â€ï¼Œåœ¨ç¼–è¾‘ç•Œé¢ç²˜è´´ä½ çš„æŠ¢ç¥¨è„šæœ¬ï¼Œè®¾ç½®å¥½åŒ¹é…çš„ç½‘å€ï¼Œä¿å­˜ã€‚</li></ul><h3 id="_3-ä½¿ç”¨æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨-app-ios-å’Œ-android" tabindex="-1">3. ä½¿ç”¨æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨ Appï¼ˆiOS å’Œ Androidï¼‰ <a class="header-anchor" href="#_3-ä½¿ç”¨æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨-app-ios-å’Œ-android" aria-label="Permalink to &quot;3. ä½¿ç”¨æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨ Appï¼ˆiOS å’Œ Androidï¼‰&quot;">â€‹</a></h3><p>å¯¹äº iOS ç”¨æˆ·ï¼Œç”±äºç³»ç»Ÿé™åˆ¶ï¼Œé€‰é¡¹æ›´å°‘ã€‚ä¸è¿‡ï¼Œæœ‰ä¸€äº›ç¬¬ä¸‰æ–¹ App å£°ç§°æ”¯æŒæ²¹çŒ´è„šæœ¬ï¼Œå¦‚ Alook æµè§ˆå™¨ï¼ˆiOS å’Œ Androidï¼‰ç­‰ã€‚è¿™äº›æµè§ˆå™¨ App å¯èƒ½å†…ç½®äº†è„šæœ¬ç®¡ç†å™¨ï¼Œå…è®¸ç”¨æˆ·æ·»åŠ å’Œæ‰§è¡Œè‡ªå®šä¹‰ JavaScript è„šæœ¬ã€‚</p><ul><li>ä¸‹è½½å¹¶å®‰è£…æ”¯æŒçš„æµè§ˆå™¨ Appã€‚</li><li>æ ¹æ® App æä¾›çš„æŒ‡å¼•æ·»åŠ å’Œç®¡ç† JavaScript è„šæœ¬ã€‚</li></ul><p>å…¨ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#56B6C2;"> //</span><span style="color:#ABB2BF;"> æ£€æŸ¥æ— éšœç¢æœåŠ¡æ˜¯å¦å·²ç»å¯ç”¨ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨åˆ™è·³è½¬åˆ°æ— éšœç¢æœåŠ¡å¯ç”¨ç•Œé¢ï¼Œå¹¶ç­‰å¾…æ— éšœç¢æœåŠ¡å¯åŠ¨ï¼›å½“æ— éšœç¢æœåŠ¡å¯åŠ¨åè„šæœ¬ä¼šç»§ç»­è¿è¡Œã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> auto.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">()</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#56B6C2;"> //</span><span style="color:#ABB2BF;">æ‰“å¼€æŸçŸ¥åå”®ç¥¨å¹³å°app</span></span>
<span class="line"><span style="color:#ABB2BF;"> app.</span><span style="color:#61AFEF;">launchApp</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŸçŸ¥åå”®ç¥¨å¹³å°&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#61AFEF;"> openConsole</span><span style="color:#ABB2BF;">()</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;"> console.</span><span style="color:#61AFEF;">setTitle</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŸçŸ¥åå”®ç¥¨å¹³å° go!&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;#ff11ee00&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">()</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;">è·å–è¾“å…¥çš„åœºæ¬¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">getPlayEtc</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">    var playEtc = </span><span style="color:#61AFEF;">rawInput</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥åœºæ¬¡å…³é”®å­—(æŒ‰ç…§é»˜è®¤æ ¼å¼)&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;å‘¨äº”&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (playEtc </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> null </span><span style="color:#FFFFFF;">||</span><span style="color:#ABB2BF;"> playEtc.</span><span style="color:#61AFEF;">trim</span><span style="color:#ABB2BF;">()</span><span style="color:#56B6C2;">==</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">        alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥åœºæ¬¡ä¿¡æ¯!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#61AFEF;"> getPlayEtc</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ‰‹åŠ¨è¾“å…¥çš„åœºæ¬¡ä¿¡æ¯ï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">playEtc);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> playEtc;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;">è·å–è¾“å…¥ç¥¨ä»·ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">getTicketPrice</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">    var ticketPrice = </span><span style="color:#61AFEF;">rawInput</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥ç¥¨ä»·å…³é”®å­—(æŒ‰ç…§é»˜è®¤æ ¼å¼)&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;1180&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (ticketPrice </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> null </span><span style="color:#FFFFFF;">||</span><span style="color:#ABB2BF;"> ticketPrice.</span><span style="color:#61AFEF;">trim</span><span style="color:#ABB2BF;">()</span><span style="color:#56B6C2;">==</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">        alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥ç¥¨ä»·ä¿¡æ¯!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#61AFEF;"> getTicketPrice</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ‰‹åŠ¨è¾“å…¥çš„ç¥¨ä»·ä¿¡æ¯ï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">ticketPrice);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> ticketPrice;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;">è·å–è¾“å…¥çš„æŠ¢ç¥¨æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">getSellTime</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">    var sellTime = </span><span style="color:#61AFEF;">rawInput</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æŠ¢ç¥¨æ—¶é—´(æŒ‰ç…§é»˜è®¤æ ¼å¼)&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;03-18 11:00&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (sellTime </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> null </span><span style="color:#FFFFFF;">||</span><span style="color:#ABB2BF;"> sellTime.</span><span style="color:#61AFEF;">trim</span><span style="color:#ABB2BF;">()</span><span style="color:#56B6C2;">==</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">        alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æŠ¢ç¥¨æ—¶é—´!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#61AFEF;"> getSellTime</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> sellTime;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€å§‹æŸçŸ¥åå”®ç¥¨å¹³å°æŠ¢ç¥¨!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var preBook= </span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²é¢„çº¦&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    var preBook2 = </span><span style="color:#61AFEF;">textContains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²è®¾ç½®&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    var isPreBook = preBook2</span><span style="color:#56B6C2;">!=</span><span style="color:#ABB2BF;">null</span><span style="color:#FFFFFF;">||</span><span style="color:#ABB2BF;">preBook</span><span style="color:#56B6C2;">!=</span><span style="color:#ABB2BF;">null;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var playEtc;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var ticketPrice;</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç•Œé¢æ˜¯å¦å·²é¢„çº¦ï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">isPreBook);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">!</span><span style="color:#ABB2BF;">isPreBook){</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ— é¢„çº¦ä¿¡æ¯ï¼Œè¯·è¾“å…¥æŠ¢ç¥¨ä¿¡æ¯!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        playEtc = </span><span style="color:#61AFEF;">getPlayEtc</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        ticketPrice = </span><span style="color:#61AFEF;">getTicketPrice</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    var month;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var day;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var hour;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var minute;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    var inputTime = </span><span style="color:#61AFEF;">getSellTime</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">åœ¨è¿™é‡Œä½¿ç”¨è¾“å…¥çš„æ—¶é—´è¿›è¡Œåç»­æ“ä½œ</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾“å…¥çš„æŠ¢ç¥¨æ—¶é—´ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> inputTime);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var times = inputTime.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var time1 = times[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    var time2 = times[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    var monthDay= time1.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;-&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    month = monthDay[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    day = monthDay[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">    var hourMinute= time2.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;:&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    hour = hourMinute[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">    minute=  hourMinute[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;"> è®¾ç½®å¼€æŠ¢æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">    var year = new </span><span style="color:#61AFEF;">Date</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">getFullYear</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    var second = </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var msecond = </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var startTimestamp = new </span><span style="color:#61AFEF;">Date</span><span style="color:#ABB2BF;">(year, month, day, hour, minute, second, msecond).</span><span style="color:#61AFEF;">getTime</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">     //</span><span style="color:#ABB2BF;"> å‡å» </span><span style="color:#FFFFFF;">45ms</span><span style="color:#ABB2BF;"> çš„ç½‘ç»œå»¶è¿Ÿ</span></span>
<span class="line"><span style="color:#ABB2BF;">    startTimestamp = startTimestamp </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 45</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var æŸçŸ¥åå”®ç¥¨å¹³å°Timestamp;</span></span>
<span class="line"><span style="color:#ABB2BF;">    var startTime = </span><span style="color:#61AFEF;">convertToTime</span><span style="color:#ABB2BF;">(startTimestamp);</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€æŠ¢æ—¶é—´ï¼š&quot;</span><span style="color:#ABB2BF;">, startTime);</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç­‰å¾…å¼€æŠ¢...&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;"> å¾ªç¯ç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#ABB2BF;"> (true) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        æŸçŸ¥åå”®ç¥¨å¹³å°Timestamp = </span><span style="color:#61AFEF;">getæŸçŸ¥åå”®ç¥¨å¹³å°Timestamp</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (æŸçŸ¥åå”®ç¥¨å¹³å°Timestamp </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> startTimestamp) {</span></span>
<span class="line"><span style="color:#C678DD;">            break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    var realStartTime = </span><span style="color:#61AFEF;">getæŸçŸ¥åå”®ç¥¨å¹³å°Timestamp</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å†²å•Šï¼ï¼ï¼&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var goRes = </span><span style="color:#56B6C2;">id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;trade_project_detail_purchase_status_bar_container_fl&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç‚¹å‡»äº†ç«‹å³è´­ç¥¨ç›¸å…³æŒ‰é’®ï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">goRes)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;">(</span><span style="color:#FFFFFF;">!</span><span style="color:#ABB2BF;">isPreBook){</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è¿›å…¥äº†ï¼Œå‡†å¤‡é€‰æ‹©åœºæ¬¡ï¼š&#39;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">playEtc);</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#ABB2BF;"> é€‰æ‹©åœºæ¬¡</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#61AFEF;">textContains</span><span style="color:#ABB2BF;">(playEtc).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#61AFEF;"> textContains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">playEtc</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#61AFEF;"> textContains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">playEtc</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#ABB2BF;"> console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é€‰æ‹©åœºæ¬¡&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#ABB2BF;"> ticketPrice = </span><span style="color:#98C379;">&quot;Â¥&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">ticketPrice</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#ABB2BF;"> app.</span><span style="color:#61AFEF;">sendBroadcast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;inspect_layout_bounds&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#61AFEF;"> sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#61AFEF;"> back</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">        //</span><span style="color:#61AFEF;"> sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">        textContains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;çœ‹å°&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">        textContains</span><span style="color:#ABB2BF;">(ticketPrice).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é€‰æ‹©ç¥¨æ¡£&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.TextView&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¡®è®¤&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#61AFEF;"> classNameStartsWith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;android.widget.&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¡®è®¤&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    textContains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ•°é‡&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">    click</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">878</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">2263</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç‚¹å‡»ç¡®è®¤&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#C678DD;"> while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.TextView&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¡®è®¤&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()){</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">     console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¡®è®¤æŒ‰é’®è¿˜åœ¨ï¼Œç»§ç»­ç‚¹å‡»&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">ç­‰å¾…ç«‹å³æ”¯ä»˜æŒ‰é’®å‡ºç°</span></span>
<span class="line"><span style="color:#61AFEF;">    className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.Button&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    var c = </span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.Button&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç‚¹å‡»ç«‹å³æ”¯ä»˜ &quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">c);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var t = </span><span style="color:#61AFEF;">getæŸçŸ¥åå”®ç¥¨å¹³å°Timestamp</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> realStartTime</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;èŠ±è´¹æ—¶é—´ï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">t)</span></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¼‘æ¯2ç§’,å¦‚æœç«‹å³æ”¯ä»˜æŒ‰é’®è¿˜åœ¨å†ç‚¹å‡»ä¸€æ¬¡&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">ä¼‘æ¯2ç§’</span></span>
<span class="line"><span style="color:#61AFEF;">    sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.Button&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()){</span></span>
<span class="line"><span style="color:#ABB2BF;">        var c = </span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.Button&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»§ç»­ç‚¹å‡»ç«‹å³æ”¯ä»˜ &quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">c);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">ç«‹å³æ”¯ä»˜æŒ‰é’®ä¸€ç›´åœ¨ä¸€ç›´æ”¯ä»˜</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#C678DD;"> while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.Button&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()){</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">     var c = </span><span style="color:#61AFEF;">className</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;android.widget.Button&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#61AFEF;">     sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;">     console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»§ç»­ç‚¹å‡»ç«‹å³æ”¯ä»˜ &quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">c);</span></span>
<span class="line"><span style="color:#56B6C2;">    //</span><span style="color:#ABB2BF;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»“æŸæ—¶é—´ï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#61AFEF;">convertToTime</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">getæŸçŸ¥åå”®ç¥¨å¹³å°Timestamp</span><span style="color:#ABB2BF;">()))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">/**</span></span>
<span class="line"><span style="color:#56B6C2;"> *</span></span>
<span class="line"><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> @</span><span style="color:#ABB2BF;">returns æŸçŸ¥åå”®ç¥¨å¹³å°æœåŠ¡å™¨æ—¶é—´æˆ³</span></span>
<span class="line"><span style="color:#56B6C2;"> */</span></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">getæŸçŸ¥åå”®ç¥¨å¹³å°Timestamp</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#D19A66;"> JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">parse</span><span style="color:#ABB2BF;">(http.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://mtop.æŸçŸ¥åå”®ç¥¨å¹³å°.cn/gw/mtop.common.getTimestamp/&quot;</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers: {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Host&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;mtop.æŸçŸ¥åå”®ç¥¨å¹³å°.cn&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Content-Type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/json;charset=utf-8&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Accept&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;*/*&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;floattime/1.1.1 (iPhone; iOS 15.6; Scale/3.00)&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Accept-Language&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;zh-Hans-CN;q=1, en-CN;q=0.9&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Accept-Encoding&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;gzip, deflate, br&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Connection&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;keep-alive&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }).body.</span><span style="color:#61AFEF;">string</span><span style="color:#ABB2BF;">()).data.t;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">/**</span></span>
<span class="line"><span style="color:#56B6C2;"> *</span></span>
<span class="line"><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> @</span><span style="color:#ABB2BF;">param {æ—¶é—´æˆ³} timestamp</span></span>
<span class="line"><span style="color:#56B6C2;"> *</span><span style="color:#56B6C2;"> @</span><span style="color:#ABB2BF;">returns </span><span style="color:#D19A66;">ISO</span><span style="color:#D19A66;"> 8601</span><span style="color:#ABB2BF;"> æ ¼å¼çš„åŒ—äº¬æ—¶é—´</span></span>
<span class="line"><span style="color:#56B6C2;"> */</span></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">convertToTime</span><span style="color:#ABB2BF;">(timestamp) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    var date = new </span><span style="color:#61AFEF;">Date</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">Number</span><span style="color:#ABB2BF;">(timestamp));</span></span>
<span class="line"><span style="color:#ABB2BF;">    var year = date.</span><span style="color:#61AFEF;">getUTCFullYear</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    var month = (date.</span><span style="color:#61AFEF;">getUTCMonth</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;0&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var day = date.</span><span style="color:#61AFEF;">getUTCDate</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;0&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var hours = (date.</span><span style="color:#61AFEF;">getUTCHours</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;0&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var minutes = date.</span><span style="color:#61AFEF;">getUTCMinutes</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;0&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var seconds = date.</span><span style="color:#61AFEF;">getUTCSeconds</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;0&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var milliseconds = date.</span><span style="color:#61AFEF;">getUTCMilliseconds</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;0&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    var iso8601 = </span><span style="color:#FFFFFF;">`${year}</span><span style="color:#56B6C2;">-</span><span style="color:#FFFFFF;">${month}</span><span style="color:#56B6C2;">-</span><span style="color:#FFFFFF;">${day} ${hours}:${minutes}:${seconds}</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">${milliseconds}`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> iso8601;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;"> //</span><span style="color:#ABB2BF;">ç‚¹å‡»æ§ä»¶æ‰€åœ¨åæ ‡</span></span>
<span class="line"><span style="color:#ABB2BF;">function </span><span style="color:#61AFEF;">btn_position_click</span><span style="color:#ABB2BF;">(x) {</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (x) {</span></span>
<span class="line"><span style="color:#ABB2BF;">       var b = x.</span><span style="color:#61AFEF;">bounds</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#56B6C2;">       print</span><span style="color:#ABB2BF;">(b.</span><span style="color:#61AFEF;">centerX</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#56B6C2;">       print</span><span style="color:#ABB2BF;">(b.</span><span style="color:#61AFEF;">centerY</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">       var c = </span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">(b.</span><span style="color:#61AFEF;">centerX</span><span style="color:#ABB2BF;">(), b.</span><span style="color:#61AFEF;">centerY</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">       console.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç‚¹å‡»æ˜¯å¦æˆåŠŸï¼š&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">c);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br></div></div><p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p><p>è¿™æ®µä»£ç æ˜¯ä¸ºäº†åœ¨ Android è®¾å¤‡ä¸Šè‡ªåŠ¨åŒ–æ‰§è¡ŒæŠ¢è´­æŸçŸ¥åå”®ç¥¨å¹³å°ç½‘ï¼ˆæŸçŸ¥åå”®ç¥¨å¹³å°.cnï¼‰ä¸Šçš„ç¥¨åŠ¡æµç¨‹ã€‚å®ƒåˆ©ç”¨äº† Auto.js è¿™æ ·çš„è„šæœ¬å¼•æ“æ¥æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä»£ç çš„è¯¦ç»†è§£æï¼š</p><ol><li><p>åˆå§‹åŒ–å’Œæ‰“å¼€æŸçŸ¥åå”®ç¥¨å¹³å° Appï¼š</p></li><li><ul><li><code>auto.waitFor();</code> ç­‰å¾…ç”¨æˆ·å¼€å¯æ— éšœç¢æœåŠ¡ã€‚å¦‚æœæœªå¼€å¯ï¼Œåˆ™å¼•å¯¼ç”¨æˆ·å»è®¾ç½®å¼€å¯ã€‚</li><li><code>app.launchApp(&quot;æŸçŸ¥åå”®ç¥¨å¹³å°&quot;);</code> å¯åŠ¨æŸçŸ¥åå”®ç¥¨å¹³å° Appã€‚</li><li><code>openConsole();</code> å¼€å¯æ§åˆ¶å°ï¼Œç”¨äºè¾“å‡ºæ—¥å¿—ã€‚</li><li><code>console.setTitle(&quot;æŸçŸ¥åå”®ç¥¨å¹³å° go!&quot;,&quot;#ff11ee00&quot;,30);</code> è®¾ç½®æ§åˆ¶å°çš„æ ‡é¢˜ã€é¢œè‰²å’Œå­—ä½“å¤§å°ã€‚</li></ul></li><li><p>è¾“å…¥ä¿¡æ¯è·å–ï¼š</p></li><li><ul><li><code>getPlayEtc()</code>ã€<code>getTicketPrice()</code> å’Œ <code>getSellTime()</code> åˆ†åˆ«ç”¨äºä»ç”¨æˆ·å¤„è·å–æ¼”å‡ºåœºæ¬¡ã€ç¥¨ä»·å’ŒæŠ¢ç¥¨æ—¶é—´çš„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯é€šè¿‡å¼¹çª—è¾“å…¥è·å–ï¼Œå¦‚æœç”¨æˆ·æœªè¾“å…¥åˆ™ä¼šæç¤ºå¹¶é‡æ–°è¯·æ±‚è¾“å…¥ã€‚</li></ul></li><li><p>ä¸»æµç¨‹(<code>main</code>)å‡½æ•°ï¼š</p></li><li><ul><li>åˆ¤æ–­æ˜¯å¦å·²é¢„çº¦ã€‚å¦‚æœæœªé¢„çº¦ï¼Œæç¤ºç”¨æˆ·è¾“å…¥æŠ¢ç¥¨æ‰€éœ€çš„ä¿¡æ¯ã€‚</li><li>æ ¹æ®ç”¨æˆ·è¾“å…¥çš„æŠ¢ç¥¨æ—¶é—´ï¼Œè®¾ç½®å…·ä½“çš„å¹´ã€æœˆã€æ—¥ã€å°æ—¶å’Œåˆ†é’Ÿï¼Œè®¡ç®—å‡ºæŠ¢ç¥¨çš„å…·ä½“æ—¶é—´æˆ³ã€‚</li><li>å¾ªç¯æ£€æŸ¥å½“å‰æ—¶é—´ï¼Œå½“è¾¾åˆ°é¢„å®šçš„æŠ¢ç¥¨æ—¶é—´æ—¶ï¼Œæ‰§è¡Œç‚¹å‡»æ“ä½œå°è¯•æŠ¢ç¥¨ã€‚</li><li>åœ¨æŠ¢ç¥¨æ—¶é—´åˆ°è¾¾åï¼Œæ¨¡æ‹Ÿç‚¹å‡»ç«‹å³è´­ç¥¨æŒ‰é’®ï¼Œç„¶åæ ¹æ®ç”¨æˆ·è¾“å…¥çš„åœºæ¬¡ä¿¡æ¯å’Œç¥¨ä»·ä¿¡æ¯é€‰æ‹©ç›¸åº”çš„åœºæ¬¡å’Œç¥¨æ¡£ã€‚</li><li>å°è¯•ç‚¹å‡»ç¡®è®¤æŒ‰é’®å¹¶ç­‰å¾…ç«‹å³æ”¯ä»˜æŒ‰é’®å‡ºç°ï¼Œç‚¹å‡»ä»¥å®Œæˆè´­ç¥¨ã€‚</li></ul></li><li><p>è¾…åŠ©å‡½æ•°ï¼š</p></li><li><ul><li><code>getæŸçŸ¥åå”®ç¥¨å¹³å°Timestamp()</code> ç”¨äºè·å–æŸçŸ¥åå”®ç¥¨å¹³å°æœåŠ¡å™¨çš„å½“å‰æ—¶é—´æˆ³ï¼Œä»¥ç¡®ä¿ä¸æœåŠ¡å™¨æ—¶é—´åŒæ­¥ã€‚</li><li><code>convertToTime(timestamp)</code> å°†æ—¶é—´æˆ³è½¬æ¢ä¸ºæ˜“è¯»çš„æ—¶é—´æ ¼å¼ã€‚</li><li><code>btn_position_click(x)</code> æ¨¡æ‹Ÿç‚¹å‡»å±å¹•ä¸ŠæŒ‡å®šæ§ä»¶çš„ä½ç½®ã€‚</li></ul></li></ol><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h1 id="å°è±¡è¶…å¸‚æŠ¢èœè„šæœ¬" tabindex="-1">å°è±¡è¶…å¸‚æŠ¢èœè„šæœ¬ <a class="header-anchor" href="#å°è±¡è¶…å¸‚æŠ¢èœè„šæœ¬" aria-label="Permalink to &quot;å°è±¡è¶…å¸‚æŠ¢èœè„šæœ¬&quot;">â€‹</a></h1><h3 id="å…¨ä»£ç å¦‚ä¸‹" tabindex="-1">å…¨ä»£ç å¦‚ä¸‹ <a class="header-anchor" href="#å…¨ä»£ç å¦‚ä¸‹" aria-label="Permalink to &quot;å…¨ä»£ç å¦‚ä¸‹&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// è§£é”æ‰‹æœºå±å¹•</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> unLock</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">device</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isScreenOn</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#E5C07B;">		device</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">wakeUp</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">		sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		swipe</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		const</span><span style="color:#E5C07B;"> password</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;123456&quot;</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">//è¿™é‡Œæ¢æˆè‡ªå·±çš„æ‰‹æœºè§£é”å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> password</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> position</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> text</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">password</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">bounds</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">			click</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">position</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">centerX</span><span style="color:#ABB2BF;">(), </span><span style="color:#E5C07B;">position</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">centerY</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#61AFEF;">			sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#61AFEF;">	sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//æŠ¢èœæµç¨‹</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> robVeg</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;">	unLock</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">	launchApp</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å°è±¡è¶…å¸‚&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">	waitForPackage</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;com.meituan.retail.v.android&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	auto</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> btn_skip</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;btn_skip&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">btn_skip</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		btn_skip</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²è·³è¿‡é¦–å±å¹¿å‘Š&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#61AFEF;">	sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">	gotoBuyCar</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">	sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">	checkAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">	sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">	submitOrder</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">robVeg</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//æ‰“å¼€è´­ç‰©è½¦é¡µé¢</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> gotoBuyCar</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;img_shopping_cart&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">		id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;img_shopping_cart&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²è¿›å…¥è´­ç‰©è½¦&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡æ‰¾åˆ°è´­ç‰©è½¦&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">		exit</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//å‹¾é€‰å…¨éƒ¨å•†å“</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> checkAll</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> isCheckedAll</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> textStartsWith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»“ç®—(&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> checkAllBtn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å…¨é€‰&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!!</span><span style="color:#E06C75;">checkAllBtn</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#56B6C2;">		!</span><span style="color:#E06C75;">isCheckedAll</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> checkAllBtn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">		sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡æ‰¾åˆ°å…¨é€‰æŒ‰é’®&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">		exit</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> submitOrder</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">count</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">textStartsWith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»“ç®—(&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">		textStartsWith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç»“ç®—(&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æˆ‘çŸ¥é“äº†&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å…³é—­æˆ‘çŸ¥é“äº†&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æˆ‘çŸ¥é“äº†&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é‡æ–°åŠ è½½&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é‡æ–°åŠ è½½&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é‡æ–°åŠ è½½&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç«‹å³æ”¯ä»˜&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">		text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç«‹å³æ”¯ä»˜&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">findOne</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">parent</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¡®è®¤æ”¯ä»˜&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#C678DD;">		const</span><span style="color:#E5C07B;"> music</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#98C379;">			&quot;/storage/emulated/0/netease/cloudmusic/Music/Joel Hanson Sara Groves - Traveling Light.mp3&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">		media</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">playMusic</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">music</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">media</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getMusicDuration</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢ä¸ªå±ï¼&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">		exit</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#61AFEF;">	sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">800</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 10000</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">		toast</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡æŠ¢åˆ°&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">		exit</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">	submitOrder</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br></div></div><h3 id="è¯´æ˜" tabindex="-1">è¯´æ˜ <a class="header-anchor" href="#è¯´æ˜" aria-label="Permalink to &quot;è¯´æ˜&quot;">â€‹</a></h3><p>è¿™æ®µä»£ç æ˜¯ä¸º Android è®¾å¤‡ä¸Šçš„è‡ªåŠ¨åŒ–è„šæœ¬ç¼–å†™çš„ï¼Œä½¿ç”¨äº† Auto.js è¿™æ ·çš„å·¥å…·ã€‚Auto.js æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ Android è®¾å¤‡ä¸Šè¿è¡Œ JavaScript ä»¥å®ç°è‡ªåŠ¨åŒ–æ“ä½œçš„åº”ç”¨ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Auto.js è¿è¡Œè¿™æ®µä»£ç çš„è¯¦ç»†æ­¥éª¤ï¼š</p><p><strong>1. å®‰è£… Auto.js</strong></p><p>- ä¸‹è½½å®‰è£…ï¼šæ‚¨å¯ä»¥ä»åº”ç”¨å¸‚åœºä¸‹è½½ Auto.js çš„ APK æ–‡ä»¶å¹¶å®‰è£…åˆ°æ‚¨çš„ Android è®¾å¤‡ä¸Šã€‚è¯·ç¡®ä¿ä»å¯ä¿¡çš„æ¥æºä¸‹è½½ä»¥é¿å…æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</p><p>- åº”ç”¨æƒé™ï¼šå®‰è£…å¹¶é¦–æ¬¡è¿è¡Œ Auto.js åï¼Œéœ€è¦æˆäºˆåº”ç”¨å„ç§æƒé™ï¼ŒåŒ…æ‹¬æ— éšœç¢æœåŠ¡æƒé™ã€æ‚¬æµ®çª—æƒé™ç­‰ï¼Œè¿™äº›æƒé™å¯¹äºå®ç°è‡ªåŠ¨åŒ–æ“ä½œæ˜¯å¿…é¡»çš„ã€‚</p><p><strong>2. ç¼–å†™æˆ–å¯¼å…¥è„šæœ¬</strong></p><p>- åˆ›å»ºè„šæœ¬ï¼šæ‰“å¼€ Auto.js åº”ç”¨ï¼Œå¯ä»¥åœ¨åº”ç”¨å†…ç›´æ¥ç¼–å†™ JavaScript è„šæœ¬ã€‚</p><p>- å¯¼å…¥è„šæœ¬ï¼šå°†æ‚¨çš„è„šæœ¬ä»£ç ï¼ˆå¦‚ä¸Šè¿°ä»£ç ï¼‰ä¿å­˜ä¸ºä¸€ä¸ª <code>.js</code> æ–‡ä»¶ï¼Œé€šè¿‡ Auto.js çš„â€œæ‰“å¼€â€åŠŸèƒ½å¯¼å…¥è¿™ä¸ªè„šæœ¬æ–‡ä»¶ã€‚</p><p><strong>3. è¿è¡Œè„šæœ¬</strong></p><p>- è°ƒè¯•è¿è¡Œï¼šåœ¨ Auto.js ä¸­æ‰“å¼€è„šæœ¬åï¼Œç‚¹å‡»è¿è¡ŒæŒ‰é’®å¼€å§‹æ‰§è¡Œè„šæœ¬ã€‚æ‚¨å¯ä»¥è§‚å¯Ÿè„šæœ¬çš„è¿è¡Œæ•ˆæœï¼Œå¹¶é€šè¿‡æ—¥å¿—è¾“å‡ºè¿›è¡Œè°ƒè¯•ã€‚</p><p>- è‡ªåŠ¨è¿è¡Œï¼šAuto.js æ”¯æŒè®¾ç½®è„šæœ¬çš„å®šæ—¶æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡åº”ç”¨å†…çš„è®¡åˆ’ä»»åŠ¡åŠŸèƒ½è®¾ç½®è„šæœ¬çš„è‡ªåŠ¨è¿è¡Œæ—¶é—´ã€‚</p><p><strong>4. ç›‘æ§å’Œç»´æŠ¤</strong></p><p>- æ—¥å¿—å’Œé”™è¯¯å¤„ç†ï¼šAuto.js æä¾›äº†æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—æ¥åˆ†æè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¡Œä¸ºå’Œå¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p><p>- è„šæœ¬æ›´æ–°ï¼šç”±äºåº”ç”¨çš„æ›´æ–°å¯èƒ½å¯¼è‡´è‡ªåŠ¨åŒ–è„šæœ¬çš„ç•Œé¢å…ƒç´ å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦å®šæœŸæ£€æŸ¥å’Œæ›´æ–°è„šæœ¬ä»¥ç¡®ä¿å…¶æ­£å¸¸è¿è¡Œã€‚</p><p><strong>5. æ³¨æ„äº‹é¡¹</strong></p><p>- ç”µæºç®¡ç†ï¼šä¸ºäº†ç¡®ä¿è„šæœ¬å¯ä»¥åœ¨å±å¹•å…³é—­åç»§ç»­è¿è¡Œï¼Œéœ€è¦åœ¨è®¾å¤‡çš„ç”µæºç®¡ç†è®¾ç½®ä¸­å°† Auto.js è®¾ç½®ä¸ºä¸å—ç”µæ± ä¼˜åŒ–å½±å“ã€‚</p><p>- å®‰å…¨ä¸åˆè§„ï¼šè‡ªåŠ¨åŒ–æ“ä½œå¯èƒ½è¿ååº”ç”¨çš„ä½¿ç”¨æ¡æ¬¾ï¼Œä½¿ç”¨æ­¤ç±»å·¥å…·æ—¶éœ€è°¨æ…ï¼Œå¹¶ç¡®ä¿æ‚¨çš„è¡Œä¸ºç¬¦åˆåº”ç”¨çš„æ”¿ç­–å’Œæ³•å¾‹æ³•è§„ã€‚</p><h1 id="è‡ªåŠ¨é¢„çº¦æŒ‚å·è„šæœ¬" tabindex="-1">è‡ªåŠ¨é¢„çº¦æŒ‚å·è„šæœ¬ <a class="header-anchor" href="#è‡ªåŠ¨é¢„çº¦æŒ‚å·è„šæœ¬" aria-label="Permalink to &quot;è‡ªåŠ¨é¢„çº¦æŒ‚å·è„šæœ¬&quot;">â€‹</a></h1><p>è¿™æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„é¢„çº¦å’Œç›‘æ§ç¨‹åº</p><h3 id="main-py-å…¨ä»£ç å¦‚ä¸‹" tabindex="-1">main.py å…¨ä»£ç å¦‚ä¸‹ <a class="header-anchor" href="#main-py-å…¨ä»£ç å¦‚ä¸‹" aria-label="Permalink to &quot;main.py å…¨ä»£ç å¦‚ä¸‹&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> schema </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> AddRegArgs, DeptSchForDocArgs, DocSchArgs, NumberSourceArgs</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> api </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Api</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> appointment</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    é¢„çº¦ç¨‹åºå…¥å£ ç”¨æ¥æµ‹è¯•æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸é¢„çº¦</span></span>
<span class="line"><span style="color:#98C379;">    :return:</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    api </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Api</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    hospitals </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_hospital</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©é™¢åŒºï¼Œè¾“å…¥é™¢åŒºå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, hospital </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(hospitals):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, hospital[</span><span style="color:#98C379;">&quot;aliasName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    hospital_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥é™¢åŒºåºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    hospital </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> hospitals[hospital_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptlist </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_deptlist</span><span style="color:#ABB2BF;">(hospital[</span><span style="color:#98C379;">&quot;hosId&quot;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©ç§‘å®¤ç±»åˆ«ï¼Œè¾“å…¥ç§‘å®¤ç±»åˆ«å‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, deptclass </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(deptlist):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, deptclass[</span><span style="color:#98C379;">&quot;deptName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptclass_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥ç§‘å®¤ç±»åˆ«åºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptclass </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> deptlist[deptclass_index]</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©ç§‘å®¤ï¼Œè¾“å…¥ç§‘å®¤å‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, dept </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(deptclass[</span><span style="color:#98C379;">&quot;deptList&quot;</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, dept[</span><span style="color:#98C379;">&quot;deptName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    dept_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥ç§‘å®¤åºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    dept </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> deptclass[</span><span style="color:#98C379;">&quot;deptList&quot;</span><span style="color:#ABB2BF;">][dept_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital}</span></span>
<span class="line"><span style="color:#ABB2BF;">    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> DeptSchForDocArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_dept_sch_for_doc</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©åŒ»ç”Ÿï¼Œè¾“å…¥åŒ»ç”Ÿå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, doc </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(doc_list):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, doc[</span><span style="color:#98C379;">&quot;docName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥åŒ»ç”Ÿåºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> doc_list[doc_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">doc, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital}</span></span>
<span class="line"><span style="color:#ABB2BF;">    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> DocSchArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_doc_sch</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç­›é€‰å‡ºå¯é¢„çº¦çš„æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">        x</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> x </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> doc_schDate</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> sum</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(y[</span><span style="color:#98C379;">&quot;numRemain&quot;</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> y[</span><span style="color:#98C379;">&quot;schState&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;0&quot;</span><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> y </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> x[</span><span style="color:#98C379;">&quot;schDateList&quot;</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#56B6C2;">        &gt;</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">    ]</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(doc_schDate) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡æœ‰å¯é¢„çº¦çš„æ—¶é—´&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©æ—¥æœŸï¼Œè¾“å…¥æ—¥æœŸå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, schDate </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(doc_schDate):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, schDate[</span><span style="color:#98C379;">&quot;schDate&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    schDate_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æ—¥æœŸåºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> doc_schDate[schDate_index]</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©æ—¶æ®µ,è¾“å…¥æ—¶æ®µå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, sch </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(schDate[</span><span style="color:#98C379;">&quot;schDateList&quot;</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, sch[</span><span style="color:#98C379;">&quot;ampmName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    sch_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æ—¶æ®µåºå·:&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    sch </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> schDate[</span><span style="color:#98C379;">&quot;schDateList&quot;</span><span style="color:#ABB2BF;">][sch_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">sch, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">doc, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital}</span></span>
<span class="line"><span style="color:#ABB2BF;">    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> NumberSourceArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">    appointment_time_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_number_source</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©é¢„çº¦æ—¶é—´ï¼Œè¾“å…¥é¢„çº¦æ—¶é—´å‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, timeDesc </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(appointment_time_list):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, timeDesc[</span><span style="color:#98C379;">&quot;timeDesc&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    time_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥é¢„çº¦æ—¶é—´åºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    appointment_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> appointment_time_list[time_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    pat_card_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_pat_card_list</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©å°±è¯Šå¡ï¼Œè¾“å…¥å°±è¯Šå¡å‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, pat_card </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(pat_card_list):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, pat_card[</span><span style="color:#98C379;">&quot;name&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    pat_card_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥å°±è¯Šå¡åºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    pat_card </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pat_card_list[pat_card_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">sch, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">doc, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">appointment_time, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">pat_card}</span></span>
<span class="line"><span style="color:#ABB2BF;">    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> AddRegArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">add_reg</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(response)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> monitor</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    ç›‘æ§ç¨‹åºå…¥å£ ç”¨æ¥å®é™…çš„æŠ¢æŒ‚å·ï¼Œæ¯10Sæ£€æµ‹ä¸€æ¬¡æŒ‡å®šæ—¥æœŸçš„æŒ‡å®šåŒ»ç”Ÿçš„æŒ‚å·æƒ…å†µ</span></span>
<span class="line"><span style="color:#98C379;">    :return:</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    api </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Api</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    hospitals </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_hospital</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©é™¢åŒºï¼Œè¾“å…¥é™¢åŒºå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, hospital </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(hospitals):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, hospital[</span><span style="color:#98C379;">&quot;aliasName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    hospital_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥é™¢åŒºåºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    hospital </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> hospitals[hospital_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptlist </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_deptlist</span><span style="color:#ABB2BF;">(hospital[</span><span style="color:#98C379;">&quot;hosId&quot;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©ç§‘å®¤ç±»åˆ«ï¼Œè¾“å…¥ç§‘å®¤ç±»åˆ«å‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, deptclass </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(deptlist):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, deptclass[</span><span style="color:#98C379;">&quot;deptName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptclass_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥ç§‘å®¤ç±»åˆ«åºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptclass </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> deptlist[deptclass_index]</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©ç§‘å®¤ï¼Œè¾“å…¥ç§‘å®¤å‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, dept </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(deptclass[</span><span style="color:#98C379;">&quot;deptList&quot;</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, dept[</span><span style="color:#98C379;">&quot;deptName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    dept_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥ç§‘å®¤åºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    dept </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> deptclass[</span><span style="color:#98C379;">&quot;deptList&quot;</span><span style="color:#ABB2BF;">][dept_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital}</span></span>
<span class="line"><span style="color:#ABB2BF;">    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> DeptSchForDocArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_dept_sch_for_doc</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©åŒ»ç”Ÿï¼Œè¾“å…¥åŒ»ç”Ÿå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, doc </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(doc_list):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, doc[</span><span style="color:#98C379;">&quot;docName&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥åŒ»ç”Ÿåºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> doc_list[doc_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">doc, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital}</span></span>
<span class="line"><span style="color:#ABB2BF;">    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> DocSchArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc_schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_doc_sch</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·é€‰æ‹©æ—¥æœŸï¼Œè¾“å…¥æ—¥æœŸå‰æ–¹åºå·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, schDate </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(doc_schDate):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">):</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(index, schDate[</span><span style="color:#98C379;">&quot;schDate&quot;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    schDate_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æ—¥æœŸåºå·ï¼š&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> doc_schDate[schDate_index]</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            doc_schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_doc_sch</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç­›é€‰å‡ºå¯é¢„çº¦çš„æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">            doc_schDate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">                x</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> x </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> doc_schDate</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#56B6C2;"> sum</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    [</span></span>
<span class="line"><span style="color:#56B6C2;">                        int</span><span style="color:#ABB2BF;">(y[</span><span style="color:#98C379;">&quot;numRemain&quot;</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">                        and</span><span style="color:#ABB2BF;"> y[</span><span style="color:#98C379;">&quot;schState&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#C678DD;">                        and</span><span style="color:#ABB2BF;"> y[</span><span style="color:#98C379;">&quot;schDate&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> schDate</span></span>
<span class="line"><span style="color:#C678DD;">                        for</span><span style="color:#ABB2BF;"> y </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> x[</span><span style="color:#98C379;">&quot;schDateList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ]</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#56B6C2;">                &gt;</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">            ]</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(doc_schDate) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡æœ‰å¯é¢„çº¦çš„æ—¶é—´,ç­‰å¾…10Såå†æ¬¡æ£€æµ‹&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> sch_index, sch </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(schDate[</span><span style="color:#98C379;">&quot;schDateList&quot;</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#ABB2BF;">                all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">sch, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">doc, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">dept, </span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">hospital}</span></span>
<span class="line"><span style="color:#ABB2BF;">                args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> NumberSourceArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">                appointment_time_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_number_source</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> appointment_time_index, appointment_time </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    appointment_time_list</span></span>
<span class="line"><span style="color:#ABB2BF;">                ):</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç›®æ ‡åŒ»å¸ˆå½“å‰å­˜åœ¨å¯é¢„çº¦æ—¶é—´ï¼Œç¨‹åºå°†å°è¯•è‡ªåŠ¨é¢„çº¦ã€‚å¦‚æœªæ”¶åˆ°é¢„çº¦æˆåŠŸæ¶ˆæ¯ï¼Œè¯·å‰å¾€é¢„çº¦ç•Œé¢æ‰‹åŠ¨é¢„çº¦ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    pat_card_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">get_pat_card_list</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    pat_card </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pat_card_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    all_args </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#56B6C2;">                        **</span><span style="color:#ABB2BF;">sch,</span></span>
<span class="line"><span style="color:#56B6C2;">                        **</span><span style="color:#ABB2BF;">doc,</span></span>
<span class="line"><span style="color:#56B6C2;">                        **</span><span style="color:#ABB2BF;">dept,</span></span>
<span class="line"><span style="color:#56B6C2;">                        **</span><span style="color:#ABB2BF;">hospital,</span></span>
<span class="line"><span style="color:#56B6C2;">                        **</span><span style="color:#ABB2BF;">appointment_time,</span></span>
<span class="line"><span style="color:#56B6C2;">                        **</span><span style="color:#ABB2BF;">pat_card,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    }</span></span>
<span class="line"><span style="color:#ABB2BF;">                    args </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> AddRegArgs</span><span style="color:#ABB2BF;">(**all_args)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> api.</span><span style="color:#61AFEF;">add_reg</span><span style="color:#ABB2BF;">(args)</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> response[</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;0&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é¢„çº¦æˆåŠŸï¼è¯·åœ¨10åˆ†é’Ÿå†…å‰å¾€è®¢å•é¡µé¢ä»˜æ¬¾å¹¶åœæ­¢ç¨‹åºè¿è¡Œï¼è‹¥æœªåŠæ—¶åœæ­¢ç¨‹åºè¿è¡Œï¼Œç¨‹åºå°†åœ¨10åˆ†é’Ÿåè‡ªåŠ¨é‡æ–°é¢„çº¦ï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é¢„çº¦å¤±è´¥ï¼è¯·å‰å¾€é¢„çº¦ç•Œé¢æ‰‹åŠ¨é¢„çº¦ï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç­‰å¾…10Såé‡æ–°é¢„çº¦&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> KeyboardInterrupt:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¨‹åºå·²åœæ­¢&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            break</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¨‹åºå¼‚å¸¸ï¼Œç¨‹åºå°†åœ¨10Såé‡æ–°é¢„çº¦&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            continue</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">    monitor</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„é¢„çº¦å’Œç›‘æ§ç¨‹åºï¼Œä¸»è¦ç”¨äºé€šè¿‡ API è¿›è¡ŒåŒ»é™¢æŒ‚å·é¢„çº¦ã€‚ä»¥ä¸‹æ˜¯ä»£ç çš„é€è¡Œç¿»è¯‘å’Œè§£é‡Šï¼š</p><p><strong>ä»£ç åŠŸèƒ½ç®€ä»‹</strong></p><p>è¿™ä¸ªè„šæœ¬å®šä¹‰äº†ä¸¤ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼š</p><ol><li>appointment()ï¼šå…è®¸ç”¨æˆ·é€šè¿‡å‘½ä»¤è¡Œç•Œé¢é€‰æ‹©åŒ»é™¢ã€ç§‘å®¤ã€åŒ»ç”Ÿå’Œæ—¶é—´ï¼Œè¿›è¡Œæ‰‹åŠ¨é¢„çº¦ã€‚</li><li>monitor()ï¼šæŒç»­ç›‘æ§ç‰¹å®šåŒ»ç”Ÿçš„å¯é¢„çº¦æƒ…å†µï¼Œå¹¶å°è¯•è‡ªåŠ¨é¢„çº¦ã€‚</li></ol><p><strong>appointment()å‡½æ•°</strong></p><p>- åˆå§‹åŒ– API è¿æ¥ã€‚</p><p>- ä» API è·å–åŒ»é™¢åˆ—è¡¨ï¼Œå¹¶è®©ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªåŒ»é™¢ã€‚</p><p>- æ ¹æ®æ‰€é€‰åŒ»é™¢è·å–ç§‘å®¤åˆ—è¡¨ï¼Œå¹¶è®©ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªç§‘å®¤ç±»åˆ«ã€‚</p><p>- åœ¨é€‰å®šçš„ç§‘å®¤ç±»åˆ«ä¸­é€‰æ‹©å…·ä½“çš„ç§‘å®¤ã€‚</p><p>- è·å–åŒ»ç”Ÿçš„æ—¶é—´è¡¨ï¼Œå¹¶è®©ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªåŒ»ç”Ÿã€‚</p><p>- æ˜¾ç¤ºåŒ»ç”Ÿå¯é¢„çº¦çš„æ—¥æœŸï¼Œå¹¶è®©ç”¨æˆ·é€‰æ‹©ã€‚</p><p>- æ˜¾ç¤ºæ‰€é€‰æ—¥æœŸçš„å…·ä½“æ—¶é—´æ®µï¼Œå¹¶è®©ç”¨æˆ·é€‰æ‹©ã€‚</p><p>- è·å–å¯ç”¨çš„é¢„çº¦æ—¶é—´ï¼Œè®©ç”¨æˆ·é€‰æ‹©å…·ä½“çš„æ—¶é—´ç‚¹ã€‚</p><p>- è·å–ç”¨æˆ·çš„å°±è¯Šå¡ä¿¡æ¯ï¼Œå¹¶è®©ç”¨æˆ·é€‰æ‹©ä¸€å¼ å°±è¯Šå¡ã€‚</p><p>- æäº¤é¢„çº¦è¯·æ±‚ï¼Œå¹¶æ˜¾ç¤ºå“åº”ç»“æœã€‚</p><p><strong>monitor()å‡½æ•°</strong></p><p>- ç±»ä¼¼äº<code>appointment()</code>ï¼Œä½†ä¸»è¦ç”¨äºè‡ªåŠ¨ç›‘æ§å’Œé¢„çº¦ã€‚</p><p>- åœ¨ç”¨æˆ·é€‰æ‹©åŒ»ç”Ÿå’Œæ—¥æœŸåï¼Œç¨‹åºæ¯ 10 ç§’æ£€æŸ¥ä¸€æ¬¡å¯é¢„çº¦æ—¶é—´ã€‚</p><p>- å¦‚æœå‘ç°æœ‰å¯é¢„çº¦çš„æ—¶é—´ï¼Œç¨‹åºä¼šå°è¯•é¢„çº¦ï¼Œå¹¶åœ¨æˆåŠŸåç­‰å¾… 10 åˆ†é’Ÿï¼ˆé˜²æ­¢é‡å¤é¢„çº¦ï¼‰ï¼Œç„¶åç»§ç»­ç›‘æ§ã€‚</p><p><strong>ä¸»ç¨‹åºå…¥å£</strong></p><p>- å½“è„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œæ—¶ï¼Œå®ƒä¼šå¯åŠ¨<code>monitor()</code>å‡½æ•°ï¼Œå¼€å§‹ç›‘æ§é¢„çº¦æƒ…å†µã€‚</p><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong></p><p>è¿™ä¸ªè„šæœ¬é€šè¿‡å‘½ä»¤è¡Œäº¤äº’ï¼Œç”¨æˆ·éœ€è¦æ ¹æ®æç¤ºè¾“å…¥é€‰æ‹©çš„åºå·æ¥é€‰æ‹©åŒ»é™¢ã€ç§‘å®¤ã€åŒ»ç”Ÿå’Œæ—¶é—´ã€‚è¿™é€‚åˆéœ€è¦é¢‘ç¹æ£€æŸ¥å’Œé¢„çº¦åŒ»é™¢æŒ‚å·çš„åœºæ™¯ï¼Œå¦‚æŠ¢è´­çƒ­é—¨åŒ»ç”Ÿçš„æŒ‚å·åé¢ã€‚</p><p><strong>å®ç°ç»†èŠ‚</strong></p><p>- è„šæœ¬ä¾èµ–äºå¤–éƒ¨å®šä¹‰çš„<code>Api</code>ç±»åŠå…¶æ–¹æ³•ï¼ˆå¦‚<code>get_hospital()</code>, <code>get_deptlist()</code>, <code>get_dept_sch_for_doc()</code>, <code>get_doc_sch()</code>, <code>get_number_source()</code>, <code>add_reg()</code>, <code>get_pat_card_list()</code>ï¼‰ï¼Œè¿™äº›æ–¹æ³•éœ€è¦ä¸åç«¯ API æ­£ç¡®äº¤äº’ã€‚</p><p>- ä½¿ç”¨äº† Python çš„å­—å…¸å±•å¼€è¯­æ³•<code>**</code>æ¥ä¼ é€’å‚æ•°ã€‚</p><p>- ä½¿ç”¨äº†å¼‚å¸¸å¤„ç†æ¥ç®¡ç†è¿è¡Œæ—¶é”™è¯¯ï¼Œå¹¶å…è®¸ç”¨æˆ·é€šè¿‡<code>Ctrl+C</code>ä¸­æ–­ç¨‹åºã€‚</p><p><strong>å¦‚ä½•å¯åŠ¨è¿è¡Œ</strong>ï¼š</p><p>å°†æ‰€æœ‰æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œ å¯åŠ¨è¿è¡Œ<strong>main.py</strong>å³å¯ã€‚</p><h3 id="schema-py-æ–‡ä»¶å†…å®¹å¦‚ä¸‹" tabindex="-1">schema.py æ–‡ä»¶å†…å®¹å¦‚ä¸‹ <a class="header-anchor" href="#schema-py-æ–‡ä»¶å†…å®¹å¦‚ä¸‹" aria-label="Permalink to &quot;schema.py æ–‡ä»¶å†…å®¹å¦‚ä¸‹&quot;">â€‹</a></h3><div class="language-py line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pydantic </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> BaseModel</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Union</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> HospitalArgs</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BaseModel</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    sysCode: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> DeptListArgs</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BaseModel</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    clinicalType: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosId: </span><span style="color:#56B6C2;">int</span></span>
<span class="line"><span style="color:#ABB2BF;">    sysCode: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> DeptSchForDocArgs</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BaseModel</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    clinicalType: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptCode: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptId: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> deptCode</span></span>
<span class="line"><span style="color:#ABB2BF;">    specialtyId: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    visitingArea: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosId: </span><span style="color:#56B6C2;">int</span></span>
<span class="line"><span style="color:#ABB2BF;">    recommendation: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#56B6C2;">    type</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;order&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    source: </span><span style="color:#56B6C2;">int</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 22</span></span>
<span class="line"><span style="color:#ABB2BF;">    sysCode: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> update</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.deptId </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.deptCode</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> DocSchArgs</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BaseModel</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docTitle: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docPhoto: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosId: </span><span style="color:#56B6C2;">int</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#56B6C2;">    type</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;order&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    visitingArea: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    clinicalType: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">    source: </span><span style="color:#56B6C2;">int</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 22</span></span>
<span class="line"><span style="color:#ABB2BF;">    sysCode: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> NumberSourceArgs</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BaseModel</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    sysCode: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    ampm: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    categor: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosId: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    schDate: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    schId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> AddRegArgs</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BaseModel</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # keyä¸ä¸€è‡´å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">    disNo: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">    schDate: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">    patienId: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å¿…é¡»å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">    clinicalType: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">    visitingArea: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    ampm: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    appointmentNumber: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> disNo</span></span>
<span class="line"><span style="color:#ABB2BF;">    categor: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    categorName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    deptName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    docName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    endTime: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    extend: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    fee: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosId: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    hosName: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    isFlexible: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    numId: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    patientId: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> patienId</span></span>
<span class="line"><span style="color:#ABB2BF;">    resDate: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> schDate</span></span>
<span class="line"><span style="color:#ABB2BF;">    schId: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    source: </span><span style="color:#56B6C2;">int</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 22</span></span>
<span class="line"><span style="color:#ABB2BF;">    startTime: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    sysCode: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    thirdUserId: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    timeDesc: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"><span style="color:#ABB2BF;">    timePoint: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    schQukCategor: </span><span style="color:#56B6C2;">str</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> update</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.appointmentNumber </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.disNo</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.resDate </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.schDate</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.patientId </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.patienId</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ª Python æ¨¡å—ï¼Œä½¿ç”¨äº†<code>pydantic</code>åº“æ¥å®šä¹‰å‡ ä¸ªæ•°æ®æ¨¡å‹ï¼ˆschemasï¼‰ï¼Œè¿™äº›æ¨¡å‹ç”¨äºæ ¡éªŒå’Œç®¡ç†æ•°æ®çš„ç»“æ„ï¼Œä¸»è¦ç”¨äºåŒ»é™¢é¢„çº¦ç³»ç»Ÿçš„ API è°ƒç”¨ã€‚ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªç±»çš„åŠŸèƒ½å’Œå±æ€§çš„ç®€è¦è¯´æ˜ï¼š</p><p><strong>1. <code>HospitalArgs</code> ç±»</strong></p><p>- åŠŸèƒ½ï¼šå®šä¹‰è·å–åŒ»é™¢æ•°æ®æ—¶å¯èƒ½éœ€è¦çš„å‚æ•°ã€‚</p><p>- å±æ€§ï¼š</p><p>- <code>sysCode</code>ï¼šç³»ç»Ÿä»£ç ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼Œé¢„è®¾ä¸º&quot;1001035&quot;ã€‚</p><p><strong>2. <code>DeptListArgs</code> ç±»</strong></p><p>- åŠŸèƒ½ï¼šå®šä¹‰è·å–ç§‘å®¤åˆ—è¡¨æ•°æ®æ—¶éœ€è¦çš„å‚æ•°ã€‚</p><p>- å±æ€§ï¼š</p><p>- <code>clinicalType</code>ï¼šä¸´åºŠç±»å‹ï¼Œé¢„è®¾ä¸º 1ã€‚</p><p>- <code>hosId</code>ï¼šåŒ»é™¢ IDï¼Œä¸ºæ•´æ•°ã€‚</p><p>- <code>sysCode</code>ï¼šç³»ç»Ÿä»£ç ï¼ŒåŒ<code>HospitalArgs</code>ã€‚</p><p><strong>3. <code>DeptSchForDocArgs</code> ç±»</strong></p><p>- åŠŸèƒ½ï¼šå®šä¹‰è·å–ç‰¹å®šç§‘å®¤ä¸‹åŒ»ç”Ÿçš„æ’ç­ä¿¡æ¯æ—¶éœ€è¦çš„å‚æ•°ã€‚</p><p>- å±æ€§ï¼š</p><p>- <code>clinicalType</code>ï¼šä¸´åºŠç±»å‹ï¼Œé¢„è®¾ä¸º 1ã€‚</p><p>- <code>deptCode</code>ï¼šç§‘å®¤ä»£ç ã€‚</p><p>- <code>deptId</code>ï¼šç§‘å®¤ IDï¼Œåˆå§‹ä¸<code>deptCode</code>ç›¸åŒã€‚</p><p>- <code>specialtyId</code>ï¼šä¸“ä¸š IDã€‚</p><p>- <code>deptName</code>ï¼šç§‘å®¤åç§°ã€‚</p><p>- <code>visitingArea</code>ï¼šè®¿é—®åŒºåŸŸã€‚</p><p>- <code>hosId</code>ï¼šåŒ»é™¢ IDã€‚</p><p>- <code>recommendation</code>ï¼šæ¨èå­—æ®µï¼Œé¢„è®¾ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p><p>- <code>type</code>ï¼šç±»å‹ï¼Œé¢„è®¾ä¸º&quot;order&quot;ã€‚</p><p>- <code>source</code>ï¼šæ¥æºï¼Œé¢„è®¾ä¸º 22ã€‚</p><p>- <code>sysCode</code>ï¼šç³»ç»Ÿä»£ç ã€‚</p><p>- <code>update()</code>ï¼šæ–¹æ³•ç”¨äºæ›´æ–°<code>deptId</code>ã€‚</p><p><strong>4. <code>DocSchArgs</code> ç±»</strong></p><p>- åŠŸèƒ½ï¼šå®šä¹‰è·å–ç‰¹å®šåŒ»ç”Ÿçš„è¯¦ç»†æ’ç­ä¿¡æ¯æ—¶éœ€è¦çš„å‚æ•°ã€‚</p><p>- å±æ€§ï¼š</p><p>- åŒ…å«åŒ»ç”Ÿ IDã€å§“åã€èŒç§°ã€ç…§ç‰‡ã€æ‰€å±åŒ»é™¢ ID å’Œåç§°ç­‰ã€‚</p><p>- å…¶ä»–ä¸<code>DeptSchForDocArgs</code>ç±»ä¼¼çš„å­—æ®µå¦‚<code>clinicalType</code>, <code>type</code>, <code>source</code>ç­‰ã€‚</p><p><strong>5. <code>NumberSourceArgs</code> ç±»</strong></p><p>- åŠŸèƒ½ï¼šå®šä¹‰è·å–æŸä¸€å…·ä½“æ—¶é—´æ®µå¯é¢„çº¦å·æºä¿¡æ¯æ—¶éœ€è¦çš„å‚æ•°ã€‚</p><p>- å±æ€§ï¼š</p><p>- <code>sysCode</code>ï¼šç³»ç»Ÿä»£ç ã€‚</p><p>- å…¶ä»–ç›¸å…³é¢„çº¦è¯¦æƒ…å¦‚æ—¶é—´æ®µï¼ˆ<code>ampm</code>ï¼‰ã€åˆ†ç±»ï¼ˆ<code>categor</code>ï¼‰ã€åŒ»ç”Ÿ IDã€ç§‘å®¤ IDã€åŒ»é™¢ ID ç­‰ã€‚</p><p><strong>6. <code>AddRegArgs</code> ç±»</strong></p><p>- åŠŸèƒ½ï¼šå®šä¹‰æ·»åŠ é¢„çº¦ä¿¡æ¯æ—¶éœ€è¦çš„å‚æ•°ã€‚</p><p>- å±æ€§ï¼š</p><p>- åŒ…å«é¢„çº¦å…·ä½“çš„ç¼–å·ã€åˆ†ç±»ã€æ—¶é—´æè¿°ã€æ‚£è€… ID ç­‰ã€‚</p><p>- å…¶ä»–é¢„çº¦ç»†èŠ‚å¦‚è´¹ç”¨ã€æ˜¯å¦çµæ´»æ’ç­ã€å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ç­‰ã€‚</p><p>- <code>update()</code>ï¼šæ–¹æ³•ç”¨äºæ›´æ–°ä¸é¢„çº¦ç¼–å·ã€æ—¥æœŸå’Œæ‚£è€… ID ç›¸å…³çš„å±æ€§ã€‚</p><p><strong>7.å¦‚ä½•å¯åŠ¨è¿è¡Œ</strong>ï¼š</p><p>å°†æ‰€æœ‰æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œ å¯åŠ¨è¿è¡Œ<strong>main.py</strong>å³å¯ã€‚</p><h3 id="api-py-æ–‡ä»¶å†…å®¹å¦‚ä¸‹" tabindex="-1">api.py æ–‡ä»¶å†…å®¹å¦‚ä¸‹ <a class="header-anchor" href="#api-py-æ–‡ä»¶å†…å®¹å¦‚ä¸‹" aria-label="Permalink to &quot;api.py æ–‡ä»¶å†…å®¹å¦‚ä¸‹&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># -*- coding: utf-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> hashlib </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> md5</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Crypto.Cipher </span><span style="color:#C678DD;">import</span><span style="color:#D19A66;"> DES</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Crypto.Util.Padding </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pad</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> base64</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Union</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> ddddocr </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> DdddOcr</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> configparser </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ConfigParser</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> schema </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> AddRegArgs, DeptSchForDocArgs, DocSchArgs, NumberSourceArgs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">ocr </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> DdddOcr</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">config </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> ConfigParser</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">config.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;conf.ini&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;utf-8&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¼‚å¸¸å¤„ç†è£…é¥°å™¨</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> exception_handler</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">func</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> wrapper</span><span style="color:#ABB2BF;">(*</span><span style="color:#D19A66;font-style:italic;">args</span><span style="color:#ABB2BF;">, **</span><span style="color:#D19A66;font-style:italic;">kwargs</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> _ </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#61AFEF;"> func</span><span style="color:#ABB2BF;">(*args, **kwargs)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å‡½æ•°</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">func.</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">å‡ºç°å¼‚å¸¸,å¼‚å¸¸å…³é”®è¯ä¸ºï¼š&quot;</span><span style="color:#ABB2BF;">, e, </span><span style="color:#98C379;">&quot;ç¨‹åºå°†åœ¨5Såé‡è¯•&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;ç¨‹åºå¼‚å¸¸ï¼Œé‡è¯•è¿è¡Œåä»æ— æ³•æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> wrapper</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Api</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;åˆå§‹åŒ–&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è¯»å–é…ç½®</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.sys_code </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;sysCode&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.desKey </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;desKey&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.phsId </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;phsId&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.host </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;host&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.token </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;token&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fallback</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        username </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;username&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fallback</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        password </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;password&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fallback</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        assert</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">            username </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> password </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        ), </span><span style="color:#98C379;">&quot;åˆå§‹åŒ–ï¼Œç”¨æˆ·å/è´¦å·å¯†ç å¿…ä¼ å…¥å…¶ä¸€&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.token:</span></span>
<span class="line"><span style="color:#ABB2BF;">            access_token </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(username, password)</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.token </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_he_ren_token</span><span style="color:#ABB2BF;">(access_token)</span></span>
<span class="line"><span style="color:#ABB2BF;">            config.</span><span style="color:#61AFEF;">set</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±Ÿè‹çœä¸­åŒ»é™¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;token&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token)</span></span>
<span class="line"><span style="color:#C678DD;">            with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;conf.ini&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;w&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;utf-8&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">                config.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(f)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è·å–tokenæˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> encrypt</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;font-style:italic;">        self</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">        key</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">        plaintext</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    ) -&gt; </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        Encrypts a plaintext string using DES</span></span>
<span class="line"><span style="color:#98C379;">        :param key:</span></span>
<span class="line"><span style="color:#98C379;">        :param plaintext:</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> key </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            key </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.desKey</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> plaintext </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            plaintext </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;1001035_&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        key </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> key.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        plaintext </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> plaintext.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        plaintext </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> pad</span><span style="color:#ABB2BF;">(plaintext, </span><span style="color:#D19A66;">DES</span><span style="color:#ABB2BF;">.block_size)</span></span>
<span class="line"><span style="color:#ABB2BF;">        cipher </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> DES</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">new</span><span style="color:#ABB2BF;">(key, </span><span style="color:#D19A66;">DES</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">MODE_ECB</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        ciphertext </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cipher.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(plaintext)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> base64.</span><span style="color:#61AFEF;">encodebytes</span><span style="color:#ABB2BF;">(ciphertext).</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;utf-8&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_hospital</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">          è·å–åŒ»åŒºä¿¡æ¯</span></span>
<span class="line"><span style="color:#98C379;">        :return:é™¢åŒºä¿¡æ¯</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-base/getHospital&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">({</span><span style="color:#98C379;">&quot;args&quot;</span><span style="color:#ABB2BF;">: {</span><span style="color:#98C379;">&quot;sysCode&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sys_code}, </span><span style="color:#98C379;">&quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token})</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_deptlist</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">hos_id</span><span style="color:#ABB2BF;">: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">]) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–ç§‘å®¤åˆ—è¡¨</span></span>
<span class="line"><span style="color:#98C379;">        :param hos_id:åŒ»é™¢id</span></span>
<span class="line"><span style="color:#98C379;">        :return: ç§‘å®¤åˆ—è¡¨</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-reg/reg/getDeptList&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#98C379;">                &quot;args&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;clinicalType&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;hosId&quot;</span><span style="color:#ABB2BF;">: hos_id,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;sysCode&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sys_code,</span></span>
<span class="line"><span style="color:#ABB2BF;">                },</span></span>
<span class="line"><span style="color:#98C379;">                &quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token,</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;dataList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_dept_sch_for_doc</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">args</span><span style="color:#ABB2BF;">: DeptSchForDocArgs) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–åŒ»ç”Ÿä¿¡æ¯</span></span>
<span class="line"><span style="color:#98C379;">        :param args: è¯·æ±‚å‚æ•°</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        args.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;args&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#56B6C2;">                **</span><span style="color:#ABB2BF;">args.</span><span style="color:#61AFEF;">dict</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#98C379;">            &quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(payload)</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-reg/reg/getDeptSchForDoc&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;schDocResultList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_doc_sch</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">arg</span><span style="color:#ABB2BF;">: DocSchArgs):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–åŒ»ç”Ÿæ’ç­ä¿¡æ¯</span></span>
<span class="line"><span style="color:#98C379;">        :param arg: è¯·æ±‚å‚æ•°</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-reg/reg/getDocSch&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;args&quot;</span><span style="color:#ABB2BF;">: {</span><span style="color:#56B6C2;">**</span><span style="color:#ABB2BF;">arg.</span><span style="color:#61AFEF;">dict</span><span style="color:#ABB2BF;">()}, </span><span style="color:#98C379;">&quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token}</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(payload)</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;dataList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_pat_card_list</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">list</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–å°±è¯Šå¡ï¼Œå³æŒ‚å·äººä¿¡æ¯</span></span>
<span class="line"><span style="color:#98C379;">        :param args:è¯·æ±‚å‚æ•°</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;args&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#98C379;">                &quot;sysCode&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.sys_code,</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#98C379;">            &quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(payload)</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-base/relevantPatient/getPatCardList&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> add_reg</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">args</span><span style="color:#ABB2BF;">: AddRegArgs) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        æäº¤è®¢å•</span></span>
<span class="line"><span style="color:#98C379;">        :param args: è¯·æ±‚å‚æ•°</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        args.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#98C379;">                &quot;args&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#56B6C2;">                    **</span><span style="color:#ABB2BF;">args.</span><span style="color:#61AFEF;">dict</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#ABB2BF;">                },</span></span>
<span class="line"><span style="color:#98C379;">                &quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token,</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-reg/reg/addReg&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(response.text)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_verification_code</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">) -&gt; [</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–éªŒè¯ç </span></span>
<span class="line"><span style="color:#98C379;">        :return: srt:verifyCode,uniqueId</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;http://wechat.jshtcm.com/cas-wechat/*.jsonRequest&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [{}]</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(payload)</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;X-Service-Id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cas-wechat.smsService&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;X-Service-Method&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;getVerifyCodeInfo&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;è·å–éªŒè¯ç å¤±è´¥&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        body </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;body&quot;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">        verifyCode </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> body[</span><span style="color:#98C379;">&quot;verifyCode&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        uniqueId </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> body[</span><span style="color:#98C379;">&quot;uniqueId&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        verifyCode </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> base64.</span><span style="color:#61AFEF;">b64decode</span><span style="color:#ABB2BF;">(verifyCode)</span></span>
<span class="line"><span style="color:#ABB2BF;">        verifyCode </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ocr.</span><span style="color:#61AFEF;">classification</span><span style="color:#ABB2BF;">(verifyCode)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> verifyCode, uniqueId</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">username</span><span style="color:#ABB2BF;">: Union[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">], </span><span style="color:#D19A66;font-style:italic;">password</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ç™»å½•</span></span>
<span class="line"><span style="color:#98C379;">        :param username: ç”¨æˆ·å/æ‰‹æœºå·</span></span>
<span class="line"><span style="color:#98C379;">        :param password: å¯†ç </span></span>
<span class="line"><span style="color:#98C379;">        :return:accessToken</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> type</span><span style="color:#ABB2BF;">(username) </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            username </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(username)</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;http://wechat.jshtcm.com/cas-wechat/logon/login&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        verifyCode, uniqueId </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_verification_code</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#98C379;">                &quot;tenantId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;hcn.jsszyy&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;pwd&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#61AFEF;">md5</span><span style="color:#ABB2BF;">(password.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">()).</span><span style="color:#61AFEF;">hexdigest</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">                &quot;forAccessToken&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;rid&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;patient&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;verifyCode&quot;</span><span style="color:#ABB2BF;">: verifyCode,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;uniqueId&quot;</span><span style="color:#ABB2BF;">: uniqueId,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;loginName&quot;</span><span style="color:#ABB2BF;">: username,</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> Exception(</span></span>
<span class="line"><span style="color:#ABB2BF;">                response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#98C379;"> &quot;ç™»å½•å¤±è´¥&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;properties&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;accessToken&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_he_ren_token</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">x_access_token</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–æ‚£è€…ç«¯token</span></span>
<span class="line"><span style="color:#98C379;">        :param x_access_token:ç™»é™†åçš„token</span></span>
<span class="line"><span style="color:#98C379;">        :return:token</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;http://wechat.jshtcm.com/cas-wechat/*.jsonRequest&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">([{</span><span style="color:#98C379;">&quot;openId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">}])</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;X-Service-Method&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;getHeRenToken&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;X-Access-Token&quot;</span><span style="color:#ABB2BF;">: x_access_token,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;X-Service-Id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cas-wechat.heRenService&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;body&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @exception_handler</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_number_source</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">args</span><span style="color:#ABB2BF;">: NumberSourceArgs) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–é¢„çº¦æ—¶é—´</span></span>
<span class="line"><span style="color:#98C379;">        :param args:</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;args&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#56B6C2;">                **</span><span style="color:#ABB2BF;">args.</span><span style="color:#61AFEF;">dict</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#98C379;">            &quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.token,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        payload </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(payload)</span></span>
<span class="line"><span style="color:#ABB2BF;">        headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsSign&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#98C379;">            &quot;phsId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.phsId,</span></span>
<span class="line"><span style="color:#98C379;">            &quot;Content-Type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.host</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/phs-reg/reg/getNumberSource&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">request</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;POST&quot;</span><span style="color:#ABB2BF;">, url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">payload)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">            str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;200&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            and</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        ):</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;msg&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    api </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Api</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(api.</span><span style="color:#61AFEF;">get_hospital</span><span style="color:#ABB2BF;">())</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™ä¸ª Python è„šæœ¬å®šä¹‰äº†ä¸€ä¸ªåä¸º Api çš„ç±»ï¼Œè¯¥ç±»å°è£…äº†ä¸åŒ»é™¢ç³»ç»Ÿçš„ API äº¤äº’åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç™»å½•ã€è·å–åŒ»é™¢ä¿¡æ¯ã€è·å–ç§‘å®¤åˆ—è¡¨ã€è·å–åŒ»ç”Ÿæ’ç­ä¿¡æ¯ã€è·å–é¢„çº¦æ—¶é—´æ®µç­‰ã€‚è¿™é‡Œå¯¹ä»£ç è¿›è¡Œäº†é€è¡Œç¿»è¯‘å’Œè§£é‡Šï¼š</p><p><strong>å¯¼å…¥ä¾èµ–å’Œåˆå§‹åŒ–å¯¹è±¡</strong></p><p>- ä½¿ç”¨äº† <code>pydantic</code> æ¨¡å—æ¥å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œ<code>requests</code> ç”¨äºå‘é€ HTTP è¯·æ±‚ï¼Œ<code>Crypto</code> ç”¨äºæ•°æ®åŠ å¯†ï¼Œ<code>ddddocr</code> ç”¨äºéªŒè¯ç è¯†åˆ«ï¼Œ<code>configparser</code> ç”¨äºé…ç½®æ–‡ä»¶ç®¡ç†ã€‚</p><p>- å®ä¾‹åŒ–äº†éªŒè¯ç è¯†åˆ«å¯¹è±¡ <code>ocr</code> å’Œé…ç½®è§£æå¯¹è±¡ <code>config</code>ã€‚</p><p><strong>å¼‚å¸¸å¤„ç†è£…é¥°å™¨ <code>exception_handler</code></strong></p><p>- å®šä¹‰äº†ä¸€ä¸ªè£…é¥°å™¨ç”¨äºæ•è·å’Œå¤„ç†å‡½æ•°è¿è¡Œä¸­çš„å¼‚å¸¸ï¼Œå¦‚æœå‡½æ•°è¿è¡Œå¤±è´¥ï¼Œåˆ™åœ¨ 5 ç§’åé‡è¯•ï¼Œæœ€å¤šé‡è¯• 3 æ¬¡ã€‚</p><p><strong>Api ç±»çš„å®šä¹‰</strong></p><p>- <code>__init__</code> æ–¹æ³•åˆå§‹åŒ– API ç±»ï¼Œä»é…ç½®æ–‡ä»¶è¯»å–å¿…è¦çš„é…ç½®é¡¹ï¼Œå¦‚ç³»ç»Ÿä»£ç ã€åŠ å¯†å¯†é’¥ç­‰ï¼Œå¹¶å°è¯•ç™»å½•è·å– tokenã€‚</p><p>- <code>encrypt</code> æ–¹æ³•ä½¿ç”¨ DES åŠ å¯†ç®—æ³•åŠ å¯†æ–‡æœ¬ã€‚</p><p><strong>API äº¤äº’æ–¹æ³•</strong></p><p>- <code>get_hospital</code>ï¼šè·å–åŒ»é™¢ä¿¡æ¯ã€‚</p><p>- <code>get_deptlist</code>ï¼šæ ¹æ®åŒ»é™¢ ID è·å–ç§‘å®¤åˆ—è¡¨ã€‚</p><p>- <code>get_dept_sch_for_doc</code>ï¼šè·å–æŒ‡å®šç§‘å®¤çš„åŒ»ç”Ÿæ’ç­ä¿¡æ¯ã€‚</p><p>- <code>get_doc_sch</code>ï¼šè·å–æŒ‡å®šåŒ»ç”Ÿçš„è¯¦ç»†æ’ç­ä¿¡æ¯ã€‚</p><p>- <code>get_pat_card_list</code>ï¼šè·å–æ‚£è€…çš„å°±è¯Šå¡åˆ—è¡¨ï¼Œç”¨äºæŒ‚å·ã€‚</p><p>- <code>add_reg</code>ï¼šæäº¤é¢„çº¦æŒ‚å·è¯·æ±‚ã€‚</p><p>- <code>get_verification_code</code>ï¼šè·å–éªŒè¯ç ä¿¡æ¯ï¼Œç”¨äºç™»å½•éªŒè¯ã€‚</p><p>- <code>login</code>ï¼šç”¨æˆ·ç™»å½•ï¼Œéœ€è¦å¤„ç†éªŒè¯ç ã€‚</p><p>- <code>get_he_ren_token</code>ï¼šè·å–ç™»å½•åçš„æ‚£è€…ç«¯ tokenï¼Œç”¨äºåç»­çš„ API è¯·æ±‚ã€‚</p><p>- <code>get_number_source</code>ï¼šè·å–æŒ‡å®šæ¡ä»¶ä¸‹çš„å¯é¢„çº¦æ—¶é—´æ®µã€‚</p><p><strong>ä¸»å‡½æ•°</strong></p><p>- å®ä¾‹åŒ– Api ç±»å¹¶è°ƒç”¨ get_hospital æ–¹æ³•æ‰“å°åŒ»é™¢ä¿¡æ¯ã€‚</p><p><strong>æ³¨æ„ç‚¹</strong></p><p>- æ­¤ä»£ç ä¾èµ–äºå¤–éƒ¨çš„é…ç½®æ–‡ä»¶ (conf.ini) å’Œç½‘ç»œ APIã€‚åœ¨è¿è¡Œä¹‹å‰ï¼Œéœ€è¦ç¡®ä¿æ‰€æœ‰çš„é…ç½®éƒ½å·²æ­£ç¡®è®¾ç½®ï¼Œå¹¶ä¸”ç›¸å…³çš„ç½‘ç»œ API å¯ç”¨ã€‚</p><p>- ä½¿ç”¨äº† DES åŠ å¯†å’Œ Base64 ç¼–ç æ¥å¤„ç†æŸäº›æ•æ„Ÿä¿¡æ¯ã€‚</p><p>- é‡‡ç”¨äº†é‡è¯•æœºåˆ¶æ¥å¤„ç†ç½‘ç»œè¯·æ±‚ä¸­å¯èƒ½é‡åˆ°çš„ä¸´æ—¶é”™è¯¯ã€‚</p><p><strong>conf.ini å…¨æ–‡ä»£ç å¦‚ä¸‹</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">[æ±Ÿè‹çœä¸­åŒ»é™¢]host </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> https:</span><span style="color:#56B6C2;">//</span><span style="color:#ABB2BF;">www.rjh.com.cn</span><span style="color:#56B6C2;">/</span><span style="color:#ABB2BF;">deskey </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wewerwephsid </span><span style="color:#56B6C2;">=</span><span style="color:#FFFFFF;"> 4546554654syscode</span><span style="color:#56B6C2;"> =</span><span style="color:#FFFFFF;"> 15654654645username</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> è´¦å·password </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> å¯†ç token </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> token</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>æ³¨æ„ï¼šé¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œéœ€è¦ä¿®æ”¹çš„é…ç½®æ˜¯<code>username</code>,<code>password</code>,<code>token</code>ã€‚å¦‚æœç›´æ¥ä½¿ç”¨<code>token</code>åˆ™æ— éœ€<code>username</code>,<code>passwordï¼Œ</code>å…¶ä»–é…ç½®åŸºæœ¬ä¸éœ€è¦æ”¹åŠ¨ã€‚</p><p><strong>å¦‚ä½•å¯åŠ¨è¿è¡Œ</strong>ï¼š</p><p>å°†æ‰€æœ‰æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œ å¯åŠ¨è¿è¡Œ<strong>main.py</strong>å³å¯ã€‚</p><h1 id="tao-å®ç§’æ€æ´»åŠ¨è„šæœ¬" tabindex="-1">tao å®ç§’æ€æ´»åŠ¨è„šæœ¬ <a class="header-anchor" href="#tao-å®ç§’æ€æ´»åŠ¨è„šæœ¬" aria-label="Permalink to &quot;tao å®ç§’æ€æ´»åŠ¨è„šæœ¬&quot;">â€‹</a></h1><h3 id="taobo-py" tabindex="-1">taobo.py <a class="header-anchor" href="#taobo-py" aria-label="Permalink to &quot;taobo.py&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> time </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> sleep</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> webdriver</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.common.exceptions </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> WebDriverException</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.by </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> By</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support.ui </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> WebDriverWait</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> expected_conditions </span><span style="color:#C678DD;">as</span><span style="color:#D19A66;"> EC</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.utils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> notify_user</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.utils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> build_chrome_options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æŠ¢è´­å¤±è´¥æœ€å¤§æ¬¡æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">max_retry_count </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 30</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è‡ªåŠ¨æŠ¢ç¥¨ç±»ï¼ˆæ·˜å®ï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> TaoBao</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">chrome_path</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;./chromedriver.exe&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">seckill_time_str</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">password</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é©±åŠ¨è·¯å¾„</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.chrome_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> chrome_path</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æŠ¢è´­æ—¶é—´</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.seckill_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(seckill_time_str, </span><span style="color:#98C379;">&#39;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ”¯ä»˜å¯†ç </span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.password </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> password</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # chromeé©±åŠ¨</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è·å–chromeé©±åŠ¨</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> start_driver</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            driver </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">find_chromedriver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> WebDriverException:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Unable to find chromedriver, Please check the drive path.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å¯»æ‰¾chromeé©±åŠ¨ï¼ˆé¦–å…ˆå»pythonå®‰è£…ç›®å½•ä¸‹æ‰¾ï¼Œå…¶æ¬¡å†å»ä¼ å…¥çš„è·¯å¾„æ‰¾ï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> find_chromedriver</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Chrome</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> WebDriverException:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Chrome</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">executable_path</span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.chrome_path, </span><span style="color:#E06C75;font-style:italic;">chrome_options</span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;">build_chrome_options</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> WebDriverException:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;Unable to find chromedriver, Please check the drive path.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç™»å½•æ·˜å®</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">login_url</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;https://www.taobao.com&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">login_time_out</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> login_url:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">start_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;Please input the login url.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ‰“å¼€é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(login_url)</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å°è¯•è·å–ç‚¹å‡»ç™»å½•è¶…é“¾æ¥</span></span>
<span class="line"><span style="color:#ABB2BF;">                a_lists </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;//div[@class=&quot;site-nav-sign&quot;]/a&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è·å–åˆ°äº†ï¼Œè¯´æ˜è¿˜æœªç™»å½•ï¼Œè¿›è¡Œç™»å½•</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(a_lists) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡ç™»å½•ï¼Œå¼€å§‹ç‚¹å‡»ç™»å½•æŒ‰é’®...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # äº²ï¼Œè¯·ç™»å½•</span></span>
<span class="line"><span style="color:#ABB2BF;">                    login_button </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> a_lists[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    login_button.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·åœ¨</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">så†…æ‰«ç ç™»é™†!!&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(login_time_out))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ç¡çœ login_time_out(s)</span></span>
<span class="line"><span style="color:#61AFEF;">                    sleep</span><span style="color:#ABB2BF;">(login_time_out)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # å°è¯•è·å–ç™»å½•æˆåŠŸé¡µé¢çš„å…ƒç´ ï¼Œæ‰¾åˆ°äº†è¡¨ç¤ºå·²ç»ç™»å½•æˆåŠŸã€‚</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;//*[@id=&quot;J_SiteNavMytaobao&quot;]/div[1]/a/span&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç™»é™†æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # è¿›å…¥è´­ç‰©è½¦</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://cart.taobao.com/cart.htm&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # ç»“æŸå¾ªç¯</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç™»é™†å¤±è´¥, åˆ·æ–°é‡è¯•, è¯·å°½å¿«ç™»é™†!!!&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                        continue</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e))</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç­‰å¾…æŠ¢è´­</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> keep_wait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç­‰å¾…åˆ°ç‚¹æŠ¢è´­...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è·å–å½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">            current_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å¦‚æœè·ç¦»æŠ¢è´­æ—¶é—´å¤§äº3åˆ†é’Ÿï¼Œåˆ™æ¯åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡ç•Œé¢ï¼Œé˜²æ­¢ç™»å½•è¶…æ—¶ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_time </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> current_time).seconds </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 180</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è¿›å…¥è´­ç‰©è½¦</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://cart.taobao.com/cart.htm&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ¯åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡ç•Œé¢ï¼Œé˜²æ­¢ç™»å½•è¶…æ—¶...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">                sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è°ƒç”¨å‡½æ•°ï¼Œå°†æµè§ˆå™¨cookieå†™å…¥æ–‡ä»¶å¤‡ç”¨ã€‚</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_cookie</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢è´­æ—¶é—´ç‚¹å°†è¿‘ï¼Œåœæ­¢è‡ªåŠ¨åˆ·æ–°ï¼Œå‡†å¤‡è¿›å…¥æŠ¢è´­é˜¶æ®µ...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æŠ¢è´­æ—¶é—´å°†è¿‘ï¼Œç»“æŸç­‰å¾…æŠ¢è´­</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æŠ¢è´­çš„å…¥å£å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> sec_kill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">login_time_out</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ­¤æ¬¡æŠ¢è´­æ—¶é—´ï¼š</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(datetime.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill_time, </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è°ƒç”¨ç™»å½•å‡½æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">login_time_out</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">login_time_out)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è°ƒç”¨ç­‰å¾…æŠ¢è´­å‡½æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">keep_wait</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è·å–å…¨é€‰æ¡†</span></span>
<span class="line"><span style="color:#ABB2BF;">        select_all </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">ID</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;J_SelectAll1&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> select_all:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å½“å‰æœªé€‰çŠ¶æ€ï¼Œè‡ªåŠ¨é€‰æ‹©å…¨éƒ¨å•†å“&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç‚¹å‡»å…¨é€‰</span></span>
<span class="line"><span style="color:#ABB2BF;">            select_all.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²ç»é€‰ä¸­å…¨éƒ¨å•†å“ï¼ï¼ï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è®°å½•æäº¤çŠ¶æ€</span></span>
<span class="line"><span style="color:#ABB2BF;">        submit_success </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é‡è¯•æŠ¢è´­æ¬¡æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">        retry_count </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è·å–å½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">            now </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> now </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.seckill_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å¼€å§‹æŠ¢è´­, å°è¯•æ¬¡æ•°ï¼š </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(retry_count </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç¡çœ ä¸€æ®µæ—¶é—´,é˜²æ­¢cpuä¸€ç›´å·¥ä½œ</span></span>
<span class="line"><span style="color:#61AFEF;">                sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç­‰å¾…ç»“ç®—æŒ‰é’®å¯ä»¥è¢«ç‚¹å‡»</span></span>
<span class="line"><span style="color:#ABB2BF;">                button </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">poll_frequency</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;#J_SmallSubmit&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç‚¹å‡»ç»“ç®—</span></span>
<span class="line"><span style="color:#ABB2BF;">                button.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²ç»ç‚¹å‡»ç»“ç®—æŒ‰é’®...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç­‰å¾…è·³è½¬åˆ°æäº¤è®¢å•æŒ‰é’®å¯ä»¥è¢«ç‚¹å‡»</span></span>
<span class="line"><span style="color:#ABB2BF;">                submit </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">poll_frequency</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;#submitOrderPC_1 &gt; div &gt; a.go-btn&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç‚¹å‡»æäº¤è®¢å•</span></span>
<span class="line"><span style="color:#ABB2BF;">                submit.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·²ç»ç‚¹å‡»æäº¤è®¢å•æŒ‰é’®...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è®°å½•æäº¤çŠ¶æ€</span></span>
<span class="line"><span style="color:#ABB2BF;">                submit_success </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é€€å‡ºå¾ªç¯</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¸´æ—¶å†™çš„è„šæœ¬, å¯èƒ½å‡ºäº†ç‚¹é—®é¢˜!!!&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                retry_count </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> retry_count </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> max_retry_count:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é‡è¯•æŠ¢è´­æ¬¡æ•°è¾¾åˆ°ä¸Šé™ï¼Œæ”¾å¼ƒé‡è¯•...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    break</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æäº¤æˆåŠŸ,å‡†å¤‡æ”¯ä»˜</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> submit_success:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.password:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pay</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> pay</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç­‰å¾…å¯†ç æ¡†åŠ è½½å®Œæ¯•</span></span>
<span class="line"><span style="color:#ABB2BF;">            element </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;sixDigitPassword&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è¾“å…¥å¯†ç </span></span>
<span class="line"><span style="color:#ABB2BF;">            element.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.password)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¯†ç è¾“å…¥å®Œæˆ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç­‰å¾…ç¡®è®¤ä»˜æ¬¾æŒ‰é’®åŠ è½½å®Œæˆ,å¹¶ä»˜æ¬¾</span></span>
<span class="line"><span style="color:#61AFEF;">            WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;#J_authSubmit&#39;</span><span style="color:#ABB2BF;">))).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä»˜æ¬¾æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            notify_user</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#61AFEF;">            notify_user</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;å•†å“æŠ¢è´­å¤±è´¥&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        finally</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;20såå…³é—­æµè§ˆå™¨...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_cookie</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        å°†æµè§ˆå™¨cookieå­˜å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è·å–æµè§ˆå™¨cookiesï¼ˆdictç±»å‹ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">        cookies </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get_cookies</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å°†cookieè½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²ï¼Œå¹¶å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">        cookie_json </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(cookies)</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;./tb_cookies.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;w&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">            f.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(cookie_json)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œä½¿ç”¨äº† Selenium åº“æ¥æ¨¡æ‹Ÿåœ¨ç½‘é¡µä¸Šçš„ç”¨æˆ·æ“ä½œï¼Œç›®çš„æ˜¯è‡ªåŠ¨å®Œæˆæ·˜å®çš„æŠ¢è´­è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬ç™»å½•ã€ç­‰å¾…æŠ¢è´­æ—¶é—´ã€é€‰è´­å•†å“ã€ç»“ç®—ã€æäº¤è®¢å•ä»¥åŠæ”¯ä»˜ã€‚ä»¥ä¸‹æ˜¯å¯¹è¿™ä¸ªè„šæœ¬å…³é”®éƒ¨åˆ†çš„é€æ­¥åˆ†æï¼š</p><p><strong>ç±»ç»“æ„å’Œåˆå§‹åŒ–</strong></p><p>- <code>TaoBao</code>ç±»åˆå§‹åŒ–æ—¶ï¼Œéœ€è¦æŒ‡å®š Chrome é©±åŠ¨çš„è·¯å¾„ã€æŠ¢è´­æ—¶é—´å’Œæ”¯ä»˜å¯†ç ã€‚</p><p>- <code>chrome_path</code>ç”¨äºæŒ‡å®š ChromeDriver çš„è·¯å¾„ï¼Œ<code>seckill_time</code>ä¸ºæŠ¢è´­æ—¶é—´ï¼Œ<code>password</code>ä¸ºæ”¯ä»˜å¯†ç ã€‚</p><p><strong>æ–¹æ³•è§£æ</strong></p><p>- <code>start_driver()</code>: åˆå§‹åŒ–å’Œå¯åŠ¨ Selenium WebDriverã€‚å¦‚æœåœ¨ç³»ç»Ÿé»˜è®¤è·¯å¾„ä¸‹æ‰¾ä¸åˆ° ChromeDriverï¼Œåˆ™ä¼šå°è¯•ä»<code>chrome_path</code>æŒ‡å®šçš„è·¯å¾„åŠ è½½ã€‚</p><p>- <code>find_chromedriver()</code>: å°è¯•åœ¨ç³»ç»Ÿé»˜è®¤è·¯å¾„å’Œæä¾›çš„<code>chrome_path</code>ä¸­å¯»æ‰¾å¹¶å¯åŠ¨ ChromeDriverã€‚</p><p>- <code>login()</code>: æ‰“å¼€æ·˜å®ä¸»é¡µï¼Œå°è¯•é€šè¿‡æ‰«ç ç™»å½•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå…è®¸ç”¨æˆ·æ‰«ç ç™»å½•ã€‚å¦‚æœç™»å½•æˆåŠŸï¼Œåˆ™è·³è½¬åˆ°è´­ç‰©è½¦é¡µé¢ã€‚</p><p>- <code>keep_wait()</code>: åœ¨æŠ¢è´­æ—¶é—´ä¹‹å‰ï¼Œè¯¥æ–¹æ³•ä¼šæŒç»­åˆ·æ–°é¡µé¢ï¼Œé˜²æ­¢ç™»å½•è¶…æ—¶ã€‚å½“æ¥è¿‘æŠ¢è´­æ—¶é—´æ—¶ï¼Œåœæ­¢åˆ·æ–°ï¼Œå‡†å¤‡æŠ¢è´­ã€‚</p><p>- <code>sec_kill()</code>: æŠ¢è´­çš„ä¸»è¦é€»è¾‘ã€‚åœ¨è®¾å®šçš„æŠ¢è´­æ—¶é—´ç‚¹åˆ°è¾¾æ—¶ï¼Œå°è¯•å…¨é€‰è´­ç‰©è½¦ä¸­çš„å•†å“å¹¶è¿›è¡Œç»“ç®—å’Œæäº¤è®¢å•ã€‚</p><p>- <code>pay()</code>: å¦‚æœæäº¤è®¢å•æˆåŠŸï¼Œè¯¥æ–¹æ³•ä¼šå°è¯•è‡ªåŠ¨å¡«å†™æ”¯ä»˜å¯†ç å¹¶å®Œæˆæ”¯ä»˜ã€‚</p><p>- <code>get_cookie()</code>: è·å–å½“å‰ä¼šè¯çš„ cookie å¹¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œè¿™å¯èƒ½ç”¨äºåç»­çš„ä¼šè¯æ¢å¤æˆ–åˆ†æã€‚</p><p><strong>æŠ¢è´­æµç¨‹</strong></p><ol><li>ç™»å½•: ä½¿ç”¨æ‰«ç ç™»å½•æ·˜å®ã€‚</li><li>ç­‰å¾…æŠ¢è´­æ—¶é—´: åœ¨æŠ¢è´­æ—¶é—´åˆ°æ¥ä¹‹å‰ï¼Œå®šæœŸåˆ·æ–°é¡µé¢ä»¥ç»´æŒä¼šè¯çŠ¶æ€ã€‚</li><li>æ‰§è¡ŒæŠ¢è´­: åœ¨è®¾å®šçš„æŠ¢è´­æ—¶é—´ï¼Œè‡ªåŠ¨é€‰æ‹©è´­ç‰©è½¦ä¸­çš„æ‰€æœ‰å•†å“ï¼Œç‚¹å‡»ç»“ç®—å¹¶æäº¤è®¢å•ã€‚</li><li>æ”¯ä»˜: åœ¨è®¢å•æäº¤åï¼Œè‡ªåŠ¨å¡«å†™æ”¯ä»˜å¯†ç å¹¶å°è¯•æ”¯ä»˜ã€‚</li></ol><p><strong>å¼‚å¸¸å¤„ç†</strong></p><p>- ä»£ç ä¸­åŒ…å«äº†å¤šå¤„å¼‚å¸¸å¤„ç†ï¼Œä»¥åº”å¯¹åœ¨ç™»å½•ã€é€‰æ‹©å•†å“ã€ç»“ç®—å’Œæ”¯ä»˜è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚</p><h3 id="main-py-ä»£ç å¦‚ä¸‹" tabindex="-1">main.py ä»£ç å¦‚ä¸‹ <a class="header-anchor" href="#main-py-ä»£ç å¦‚ä¸‹" aria-label="Permalink to &quot;main.py ä»£ç å¦‚ä¸‹&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tkinter </span><span style="color:#C678DD;">import</span><span style="color:#56B6C2;"> *</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tkinter.ttk </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Combobox</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> seckill.taobao </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> TaoBao</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> run_killer</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">time</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">password</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">platform</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æŠ¢è´­æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">    seckill_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ”¯ä»˜å¯†ç </span></span>
<span class="line"><span style="color:#ABB2BF;">    password </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(password.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å¹³å°ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">    platform </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> platform.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(seckill_time, password)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> platform </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;æ·˜å®&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">        TaoBao</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">seckill_time_str</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">seckill_time, </span><span style="color:#E06C75;font-style:italic;">password</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">password).</span><span style="color:#61AFEF;">sec_kill</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">login_time_out</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;æœªçŸ¥å¹³å°ç±»å‹&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    win </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Tk</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    win.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç”µå•†ç§’æ€åŠ©æ‰‹&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    win.</span><span style="color:#61AFEF;">iconbitmap</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;img/icon.ico&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    width </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 540</span></span>
<span class="line"><span style="color:#ABB2BF;">    height </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 350</span></span>
<span class="line"><span style="color:#ABB2BF;">    screenwidth </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> win.</span><span style="color:#61AFEF;">winfo_screenwidth</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    screenheight </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> win.</span><span style="color:#61AFEF;">winfo_screenheight</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    align_str </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">x</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">+</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">+</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> (width, height, (screenwidth </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> width) </span><span style="color:#56B6C2;">/</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">, (screenheight </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> height) </span><span style="color:#56B6C2;">/</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    win.</span><span style="color:#61AFEF;">geometry</span><span style="color:#ABB2BF;">(align_str)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è®¾ç½®å¼€æŠ¢æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">    label1 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;å¼€æŠ¢æ—¶é—´:&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    label1.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    start_time </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> StringVar</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    time </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Entry</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">textvariable</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">start_time, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">23</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;blue&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    start_time.</span><span style="color:#61AFEF;">set</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ”¯ä»˜å¯†ç </span></span>
<span class="line"><span style="color:#ABB2BF;">    label2 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æ”¯ä»˜å¯†ç :&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    label2.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    password </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Entry</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">23</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">show</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;*&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;blue&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    password.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é€‰æ‹©å¹³å°</span></span>
<span class="line"><span style="color:#ABB2BF;">    label3 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æŠ¢è´­å¹³å°:&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    label3.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    platform_value </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> StringVar</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    platform </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Combobox</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">textvariable</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">platform_value, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    platform[</span><span style="color:#98C379;">&quot;values&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&quot;æ·˜å®&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ª</span></span>
<span class="line"><span style="color:#ABB2BF;">    platform.</span><span style="color:#61AFEF;">current</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    platform.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å¼€å§‹æŠ¢è´­</span></span>
<span class="line"><span style="color:#ABB2BF;">    b1 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Button</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;å¼€å§‹æŠ¢è´­&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                command</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">lambda</span><span style="color:#ABB2BF;">: </span><span style="color:#61AFEF;">run_killer</span><span style="color:#ABB2BF;">(time, password, platform),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                background</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;green&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">21</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    b1.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">320</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    win.</span><span style="color:#61AFEF;">resizable</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä½¿ç”¨è¯´æ˜</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt0 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;ä½¿ç”¨è¯´æ˜:&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">11</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt0.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    txt1 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;1ã€å®‰è£…chromeæµè§ˆå™¨ä»¥åŠchromeDriverï¼ˆæ”¾ç½®åœ¨pythonå®‰è£…æ ¹ç›®å½•ä¸‹ï¼‰&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt1.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">180</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    txt2 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;2ã€æŠ¢è´­å‰è¦æ¸…ç©ºè´­ç‰©è½¦ï¼Œç„¶åæŠŠè¦æŠ¢çš„ä¸œè¥¿åŠ å…¥è´­ç‰©è½¦&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt2.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">205</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    txt3 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;3ã€å¼€æŠ¢æ—¶é—´å¿…é¡»æ˜¯ %Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S å½¢å¼ï¼Œå¦‚2020-12-29 12:10:15&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt3.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    txt4 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;4ã€è¾“å…¥å¼€æŠ¢æ—¶é—´å’Œæ”¯ä»˜å¯†ç åç‚¹å¼€å§‹ï¼Œç¨‹åºä¼šæ§åˆ¶æµè§ˆå™¨æ‰“å¼€æ·˜å®ç™»é™†é¡µ&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt4.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    txt5 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;5ã€æ‰«ç ç™»é™†åï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ·æ–°è´­ç‰©è½¦é¡µé¢ï¼Œåˆ°ç‚¹ä¼šå®ŒæˆæŠ¢è´­åŠ¨ä½œ&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt5.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">280</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    txt6 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Label</span><span style="color:#ABB2BF;">(win, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;6ã€å¦‚æœæƒ³æ‰‹åŠ¨ä»˜æ¬¾ï¼Œè¾“å…¥å¼€æŠ¢æ—¶é—´åä¸ç”¨è¾“å…¥æ”¯ä»˜å¯†ç ï¼Œç›´æ¥ç‚¹å¼€å§‹å°±å¯ä»¥äº†&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Lucida Grande&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                 fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;green&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    txt6.</span><span style="color:#61AFEF;">place</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">305</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    win.</span><span style="color:#61AFEF;">mainloop</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">    main</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªåŸºäº Tkinter GUI çš„ç”µå•†ç§’æ€åŠ©æ‰‹åº”ç”¨ï¼Œç”¨äºè‡ªåŠ¨åŒ–å¤„ç†äº¬ä¸œå’Œæ·˜å®çš„å•†å“æŠ¢è´­è¿‡ç¨‹ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™ä¸ªç•Œé¢è®¾ç½®æŠ¢è´­æ—¶é—´ã€æ”¯ä»˜å¯†ç ï¼Œå¹¶é€‰æ‹©æŠ¢è´­å¹³å°ï¼ˆæ·˜å®ï¼‰ã€‚ä¸‹é¢æ˜¯å¯¹è¿™æ®µä»£ç çš„å…·ä½“åˆ†æï¼š</p><p><strong>ä¸»è¦åŠŸèƒ½</strong></p><ol><li>GUI è®¾ç½®ï¼šä½¿ç”¨ Tkinter åˆ›å»ºå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ŒåŒ…æ‹¬è¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†å’ŒæŒ‰é’®ï¼Œå…è®¸ç”¨æˆ·è¾“å…¥æŠ¢è´­çš„è¯¦ç»†ä¿¡æ¯ã€‚</li><li>æŠ¢è´­æ—¶é—´å’Œæ”¯ä»˜å¯†ç è¾“å…¥ï¼šç”¨æˆ·å¯ä»¥è¾“å…¥å…·ä½“çš„æŠ¢è´­æ—¶é—´å’Œæ”¯ä»˜å¯†ç ã€‚</li><li>å¹³å°é€‰æ‹©ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡ä¸‹æ‹‰èœå•é€‰æ‹©è¦æŠ¢è´­çš„ç”µå•†å¹³å°ï¼Œç›®å‰æ”¯æŒæ·˜å®å’Œå…¶ä»–ã€‚</li><li>å¼€å§‹æŠ¢è´­æŒ‰é’®ï¼šç‚¹å‡»åæ ¹æ®è¾“å…¥çš„æ—¶é—´ã€å¯†ç å’Œé€‰æ‹©çš„å¹³å°æ‰§è¡ŒæŠ¢è´­æ“ä½œã€‚</li></ol><p><strong>ä»£ç ç»“æ„è§£æ</strong></p><p>- run_killer() å‡½æ•°ï¼šæ ¹æ®ç”¨æˆ·åœ¨ GUI ä¸­è®¾ç½®çš„æ—¶é—´ã€å¯†ç å’Œå¹³å°ï¼Œå®ä¾‹åŒ–ç›¸åº”çš„äº¬ä¸œæˆ–æ·˜å®ç§’æ€ç±»ï¼Œå¹¶è°ƒç”¨å…¶<code>sec_kill()</code>æ–¹æ³•å¼€å§‹æŠ¢è´­ã€‚</p><p>- main() å‡½æ•°ï¼šè®¾ç½® GUI çª—å£ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„æ ‡ç­¾ã€è¾“å…¥æ¡†ã€æŒ‰é’®å’Œæ–‡æœ¬è¯´æ˜ã€‚æ­¤å¤–ï¼Œè¿˜è®¾å®šäº†çª—å£çš„å¤§å°å’Œä½ç½®ã€‚</p><p><strong>GUI ç»„ä»¶</strong></p><p>- æ—¶é—´è¾“å…¥ï¼šä½¿ç”¨<code>Entry</code>ç»„ä»¶è®©ç”¨æˆ·è¾“å…¥æŠ¢è´­çš„å…·ä½“æ—¶é—´ã€‚</p><p>- å¯†ç è¾“å…¥ï¼šä½¿ç”¨<code>Entry</code>ç»„ä»¶è®©ç”¨æˆ·è¾“å…¥æ”¯ä»˜å¯†ç ï¼Œè¾“å…¥æ˜¾ç¤ºä¸ºæ˜Ÿå·(*)ä»¥ä¿å¯†ã€‚</p><p>- å¹³å°é€‰æ‹©ï¼šä½¿ç”¨<code>Combobox</code>ç»„ä»¶è®©ç”¨æˆ·é€‰æ‹©æŠ¢è´­å¹³å°ã€‚</p><p>- å¼€å§‹æŒ‰é’®ï¼šä½¿ç”¨<code>Button</code>ç»„ä»¶ï¼Œç”¨æˆ·ç‚¹å‡»åè°ƒç”¨<code>run_killer()</code>å‡½æ•°ã€‚</p><p><strong>ä½¿ç”¨è¯´æ˜</strong></p><p>ç•Œé¢ä¸‹æ–¹æä¾›äº†è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼ŒåŒ…æ‹¬å¦‚ä½•è®¾ç½®æ—¶é—´ã€æ¸…ç©ºè´­ç‰©è½¦ã€æ‰«ç ç™»å½•ç­‰æ­¥éª¤ã€‚</p><h3 id="ä»£ç è¿è¡Œæµç¨‹" tabindex="-1">ä»£ç è¿è¡Œæµç¨‹ <a class="header-anchor" href="#ä»£ç è¿è¡Œæµç¨‹" aria-label="Permalink to &quot;ä»£ç è¿è¡Œæµç¨‹&quot;">â€‹</a></h3><ol><li>è¿è¡Œç¨‹åºåï¼Œæ˜¾ç¤ºä¸»çª—å£ã€‚</li><li>ç”¨æˆ·è¾“å…¥æŠ¢è´­æ—¶é—´ã€æ”¯ä»˜å¯†ç ï¼ˆå¯é€‰ï¼‰ã€‚</li><li>é€‰æ‹©æŠ¢è´­å¹³å°ã€‚</li><li>ç‚¹å‡»å¼€å§‹æŠ¢è´­ï¼Œç¨‹åºä¼šåœ¨åå°æ ¹æ®è®¾å®šçš„æ—¶é—´è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œç™»å½•å¹¶æ‰§è¡ŒæŠ¢è´­åŠ¨ä½œã€‚</li></ol><h3 id="æ³¨æ„äº‹é¡¹-2" tabindex="-1">æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-2" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h3><p>- ç¡®ä¿å·²å®‰è£… Chrome æµè§ˆå™¨åŠå¯¹åº”ç‰ˆæœ¬çš„ ChromeDriverï¼Œå¹¶æ”¾ç½®åœ¨åˆé€‚çš„è·¯å¾„ä¸‹ã€‚</p><p>- ä½¿ç”¨å‰ç¡®ä¿è´­ç‰©è½¦æ˜¯æ¸…ç©ºçš„ï¼ŒæŠ¢è´­å‰å°†å•†å“åŠ å…¥è´­ç‰©è½¦ã€‚</p><p>- è¾“å…¥æ—¶é—´æ ¼å¼å¿…é¡»ç¬¦åˆ<code>%Y-%m-%d %H:%M:%S</code>ï¼Œä¾‹å¦‚<code>2024-04-24 23:10:15</code>ã€‚</p><p>æ­¤ä»£ç æä¾›äº†ä¸€ä¸ªåŸºæœ¬çš„è‡ªåŠ¨åŒ–ç§’æ€å·¥å…·çš„æ¡†æ¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´å’Œæ‰©å±•åŠŸèƒ½ã€‚</p><h1 id="xiao-ç±³æœ‰å“é¢„çº¦æŸå°è„šæœ¬" tabindex="-1">xiao ç±³æœ‰å“é¢„çº¦æŸå°è„šæœ¬ <a class="header-anchor" href="#xiao-ç±³æœ‰å“é¢„çº¦æŸå°è„šæœ¬" aria-label="Permalink to &quot;xiao ç±³æœ‰å“é¢„çº¦æŸå°è„šæœ¬&quot;">â€‹</a></h1><p><strong>ä¸»è¦ä»£ç å¦‚ä¸‹</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> base64</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> functools</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json,sys,hashlib</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pickle</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;">  urllib.parse</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> multiprocessing</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> encrpty </span><span style="color:#C678DD;">import</span><span style="color:#56B6C2;"> *</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> mi_logger </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logger</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> timer </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Timer</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> config </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> global_config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> concurrent.futures </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ProcessPoolExecutor</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> util </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">    parse_json,</span></span>
<span class="line"><span style="color:#ABB2BF;">    send_wechat,</span></span>
<span class="line"><span style="color:#ABB2BF;">    wait_some_time,</span></span>
<span class="line"><span style="color:#ABB2BF;">    get_random_useragent</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">ä¸»è¦ç”¨åˆ°çš„åŠ å¯†ç®—æ³•æœ‰ä¸¤ä¸ªï¼š</span></span>
<span class="line"><span style="color:#98C379;">1ã€ç™»å½•æ¥å£çš„åŠ å¯†ç®—æ³•ï¼ŒåŒ…æ‹¬è¯·æ±‚å¤´å’Œbodyï¼Œå…·ä½“åŠ å¯†é€»è¾‘åœ¨å…¶ä»–æ–‡ä»¶ã€‚</span></span>
<span class="line"><span style="color:#98C379;">2ã€æŠ¢è´­ã€é¢„çº¦çš„å…¥å‚åŠ å¯†ï¼ŒåŒ…æ‹¬ yp-srsã€ yp-ssã€ yp-srtä¸‰ä¸ªå€¼ã€‚</span></span>
<span class="line"><span style="color:#98C379;">å…·ä½“åŠ å¯†é€»è¾‘æ¯”è¾ƒæ•æ„Ÿï¼Œæš‚ä¸å…¬å¼€ã€‚</span></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> MiSeckill</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">object</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;"> , </span><span style="color:#D19A66;font-style:italic;">user_name</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # åˆå§‹åŒ–ä¿¡æ¯</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.act_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> global_config.</span><span style="color:#61AFEF;">getRaw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;config&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;act_id&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.timers </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Timer</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.spider_session </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> SpiderSession</span><span style="color:#ABB2BF;">(user_name)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">load_cookies_from_local</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.login </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Login</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.spider_session,user_name)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">get_session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.user_agent </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.spider_session.user_agent</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.locationUrl </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login_by_accountAndPassword</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ç™»é™†</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.login.is_login:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç™»å½•æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.login.</span><span style="color:#61AFEF;">login_by_accountAndPassword</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.login.is_login:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            #å°†cookieè®°å½•åœ¨æœ¬åœ°</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.spider_session.</span><span style="color:#61AFEF;">save_cookies_to_local</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.login.nickName)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è´¦å·å¯†ç ç™»å½•å¤±è´¥ï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> check_login</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">func</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        ç”¨æˆ·ç™»é™†æ€æ ¡éªŒè£…é¥°å™¨ã€‚è‹¥ç”¨æˆ·æœªç™»é™†ï¼Œåˆ™è°ƒç”¨ç™»é™†</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">        @functools</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">wraps</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">func</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        def</span><span style="color:#61AFEF;"> new_func</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, *</span><span style="color:#D19A66;font-style:italic;">args</span><span style="color:#ABB2BF;">, **</span><span style="color:#D19A66;font-style:italic;">kwargs</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.login.is_login:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login_by_accountAndPassword</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#61AFEF;"> func</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">, *args, **kwargs)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> new_func</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @check_login</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> appoint</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        é¢„çº¦</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_appoint</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> getSignByData</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #æ ¸å¿ƒåŠ å¯†ï¼Œéšè—</span></span>
<span class="line"><span style="color:#C678DD;">        pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        re </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#98C379;">            &#39;yp-srt&#39;</span><span style="color:#ABB2BF;">:xxx,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;yp-srs&#39;</span><span style="color:#ABB2BF;">: xxx,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;yp-ss&#39;</span><span style="color:#ABB2BF;">: xxx</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> isAppoint</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ ¸å¿ƒä»£ç éšè—</span></span>
<span class="line"><span style="color:#C678DD;">        pass</span></span>
<span class="line"><span style="color:#ABB2BF;">        re </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;xxxxxxxxxxxxx&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                               data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(data), </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">header)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;success&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;">  re.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;userStatusInfo&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;userStatusInfo&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ordered&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è·å–ä»Šæ—¥å•†å“ä¿¡æ¯å‡ºé”™ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œã€‚&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;">  False</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _appoint</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getTodayActid</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isAppoint</span><span style="color:#ABB2BF;">() :</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---------æ‚¨å·²é¢„çº¦æˆåŠŸï¼Œæ— éœ€å†æ¬¡é¢„çº¦ï¼----------&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        nowtime </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [{}, {</span><span style="color:#98C379;">&quot;actId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.act_id, </span><span style="color:#98C379;">&quot;tel&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">}]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #è·å–æ ¡éªŒæ‰€éœ€åŠ å¯†å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">        signDict </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">  self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSignByData</span><span style="color:#ABB2BF;">(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        headerPhone </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;accept&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;*/*&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;accept-encoding&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;gzip, deflate, br&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;accept-language&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;zh-CN,zh;q=0.9&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;content-type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            ,</span><span style="color:#98C379;">&quot;referer&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.locationUrl</span></span>
<span class="line"><span style="color:#ABB2BF;">            ,</span><span style="color:#98C379;">&quot;user-agent&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;X-Requested-With&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;XMLHttpRequest&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;yp-srs&quot;</span><span style="color:#ABB2BF;">: signDict[</span><span style="color:#98C379;">&#39;yp-srs&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;yp-ss&quot;</span><span style="color:#ABB2BF;">: signDict[</span><span style="color:#98C379;">&#39;yp-ss&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;yp-srt&quot;</span><span style="color:#ABB2BF;">: signDict[</span><span style="color:#98C379;">&#39;yp-srt&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        re </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://m.xiaomiyoupin.com/mtop/act/orderspike/order?_=&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(nowtime),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                               data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(data),</span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headerPhone)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(re.text).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(re.text).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---------é¢„çº¦æˆåŠŸï¼Œè®°å¾—æŒ‰æ—¶æŠ¢è´­å“¦ï¼----------&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å½“å‰é¢„çº¦äººæ•°ä¸ºï¼š</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(re.text).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;orderCount&quot;</span><span style="color:#ABB2BF;">) ))</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é¢„çº¦å¤±è´¥ï¼Œè¿”å›ç»“æœä¸ºï¼š</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(re.text)))</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @check_login</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> seckill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        æŠ¢è´­</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_seckill</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> seckill_by_proc_pool</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">work_count</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        å¤šè¿›ç¨‹è¿›è¡ŒæŠ¢è´­</span></span>
<span class="line"><span style="color:#98C379;">        work_countï¼šè¿›ç¨‹æ•°é‡</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        multiprocessing.</span><span style="color:#61AFEF;">freeze_support</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#61AFEF;"> ProcessPoolExecutor</span><span style="color:#ABB2BF;">(work_count) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pool:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(work_count):</span></span>
<span class="line"><span style="color:#ABB2BF;">                pool.</span><span style="color:#61AFEF;">submit</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.seckill)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> getUserlevel</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;"> :</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ ¸å¿ƒä»£ç éšè—</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"><span style="color:#ABB2BF;">            re </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;xxxx&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(data),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                                   headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">header)</span></span>
<span class="line"><span style="color:#ABB2BF;">            re </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;userLevelVO&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # logger.info(re)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> re:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è·å–ç”¨æˆ·å“å€¼ä¸ºï¼š&quot;</span><span style="color:#56B6C2;">+str</span><span style="color:#ABB2BF;">(re.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">))</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;, æ´»è·ƒåº¦ï¼š&quot;</span><span style="color:#56B6C2;">+str</span><span style="color:#ABB2BF;">(re.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;activity&quot;</span><span style="color:#ABB2BF;">))</span><span style="color:#56B6C2;">+</span></span>
<span class="line"><span style="color:#98C379;">                        &quot;, åèª‰å€¼ï¼š&quot;</span><span style="color:#56B6C2;">+str</span><span style="color:#ABB2BF;">(re.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;reputation&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e :</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è·å–ç”¨æˆ·å“å€¼å‡ºç°å¼‚å¸¸ã€</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">ã€‘&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(e))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> getTodayActid</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;"> :</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            #æ ¸å¿ƒä»£ç éšè—</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            ###è¿”å›302è½¬è·³é“¾æ¥</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> re.headers.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.locationUrl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.headers.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Location&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                urlparse </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> urllib.parse.</span><span style="color:#61AFEF;">urlparse</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.locationUrl)</span></span>
<span class="line"><span style="color:#ABB2BF;">                query_dict </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> urllib.parse.</span><span style="color:#61AFEF;">parse_qs</span><span style="color:#ABB2BF;">(urlparse.query)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.act_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> query_dict.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;actId&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è·å–åˆ°ä»Šæ—¥é£å¤©èŒ…å°å•†å“idä¸º -----&gt; </span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.act_id))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            ##è®¿é—®ä¸€æ¬¡æŠ¢è´­é¡µé¢</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.locationUrl)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e :</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è·å–å½“å¤©å•†å“idå‡ºé”™ï¼š</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(e))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> _seckill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        æŠ¢è´­</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        a</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getUserlevel</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getTodayActid</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.timers.</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¬¬</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">æ¬¡æŠ¢è´­ã€‚&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(a))</span></span>
<span class="line"><span style="color:#ABB2BF;">                    flag </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">startKill</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    #æŠ¢è´­æˆåŠŸç›´æ¥è¿”å›ï¼Œå¤±è´¥ç»§ç»­</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> flag :</span></span>
<span class="line"><span style="color:#C678DD;">                        return</span></span>
<span class="line"><span style="color:#ABB2BF;">                    a </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> a </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;">                    wait_some_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> a</span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;"> :</span></span>
<span class="line"><span style="color:#ABB2BF;">                        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å¤±è´¥,æ˜å¤©ç»§ç»­åŠªåŠ›ã€‚&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                        return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŠ¢è´­å‘ç”Ÿå¼‚å¸¸ï¼Œç¨åç»§ç»­æ‰§è¡Œï¼&#39;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"><span style="color:#61AFEF;">            wait_some_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> startKill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [{}, {</span><span style="color:#98C379;">&quot;actId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.act_id,</span></span>
<span class="line"><span style="color:#98C379;">                     &quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.act_id}]</span></span>
<span class="line"><span style="color:#ABB2BF;">        reDict </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSignByData</span><span style="color:#ABB2BF;">(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        trustType </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> xxx</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        headerPhone </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &quot;accept&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;*/*&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;accept-encoding&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;gzip, deflate, br&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;accept-language&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;zh-CN,zh;q=0.9&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;content-type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;application/json&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            ,</span><span style="color:#98C379;">&quot;referer&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.locationUrl</span></span>
<span class="line"><span style="color:#ABB2BF;">            ,</span><span style="color:#98C379;">&quot;user-agent&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.user_agent</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;X-Requested-With&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;XMLHttpRequest&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;c&quot;</span><span style="color:#ABB2BF;">: xxxx</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;d&quot;</span><span style="color:#ABB2BF;">: xxxx</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;yp-srs&quot;</span><span style="color:#ABB2BF;">: reDict[</span><span style="color:#98C379;">&#39;yp-srs&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;yp-ss&quot;</span><span style="color:#ABB2BF;">: reDict[</span><span style="color:#98C379;">&#39;yp-ss&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            , </span><span style="color:#98C379;">&quot;yp-srt&quot;</span><span style="color:#ABB2BF;">: reDict[</span><span style="color:#98C379;">&#39;yp-srt&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        re </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;https://m.xiaomiyoupin.com/mtop/act/orderspike/ekips?_=&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                               data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">json.</span><span style="color:#61AFEF;">dumps</span><span style="color:#ABB2BF;">(data), </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headerPhone)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(re.text).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;"> :</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(re.text).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;-------------æˆåŠŸå•¦ï¼Œè¯·ä½œè€…å–æ¯å’–å•¡å§ï¼ï¼ï¼---------------&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢è´­å¤±è´¥:ã€</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">ã€‘&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(re.text.</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> False</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br></div></div><h3 id="è¯´æ˜-1" tabindex="-1">è¯´æ˜ <a class="header-anchor" href="#è¯´æ˜-1" aria-label="Permalink to &quot;è¯´æ˜&quot;">â€‹</a></h3><p>è¿™ä¸ªè„šæœ¬æ˜¯ä¸€ä¸ªç”¨äºå°ç±³æœ‰å“çš„ç§’æ€åŠ©æ‰‹ï¼ŒåŸºäº Python ç¼–å†™ï¼Œä½¿ç”¨äº†å¤šä¸ªåº“å’Œå·¥å…·æ¥å¤„ç†ç™»å½•ã€é¢„çº¦ã€å’Œç§’æ€æµç¨‹ã€‚ä¸‹é¢è¯¦ç»†è§£æå„éƒ¨åˆ†çš„åŠŸèƒ½å’Œå·¥ä½œæœºåˆ¶ï¼š</p><p><strong>å¯¼å…¥çš„åº“å’Œæ¨¡å—</strong></p><p>- <code>base64</code>, <code>random</code>, <code>time</code>, <code>requests</code>, <code>functools</code>, <code>json</code>, <code>sys</code>, <code>hashlib</code>, <code>os</code>, <code>pickle</code>, <code>urllib.parse</code>, <code>multiprocessing</code>: è¿™äº›æ˜¯ Python æ ‡å‡†åº“ï¼Œç”¨äºå¤„ç†æ•°æ®ç¼–ç ã€æ—¶é—´æ“ä½œã€ç½‘ç»œè¯·æ±‚ã€åŠŸèƒ½æ‰©å±•ã€æ•°æ®åºåˆ—åŒ–å’Œå¹¶è¡Œè®¡ç®—ã€‚</p><p>- <code>encrpty</code>, <code>mi_logger</code>, <code>timer</code>, <code>config</code>, <code>util</code>: è¿™äº›æ˜¯è‡ªå®šä¹‰æ¨¡å—ï¼Œåˆ†åˆ«å¤„ç†åŠ å¯†ã€æ—¥å¿—è®°å½•ã€è®¡æ—¶ã€é…ç½®ç®¡ç†å’Œä¸€äº›å®ç”¨åŠŸèƒ½ï¼Œå¦‚è§£æ JSONã€å‘é€å¾®ä¿¡é€šçŸ¥ã€ç­‰å¾…éšæœºæ—¶é—´ã€è·å–éšæœºç”¨æˆ·ä»£ç†ç­‰ã€‚</p><p><strong>æ ¸å¿ƒç±»ï¼š<code>MiSeckill</code></strong></p><p>è¿™ä¸ªç±»æ˜¯ç§’æ€æµç¨‹çš„ä¸»ä½“ï¼ŒåŒ…å«äº†ç™»å½•ã€é¢„çº¦ã€ç§’æ€ç­‰åŠŸèƒ½çš„å®ç°ã€‚</p><p>- åˆå§‹åŒ– (<code>__init__</code>): è®¾ç½®æ´»åŠ¨ IDã€è®¡æ—¶å™¨ã€ä¼šè¯ç®¡ç†ã€ç”¨æˆ·ä»£ç†ç­‰ã€‚</p><p>- ç™»å½• (<code>login_by_accountAndPassword</code>): å°è¯•é€šè¿‡è´¦å·å’Œå¯†ç ç™»å½•ï¼Œå¹¶åœ¨æˆåŠŸåä¿å­˜ cookie åˆ°æœ¬åœ°ã€‚</p><p>- ç™»å½•æ ¡éªŒè£…é¥°å™¨ (<code>check_login</code>): ä¸€ä¸ªè£…é¥°å™¨ï¼Œç”¨äºç¡®ä¿åœ¨æ‰§è¡Œä»»ä½•éœ€è¦ç™»å½•çš„æ“ä½œå‰ç”¨æˆ·å·²ç»ç™»å½•ã€‚</p><p>- é¢„çº¦ (<code>appoint</code>): æ‰§è¡Œé¢„çº¦åŠ¨ä½œï¼Œå¦‚æœç”¨æˆ·å·²ç»é¢„çº¦åˆ™ä¸å†é‡å¤é¢„çº¦ã€‚</p><p>- è·å–ç­¾å (<code>getSignByData</code>): ç”¨äºç”Ÿæˆè¯·æ±‚çš„ç­¾åï¼Œè¿™æ˜¯ç§’æ€ä¸­é˜²æ­¢è¯·æ±‚ä¼ªé€ çš„å…³é”®æ­¥éª¤ï¼Œå®ç°ç»†èŠ‚æœªå…¬å¼€ã€‚</p><p>- æ£€æŸ¥é¢„çº¦çŠ¶æ€ (<code>isAppoint</code>): æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»æˆåŠŸé¢„çº¦ã€‚</p><p>- æ‰§è¡Œé¢„çº¦ (<code>_appoint</code>): åŒ…å«è·å–å½“æ—¥æ´»åŠ¨ ID å’Œæ£€æŸ¥é¢„çº¦çŠ¶æ€çš„é€»è¾‘ã€‚</p><p>- ç§’æ€ (<code>seckill</code>): æ‰§è¡Œç§’æ€åŠ¨ä½œã€‚</p><p>- <strong>å¤šè¿›ç¨‹ç§’æ€</strong> (<code>seckill_by_proc_pool</code>): ä½¿ç”¨å¤šè¿›ç¨‹æ¥åŒæ—¶æ‰§è¡Œå¤šä¸ªç§’æ€ä»»åŠ¡ï¼Œæé«˜æˆåŠŸç‡ã€‚</p><p>- è·å–ç”¨æˆ·ç­‰çº§ (<code>getUserlevel</code>): è·å–ç”¨æˆ·åœ¨å°ç±³æœ‰å“ä¸Šçš„ç­‰çº§å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ï¼Œå¯èƒ½ç”¨äºä¼˜å…ˆçº§åˆ¤æ–­ã€‚</p><p>- è·å–å½“æ—¥æ´»åŠ¨ ID (<code>getTodayActid</code>): è·å–å½“å¤©çš„æ´»åŠ¨ IDï¼Œè¿™æ˜¯è¿›è¡Œç§’æ€æ‰€å¿…éœ€çš„ã€‚</p><p>- å®é™…æ‰§è¡Œç§’æ€ (<code>_seckill</code>): åŒ…æ‹¬ç”¨æˆ·ç­‰çº§è·å–ã€æ´»åŠ¨ ID è·å–ã€ä»¥åŠåå¤å°è¯•ç§’æ€çš„å¾ªç¯é€»è¾‘ã€‚</p><p>- å¼€å§‹ç§’æ€ (<code>startKill</code>): æ ¹æ®æä¾›çš„æ•°æ®ç”Ÿæˆç­¾åï¼Œæ„é€ è¯·æ±‚å¤´ï¼Œç„¶åå‘é€ç§’æ€è¯·æ±‚ã€‚</p><h3 id="å®é™…ä½¿ç”¨" tabindex="-1">å®é™…ä½¿ç”¨ <a class="header-anchor" href="#å®é™…ä½¿ç”¨" aria-label="Permalink to &quot;å®é™…ä½¿ç”¨&quot;">â€‹</a></h3><p>è¿™ä¸ªè„šæœ¬é…ç½®äº†å¤šçº¿ç¨‹è¿è¡Œæ–¹å¼ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªè´¦æˆ·åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œä»è€ŒåŒæ—¶æ‰§è¡Œå¤šä¸ªç§’æ€ä»»åŠ¡ã€‚ä½¿ç”¨äº† ProcessPoolExecutor æ¥ç®¡ç†è¿›ç¨‹æ± ï¼Œè¿™æ˜¯ Python <code>concurrent.futures</code>æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºç®€åŒ–å¹¶è¡Œæ‰§è¡Œçš„å¤æ‚æ€§ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-3" tabindex="-1">æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-3" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h3><p>- è¯¥è„šæœ¬æ¶‰åŠåŠ å¯†å’Œç½‘ç»œè¯·æ±‚ï¼Œè¿™å¯èƒ½å—åˆ°æ³•å¾‹å’Œé“å¾·çš„é™åˆ¶ï¼Œç‰¹åˆ«æ˜¯åœ¨è‡ªåŠ¨åŒ–è´­ä¹°ï¼ˆç§’æ€ï¼‰å’Œè‡ªåŠ¨ç™»å½•ç­‰é¢†åŸŸã€‚ä½¿ç”¨æ­¤ç±»è„šæœ¬å¯èƒ½è¿åæœåŠ¡æä¾›å•†çš„ä½¿ç”¨æ¡æ¬¾ã€‚- ç§’æ€è¡Œä¸ºå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå‹åŠ›ï¼Œä¸”åœ¨ç«äº‰æ¿€çƒˆçš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´è´¦æˆ·è¢«æš‚æ—¶æˆ–æ°¸ä¹…å°ç¦ã€‚</p><h1 id="hua-ä¸ºå•†åŸæŠ¢è´­æ‰‹æœºè„šæœ¬" tabindex="-1">hua ä¸ºå•†åŸæŠ¢è´­æ‰‹æœºè„šæœ¬ <a class="header-anchor" href="#hua-ä¸ºå•†åŸæŠ¢è´­æ‰‹æœºè„šæœ¬" aria-label="Permalink to &quot;hua ä¸ºå•†åŸæŠ¢è´­æ‰‹æœºè„šæœ¬&quot;">â€‹</a></h1><p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Python å’Œ Selenium åº“ç¼–å†™çš„è‡ªåŠ¨åŒ–è„šæœ¬</p><h3 id="å…¨ä»£ç å¦‚ä¸‹-1" tabindex="-1">å…¨ä»£ç å¦‚ä¸‹ï¼š <a class="header-anchor" href="#å…¨ä»£ç å¦‚ä¸‹-1" aria-label="Permalink to &quot;å…¨ä»£ç å¦‚ä¸‹ï¼š&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#   coding = utf-8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#############ç”¨æˆ·é…ç½®####################################</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è´¦å·å¯†ç </span></span>
<span class="line"><span style="color:#D19A66;">ACCOUNTS</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">    &quot;åä¸ºè´¦æˆ·è´¦å·/ç”µè¯/é‚®ç®±&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è´¦æˆ·å¯†ç &quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># chrome driverè·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">chrome_driver </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/usr/local/bin/chromedriver&quot;</span><span style="color:#7F848E;font-style:italic;">   # Macç¤ºä¾‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># chrome_driver = &quot;C:\Google\ChromeApplication\chromedriver.exe&quot;   # Windowsç¤ºä¾‹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">personalDataPath </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/Users/zhangliang/Downloads/BUY-HW-master/Default&quot;</span><span style="color:#7F848E;font-style:italic;">  # Chromeçš„ä¸ªäººèµ„æ–™è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ‰‹æœºé“¾æ¥</span></span>
<span class="line"><span style="color:#D19A66;">BUY_URL</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;https://www.vmall.com/product/10086232069466.html&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¼€å§‹è‡ªåŠ¨åˆ·æ–°ç­‰å¾…æŠ¢è´­æŒ‰é’®å‡ºç°çš„æ—¶é—´ç‚¹,å»ºè®®æå‰10-30sï¼Œå¹¶æå‰2-5åˆ†é’Ÿå¯åŠ¨pythonè„šæœ¬ï¼Œç¡®ä¿ç™»é™†æˆåŠŸï¼Œè¿›å…¥é¡µé¢ã€‚</span></span>
<span class="line"><span style="color:#D19A66;">BEGIN_GO</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;2024-04-22 10:07:50&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦å¯åŠ¨è‡ªåŠ¨é€‰æ‰‹æœºå‚æ•°ã€‚1ä¸ºå¼€å¯ï¼Œ0ä¸ºå…³é—­ã€‚å½“ä¸å¯ç”¨æ—¶ï¼Œæ— éœ€å¡«å†™ä¸‹é¢çš„å‚æ•°ï¼Œæ­¤æ—¶æŠ¢è´­ä¼šé»˜è®¤ç½‘é¡µä¸Šçš„é»˜(ç¬¬ä¸€ä¸ªé¢œè‰²ã€ç‰ˆæœ¬ã€å¥—é¤)ã€‚è‹¥ä¸éœ€è¦è¯·å…³é—­æ­¤é€‰é¡¹èƒ½åŠ å¿«é€Ÿåº¦ã€‚</span></span>
<span class="line"><span style="color:#D19A66;">AUTO_SELECT</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦å¯åŠ¨è‡ªåŠ¨é€‰æ‰‹æœºé¢œè‰²</span></span>
<span class="line"><span style="color:#D19A66;">AUTO_COLOR</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦å¯åŠ¨è‡ªåŠ¨é€‰æ‰‹æœºç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#D19A66;">AUTO_EDITION</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦å¯åŠ¨è‡ªåŠ¨é€‰æ‰‹æœºå¥—é¤</span></span>
<span class="line"><span style="color:#D19A66;">AUTO_COMBO</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># é¢œè‰²ï¼Œä»…å½“AUTO_SELECT=1å’ŒAUTO_COLOR=1æ—¶æ‰éœ€è¦å†™</span></span>
<span class="line"><span style="color:#D19A66;">COLOR</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;ç¿¡å†·ç¿ &#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç‰ˆæœ¬ï¼Œä»…å½“AUTO_SELECT=1å’ŒAUTO_EDITION=1æ—¶æ‰éœ€è¦å†™</span></span>
<span class="line"><span style="color:#D19A66;">EDITION</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;5Gå…¨ç½‘é€š 8GB+256GB&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¥—é¤ï¼Œä»…å½“AUTO_SELECT=1å’ŒAUTO_COMBO=1æ—¶æ‰éœ€è¦å†™</span></span>
<span class="line"><span style="color:#D19A66;">COMBO</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;å®˜æ–¹æ ‡é…&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç™»é™†ä¿¡ä»» 0è¡¨ç¤ºä¸ä¿¡ä»»ï¼Œ1è¡¨ç¤ºä¿¡ä»»ã€‚ä¸€èˆ¬æ— éœ€æ”¹åŠ¨ã€‚è‹¥ä¿¡ä»»ï¼Œå½“æ‚¨ä¸‹æ¬¡ç™»å½•æ—¶ï¼Œç³»ç»Ÿå°†ä¸ä¼šè¦æ±‚æ‚¨æä¾›éªŒè¯ç ã€‚å¯¹äºHUAWEI STOREæ™®é€šç‰ˆè„šæœ¬ï¼Œæ¯æ¬¡è¿è¡Œè„šæœ¬å³åˆ›å»ºä¸€ä¸ªæ–°Chromeï¼Œä¿¡ä»»æ„ä¹‰ä¸å¤§ï¼Œé»˜è®¤ä¸º0ï¼Œå»ºè®®è®¾ç½®ä¸º0</span></span>
<span class="line"><span style="color:#D19A66;">TRUST</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">###############ç¨‹åºå¼€å§‹#################################</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.action_chains </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ActionChains</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> selenium</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> threading </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Thread</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> webdriver</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç™»å½•url,ä¸€èˆ¬æ— éœ€æ”¹åŠ¨</span></span>
<span class="line"><span style="color:#D19A66;">LOGIN_URL</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;https://hwid1.vmall.com/CAS/portal/login.html?validated=true&amp;themeName=red&amp;service=https%3A</span><span style="color:#D19A66;">%2F%2F</span><span style="color:#98C379;">www.vmall.com</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">account</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">acaslogin</span><span style="color:#D19A66;">%3F</span><span style="color:#98C379;">url%3Dhttps%253A</span><span style="color:#D19A66;">%252F%252F</span><span style="color:#98C379;">www.vmall.com</span><span style="color:#D19A66;">%252F</span><span style="color:#98C379;">&amp;loginChannel=26000000&amp;reqClientType=26&amp;lang=zh-cn&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¿›åˆ°è´­ä¹°é¡µé¢åæäº¤è®¢å•</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> submitOrder</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#D19A66;"> BUY_URL</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> driver.current_url:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:å½“å‰é¡µé¢è¿˜åœ¨å•†å“è¯¦æƒ…ï¼ï¼ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        goToBuy</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        order_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.current_url</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            submitOrder </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æäº¤è®¢å•&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            submitOrder.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:æˆåŠŸæäº¤è®¢å•&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            break</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:æäº¤ä¸äº†è®¢å•ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼å¿«å»è‡ªå·±æäº¤ï¼ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># åˆ°äº†è®¢å•æäº¤é¡µé¢æäº¤ä¸äº†è®¢å•ä¸€ç›´ç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;è¯·è‡ªè¡ŒæŸ¥çœ‹æäº¤ç»“æœï¼ï¼ç¨‹åº60såé€€å‡º&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ’é˜Ÿä¸­</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> onQueue</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    nowUrl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.current_url</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å¼€å§‹æ’é˜Ÿï¼š&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> BEGIN_GO</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        errorbutton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;boxCloseBtn&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> errorbutton.</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;style&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;display: none;&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">())</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;æŠ¢è´­å¤±è´¥ï¼Œå†è¯•ä¸€æ¬¡&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            goToBuy</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> nowUrl </span><span style="color:#56B6C2;">!=</span><span style="color:#ABB2BF;"> driver.current_url </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> driver.current_url </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> BUY_URL</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:æˆåŠŸï¼æ’é˜Ÿé¡µé¢è·³è½¬äº†!!!!!!!!!!!!!!&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">                submitOrder</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">())</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:æ’é˜Ÿä¸­&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ’é˜Ÿä¸­</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># é€‰æ‹©æ‰‹æœºè§„æ ¼</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> select</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#D19A66;"> AUTO_COLOR</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            color </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">COLOR</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            color.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">COLOR</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;é€‰æ‹©æˆåŠŸï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                color </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">COLOR</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                color.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">COLOR</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;é€‰æ‹©æˆåŠŸï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;é¢œè‰²é€‰æ‹©é”™è¯¯ï¼è¯·æ‰‹åŠ¨é€‰æ‹©ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;æ— éœ€é€‰æ‹©é¢œè‰²&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#D19A66;"> AUTO_EDITION</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            edition </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EDITION</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            edition.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">EDITION</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;é€‰æ‹©æˆåŠŸï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                edition </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EDITION</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                edition.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">EDITION</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;é€‰æ‹©æˆåŠŸï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;ç‰ˆæœ¬é€‰æ‹©é”™è¯¯ï¼è¯·æ‰‹åŠ¨é€‰æ‹©ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;æ— éœ€é€‰æ‹©ç‰ˆæœ¬&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#D19A66;"> AUTO_COMBO</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            combo </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">COMBO</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            combo.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">COMBO</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;é€‰æ‹©æˆåŠŸï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                combo </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">COMBO</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                combo.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">COMBO</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;é€‰æ‹©æˆåŠŸï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;å¥—é¤é€‰æ‹©é”™è¯¯ï¼è¯·æ‰‹åŠ¨é€‰æ‹©ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;æ— éœ€é€‰æ‹©å¥—é¤&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç™»å½•æˆåŠŸå»åˆ°è´­ä¹°é¡µé¢</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> goToBuy</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    autoSelect </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> AUTO_SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">BUY_URL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#D19A66;"> BUY_URL</span><span style="color:#56B6C2;"> !=</span><span style="color:#ABB2BF;"> driver.current_url:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">BUY_URL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;æ‰“å¼€è´­ä¹°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è½¬æ¢æˆæŠ¢è´­æ—¶é—´æˆ³</span></span>
<span class="line"><span style="color:#ABB2BF;">    timeArray </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">BEGIN_GO</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">mktime</span><span style="color:#ABB2BF;">(timeArray)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å†æ¬¡ç™»é™†</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        denglu1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_id</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;top-index-loginUrl&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        denglu1.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å·²ç»ç™»é™†&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç»“æŸæ ‡å¿—ä½</span></span>
<span class="line"><span style="color:#ABB2BF;">    over </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;">(autoSelect </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#61AFEF;">        select</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;è·³è¿‡é€‰æ‹©é…ç½®&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    isRemind </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å‡†å¤‡å®Œæ¯•ï¼Œå¼€å§‹ç­‰å¾…&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            isRemind </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> timestamp:  </span><span style="color:#7F848E;font-style:italic;"># åˆ°äº†æŠ¢è´­æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">            text </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                &#39;//*[@id=&quot;pro-operation&quot;]/a&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].text</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;å·²å”®å®Œ&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                over </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#ABB2BF;"> text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;ç«‹å³ç”³è´­&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                buyButton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç«‹å³ç”³è´­&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                isRemindd </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> buyButton.</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;class&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &#39;product-button02 disabled&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                            time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å¯ä»¥å¼€å§‹ç”³è´­ï¼Œç«‹å³ç”³è´­&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        buyButton.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                            textnext </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_elements_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                                &#39;//div[@id=&quot;pro-operation-countdown&quot;]/p&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].text</span></span>
<span class="line"><span style="color:#C678DD;">                            if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 2</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> isRemindd </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">, time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span></span>
<span class="line"><span style="color:#ABB2BF;">                                      user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å‡†å¤‡å¼€å§‹ä¸‹ä¸€è½®&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> textnext.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å¼€å”®:&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;çš„æŠ¢è´­&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                                isRemindd </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">                        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                            if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 2</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> isRemindd </span><span style="color:#56B6C2;">!=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                                    time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å‡†å¤‡å¼€å§‹ä¸‹ä¸€è½®çš„æŠ¢è´­&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                                isRemindd </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    buyButton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç«‹å³ç”³è´­&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#ABB2BF;"> text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;0å…ƒé¢„çº¦&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                buyButton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;0å…ƒé¢„çº¦&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:è¯·æ‰‹åŠ¨è¿›è¡Œé¢„çº¦ã€‚ç¨‹åºå°†åœ¨ä¸€åˆ†é’Ÿåé€€å‡º&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                buyButton.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#ABB2BF;"> text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;å‚ä¸é¢„çº¦&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                buyButton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å‚ä¸é¢„çº¦&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;:è¯·æ‰‹åŠ¨è¿›è¡Œé¢„çº¦ã€‚ç¨‹åºå°†åœ¨ä¸€åˆ†é’Ÿåé€€å‡º&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                buyButton.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                over </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> timestamp</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                isRemind </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">, time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span></span>
<span class="line"><span style="color:#ABB2BF;">                      user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;æœªåˆ°è„šæœ¬å¼€å¯æ—¶é—´ï¼Œè¯·é€‰æ‹©å¥½æŠ¢è´­çš„é¢œè‰²ã€ç‰ˆæœ¬ã€å¥—é¤ç­‰(è‹¥å·²ç»é…ç½®åˆ™å¿½ç•¥)ï¼Œå°†åœ¨è®¾å®šçš„è„šæœ¬å¯åŠ¨æ—¶é—´å‰15ç§’å¯åŠ¨&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;-&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.99</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#C678DD;"> or</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                isRemind </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 3</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;å³å°†å¼€å§‹æŠ¢è´­ï¼Œç¨‹åºå¯åŠ¨&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.05</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> over:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;å¾ˆé—æ†¾ï¼Œ&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                        time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">())</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;æŠ¢è´­ç»“æŸ,ç¨‹åºå°†åœ¨60såé€€å‡º&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">        exit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">        onQueue</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¿¡ä»»æµè§ˆå™¨(driver)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> trustdriver</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#D19A66;"> TRUST</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                trust </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;//div[@ht=&quot;click_dialog_leftbtn&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                trust.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;ä¸ä¿¡ä»»å‡ºé”™ï¼Œè¯·è‡ªè¡Œç‚¹å‡»ä¸ä¿¡ä»»&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#D19A66;"> TRUST</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                trust </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;//div[@ht=&quot;click_dialog_rightbtn&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                trust.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;ä¿¡ä»»å‡ºé”™ï¼Œè¯·è‡ªè¡Œç‚¹å‡»ä¿¡ä»»&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‘é€éªŒè¯ç </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> sendcode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        isGetVerification </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">            &#39;//div[@ht=&quot;click_authentication_getAuthcode&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        number </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//div[@id=&quot;accountDiv&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> isGetVerification.text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;è·å–éªŒè¯ç &#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        isGetVerification.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> number </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;éªŒè¯ç å·²ç»å‘é€&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(user</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;éªŒè¯ç å·²ç»å‘é€è‡³&#39;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">number.text)</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            inputdiv </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                &#39;//input[@ht=&quot;input_authentication_authcode&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            inputdiv.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è‡ªåŠ¨ç‚¹å‡»è¾“å…¥æ¡†</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç™»å½•å•†åŸ,ç™»é™†æˆåŠŸåè‡³å•†åŸé¦–é¡µç„¶åè·³è½¬è‡³æŠ¢è´­é¡µé¢</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> loginMall</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">pwd</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    option </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">ChromeOptions</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    argument </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;--user-data-dir=&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> personalDataPath</span></span>
<span class="line"><span style="color:#ABB2BF;">    option.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(argument)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é…ç½®æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Chrome</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">executable_path</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">chrome_driver, </span><span style="color:#E06C75;font-style:italic;">options</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">option)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;webDriveræ‰“å¼€æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">LOGIN_URL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ‰“å¼€ç™»é™†é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ</span></span>
<span class="line"><span style="color:#ABB2BF;">        account </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">            &#39;//input[@ht=&quot;input_pwdlogin_account&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        account.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(user)</span></span>
<span class="line"><span style="color:#ABB2BF;">        password </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">            &#39;//input[@ht=&quot;input_pwdlogin_pwd&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        password.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(pwd)</span></span>
<span class="line"><span style="color:#ABB2BF;">        denglu </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">            &#39;//div[@ht=&quot;click_pwdlogin_submitLogin&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        ActionChains</span><span style="color:#ABB2BF;">(driver).</span><span style="color:#61AFEF;">move_to_element</span><span style="color:#ABB2BF;">(denglu).</span><span style="color:#61AFEF;">perform</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        denglu.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;æˆåŠŸè¾“å…¥äº†è´¦å·å¯†ç ï¼Œå°è¯•ç™»é™†.&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;è´¦å·å¯†ç ä¸èƒ½è¾“å…¥,è¯·æ‰‹åŠ¨è¾“å…¥å¹¶ç™»é™†ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    isRemind </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">    islogin </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#98C379;"> &quot;ç™»å½•&quot;</span><span style="color:#C678DD;"> not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> driver.title:  </span><span style="color:#7F848E;font-style:italic;"># é¡µé¢è·³è½¬ç™»é™†æˆåŠŸ</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;ç™»å½•æˆåŠŸï¼ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            goToBuy</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#C678DD;">            break</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># æ²¡æœ‰ç™»é™†æˆåŠŸ</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> isRemind </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(user </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;è¯·æ‰‹åŠ¨å®Œæˆè®¤è¯å¹¶ç™»é™†ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                isRemind </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># åˆ¤æ–­æ˜¯å¦åœ¨è·å–éªŒè¯ç ç•Œé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">                isGetVerification </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;//div[@class=&quot;hwid-dialog-header paddingBottom18&quot;]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> isGetVerification.text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;èº«ä»½éªŒè¯&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">                    sendcode</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    islogin </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    denglu </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_link_text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç™»é™†&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    denglu.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(denglu)</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.05</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> islogin </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># åˆ¤æ–­æ˜¯å¦åœ¨ä¿¡ä»»æµè§ˆå™¨ç•Œé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">                    isGetVerification </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                        &#39;//div[@class=&quot;hwid-dialog-header paddingBottom40&quot;]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#98C379;"> &#39;æ˜¯å¦ä¿¡ä»»æ­¤æµè§ˆå™¨&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> isGetVerification.text:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        islogin </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#61AFEF;">                        trustdriver</span><span style="color:#ABB2BF;">(driver, user)</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.05</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> islogin </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> or</span><span style="color:#ABB2BF;"> islogin </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                error </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    error </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver.</span><span style="color:#61AFEF;">find_element_by_xpath</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                        &#39;//div[@class=&quot;marginTB8 hwid-input-msg-error&quot;]&#39;</span><span style="color:#ABB2BF;">).text</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(error)</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#98C379;"> &#39;å›¾å½¢éªŒè¯ç &#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> error:</span></span>
<span class="line"><span style="color:#C678DD;">                    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        denglu.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                    except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                elif</span><span style="color:#98C379;"> &#39;è¾ƒä¸ºé¢‘ç¹&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> error:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;éªŒè¯ç è·å–é¢‘ç¹ï¼Œè¯·ä¸€å°æ—¶åå†è¯•ï¼Œæˆ–è€…ä½¿ç”¨HUAWEI STORE GO DEVç‰ˆä¿¡ä»»æµè§ˆå™¨&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;60såç¨‹åºé€€å‡º&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">                    exit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è´¦å·å¯†ç </span></span>
<span class="line"><span style="color:#ABB2BF;">    data </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> ACCOUNTS</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ„å»ºçº¿ç¨‹</span></span>
<span class="line"><span style="color:#ABB2BF;">    threads </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> account, pwd </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">        t </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Thread</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">target</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">loginMall, </span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(account, pwd,))</span></span>
<span class="line"><span style="color:#ABB2BF;">        threads.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(t)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¯åŠ¨æ‰€æœ‰çº¿ç¨‹</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> thr </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> threads:</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        thr.</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br></div></div><h3 id="è¯´æ˜-2" tabindex="-1">è¯´æ˜ <a class="header-anchor" href="#è¯´æ˜-2" aria-label="Permalink to &quot;è¯´æ˜&quot;">â€‹</a></h3><p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Python å’Œ Selenium åº“ç¼–å†™çš„è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œç”¨äºåœ¨åä¸ºå®˜æ–¹å•†åŸè‡ªåŠ¨ç™»å½•å¹¶æŠ¢è´­æŒ‡å®šå•†å“ã€‚ç”¨äºæŠ¢è´­é™é‡å‘å”®çš„çƒ­é—¨å•†å“ï¼Œå¦‚æ‰‹æœºã€ç”µå­è®¾å¤‡ç­‰ã€‚è¿™é‡Œæ˜¯è„šæœ¬çš„é€æ®µè§£é‡Šå’Œè¯´æ˜ï¼š</p><p><strong>é…ç½®åŒºåŸŸ</strong></p><p>è„šæœ¬å¼€å¤´å®šä¹‰äº†ç”¨æˆ·éœ€è¦é…ç½®çš„ä¸€äº›å˜é‡ï¼š</p><p>- ACCOUNTSï¼šå­˜å‚¨ç”¨æˆ·çš„åä¸ºè´¦å·ä¿¡æ¯ã€‚</p><p>- chrome_driverï¼šæŒ‡å®š Chrome WebDriver çš„è·¯å¾„ï¼Œç”¨äº Selenium æ§åˆ¶ Chrome æµè§ˆå™¨ã€‚</p><p>- personalDataPathï¼šChrome æµè§ˆå™¨çš„ä¸ªäººèµ„æ–™è·¯å¾„ï¼Œç”¨äºä¿æŒç™»å½•çŠ¶æ€ã€‚</p><p>- BUY_URLï¼šå•†å“çš„è´­ä¹°é“¾æ¥ã€‚</p><p>- BEGIN_GOï¼šè®¾å®šè„šæœ¬å¼€å§‹æŠ¢è´­çš„æ—¶é—´ã€‚</p><p>- AUTO_SELECTã€AUTO_COLORã€AUTO_EDITIONã€AUTO_COMBOï¼šç”¨äºè‡ªåŠ¨é€‰æ‹©å•†å“çš„å‚æ•°ï¼Œå¦‚é¢œè‰²ã€ç‰ˆæœ¬ã€å¥—é¤ç­‰ã€‚</p><p><strong>ä¸»è¦å‡½æ•°</strong></p><p>- submitOrderï¼šæäº¤è®¢å•çš„å‡½æ•°ã€‚æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦æ­£ç¡®ï¼Œç„¶åå°è¯•ç‚¹å‡»â€œæäº¤è®¢å•â€æŒ‰é’®ã€‚</p><p>- onQueueï¼šå¤„ç†æ’é˜Ÿè¿‡ç¨‹çš„å‡½æ•°ã€‚ä¸æ–­æ£€æŸ¥å½“å‰é¡µé¢çŠ¶æ€ï¼Œå¦‚å‡ºç°é”™è¯¯æç¤ºæˆ–é¡µé¢è·³è½¬åˆ™å¤„ç†ç›¸åº”æƒ…å†µã€‚</p><p>- selectï¼šæ ¹æ®é…ç½®é€‰æ‹©å•†å“å‚æ•°ï¼ˆå¦‚é¢œè‰²ã€ç‰ˆæœ¬ã€å¥—é¤ï¼‰çš„å‡½æ•°ã€‚</p><p>- goToBuyï¼šå¯¼èˆªåˆ°è´­ä¹°é¡µé¢å¹¶æ ¹æ®é…ç½®é€‰æ‹©å•†å“å‚æ•°çš„å‡½æ•°ã€‚</p><p>- trustdriverï¼šå¤„ç†æµè§ˆå™¨ä¿¡ä»»çš„å‡½æ•°ã€‚</p><p>- sendcodeï¼šå¤„ç†å‘é€éªŒè¯ç çš„å‡½æ•°ã€‚</p><p>- loginMallï¼šè´Ÿè´£ç™»å½•åä¸ºå•†åŸçš„å‡½æ•°ã€‚ä½¿ç”¨ Selenium æ¨¡æ‹Ÿç”¨æˆ·ç™»å½•è¿‡ç¨‹ï¼Œå¤„ç†ç™»å½•åçš„å„ç§å¯èƒ½æƒ…å†µã€‚</p><p><strong>è¿è¡Œè„šæœ¬</strong></p><p>è„šæœ¬é€šè¿‡å¤šçº¿ç¨‹å¯åŠ¨ï¼Œä¸ºæ¯ä¸ªè´¦æˆ·åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ç™»å½•å’Œè´­ä¹°æµç¨‹ã€‚ä½¿ç”¨ Thread ç±»æ¥ç®¡ç†è¿™äº›çº¿ç¨‹ã€‚</p><h3 id="å¦‚ä½•è¿è¡Œè¿™æ®µä»£ç " tabindex="-1">å¦‚ä½•è¿è¡Œè¿™æ®µä»£ç  <a class="header-anchor" href="#å¦‚ä½•è¿è¡Œè¿™æ®µä»£ç " aria-label="Permalink to &quot;å¦‚ä½•è¿è¡Œè¿™æ®µä»£ç &quot;">â€‹</a></h3><ol><li>å®‰è£… Pythonï¼šç¡®ä¿ä½ çš„ç”µè„‘ä¸Šå®‰è£…äº† Python ç¯å¢ƒã€‚</li><li>å®‰è£… Selenium åº“ï¼šé€šè¿‡ pip å®‰è£… Seleniumã€‚å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ pip install seleniumã€‚</li><li>ä¸‹è½½ ChromeDriverï¼šæ ¹æ®ä½ çš„ Chrome æµè§ˆå™¨ç‰ˆæœ¬ï¼Œä» <a href="https://sites.google.com/a/chromium.org/chromedriver/" target="_blank" rel="noreferrer">ChromeDriver</a> ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„é©±åŠ¨ç¨‹åºï¼Œå¹¶è®¾ç½® chrome_driver`å˜é‡æŒ‡å‘ä¸‹è½½çš„è·¯å¾„ã€‚</li><li>é…ç½® Chrome ç”¨æˆ·æ•°æ®ï¼šæŒ‡å®š personalDataPath ä¸ºä½ çš„ Chrome ç”¨æˆ·æ•°æ®è·¯å¾„ï¼Œè¿™å¯ä»¥è®©è„šæœ¬ä½¿ç”¨ä½ çš„ç™»å½•çŠ¶æ€å’Œæµè§ˆå™¨é…ç½®ã€‚</li><li>è¿è¡Œè„šæœ¬ï¼šåœ¨ç»ˆç«¯æˆ–å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡Œè¿™ä¸ª Python è„šæœ¬ã€‚</li></ol><h3 id="æ³¨æ„äº‹é¡¹-4" tabindex="-1">æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-4" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h3><ul><li><p>ç¡®ä¿ä½ äº†è§£ä½¿ç”¨è¿™ç§è„šæœ¬å¯èƒ½è¿ååä¸ºå•†åŸçš„ä½¿ç”¨æ¡æ¬¾ã€‚åœ¨ä½¿ç”¨å‰è¯·åŠ¡å¿…äº†è§£ç›¸å…³æ³•å¾‹æ³•è§„åŠå¹³å°è§„åˆ™ã€‚</p></li><li><p>è‡ªåŠ¨åŒ–æŠ¢è´­å¯èƒ½å¯¼è‡´è´¦å·è¢«æš‚æ—¶å°ç¦æˆ–å…¶ä»–ä¸è‰¯åæœï¼Œéœ€è°¨æ…ä½¿ç”¨ã€‚</p></li><li><p>ä¿æŠ¤ä½ çš„è´¦æˆ·å®‰å…¨ï¼Œä¸è¦åœ¨è„šæœ¬ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯</p></li></ul><h1 id="æŸéº¦ç½‘è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬" tabindex="-1">æŸéº¦ç½‘è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬ <a class="header-anchor" href="#æŸéº¦ç½‘è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬" aria-label="Permalink to &quot;æŸéº¦ç½‘è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬&quot;">â€‹</a></h1><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">åŸºäºpythonå’Œseleniumå®ç°çš„æŸéº¦ç½‘è‡ªåŠ¨åˆ·æ–°æŠ¢ç¥¨è„šæœ¬</span></span>
<span class="line"><span style="color:#98C379;">ç”¨æˆ·è¦æå‰æ·»åŠ å¥½ä¸ªäººä¿¡æ¯å’Œæ”¶è´§åœ°å€</span></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> webdriver</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support.ui </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> WebDriverWait</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.keys </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Keys</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.by </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> By</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> expected_conditions </span><span style="color:#C678DD;">as</span><span style="color:#D19A66;"> EC</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.common.exceptions </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> TimeoutException</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®æŠ¢ç¥¨é“¾æ¥å’Œå¼€ç¥¨æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># URL = &quot;https://piao.damai.cn/146290.html?spm=a2o6e.search.0.0.7e2b4d157EDtjL&quot;# PCé¡µé¢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">URL</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://m.damai.cn/damai/perform/item.html?projectId=146290&#39;</span><span style="color:#7F848E;font-style:italic;">#æ‰‹æœºé¡µé¢</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># HOUR = 19</span></span>
<span class="line"><span style="color:#D19A66;">MIN</span><span style="color:#56B6C2;">  =</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#D19A66;">USERNAME</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;13112390306&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Chrome</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®ç­‰å¾…æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;">wait </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">URL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">PCç«¯ç½‘é¡µæŠ¢ç¥¨æ“ä½œ</span></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">seletor</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ§ä»¶å¯ç‚¹å‡»æ—¶æ‰é€‰å®š</span></span>
<span class="line"><span style="color:#ABB2BF;">        choice </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wait.</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, seletor)))</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> choice</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> TimeoutException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Time out!&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Not found!&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> login</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç‚¹å‡»ç™»å½•</span></span>
<span class="line"><span style="color:#ABB2BF;">    login </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;userLoginInfo&quot;]/span/a[1]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    login.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    username </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;login_email&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    username.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">USERNAME</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    ç”±äºå¯†ç æ¡†æ§ä»¶è¢«è®¾ç½®ä¸ºä¸å¯è§</span></span>
<span class="line"><span style="color:#98C379;">    å…ˆè‡ªè¡Œè¾“å…¥å¯†ç å¹¶è®°ä½å¯†ç </span></span>
<span class="line"><span style="color:#98C379;">    æ–¹ä¾¿åˆ·æ–°</span></span>
<span class="line"><span style="color:#98C379;">    ï¼ˆä¹Ÿå¯ç”¨cookieå®ç°ï¼‰</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    password </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;login_pwd_txt&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        password.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        password.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;********&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(password)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Password Can&#39;t click&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> buy</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç‚¹å‡»ä»·æ ¼</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        price </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        plus </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        buybtn </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        submit </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        booker </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        select </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        confirm </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">URL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é€‰æ‹©ä»·æ ¼</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> price:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è¿™é‡Œé€‰çš„æ˜¯580ç¥¨é¢çš„ï¼Œå¦‚æœé€‰å…¶ä»–ç¥¨é¢ï¼Œä¿®æ”¹æœ€åçš„li[*]å³å¯</span></span>
<span class="line"><span style="color:#ABB2BF;">            price </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;priceList&quot;]/div/ul/li[3]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        price.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ•°é‡åŠ 1</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> plus:</span></span>
<span class="line"><span style="color:#ABB2BF;">            plus </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;cartList&quot;]/div[1]/ul/li/span[3]/a[2]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        plus.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ç«‹å³æŠ¢è´­</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> buybtn:</span></span>
<span class="line"><span style="color:#ABB2BF;">            buybtn </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;btnBuyNow&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, buybtn)</span></span>
<span class="line"><span style="color:#ABB2BF;">        buybtn.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é€‰æ‹©è´­ç¥¨äºº</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> booker:</span></span>
<span class="line"><span style="color:#ABB2BF;">            booker </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[3]/div[3]/div[2]/div[2]/div/a&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, booker)</span></span>
<span class="line"><span style="color:#ABB2BF;">        booker.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é€‰æ‹©ã€ç¡®å®š</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> select:</span></span>
<span class="line"><span style="color:#ABB2BF;">            select </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[3]/div[3]/div[12]/div/div[2]/div/div[2]/div/table/tbody/tr/label/td[1]/input&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, select)</span></span>
<span class="line"><span style="color:#ABB2BF;">        select.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> confirm:</span></span>
<span class="line"><span style="color:#ABB2BF;">            confirm </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[3]/div[3]/div[12]/div/div[2]/div/p/div/a&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, confirm)</span></span>
<span class="line"><span style="color:#ABB2BF;">        confirm.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æäº¤è®¢å•</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> submit:</span></span>
<span class="line"><span style="color:#ABB2BF;">            submit </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;orderConfirmSubmit&quot;]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, submit)</span></span>
<span class="line"><span style="color:#ABB2BF;">        submit.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢ç¥¨å¤±è´¥ï¼Œå°è¯•é‡æ–°æŠ¢ç¥¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        buy</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> test</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#61AFEF;">    login</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€å§‹æŠ¢ç¥¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">    buy</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢ç¥¨æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">ç§»åŠ¨ç«¯æŠ¢ç¥¨æ“ä½œ</span></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> login_mobile</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    ç‚¹å‡»è´­ä¹°è¿›å…¥ç™»å½•ç•Œé¢</span></span>
<span class="line"><span style="color:#98C379;">    è‡ªè¡Œè¾“å…¥å¸å·å¯†ç </span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç«‹å³è´­ä¹°</span></span>
<span class="line"><span style="color:#ABB2BF;">    buybtn </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> buybtn:</span></span>
<span class="line"><span style="color:#ABB2BF;">        buybtn </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div[2]/div/div[1]/div[2]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, buybtn)</span></span>
<span class="line"><span style="color:#ABB2BF;">    buybtn.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é»˜è®¤å·²ç»é€‰å¥½æ—¶é—´äº†ï¼Œå†ç‚¹å‡»ç«‹å³è´­ä¹°</span></span>
<span class="line"><span style="color:#ABB2BF;">    buy </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> buy:</span></span>
<span class="line"><span style="color:#ABB2BF;">        buy </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div[3]/div[2]/div[1]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, buy)</span></span>
<span class="line"><span style="color:#ABB2BF;">    buy.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> buy_mobile</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ç«‹å³è´­ä¹°</span></span>
<span class="line"><span style="color:#ABB2BF;">        buybtn </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> buybtn:</span></span>
<span class="line"><span style="color:#ABB2BF;">            buybtn </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div[2]/div/div[1]/div[2]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, buybtn)</span></span>
<span class="line"><span style="color:#ABB2BF;">        buybtn.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é»˜è®¤å·²ç»é€‰å¥½æ—¶é—´äº†ï¼Œå†ç‚¹å‡»ç«‹å³è´­ä¹°</span></span>
<span class="line"><span style="color:#ABB2BF;">        buy </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> buy:</span></span>
<span class="line"><span style="color:#ABB2BF;">            buy </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div[3]/div[2]/div[1]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, buy)</span></span>
<span class="line"><span style="color:#ABB2BF;">        buy.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # 580ç¥¨é¢</span></span>
<span class="line"><span style="color:#ABB2BF;">        price </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> price:</span></span>
<span class="line"><span style="color:#ABB2BF;">            price </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//html/body/div[1]/div/div[2]/ul/li[3]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, price)</span></span>
<span class="line"><span style="color:#ABB2BF;">        price.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ•°é‡+1</span></span>
<span class="line"><span style="color:#ABB2BF;">        count </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> count:</span></span>
<span class="line"><span style="color:#ABB2BF;">            count </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div/div[3]/ul/li/div/div[3]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, count)</span></span>
<span class="line"><span style="color:#ABB2BF;">        count.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # é€‰å¥½äº†</span></span>
<span class="line"><span style="color:#ABB2BF;">        select </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> select:</span></span>
<span class="line"><span style="color:#ABB2BF;">            select </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div/div[4]/div[3]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, select)</span></span>
<span class="line"><span style="color:#ABB2BF;">        select.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è´­ç¥¨äºº</span></span>
<span class="line"><span style="color:#ABB2BF;">        booker </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> booker:</span></span>
<span class="line"><span style="color:#ABB2BF;">            booker </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div[1]/div[2]/div[1]/div[2]/div/ul/li/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, booker)</span></span>
<span class="line"><span style="color:#ABB2BF;">        booker.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å»ä»˜æ¬¾</span></span>
<span class="line"><span style="color:#ABB2BF;">        pay </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> None</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> pay:</span></span>
<span class="line"><span style="color:#ABB2BF;">            pay </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> choose</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/html/body/div[1]/div[2]/div[2]/div[2]/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollIntoView();&quot;</span><span style="color:#ABB2BF;">, pay)</span></span>
<span class="line"><span style="color:#ABB2BF;">        pay.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢ç¥¨å¤±è´¥ï¼Œå°è¯•é‡æ–°æŠ¢ç¥¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        buy_mobile</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> test_mobile</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#61AFEF;">    login_mobile</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€å§‹æŠ¢ç¥¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">    buy_mobile</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢ç¥¨æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é»˜è®¤PCç½‘é¡µï¼Œæ‰‹æœºç½‘é¡µå¯¹åº”ä¿®æ”¹å³å¯</span></span>
<span class="line"><span style="color:#61AFEF;">    login</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # 30ç§’ç­‰å¾…ç”¨æˆ·è¾“å…¥å¯†ç åå†å¼€å§‹åˆ·</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#D19A66;"> MIN</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">localtime</span><span style="color:#ABB2BF;">().tm_min:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€å§‹æŠ¢ç¥¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            buy</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¢ç¥¨æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # test()</span></span>
<span class="line"><span style="color:#61AFEF;">    test_mobile</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # main()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br></div></div><h1 id="ç§’æŠ¢æ¼”å”±ä¼šé—¨ç¥¨é€šç”¨æ¨¡æ¿" tabindex="-1">ç§’æŠ¢æ¼”å”±ä¼šé—¨ç¥¨é€šç”¨æ¨¡æ¿ <a class="header-anchor" href="#ç§’æŠ¢æ¼”å”±ä¼šé—¨ç¥¨é€šç”¨æ¨¡æ¿" aria-label="Permalink to &quot;ç§’æŠ¢æ¼”å”±ä¼šé—¨ç¥¨é€šç”¨æ¨¡æ¿&quot;">â€‹</a></h1><p><strong>å…¨ä»£ç å¦‚ä¸‹</strong>ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># coding: utf-8</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> json </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> loads</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> os.path </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> exists</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pickle </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> dump, load</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> time </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> sleep, time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> webdriver</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.common.exceptions </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> TimeoutException, NoSuchElementException</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.chrome.service </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Service</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.by </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> By</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.desired_capabilities </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> DesiredCapabilities</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> expected_conditions </span><span style="color:#C678DD;">as</span><span style="color:#D19A66;"> EC</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support.ui </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> WebDriverWait</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Concert</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">object</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">date</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">session</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">price</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">real_name</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">nick_name</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">ticket_num</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">viewer_person</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">é¢„çº¦å¹³å°_url</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">target_url</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">                 driver_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> date  </span><span style="color:#7F848E;font-style:italic;"># æ—¥æœŸåºå·</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.session </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> session  </span><span style="color:#7F848E;font-style:italic;"># åœºæ¬¡åºå·ä¼˜å…ˆçº§</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price  </span><span style="color:#7F848E;font-style:italic;"># ç¥¨ä»·åºå·ä¼˜å…ˆçº§</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.real_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> real_name  </span><span style="color:#7F848E;font-style:italic;"># å®åè€…åºå·</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.status </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;">  # çŠ¶æ€æ ‡è®°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.time_start </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;">  # å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.time_end </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;">  # ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.num </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;">  # å°è¯•æ¬¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.ticket_num </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ticket_num  </span><span style="color:#7F848E;font-style:italic;"># è´­ä¹°ç¥¨æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.viewer_person </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> viewer_person  </span><span style="color:#7F848E;font-style:italic;"># è§‚å½±äººåºå·ä¼˜å…ˆçº§</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.nick_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> nick_name  </span><span style="color:#7F848E;font-style:italic;"># ç”¨æˆ·æ˜µç§°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.é¢„çº¦å¹³å°_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> é¢„çº¦å¹³å°_url  </span><span style="color:#7F848E;font-style:italic;"># é¢„çº¦å¹³å°å®˜ç½‘ç½‘å€</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.target_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> target_url  </span><span style="color:#7F848E;font-style:italic;"># ç›®æ ‡è´­ç¥¨ç½‘å€</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver_path  </span><span style="color:#7F848E;font-style:italic;"># æµè§ˆå™¨é©±åŠ¨åœ°å€</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> isClassPresent</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">ret</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> item.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">name)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> ret:</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#ABB2BF;"> result</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è·å–è´¦å·çš„cookieä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_cookie</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.é¢„çº¦å¹³å°_url)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###è¯·ç‚¹å‡»ç™»å½•###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;login-user&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.title.</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é¢„çº¦å¹³å°ç½‘-å…¨çƒæ¼”å‡ºèµ›äº‹å®˜æ–¹è´­ç¥¨å¹³å°&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…ç½‘é¡µåŠ è½½å®Œæˆ</span></span>
<span class="line"><span style="color:#61AFEF;">            sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###è¯·æ‰«ç ç™»å½•###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.title </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;é¢„çº¦å¹³å°ç™»å½•&#39;</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…æ‰«ç å®Œæˆ</span></span>
<span class="line"><span style="color:#61AFEF;">            sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">        dump</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get_cookies</span><span style="color:#ABB2BF;">(), </span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;cookies.pkl&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;wb&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###Cookieä¿å­˜æˆåŠŸ###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> set_cookie</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            cookies </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;cookies.pkl&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;rb&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># è½½å…¥cookie</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> cookie </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> cookies:</span></span>
<span class="line"><span style="color:#ABB2BF;">                cookie_dict </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;domain&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;.é¢„çº¦å¹³å°.cn&#39;</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># å¿…é¡»æœ‰ï¼Œä¸ç„¶å°±æ˜¯å‡ç™»å½•</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;name&#39;</span><span style="color:#ABB2BF;">: cookie.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;value&#39;</span><span style="color:#ABB2BF;">: cookie.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;expires&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;path&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;/&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;httpOnly&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;HostOnly&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;Secure&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">add_cookie</span><span style="color:#ABB2BF;">(cookie_dict)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###è½½å…¥Cookie###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###å¼€å§‹ç™»å½•###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.target_url)</span></span>
<span class="line"><span style="color:#61AFEF;">        WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">title_contains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å•†å“è¯¦æƒ…&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">set_cookie</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> enter_concert</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.time_start </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> time</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è®°å½•å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###æ‰“å¼€æµè§ˆå™¨ï¼Œè¿›å…¥é¢„çº¦å¹³å°ç½‘###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#61AFEF;"> exists</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;cookies.pkl&#39;</span><span style="color:#ABB2BF;">):  </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœä¸å­˜åœ¨cookie.pkl,å°±è·å–ä¸€ä¸‹</span></span>
<span class="line"><span style="color:#ABB2BF;">            service </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Service</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver_path)</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Chrome</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">service</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">service)</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_cookie</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###æˆåŠŸè·å–Cookieï¼Œé‡å¯æµè§ˆå™¨###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        options </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">ChromeOptions</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ç¦æ­¢å›¾ç‰‡ã€jsã€cssåŠ è½½</span></span>
<span class="line"><span style="color:#ABB2BF;">        prefs </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;profile.managed_default_content_settings.images&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                 &quot;profile.managed_default_content_settings.javascript&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                 &#39;permissions.default.stylesheet&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">        mobile_emulation </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;deviceName&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Nexus 6&quot;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">        options.</span><span style="color:#61AFEF;">add_experimental_option</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;prefs&quot;</span><span style="color:#ABB2BF;">, prefs)</span></span>
<span class="line"><span style="color:#ABB2BF;">        options.</span><span style="color:#61AFEF;">add_experimental_option</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;mobileEmulation&quot;</span><span style="color:#ABB2BF;">, mobile_emulation)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å°±æ˜¯è¿™ä¸€è¡Œå‘Šè¯‰chromeå»æ‰äº†webdriverç—•è¿¹ï¼Œä»¤navigator.webdriver=falseï¼Œæå…¶å…³é”®</span></span>
<span class="line"><span style="color:#ABB2BF;">        options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-blink-features=AutomationControlled&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;--log-level=3&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ›´æ¢ç­‰å¾…ç­–ç•¥ä¸ºä¸ç­‰å¾…æµè§ˆå™¨åŠ è½½å®Œå…¨å°±è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œ</span></span>
<span class="line"><span style="color:#ABB2BF;">        capa </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> DesiredCapabilities.</span><span style="color:#D19A66;">CHROME</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # normal, eager, none</span></span>
<span class="line"><span style="color:#ABB2BF;">        capa[</span><span style="color:#98C379;">&quot;pageLoadStrategy&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;eager&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        service </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Service</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver_path)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Chrome</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">service</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">service, </span><span style="color:#E06C75;font-style:italic;">options</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">options, </span><span style="color:#E06C75;font-style:italic;">desired_capabilities</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">capa)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ç™»å½•åˆ°å…·ä½“æŠ¢è´­é¡µé¢</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">refresh</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> click_util</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">btn</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">locator</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            btn.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">(locator))</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å®ç°è´­ä¹°å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> choose_ticket</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###è¿›å…¥æŠ¢ç¥¨ç•Œé¢###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¦‚æœè·³è½¬åˆ°äº†ç¡®è®¤ç•Œé¢å°±ç®—è¿™æ­¥æˆåŠŸäº†ï¼Œå¦åˆ™ç»§ç»­æ‰§è¡Œæ­¤æ­¥</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.title.</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è®¢å•ç¡®è®¤&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.num </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span><span style="color:#7F848E;font-style:italic;">  # å°è¯•æ¬¡æ•°åŠ 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.current_url.</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;buy.é¢„çº¦å¹³å°.cn&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­é¡µé¢åŠ è½½æƒ…å†µ ç¡®ä¿é¡µé¢åŠ è½½å®Œæˆ</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">                WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    lambda</span><span style="color:#D19A66;font-style:italic;"> driver</span><span style="color:#ABB2BF;">: driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;return document.readyState&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;complete&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&quot;***Error: é¡µé¢åŠ è½½è¶…æ—¶***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­rootå…ƒç´ æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                box </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">ID</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;root&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&quot;***Error: é¡µé¢ä¸­IDä¸ºrootçš„æ•´ä½“å¸ƒå±€å…ƒç´ ä¸å­˜åœ¨æˆ–åŠ è½½è¶…æ—¶***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥å¹¶å¤„ç†æ¸©é¦¨æç¤ºé®ç½©</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                health_info </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;health-info-content&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---æ£€æµ‹åˆ°æ¸©é¦¨æç¤ºé®ç½©---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                health_info_box </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> health_info.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">ID</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;health-info-html-box&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æ¨¡æ‹Ÿå‘ä¸Šæ»‘åŠ¨ï¼Œé˜…è¯»æ¸©é¦¨æç¤ºå†…å®¹</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---æ­£åœ¨æ¨¡æ‹Ÿå‘ä¸Šæ»‘åŠ¨é˜…è¯»æ¸©é¦¨æç¤ºå†…å®¹---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[0].scrollTop = arguments[0].scrollHeight&quot;</span><span style="color:#ABB2BF;">, health_info_box)</span></span>
<span class="line"><span style="color:#61AFEF;">                sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…æ»‘åŠ¨å®Œæˆ</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---æ¨¡æ‹Ÿæ»‘åŠ¨å®Œæˆ---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç‚¹å‡»â€œçŸ¥é“äº†â€æŒ‰é’®</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---æ­£åœ¨ç‚¹å‡»â€œçŸ¥é“äº†â€æŒ‰é’®---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                know_button </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> health_info.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;button&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                know_button.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---â€œçŸ¥é“äº†â€æŒ‰é’®ç‚¹å‡»æˆåŠŸ---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> TimeoutException:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---ä¸å­˜åœ¨æ¸©é¦¨æç¤ºé®ç½©---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> NoSuchElementException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;***Error: æ¸©é¦¨æç¤ºé®ç½©æ“ä½œå¼‚å¸¸ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥å¹¶å¤„ç†å®ååˆ¶è§‚æ¼”æç¤ºé®ç½©</span></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                realname_info </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;realname-content&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---æ£€æµ‹åˆ°å®ååˆ¶è§‚æ¼”æç¤ºé®ç½©---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç‚¹å‡»â€œçŸ¥é“äº†â€æŒ‰é’®</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---æ­£åœ¨ç‚¹å‡»â€œçŸ¥é“äº†â€æŒ‰é’®---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                known_button </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> realname_info.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;known&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                known_button.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---â€œçŸ¥é“äº†â€æŒ‰é’®ç‚¹å‡»æˆåŠŸ---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> TimeoutException:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---ä¸å­˜åœ¨å®ååˆ¶è§‚æ¼”æç¤ºé®ç½©---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> NoSuchElementException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;***Error: å®ååˆ¶è§‚æ¼”æç¤ºé®ç½©æ“ä½œå¼‚å¸¸ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                buybutton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> box.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;buy__button&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                buybutton_text </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> buybutton.text</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---å®šä½è´­ä¹°æŒ‰é’®æˆåŠŸ---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;***Error: å®šä½è´­ä¹°æŒ‰é’®å¤±è´¥***: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#98C379;"> &quot;å³å°†å¼€æŠ¢&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> buybutton_text:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.status </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;---å°šæœªå¼€å”®ï¼Œåˆ·æ–°ç­‰å¾…---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#98C379;"> &quot;ç¼ºè´§&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> buybutton_text:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#98C379;">&quot;---å·²ç»ç¼ºè´§ï¼Œåˆ·æ–°ç­‰å¾…---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">            sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            buybutton.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;---ç‚¹å‡»è´­ä¹°æŒ‰é’®---&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            box </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.sku-pop-wrapper&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æ—¥æœŸé€‰æ‹©</span></span>
<span class="line"><span style="color:#ABB2BF;">                toBeClicks </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    date </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                        EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;bui-dm-sku-calendar&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    date </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> date </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    date_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> date.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                        by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;bui-calendar-day-box&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.date:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        j </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> date_list[i </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        toBeClicks.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(j)</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#C678DD;">                    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> toBeClicks:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        i.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">                        sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.05</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é€‰å®šåœºæ¬¡</span></span>
<span class="line"><span style="color:#ABB2BF;">                session </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;sku-times-card&#39;</span><span style="color:#ABB2BF;">)))  </span><span style="color:#7F848E;font-style:italic;"># æ—¥æœŸã€åœºæ¬¡å’Œç¥¨æ¡£è¿›è¡Œå®šä½</span></span>
<span class="line"><span style="color:#ABB2BF;">                session_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                    by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;bui-dm-sku-card-item&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                toBeClicks </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.session:  </span><span style="color:#7F848E;font-style:italic;"># æ ¹æ®ä¼˜å…ˆçº§é€‰æ‹©ä¸€ä¸ªå¯è¡Œåœºæ¬¡</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> i </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(session_list):</span></span>
<span class="line"><span style="color:#ABB2BF;">                        i </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(session_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    j </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> session_list[i </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    k </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isClassPresent</span><span style="color:#ABB2BF;">(j, </span><span style="color:#98C379;">&#39;item-tag&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> k:  </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ‰¾åˆ°äº†å¸¦presellçš„ç±»</span></span>
<span class="line"><span style="color:#C678DD;">                        if</span><span style="color:#ABB2BF;"> k.text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;æ— ç¥¨&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                            continue</span></span>
<span class="line"><span style="color:#C678DD;">                        elif</span><span style="color:#ABB2BF;"> k.text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;é¢„å”®&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                            toBeClicks.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(j)</span></span>
<span class="line"><span style="color:#C678DD;">                            break</span></span>
<span class="line"><span style="color:#C678DD;">                        elif</span><span style="color:#ABB2BF;"> k.text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;æƒ &#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                            toBeClicks.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(j)</span></span>
<span class="line"><span style="color:#C678DD;">                            break</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        toBeClicks.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(j)</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å¤šåœºæ¬¡çš„åœºè¦å…ˆé€‰æ‹©åœºæ¬¡æ‰ä¼šå‡ºç°ç¥¨æ¡£</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> toBeClicks:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    i.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">                    sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.05</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é€‰å®šç¥¨æ¡£</span></span>
<span class="line"><span style="color:#ABB2BF;">                toBeClicks </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#ABB2BF;">                price </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;sku-tickets-card&#39;</span><span style="color:#ABB2BF;">)))  </span><span style="color:#7F848E;font-style:italic;"># æ—¥æœŸã€åœºæ¬¡å’Œç¥¨æ¡£è¿›è¡Œå®šä½</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                price_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                    by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;bui-dm-sku-card-item&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é€‰å®šç¥¨æ¡£</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.price:</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> i </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(price_list):</span></span>
<span class="line"><span style="color:#ABB2BF;">                        i </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(price_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    j </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price_list[i </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    k </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isClassPresent</span><span style="color:#ABB2BF;">(j, </span><span style="color:#98C379;">&#39;item-tag&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> k:  </span><span style="color:#7F848E;font-style:italic;"># å­˜åœ¨notticketä»£è¡¨å­˜åœ¨ç¼ºè´§ç™»è®°ï¼Œè·³è¿‡</span></span>
<span class="line"><span style="color:#C678DD;">                        continue</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        toBeClicks.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(j)</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> toBeClicks:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    i.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">                    sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                buybutton </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> box.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                    by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;sku-footer-buy-button&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # sleep(1.0)</span></span>
<span class="line"><span style="color:#ABB2BF;">                buybutton_text </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> buybutton.text</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> buybutton_text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&quot;***Error: æäº¤ç¥¨æ¡£æŒ‰é’®æ–‡å­—è·å–ä¸ºç©º,é€‚å½“è°ƒæ•´ sleep æ—¶é—´***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">                    WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                        EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;bui-dm-sku-counter&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&quot;***è´­ç¥¨æŒ‰é’®æœªå¼€å§‹***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;***Error: é€‰æ‹©æ—¥æœŸoråœºæ¬¡orç¥¨æ¡£ä¸æˆåŠŸ***: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                ticket_num_up </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> box.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                    by</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;plus-enable&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> buybutton_text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;é€‰åº§è´­ä¹°&quot;</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># é€‰åº§è´­ä¹°æ²¡æœ‰å¢å‡ç¥¨æ•°é”®</span></span>
<span class="line"><span style="color:#ABB2BF;">                    buybutton.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.status </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 5</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###è¯·è‡ªè¡Œé€‰æ‹©ä½ç½®å’Œç¥¨ä»·###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    break</span></span>
<span class="line"><span style="color:#C678DD;">                elif</span><span style="color:#ABB2BF;"> buybutton_text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;æäº¤ç¼ºè´§ç™»è®°&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&#39;###ç¥¨å·²è¢«æŠ¢å®Œï¼ŒæŒç»­æ¡æ¼ä¸­...æˆ–è¯·å…³é—­ç¨‹åºå¹¶æ‰‹åŠ¨æäº¤ç¼ºè´§ç™»è®°###&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&quot;***Error: ticket_num_up ä½ç½®æ‰¾ä¸åˆ°***&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> buybutton_text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;ç«‹å³é¢„è®¢&quot;</span><span style="color:#C678DD;"> or</span><span style="color:#ABB2BF;"> buybutton_text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;ç«‹å³è´­ä¹°&quot;</span><span style="color:#C678DD;"> or</span><span style="color:#ABB2BF;"> buybutton_text </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;ç¡®å®š&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.ticket_num </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">):  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®å¢åŠ ç¥¨æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ticket_num_up.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                buybutton.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.status </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 4</span></span>
<span class="line"><span style="color:#61AFEF;">                WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">title_contains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç¡®è®¤&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æœªå®šä¹‰æŒ‰é’®ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">buybutton_text</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> check_order</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.status </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é€‰æ‹©è§‚å½±äºº</span></span>
<span class="line"><span style="color:#ABB2BF;">            toBeClicks </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#61AFEF;">            WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;//*[@id=&quot;dmViewerBlock_DmViewerBlock&quot;]/div[2]/div/div&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#ABB2BF;">            people </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;//*[@id=&quot;dmViewerBlock_DmViewerBlock&quot;]/div[2]/div/div&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.viewer_person:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> i </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(people):</span></span>
<span class="line"><span style="color:#C678DD;">                    break</span></span>
<span class="line"><span style="color:#ABB2BF;">                j </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> people[i </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                j.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;">                sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.05</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">            WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    (By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;//*[@id=&quot;dmOrderSubmitBlock_DmOrderSubmitBlock&quot;]/div[2]/div/div[2]/div[2]/div[2]&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#ABB2BF;">            comfirmBtn </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                By.</span><span style="color:#D19A66;">XPATH</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;//*[@id=&quot;dmOrderSubmitBlock_DmOrderSubmitBlock&quot;]/div[2]/div/div[2]/div[2]/div[2]&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">            sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            comfirmBtn.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­titleæ˜¯ä¸æ˜¯æ”¯ä»˜å®</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###æ­£åœ¨è·³è½¬åˆ°æ”¯ä»˜å®ä»˜æ¬¾ç•Œé¢###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">                    WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                        EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">title_contains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ”¯ä»˜å®&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###è®¢å•æäº¤æˆåŠŸ###&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.status </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 6</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.time_end </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                    break</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é€šè¿‡äººå·¥åˆ¤æ–­è®¢å•æäº¤çŠ¶æ€</span></span>
<span class="line"><span style="color:#ABB2BF;">                    step </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                        &quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">###</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">1.æˆåŠŸè·³è½¬åˆ°æ”¯ä»˜å®ä»˜æ¬¾é¡µé¢</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">2.æœªçŸ¥ï¼Œæ²¡è·³è½¬åˆ°æ”¯ä»˜å®ç•Œé¢ï¼Œå°è¯•é‡æ–°æŠ¢ç¥¨</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">3.æœªçŸ¥ï¼Œé€€å‡ºè„šæœ¬</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">###</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">è¯·è¾“å…¥å½“å‰çŠ¶æ€ï¼š&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> step </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;1&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # æˆåŠŸ</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è®¢å•æäº¤æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.status </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 6</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.time_end </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#C678DD;">                    elif</span><span style="color:#ABB2BF;"> step </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;2&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # å¤±è´¥ï¼Œè¿›å…¥ä¸‹ä¸€è½®æŠ¢ç¥¨</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å°è¯•é‡æ–°æŠ¢ç¥¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                        return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                    elif</span><span style="color:#ABB2BF;"> step </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;3&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # é€€å‡ºè„šæœ¬</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è„šæœ¬é€€å‡ºæˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                        return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                        raise</span><span style="color:#ABB2BF;"> Exception(</span><span style="color:#C678DD;">u</span><span style="color:#98C379;">&#39;***Error: æœªçŸ¥è¾“å…¥***&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;./config.json&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">            config </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> loads</span><span style="color:#ABB2BF;">(f.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # params: åœºæ¬¡ä¼˜å…ˆçº§ï¼Œç¥¨ä»·ä¼˜å…ˆçº§ï¼Œå®åè€…åºå·, ç”¨æˆ·æ˜µç§°ï¼Œ è´­ä¹°ç¥¨æ•°ï¼Œ å®˜ç½‘ç½‘å€ï¼Œ ç›®æ ‡ç½‘å€, æµè§ˆå™¨é©±åŠ¨åœ°å€</span></span>
<span class="line"><span style="color:#ABB2BF;">        con </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Concert</span><span style="color:#ABB2BF;">(config[</span><span style="color:#98C379;">&#39;date&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;sess&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;price&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;real_name&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;nick_name&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                      config[</span><span style="color:#98C379;">&#39;ticket_num&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;viewer_person&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;é¢„çº¦å¹³å°_url&#39;</span><span style="color:#ABB2BF;">], config[</span><span style="color:#98C379;">&#39;target_url&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                      config[</span><span style="color:#98C379;">&#39;driver_path&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">        con.</span><span style="color:#61AFEF;">enter_concert</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è¿›å…¥åˆ°å…·ä½“æŠ¢è´­é¡µé¢</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#56B6C2;">        exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            con.</span><span style="color:#61AFEF;">choose_ticket</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            retry </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> con.</span><span style="color:#61AFEF;">check_order</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> retry:</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            con.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(con.target_url)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#C678DD;">            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> con.status </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 6</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;###ç»è¿‡</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">è½®å¥‹æ–—ï¼Œè€—æ—¶</span><span style="color:#D19A66;">%.1f</span><span style="color:#98C379;">ç§’ï¼ŒæˆåŠŸä¸ºæ‚¨æŠ¢ç¥¨ï¼è¯·åŠæ—¶ç¡®è®¤è®¢å•ä¿¡æ¯å¹¶å®Œæˆæ”¯ä»˜ï¼###&quot;</span><span style="color:#56B6C2;"> %</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">            con.num, </span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(con.time_end </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> con.time_start, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#56B6C2;">        input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŒ‰ Enter é”®é€€å‡ºè„šæœ¬&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br></div></div><p>è§£æ</p><p>è¿™ä¸ªPythonè„šæœ¬ä½¿ç”¨äº†Seleniumåº“æ¥è‡ªåŠ¨åŒ–webæµè§ˆå™¨æ“ä½œï¼Œç›®çš„æ˜¯è‡ªåŠ¨åŒ–è´­ç¥¨æµç¨‹ã€‚è„šæœ¬çš„ä¸»ä½“æ˜¯ä¸€ä¸ªåä¸º<code>Concert</code>çš„ç±»ï¼Œç”¨æ¥å¤„ç†ä»ç™»å½•åˆ°è´­ç¥¨çš„æ‰€æœ‰æ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯ä»£ç ä¸­å…³é”®éƒ¨åˆ†çš„è¯¦ç»†è§£é‡Šï¼š</p><p>### ç±»å®šä¹‰ï¼š<code>Concert</code></p><p><code>Concert</code>ç±»è´Ÿè´£é…ç½®å’Œæ‰§è¡Œæ•´ä¸ªè´­ç¥¨æµç¨‹ï¼Œå®ƒçš„æ„é€ å‡½æ•°æ¥æ”¶å¤šä¸ªå‚æ•°æ¥å®šä¹‰è´­ç¥¨çš„å…·ä½“ç»†èŠ‚ï¼ˆå¦‚æ—¥æœŸã€åœºæ¬¡ã€ç¥¨ä»·ç­‰ï¼‰ã€‚</p><p>- __init__æ–¹æ³•ï¼šåˆå§‹åŒ–ç±»çš„å±æ€§ï¼Œè®¾ç½®è´­ç¥¨çš„ç›¸å…³å‚æ•°ã€‚</p><p>- isClassPresentæ–¹æ³•ï¼šè¾…åŠ©æ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥ç‰¹å®šçš„CSSç±»æ˜¯å¦å­˜åœ¨äºé¡µé¢å…ƒç´ ä¸­ã€‚</p><p>- get_cookieæ–¹æ³•ï¼šè®¿é—®é¢„çº¦å¹³å°ç½‘ä¸»é¡µï¼Œå¼•å¯¼ç”¨æˆ·ç™»å½•ä»¥è·å–cookiesï¼Œè¿™äº›cookieséšåè¢«ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ä»¥ä¾¿åç»­ä½¿ç”¨ã€‚</p><p>-set_cookieæ–¹æ³•ï¼šä»æœ¬åœ°æ–‡ä»¶åŠ è½½cookiesï¼Œå¹¶å°†å®ƒä»¬è®¾ç½®åˆ°æµè§ˆå™¨é©±åŠ¨ä¸­ï¼Œå®ç°è‡ªåŠ¨ç™»å½•ã€‚</p><p>- loginæ–¹æ³•ï¼šåŠ è½½ç›®æ ‡è´­ç¥¨ç½‘é¡µï¼Œå¹¶è°ƒç”¨<code>set_cookie</code>æ¥ç™»å½•ã€‚</p><p>- enter_concertæ–¹æ³•ï¼šè®¾ç½®æµè§ˆå™¨é©±åŠ¨å¹¶é…ç½®ï¼ˆå¦‚ç¦æ­¢å›¾ç‰‡å’ŒJavaScriptçš„åŠ è½½ï¼‰ï¼Œç„¶åè°ƒç”¨<code>login</code>æ–¹æ³•è¿›å…¥è´­ç¥¨é¡µé¢ã€‚</p><p><strong>è´­ç¥¨æµç¨‹</strong></p><p>- choose_ticketæ–¹æ³•ï¼šå®ç°è´­ç¥¨çš„æ ¸å¿ƒé€»è¾‘ã€‚è¿™ä¸ªæ–¹æ³•ä¼šä¸æ–­å°è¯•é€‰ç¥¨å’Œè´­ä¹°ï¼ŒåŒ…æ‹¬å¤„ç†å¤šç§é¡µé¢å…ƒç´ ï¼ˆå¦‚æ—¥å†ã€åœºæ¬¡ã€ç¥¨æ¡£ç­‰ï¼‰ã€‚</p><p>- click_utilæ–¹æ³•ï¼šå°è¯•ç‚¹å‡»ç‰¹å®šæŒ‰é’®ç›´åˆ°é¡µé¢ä¸Šå‡ºç°æœŸæœ›çš„å…ƒç´ ä¸ºæ­¢ã€‚</p><p>- check_orderæ–¹æ³•ï¼šåœ¨æˆåŠŸé€‰æ‹©ç¥¨ä¹‹åï¼Œæ£€æŸ¥è®¢å•ä¿¡æ¯ï¼Œå¹¶å°è¯•æäº¤è®¢å•ã€‚</p><p><strong>ä¸»ç¨‹åº</strong></p><p>- ä¸»ç¨‹åºéƒ¨åˆ†ä»é…ç½®æ–‡ä»¶ï¼ˆconfig.jsonï¼‰åŠ è½½é…ç½®ï¼Œåˆ›å»ºConcertç±»çš„å®ä¾‹ï¼Œå¹¶æ‰§è¡Œè´­ç¥¨æµç¨‹ã€‚</p><p>- ä½¿ç”¨äº†å¼‚å¸¸å¤„ç†æ¥æ•è·å’Œå¤„ç†è¿è¡Œä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</p><p>- å¾ªç¯è°ƒç”¨choose_ticketå’Œcheck_orderï¼Œç›´åˆ°ç¥¨åŠ¡æˆåŠŸè´­ä¹°æˆ–ç”¨æˆ·é€‰æ‹©é€€å‡ºã€‚</p><p><strong>å…¶ä»–æŠ€æœ¯ç»†èŠ‚</strong></p><p>- ä½¿ç”¨äº†WebDriverçš„Chromeå®ç°ï¼Œå¹¶é€šè¿‡ä¸€ç³»åˆ—é…ç½®æ¥ä¼˜åŒ–æ€§èƒ½å’Œæ©ç›–è‡ªåŠ¨åŒ–ç—•è¿¹ã€‚</p><p>- åˆ©ç”¨æ˜¾å¼ç­‰å¾…å’Œæ¡ä»¶æ£€æŸ¥æ¥ç¡®ä¿é¡µé¢å…ƒç´ åŠ è½½å®Œæˆã€‚</p><p>- å¤„ç†äº†ä¸€äº›å¸¸è§çš„å¼¹çª—å’Œæç¤ºï¼Œç¡®ä¿æµç¨‹ä¸ä¼šè¢«æ„å¤–æ‰“æ–­ã€‚</p><p>ç‰¹åˆ«é€‚ç”¨äºé‚£äº›éœ€è¦åœ¨ç‰¹å®šæ—¶é—´æŠ¢è´­é—¨ç¥¨çš„åœºåˆï¼Œä¾‹å¦‚çƒ­é—¨æ¼”å”±ä¼šã€ä½“è‚²èµ›äº‹ç­‰ã€‚é€šè¿‡è‡ªåŠ¨åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œç”¨æˆ·å¯ä»¥æ˜¾è‘—æé«˜æˆåŠŸè´­ç¥¨çš„æœºç‡ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h1 id="python-å…æ»‘å—éªŒè¯è„šæœ¬" tabindex="-1">Python å…æ»‘å—éªŒè¯è„šæœ¬ <a class="header-anchor" href="#python-å…æ»‘å—éªŒè¯è„šæœ¬" aria-label="Permalink to &quot;Python å…æ»‘å—éªŒè¯è„šæœ¬&quot;">â€‹</a></h1><p><img src="/ProgramLearnNotes/assets/640-1714148323181-31.DjK1xR8c.webp" alt="å›¾ç‰‡"></p><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºè‡ªåŠ¨ç™»å½•äº¬ä¸œå¹¶æ›´æ–° Cookie åˆ°é’é¾™ç®¡ç†ç³»ç»Ÿçš„ Python è„šæœ¬ã€‚è„šæœ¬æ”¯æŒé€šè¿‡è´¦å·å¯†ç è‡ªåŠ¨ç™»å½•ï¼Œé€‚ç”¨äºéœ€è¦å®šæœŸæ›´æ–°äº¬ä¸œ Cookie çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨é’é¾™ç­‰è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œäº¬ä¸œç›¸å…³æ´»åŠ¨è„šæœ¬è¿è¡Œæ—¶ã€‚</p><p>å…¨ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#98C379;">è„šæœ¬è¯´æ˜ï¼š</span></span>
<span class="line"><span style="color:#98C379;">1ã€è„šæœ¬ç”¨äºä½¿ç”¨è´¦å·å¯†ç è‡ªåŠ¨ç™»å½•äº¬ä¸œè·å–ckï¼Œè‡ªåŠ¨æ›´æ–°ckåˆ°é’é¾™</span></span>
<span class="line"><span style="color:#98C379;">2ã€å»ºè®®æœ¬åœ°ç™»å½•ï¼Œä¸å»ºè®®ä½¿ç”¨ä»£ç†ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æ‰‹æœºéªŒè¯ç ä¹‹åä¸€èˆ¬ä¸éœ€è¦éªŒè¯ç å°±å¯ä»¥å¯†ç ç™»å½•</span></span>
<span class="line"><span style="color:#98C379;">3ã€ç¨‹åºä»…æ›´æ–°è¢«ç¦ç”¨çš„ck</span></span>
<span class="line"><span style="color:#98C379;">4ã€è„šæœ¬æœ‰pyæºç ä»¥åŠwindowsç‰ˆæœ¬exeç¨‹åº</span></span>
<span class="line"><span style="color:#98C379;">5ã€pyè„šæœ¬éœ€è¦opencv-pythonã€pyppeteerã€Pillowã€asyncioã€aiohttpç­‰ä¾èµ–</span></span>
<span class="line"><span style="color:#98C379;">6ã€linuxéœ€è¦æ¡Œé¢ç¯å¢ƒï¼Œæ¯”å¦‚gnomeç”¨äºå›¾å½¢å¤„ç†</span></span>
<span class="line"><span style="color:#98C379;">7ã€ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¼šä¸‹è½½chromeæµè§ˆå™¨ï¼Œç”Ÿæˆjdck.inié…ç½®æ–‡ä»¶ï¼Œç­‰å¾…å³å¯ï¼Œåç»­æ— éœ€ç­‰å¾…</span></span>
<span class="line"><span style="color:#98C379;">8ã€æ­¤è„šæœ¬é€‚åˆäºé’é¾™å†…éƒ¨è¿è¡Œï¼Œå› é’é¾™å¤§éƒ¨åˆ†ä¸æ”¯æŒopencvæ’ä»¶ï¼Œä»…æ”¯æŒlinuxä»¥åŠwindowsè¿è¡Œï¼Œå»ºè®®ä½¿ç”¨windowsç‰ˆæœ¬ï¼Œå®šæ—¶è¿è¡Œå³å¯ã€‚</span></span>
<span class="line"><span style="color:#98C379;">9ã€è„šæœ¬åŸºäºpython3.12.1ç¼–å†™ï¼Œç›®å‰3.11å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå…¶å®ƒç‰ˆæœ¬æœªæµ‹è¯•</span></span>
<span class="line"><span style="color:#98C379;">10ã€è„šæœ¬éœ€è¦é’é¾™åº”ç”¨æƒé™â€”â€”ç¯å¢ƒå˜é‡è·Ÿè„šæœ¬ç®¡ç†</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">jdck.inié…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#98C379;">Displaylogin=0  #æ˜¯å¦æ˜¾ç¤ºç™»å½•æ“ä½œï¼Œ1æ˜¾ç¤ºï¼Œ0ä¸æ˜¾ç¤º</span></span>
<span class="line"><span style="color:#98C379;">qlip=http://192.168.1.1:5700  #å¡«é’é¾™çš„ip</span></span>
<span class="line"><span style="color:#98C379;">client_id=*******    #å¡«é’é¾™å¯¹æ¥åº”ç”¨çš„client_id</span></span>
<span class="line"><span style="color:#98C379;">client_secret=*******     #å¡«é’é¾™å¯¹æ¥åº”ç”¨çš„client_secret</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">ç™»é™†å·ç #å¯†ç #å¤‡æ³¨      #å¤šè´¦æˆ·æ¢è¡Œ</span></span>
<span class="line"><span style="color:#98C379;">517123248#ya21udb95#æˆ‘æ˜¯å¤‡æ³¨1</span></span>
<span class="line"><span style="color:#98C379;">15611167798#123456789#æˆ‘æ˜¯å¤‡æ³¨2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">åºŸæ¡ˆï¼šAutoJDCK_DP = http://192.168.2.3:2233      #è®¾ç½®ç™»å½•ä»£ç†ï¼ˆä¸å»ºè®®è®¾ç½®ä»£ç†ï¼ŒåŸºæœ¬ä¸Šè¦éªŒè¯ç ï¼‰</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">å…è´£å£°æ˜</span></span>
<span class="line"><span style="color:#98C379;">æœ¬è„šæœ¬ä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·åœ¨ä¸‹è½½å24å°æ—¶å†…åˆ é™¤ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚</span></span>
<span class="line"><span style="color:#98C379;">ä½œè€…ä¸å¯¹å› ä½¿ç”¨è¯¥è„šæœ¬é€ æˆçš„ä»»ä½•æŸå¤±æˆ–æ³•å¾‹é—®é¢˜è´Ÿè´£ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> asyncio  </span><span style="color:#7F848E;font-style:italic;"># å¼‚æ­¥I/Oæ“ä½œåº“</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random  </span><span style="color:#7F848E;font-style:italic;">#ç”¨äºæ¨¡æ‹Ÿå»¶è¿Ÿè¾“å…¥</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> re </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> T  </span><span style="color:#7F848E;font-style:italic;"># éšæœºæ•°ç”Ÿæˆåº“</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> cv2  </span><span style="color:#7F848E;font-style:italic;"># OpenCVåº“ï¼Œç”¨äºå›¾åƒå¤„ç†</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os  </span><span style="color:#7F848E;font-style:italic;">#è¯»å–é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pyppeteer </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> launch  </span><span style="color:#7F848E;font-style:italic;"># pyppeteeråº“ï¼Œç”¨äºè‡ªåŠ¨åŒ–æ§åˆ¶æµè§ˆå™¨</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> aiohttp   </span><span style="color:#7F848E;font-style:italic;">#ç”¨äºè¯·æ±‚é’é¾™</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> urllib </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> request  </span><span style="color:#7F848E;font-style:italic;"># ç”¨äºç½‘ç»œè¯·æ±‚ï¼Œè¿™é‡Œä¸»è¦ç”¨æ¥ä¸‹è½½å›¾ç‰‡</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image  </span><span style="color:#7F848E;font-style:italic;">#ç”¨äºå›¾åƒå¤„ç†</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> platform  </span><span style="color:#7F848E;font-style:italic;">#åˆ¤æ–­ç³»ç»Ÿç±»å‹</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> zipfile  </span><span style="color:#7F848E;font-style:italic;">#ç”¨äºè§£å‹æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#7F848E;font-style:italic;">#è·å–æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">message</span><span style="color:#ABB2BF;">):     </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–å¼‚æ­¥print</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(message)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> ifconfigfile</span><span style="color:#ABB2BF;">():                           </span><span style="color:#7F848E;font-style:italic;">#åˆ¤æ–­æœ‰æ²¡æœ‰é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> configfile            </span><span style="color:#7F848E;font-style:italic;">#é…ç½®æ–‡ä»¶å…¨å±€å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    configfile </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;jdck.ini&#39;</span><span style="color:#7F848E;font-style:italic;">     #é…ç½®æ–‡ä»¶åç§°ä¸º</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(configfile):     </span><span style="color:#7F848E;font-style:italic;">#çœ‹çœ‹æœ‰æ²¡æœ‰é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">        configdata </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#98C379;">&#39;Displaylogin=0  #æ˜¯å¦æ˜¾ç¤ºç™»å½•æ“ä½œï¼Œ1æ˜¾ç¤ºï¼Œ0ä¸æ˜¾ç¤º</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;qlip=http://192.168.1.1:5700</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;client_id=*******</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;client_secret=*******</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;517123248#ya21udb95#æˆ‘æ˜¯å¤‡æ³¨1</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;15611167798#123456789#æˆ‘æ˜¯å¤‡æ³¨2</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(configfile, </span><span style="color:#98C379;">&#39;w&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:     </span><span style="color:#7F848E;font-style:italic;">#æ‰“å¼€é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#E06C75;">            file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writelines</span><span style="color:#ABB2BF;">(configdata)       </span><span style="color:#7F848E;font-style:italic;">#å†™å…¥configdataçš„å†…å®¹åˆ°é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å·²åœ¨å½“å‰è„šæœ¬ç›®å½•ä¸‹ç”Ÿæˆäº†é…ç½®æ–‡ä»¶ï¼Œè¯·ä¿®æ”¹åå†è¿è¡Œ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…10ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> SystemExit</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> download_file</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">):        </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–æµè§ˆå™¨ä¸‹è½½</span></span>
<span class="line"><span style="color:#ABB2BF;">    timeout </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">total</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">60000</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®è¶…æ—¶æ—¶é—´</span></span>
<span class="line"><span style="color:#C678DD;">    async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">timeout) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:</span></span>
<span class="line"><span style="color:#C678DD;">        async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:</span></span>
<span class="line"><span style="color:#C678DD;">            with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                file_size </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(response.headers.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Content-Length&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                downloaded_size </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">                chunk_size </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1024</span></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    chunk </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.content.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(chunk_size)</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> chunk:</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#E06C75;">                    file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(chunk)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    downloaded_size </span><span style="color:#56B6C2;">+=</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(chunk)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    progress </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (downloaded_size </span><span style="color:#56B6C2;">/</span><span style="color:#ABB2BF;"> file_size) </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 100</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;å·²ä¸‹è½½</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">progress</span><span style="color:#C678DD;">:.2f</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">%...&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\r</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¸‹è½½å®Œæˆï¼Œè¿›è¡Œè§£å‹å®‰è£…....&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> init_web_display</span><span style="color:#ABB2BF;">():                           </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–æµè§ˆå™¨æ˜¾ç¤ºé…ç½®</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> WebDisplay                             </span><span style="color:#7F848E;font-style:italic;">#è®¾ç½®ä¸ºå…¨å±€å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    WebDisplay </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span><span style="color:#7F848E;font-style:italic;">                             #é»˜è®¤ä¸æ˜¾ç¤ºç™»å½•</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(configfile, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> line </span><span style="color:#C678DD;">in</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#98C379;"> &#39;Displaylogin=1&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> line:                             </span><span style="color:#7F848E;font-style:italic;">#å¦‚æœé…ç½®æ–‡ä»¶æœ‰Displaylogin=1è¿™ä¸ªä¸œè¥¿</span></span>
<span class="line"><span style="color:#ABB2BF;">                    WebDisplay </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span><span style="color:#7F848E;font-style:italic;">                             #å°±å˜æ›´æˆæ˜¾ç¤ºç™»å½•æ“ä½œ</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å½“å‰æ¨¡å¼ï¼šæ˜¾ç¤ºwebç™»å½•å›¾å½¢åŒ–ç•Œé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    break</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> WebDisplay:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å½“å‰é…ç½®ä¸æ˜¾ç¤ºwebç™»å½•å›¾å½¢åŒ–ç•Œé¢ï¼Œè‹¥è¦å–æ¶ˆé™é»˜ç™»é™†ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å‚æ•°Displaylogin=1&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> FileNotFoundError:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯»å–é…ç½®æ–‡ä»¶æ—¶å‡ºé”™&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> init_chrome</span><span style="color:#ABB2BF;">():        </span><span style="color:#7F848E;font-style:italic;">#åˆ¤æ–­chromeæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™ä¸‹è½½ï¼Œä»…é’ˆå¯¹windows</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> platform.</span><span style="color:#61AFEF;">system</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;Windows&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        chrome_dir </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.environ[</span><span style="color:#98C379;">&#39;USERPROFILE&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;AppData&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Local&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;pyppeteer&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;pyppeteer&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;local-chromium&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;588429&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;chrome-win32&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        chrome_exe </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(chrome_dir, </span><span style="color:#98C379;">&#39;chrome.exe&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        chmod_dir </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.environ[</span><span style="color:#98C379;">&#39;USERPROFILE&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;AppData&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Local&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;pyppeteer&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;pyppeteer&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;local-chromium&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;588429&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;chrome-win32&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;chrome-win32&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(chrome_exe):</span></span>
<span class="line"><span style="color:#C678DD;">            return</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è²Œä¼¼ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œæœªæ‰¾åˆ°chromeï¼Œæ­£åœ¨ä¸‹è½½chromeæµè§ˆå™¨....&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            chromeurl </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;http://npm.taobao.org/mirrors/chromium-browser-snapshots/Win_x64/588429/chrome-win32.zip&#39;</span><span style="color:#7F848E;font-style:italic;">        #å®šä¹‰ä¸‹è½½åœ°å€</span></span>
<span class="line"><span style="color:#ABB2BF;">            target_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;chrome-win.zip&#39;</span><span style="color:#7F848E;font-style:italic;">                                                          #å®šä¹‰ä¸‹è½½æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> download_file</span><span style="color:#ABB2BF;">(chromeurl, target_file)           </span><span style="color:#7F848E;font-style:italic;">#ä¸‹è½½</span></span>
<span class="line"><span style="color:#C678DD;">            with</span><span style="color:#ABB2BF;"> zipfile.</span><span style="color:#61AFEF;">ZipFile</span><span style="color:#ABB2BF;">(target_file, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> zip_ref:</span></span>
<span class="line"><span style="color:#ABB2BF;">                zip_ref.</span><span style="color:#61AFEF;">extractall</span><span style="color:#ABB2BF;">(chrome_dir)</span></span>
<span class="line"><span style="color:#ABB2BF;">            os.</span><span style="color:#61AFEF;">remove</span><span style="color:#ABB2BF;">(target_file)</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(chmod_dir):              </span><span style="color:#7F848E;font-style:italic;">#ç§»åŠ¨æ‰€æœ‰æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">                source_item </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(chmod_dir, item)</span></span>
<span class="line"><span style="color:#ABB2BF;">                destination_item </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(chrome_dir, item)</span></span>
<span class="line"><span style="color:#ABB2BF;">                os.</span><span style="color:#61AFEF;">rename</span><span style="color:#ABB2BF;">(source_item, destination_item)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è§£å‹å®‰è£…å®Œæˆ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…1ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">    elif</span><span style="color:#ABB2BF;"> platform.</span><span style="color:#61AFEF;">system</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;Linux&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        chrome_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">expanduser</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;~/.local/share/pyppeteer/local-chromium/1181205/chrome-linux/chrome&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        download_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">expanduser</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;~/.local/share/pyppeteer/local-chromium/1181205/&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">isfile</span><span style="color:#ABB2BF;">(chrome_path):</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è²Œä¼¼ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œæœªæ‰¾åˆ°chromeï¼Œæ­£åœ¨ä¸‹è½½chromeæµè§ˆå™¨....&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ–‡ä»¶ä½äºgithubï¼Œè¯·è€å¿ƒç­‰å¾…ï¼Œå¦‚é‡åˆ°ç½‘ç»œé—®é¢˜å¯åˆ°é¡¹ç›®åœ°å€æ‰‹åŠ¨ä¸‹è½½&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            download_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;https://github.com/dsmggm/svjdck/releases/download/jdck/chrome-linux.zip&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(download_path):       </span><span style="color:#7F848E;font-style:italic;">#å¦‚æœæ²¡æœ‰è·¯å¾„å°±åˆ›å»ºè·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">                os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(download_path, </span><span style="color:#E06C75;font-style:italic;">exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸‹è½½è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">            target_file </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(download_path, </span><span style="color:#98C379;">&#39;chrome-linux.zip&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸‹è½½æ–‡ä»¶è·¯å¾„è·Ÿæ–‡ä»¶å</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#61AFEF;"> download_file</span><span style="color:#ABB2BF;">(download_url, target_file)           </span><span style="color:#7F848E;font-style:italic;">#ä¸‹è½½</span></span>
<span class="line"><span style="color:#C678DD;">            with</span><span style="color:#ABB2BF;"> zipfile.</span><span style="color:#61AFEF;">ZipFile</span><span style="color:#ABB2BF;">(target_file, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> zip_ref:</span></span>
<span class="line"><span style="color:#ABB2BF;">                zip_ref.</span><span style="color:#61AFEF;">extractall</span><span style="color:#ABB2BF;">(download_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">            os.</span><span style="color:#61AFEF;">remove</span><span style="color:#ABB2BF;">(target_file)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;åˆ åŒ…&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            os.</span><span style="color:#61AFEF;">chmod</span><span style="color:#ABB2BF;">(chrome_path, </span><span style="color:#C678DD;">0o</span><span style="color:#D19A66;">755</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è§£å‹å®‰è£…å®Œæˆ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    elif</span><span style="color:#ABB2BF;"> platform.</span><span style="color:#61AFEF;">system</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;Darwin&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#98C379;"> &#39;mac&#39;</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#98C379;"> &#39;unknown&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> initql</span><span style="color:#ABB2BF;">():        </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–é’é¾™å¹¶è·å–é’é¾™çš„token</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> qlip  </span><span style="color:#7F848E;font-style:italic;"># å£°æ˜è¿™ä¸ªæ˜¯å…¨å±€å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    client_id </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span><span style="color:#7F848E;font-style:italic;">   #åˆå§‹åŒ–å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    client_secret </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span><span style="color:#7F848E;font-style:italic;">   #åˆå§‹åŒ–å˜é‡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(configfile, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:    </span><span style="color:#7F848E;font-style:italic;">#ç”¨UTF-8ç¼–ç æ–¹å¼æ‰“å¼€é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">            lines </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readlines</span><span style="color:#ABB2BF;">()           </span><span style="color:#7F848E;font-style:italic;">#éå†æ¯ä¸€è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> line </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> lines:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#98C379;"> &#39;qlip=&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> line:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    qlip </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> line.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;qlip=&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()         </span><span style="color:#7F848E;font-style:italic;">#æ‰¾é…ç½®æ–‡ä»¶ä¸­qlip=çš„å€¼å¹¶èµ‹äºˆqlip</span></span>
<span class="line"><span style="color:#C678DD;">                elif</span><span style="color:#98C379;"> &#39;client_id=&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> line:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    client_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> line.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;client_id=&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()       </span><span style="color:#7F848E;font-style:italic;">#åŒä¸Š</span></span>
<span class="line"><span style="color:#C678DD;">                elif</span><span style="color:#98C379;"> &#39;client_secret=&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> line:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    client_secret </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> line.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;client_secret=&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()     </span><span style="color:#7F848E;font-style:italic;">#åŒä¸Š</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> qlip </span><span style="color:#C678DD;">or</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> client_id </span><span style="color:#C678DD;">or</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> client_secret:         </span><span style="color:#7F848E;font-style:italic;">#å¦‚æœæ²¡æœ‰ä¸‰ä¸ªå‚æ•°å˜é‡æ²¡æœ‰å€¼ï¼Œå°±æŠ¥ä¸‹é¢çš„é”™è¯¯ï¼Œå•ä¸ªæ£€æµ‹æŠ¥é”™</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> qlip:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é’é¾™IPé…ç½®å‡ºé”™ï¼Œè¯·ç¡®è®¤é…ç½®æ–‡ä»¶&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…10ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> client_id:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é’é¾™client_idé…ç½®å‡ºé”™ï¼Œè¯·ç¡®è®¤é…ç½®æ–‡ä»¶&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…10ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> client_secret:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é’é¾™client_secreté…ç½®å‡ºé”™ï¼Œè¯·ç¡®è®¤é…ç½®æ–‡ä»¶&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…10ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">            raise</span><span style="color:#ABB2BF;"> SystemExit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:                </span><span style="color:#7F848E;font-style:italic;">#è·å–é’é¾™çš„token</span></span>
<span class="line"><span style="color:#C678DD;">            async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">qlip</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/open/auth/token?client_id=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">client_id</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&amp;client_secret=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">client_secret</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:</span></span>
<span class="line"><span style="color:#ABB2BF;">                dicts </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å·²è¿æ¥é’é¾™å®¹å™¨...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> dicts[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;è¿æ¥é’é¾™å‘ç”Ÿå¼‚å¸¸ï¼Œè¯·ç¡®è®¤é…ç½®æ–‡ä»¶ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…10ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"><span style="color:#C678DD;">        raise</span><span style="color:#ABB2BF;"> SystemExit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> qlenvs</span><span style="color:#ABB2BF;">():   </span><span style="color:#7F848E;font-style:italic;">#è·å–é’é¾™å…¨éƒ¨jdckå˜é‡</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:                              </span><span style="color:#7F848E;font-style:italic;"># å¼‚æ­¥æ“ä½œå‘½ä»¤</span></span>
<span class="line"><span style="color:#ABB2BF;">            url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">qlip</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/open/envs?searchValue=&quot;</span><span style="color:#7F848E;font-style:italic;">                   #è®¾ç½®è®¾ç½®è¿æ¥</span></span>
<span class="line"><span style="color:#ABB2BF;">            headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;Authorization&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Bearer &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> qltoken}                         </span><span style="color:#7F848E;font-style:italic;">#è®¾ç½®apiçš„headersè¯·æ±‚å¤´</span></span>
<span class="line"><span style="color:#C678DD;">            async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:                              </span><span style="color:#7F848E;font-style:italic;">#è·å–å˜é‡è¯·æ±‚</span></span>
<span class="line"><span style="color:#ABB2BF;">                rjson </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()                             </span><span style="color:#7F848E;font-style:italic;">#è§£æè¿”å›çš„jsonæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:                                </span><span style="color:#7F848E;font-style:italic;">#å¦‚æœè¿”å›code200,æ ¹æ®é’é¾™apiæ–‡æ¡£</span></span>
<span class="line"><span style="color:#ABB2BF;">                    jd_cookie_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [env </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> env </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> env.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;JD_COOKIE&#39;</span><span style="color:#ABB2BF;">]            </span><span style="color:#7F848E;font-style:italic;">#è·å–å…¨éƒ¨jdçš„å˜é‡</span></span>
<span class="line"><span style="color:#C678DD;">                    global</span><span style="color:#ABB2BF;"> notess      </span><span style="color:#7F848E;font-style:italic;">#æŠŠå¤‡æ³¨è®¾ç½®ä¸ºå…¨éƒ¨å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">                    notess </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [env[</span><span style="color:#98C379;">&#39;remarks&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> env </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> env.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;JD_COOKIE&#39;</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> env.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">]             </span><span style="color:#7F848E;font-style:italic;">#æ‰¾åˆ°æ‰€æœ‰nameä¸ºJD_COOKIEï¼Œstatusä¸º0çš„å­—å…¸åˆ—è¡¨ï¼Œç„¶åæŠŠremarksçš„å€¼æ”¾è¿›notess</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    #global jdckpasswd      #æŠŠè´¦å·å¯†ç å˜é‡è®¾ä¸ºå…¨å±€å˜é‡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    #jdckpasswd = next((env[&#39;value&#39;].strip().split(&#39;\n&#39;) for env in rjson[&#39;data&#39;] if env.get(&#39;name&#39;) == &#39;jdckpasswd&#39;), None)      #è·å–è´¦å·å¯†ç å˜é‡</span></span>
<span class="line"><span style="color:#C678DD;">                    global</span><span style="color:#ABB2BF;"> proxy_server      </span><span style="color:#7F848E;font-style:italic;">#æŠŠä»£ç†å˜é‡è®¾ä¸ºå…¨å±€å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">                    proxy_server </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> next</span><span style="color:#ABB2BF;">((env[</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> env </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> env.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;AutoJDCK_DP&#39;</span><span style="color:#ABB2BF;">), </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;">#è·å–ä»£ç†å˜é‡</span></span>
<span class="line"><span style="color:#C678DD;">                    return</span><span style="color:#ABB2BF;"> jd_cookie_data</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;è·å–ç¯å¢ƒå˜é‡å¤±è´¥ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rjson[</span><span style="color:#98C379;">&#39;message&#39;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;è·å–ç¯å¢ƒå˜é‡å¤±è´¥ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> push_message</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">qltoken</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">notes</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    js_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;JdckNotify.js&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    push_data </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">const notify = require(&#39;./sendNotify&#39;)</span></span>
<span class="line"><span style="color:#98C379;">const message = [&quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;"> è´¦å·éœ€è¦éªŒè¯ç™»å½•&quot;];</span></span>
<span class="line"><span style="color:#98C379;">notify.sendNotify(`JDCKç™»å½•éªŒè¯é€šçŸ¥`, message)</span></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(notes)       </span><span style="color:#7F848E;font-style:italic;">#è„šæœ¬å†…å®¹ï¼Œ{}æ˜¯noteså˜é‡å†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">    data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">        &quot;filename&quot;</span><span style="color:#ABB2BF;">: js_file,</span></span>
<span class="line"><span style="color:#98C379;">        &quot;path&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;./&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">        &quot;content&quot;</span><span style="color:#ABB2BF;">: push_data    </span><span style="color:#7F848E;font-style:italic;">#è„šæœ¬å†…å®¹ï¼Œå¦‚ä¸Špush_data</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:                             </span><span style="color:#7F848E;font-style:italic;">#æ¨é€è¿è¡Œè„šæœ¬</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">qlip</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/open/scripts/run&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;Authorization&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Bearer &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> qltoken}, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:            </span><span style="color:#7F848E;font-style:italic;">#æ›´æ–°å˜é‡çš„api</span></span>
<span class="line"><span style="color:#ABB2BF;">                rjson </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ¨é€éªŒè¯é€šçŸ¥&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ¨é€éªŒè¯é€šçŸ¥å¤±è´¥,è¯·æ£€æŸ¥é’é¾™åº”ç”¨ã€Šè„šæœ¬ç®¡ç†ã€‹æƒé™&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ¨é€éªŒè¯é€šçŸ¥å¤±è´¥,è¯·æ£€æŸ¥é’é¾™è¿æ¥çŠ¶æ€å’Œåº”ç”¨ã€Šè„šæœ¬ç®¡ç†ã€‹æƒé™&#39;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> logon_main</span><span style="color:#ABB2BF;">():             </span><span style="color:#7F848E;font-style:italic;">#è¯»å–é…ç½®æ–‡ä»¶è´¦æˆ·å¯†ç ï¼Œç™»å½•</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> qltoken   </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–é’é¾™è·å–é’é¾™ck</span></span>
<span class="line"><span style="color:#ABB2BF;">    qltoken </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> initql</span><span style="color:#ABB2BF;">()      </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–é’é¾™token</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> envs               </span><span style="color:#7F848E;font-style:italic;">#é’é¾™ç¯å¢ƒå…¨å±€å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    envs </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> qlenvs</span><span style="color:#ABB2BF;">()   </span><span style="color:#7F848E;font-style:italic;">#è·å–é’é¾™ç¯å¢ƒå˜é‡(ä»…JC_COOKIE)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> init_web_display</span><span style="color:#ABB2BF;">()     </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–WebDisplay</span></span>
<span class="line"><span style="color:#C678DD;">    global</span><span style="color:#ABB2BF;"> asgs</span></span>
<span class="line"><span style="color:#ABB2BF;">    asgs </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> init_proxy_server</span><span style="color:#ABB2BF;">()   </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–ç™»å½•ä»£ç†ï¼ˆæµè§ˆå™¨argsçš„å€¼ï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(configfile, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> jdckpasswd:</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> line </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> jdckpasswd:    </span><span style="color:#7F848E;font-style:italic;"># å»é™¤è¡Œå°¾çš„æ¢è¡Œç¬¦</span></span>
<span class="line"><span style="color:#ABB2BF;">            line </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> line.</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            userdata </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> line.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#&#39;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨&#39;#&#39;åˆ†å‰²å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(userdata) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 3</span><span style="color:#ABB2BF;">:   </span><span style="color:#7F848E;font-style:italic;">#åˆ†ä¸ºä¸‰æ®µï¼Œå¦‚æœä¸æ»¡è¶³3æ®µï¼Œåˆ™è·³è¿‡æ­¤è¡Œ</span></span>
<span class="line"><span style="color:#ABB2BF;">                usernum, passwd, notes</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> userdata     </span><span style="color:#7F848E;font-style:italic;"># è§£åŒ…åˆ—è¡¨åˆ°å››ä¸ªå˜é‡ï¼Œå¹¶æŒ‰ç…§æŒ‡å®šæ ¼å¼æ‰“å°</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> notes </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> notess:        </span><span style="color:#7F848E;font-style:italic;"># åˆ¤æ–­æ˜¯å¦ä¸å­˜åœ¨ &quot;notes&quot; åœ¨ notess ä¸­</span></span>
<span class="line"><span style="color:#C678DD;">                    await</span><span style="color:#61AFEF;"> validate_logon</span><span style="color:#ABB2BF;">(usernum, passwd, notes)   </span><span style="color:#7F848E;font-style:italic;">#ç™»å½•</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> get_user_choice</span><span style="color:#ABB2BF;">():            </span><span style="color:#7F848E;font-style:italic;">#çŸ­ä¿¡éªŒè¯é€‰æ‹©</span></span>
<span class="line"><span style="color:#ABB2BF;">    choice </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#ABB2BF;"> choice </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            choice </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">wait_for</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                asyncio.</span><span style="color:#61AFEF;">get_event_loop</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">run_in_executor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;éœ€è¦è¿›è¡ŒçŸ­ä¿¡éªŒè¯ï¼Œå›1è¿›è¡ŒéªŒè¯ï¼Œå›2ä¸éªŒè¯ï¼š  &quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">120</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> choice </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ— æ•ˆè¾“å…¥ï¼Œè¯·åªè¾“å…¥1æˆ–2ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š  &quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> asyncio.TimeoutError:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">è¾“å…¥è¶…æ—¶ï¼Œè·³è¿‡ç™»é™†&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            choice </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;2&#39;</span></span>
<span class="line"><span style="color:#C678DD;">            break</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å‘ç”Ÿé”™è¯¯ï¼š&quot;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> choice</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> validate_logon</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">usernum</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">passwd</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">notes</span><span style="color:#ABB2BF;">):                                         </span><span style="color:#7F848E;font-style:italic;">#ç™»å½•æ“ä½œ</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ­£åœ¨ç™»å½• </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">notes</span><span style="color:#D19A66;">}</span><span style="color:#D19A66;"> {</span><span style="color:#ABB2BF;">usernum</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> çš„è´¦å·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    browser </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> launch</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#98C379;">        &#39;headless&#39;</span><span style="color:#ABB2BF;">: WebDisplay,  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®ä¸ºéæ— å¤´æ¨¡å¼ï¼Œå³å¯è§†åŒ–æµè§ˆå™¨ç•Œé¢</span></span>
<span class="line"><span style="color:#98C379;">        &#39;args&#39;</span><span style="color:#ABB2BF;">: asgs,</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">    page </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> browser.</span><span style="color:#61AFEF;">newPage</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># æ‰“å¼€æ–°é¡µé¢</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">setViewport</span><span style="color:#ABB2BF;">({</span><span style="color:#98C379;">&#39;width&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">360</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;height&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">640</span><span style="color:#ABB2BF;">})  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®è§†çª—å¤§å°</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">goto</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;https://plogin.m.jd.com/login/login?appid=300&amp;returnurl=https%3A</span><span style="color:#D19A66;">%2F%2F</span><span style="color:#98C379;">m.jd.com</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">&amp;source=wq_passport&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è®¿é—®äº¬ä¸œç™»å½•é¡µé¢</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> typeuser</span><span style="color:#ABB2BF;">(page, usernum, passwd)        </span><span style="color:#7F848E;font-style:italic;">#è¿›è¡Œè´¦å·å¯†ç ç™»å½•</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    should_break </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span><span style="color:#7F848E;font-style:italic;">  #å®šä¹‰ä¸‹é¢ä¸åœå¾ªç¯</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:                              </span><span style="color:#7F848E;font-style:italic;">#æ‰¾ck</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">J</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;#searchWrapper&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#61AFEF;"> SubmitCK</span><span style="color:#ABB2BF;">(page, notes)  </span><span style="color:#7F848E;font-style:italic;">#æäº¤ck</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#ABB2BF;"> browser.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;">#å…³é—­æµè§ˆå™¨</span></span>
<span class="line"><span style="color:#ABB2BF;">                should_break </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:                              </span><span style="color:#7F848E;font-style:italic;">#æ£€æŸ¥æ˜¯ä¸æ˜¯è¦çŸ­ä¿¡éªŒè¯</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">J</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.sub-title&#39;</span><span style="color:#ABB2BF;">):       </span><span style="color:#7F848E;font-style:italic;">#&lt;p data-v-4c407d20=&quot;&quot; class=&quot;sub-title&quot;&gt;é€‰æ‹©è®¤è¯æ–¹å¼&lt;/p&gt;</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#61AFEF;"> push_message</span><span style="color:#ABB2BF;">(qltoken, notes)          </span><span style="color:#7F848E;font-style:italic;">#æ¨é€éœ€è¦éªŒè¯ç™»é™†é€šçŸ¥</span></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        choice </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> get_user_choice</span><span style="color:#ABB2BF;">()            </span><span style="color:#7F848E;font-style:italic;">#è°ƒç”¨é€‰æ‹©å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">                        if</span><span style="color:#ABB2BF;"> choice </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;1&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ­£åœ¨å‘é€çŸ­ä¿¡éªŒè¯&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                            await</span><span style="color:#61AFEF;"> duanxin</span><span style="color:#ABB2BF;">(page)    </span><span style="color:#7F848E;font-style:italic;">#è°ƒç”¨çŸ­ä¿¡ç™»å½•å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">                            break</span></span>
<span class="line"><span style="color:#C678DD;">                        elif</span><span style="color:#ABB2BF;"> choice </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;2&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                            await</span><span style="color:#ABB2BF;"> browser.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;">#å…³é—­æµè§ˆå™¨</span></span>
<span class="line"><span style="color:#56B6C2;">                            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¸è¿›è¡ŒéªŒè¯ï¼Œè·³è¿‡æ­¤è´¦æˆ·ç™»å½•&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                            should_break </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                            break</span></span>
<span class="line"><span style="color:#C678DD;">                        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ— æ•ˆçš„é€‰æ‹©&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    except</span><span style="color:#ABB2BF;"> asyncio.TimeoutError:</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾“å…¥è¶…æ—¶ï¼Œè·³è¿‡ç™»é™†&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        should_break </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:                              </span><span style="color:#7F848E;font-style:italic;">#æ£€æµ‹æ˜¯å¦è¦è¿‡æ»‘å—</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;small_img&quot;]&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#61AFEF;"> verification</span><span style="color:#ABB2BF;">(page)  </span><span style="color:#7F848E;font-style:italic;">#è¿‡æ»‘å—</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;captcha_modal&quot;]/div/div[3]/button&#39;</span><span style="color:#ABB2BF;">):             </span><span style="color:#7F848E;font-style:italic;">#ç‚¹å‡»å›¾ç‰‡éªŒè¯ï¼Œæ— æ³•è¿‡</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…3ç§’</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;éªŒè¯å‡ºé”™ï¼Œæ­£åœ¨é‡è¯•â€¦â€¦&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">reload</span><span style="color:#ABB2BF;">()                  </span><span style="color:#7F848E;font-style:italic;">#åˆ·æ–°æµè§ˆå™¨</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#61AFEF;"> typeuser</span><span style="color:#ABB2BF;">(page, usernum, passwd)        </span><span style="color:#7F848E;font-style:italic;">#è¿›è¡Œè´¦å·å¯†ç ç™»å½•</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> should_break:  </span><span style="color:#7F848E;font-style:italic;">#æ£€æŸ¥æ˜¯å¦åœæ­¢å¾ªç¯</span></span>
<span class="line"><span style="color:#C678DD;">            break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> typeuser</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">page</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">usernum</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">passwd</span><span style="color:#ABB2BF;">):         </span><span style="color:#7F848E;font-style:italic;">#è¾“å…¥è´¦æˆ·å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitForSelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.J_ping.planBLogin&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…å…ƒç´ å‡ºç°</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.J_ping.planBLogin&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç‚¹å‡»å¯†ç ç™»å½•</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">type</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#username&#39;</span><span style="color:#ABB2BF;">, usernum, {</span><span style="color:#98C379;">&#39;delay&#39;</span><span style="color:#ABB2BF;">: random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">121</span><span style="color:#ABB2BF;">)})  </span><span style="color:#7F848E;font-style:italic;"># è¾“å…¥ç”¨æˆ·åï¼Œæ¨¡æ‹Ÿé”®ç›˜è¾“å…¥å»¶è¿Ÿ</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">type</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#pwd&#39;</span><span style="color:#ABB2BF;">, passwd, {</span><span style="color:#98C379;">&#39;delay&#39;</span><span style="color:#ABB2BF;">: random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">151</span><span style="color:#ABB2BF;">)})  </span><span style="color:#7F848E;font-style:italic;"># è¾“å…¥å¯†ç ï¼Œæ¨¡æ‹Ÿé”®ç›˜è¾“å…¥å»¶è¿Ÿ</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">))      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…1-2ç§’</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.policy_tip-checkbox&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç‚¹å‡»åŒæ„</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">))      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…1-2ç§’</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.btn.J_ping.btn-active&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç‚¹å‡»ç™»å½•æŒ‰é’®</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">))      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…1-2ç§’</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> SubmitCK</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">page</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">notes</span><span style="color:#ABB2BF;">):  </span><span style="color:#7F848E;font-style:italic;">#æäº¤ck</span></span>
<span class="line"><span style="color:#ABB2BF;">    cookies </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">cookies</span><span style="color:#ABB2BF;">()                             </span><span style="color:#7F848E;font-style:italic;">#è®¾ç½®cookeiså˜é‡ï¼Œç”¨äºä¸‹é¢çš„æœç´¢</span></span>
<span class="line"><span style="color:#ABB2BF;">    pt_key </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#7F848E;font-style:italic;">                             #åˆå§‹åŒ–å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    pt_pin </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#7F848E;font-style:italic;">                             #åˆå§‹åŒ–å˜é‡</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> cookie </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> cookies:                              </span><span style="color:#7F848E;font-style:italic;">#æ‰¾æ‰€æœ‰ç½‘é¡µæ‰€æœ‰çš„cookieæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> cookie[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;pt_key&#39;</span><span style="color:#ABB2BF;">:                             </span><span style="color:#7F848E;font-style:italic;">#æ‰¾åˆ°pt_keyçš„å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">            pt_key </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cookie[</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">]                             </span><span style="color:#7F848E;font-style:italic;">#æŠŠå€¼è®¾ç½®åˆ°å˜é‡pt_key</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#ABB2BF;"> cookie[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;pt_pin&#39;</span><span style="color:#ABB2BF;">:                             </span><span style="color:#7F848E;font-style:italic;">#æ‰¾åˆ°pt_pinçš„å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">            pt_pin </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cookie[</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">]                             </span><span style="color:#7F848E;font-style:italic;">#æŠŠå€¼è®¾ç½®åˆ°å˜é‡pt_pin</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;"> ç™»å½•æˆåŠŸ pt_key=</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">;pt_pin=</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">;&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(notes, pt_key, pt_pin))    </span><span style="color:#7F848E;font-style:italic;"># æ‰“å° pt_key å’Œ pt_pin å€¼</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;jdck.log&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;a+&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:    </span><span style="color:#7F848E;font-style:italic;">#æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">        content </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;</span><span style="color:#D19A66;">{}</span><span style="color:#D19A66;">   {}</span><span style="color:#98C379;">   pt_key=</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">;pt_pin=</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&#39;</span><span style="color:#ABB2BF;">), notes, pt_key, pt_pin)   </span><span style="color:#7F848E;font-style:italic;"># æ„é€ è¦å†™å…¥æ–‡ä»¶çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#E06C75;">        file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(content)  </span><span style="color:#7F848E;font-style:italic;"># å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    found_ddhhs </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span><span style="color:#7F848E;font-style:italic;">                             #åˆå§‹åŒ–å¾ªç¯å˜é‡ï¼Œç”¨äºåé¢æ‰¾ä¸åˆ°å˜é‡çš„è§£å†³æ–¹å¼</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> env </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> envs:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> notes </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> env[</span><span style="color:#98C379;">&quot;remarks&quot;</span><span style="color:#ABB2BF;">]:      </span><span style="color:#7F848E;font-style:italic;">#åœ¨æ‰€æœ‰å˜é‡å€¼ä¸­æ‰¾remarksï¼Œæ‰¾åˆ°æ‰§è¡Œä¸‹é¢çš„æ›´æ–°ck</span></span>
<span class="line"><span style="color:#ABB2BF;">            envid </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> env[</span><span style="color:#98C379;">&quot;id&quot;</span><span style="color:#ABB2BF;">]                             </span><span style="color:#7F848E;font-style:italic;">#æŠŠæ‰¾åˆ°çš„idè®¾ä¸ºenvidçš„å˜é‡å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">            remarks </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> env[</span><span style="color:#98C379;">&quot;remarks&quot;</span><span style="color:#ABB2BF;">]                             </span><span style="color:#7F848E;font-style:italic;">#åŒä¸Š</span></span>
<span class="line"><span style="color:#ABB2BF;">            found_ddhhs </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span><span style="color:#7F848E;font-style:italic;">                             #æŠŠå˜é‡è®¾ä¸ºTrueï¼Œåœä¸‹å¾ªç¯</span></span>
<span class="line"><span style="color:#ABB2BF;">            data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">                &#39;name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;JD_COOKIE&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;pt_key=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pt_key</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">;pt_pin=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pt_pin</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">;&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;remarks&quot;</span><span style="color:#ABB2BF;">: remarks,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;id&quot;</span><span style="color:#ABB2BF;">: envid,</span></span>
<span class="line"><span style="color:#ABB2BF;">            }                             </span><span style="color:#7F848E;font-style:italic;">#æäº¤é’é¾™çš„æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">            async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:                             </span><span style="color:#7F848E;font-style:italic;">#ä¸‹é¢æ˜¯æäº¤</span></span>
<span class="line"><span style="color:#ABB2BF;">                url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">qlip</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/open/envs&quot;</span></span>
<span class="line"><span style="color:#C678DD;">                async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;Authorization&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Bearer &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> qltoken}, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:            </span><span style="color:#7F848E;font-style:italic;">#æ›´æ–°å˜é‡çš„api</span></span>
<span class="line"><span style="color:#ABB2BF;">                    rjson </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        url2 </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">qlip</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/open/envs/enable&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        data2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">                            envid</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ]</span></span>
<span class="line"><span style="color:#C678DD;">                        async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(url2, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;Authorization&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Bearer &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> qltoken}, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data2) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:            </span><span style="color:#7F848E;font-style:italic;">#å¯ç”¨å˜é‡çš„api</span></span>
<span class="line"><span style="color:#ABB2BF;">                            rjson2 </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                            if</span><span style="color:#ABB2BF;"> rjson2[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ›´æ–°</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">notes</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ç¯å¢ƒå˜é‡æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                                return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å¯ç”¨</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">notes</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ç¯å¢ƒå˜é‡å¤±è´¥ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rjson[</span><span style="color:#98C379;">&#39;message&#39;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                                return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">                    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ›´æ–°</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">notes</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ç¯å¢ƒå˜é‡å¤±è´¥ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rjson[</span><span style="color:#98C379;">&#39;message&#39;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                        return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> found_ddhhs:          </span><span style="color:#7F848E;font-style:italic;">#å¦‚æœæ²¡æ‰¾åˆ°pt_pinï¼Œæ‰§è¡Œä¸‹é¢çš„æ–°å»ºckï¼Œä»¥ä¸‹åŒä¸Šï¼Œåªæ˜¯æ–°å»ºä¸æ˜¯æ›´æ–°</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#98C379;">                &#39;name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;JD_COOKIE&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;pt_key=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pt_key</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">;pt_pin=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pt_pin</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">;&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;remarks&quot;</span><span style="color:#ABB2BF;">: notes,</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        ]</span></span>
<span class="line"><span style="color:#C678DD;">        async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:</span></span>
<span class="line"><span style="color:#ABB2BF;">            url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">qlip</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/open/envs&quot;</span></span>
<span class="line"><span style="color:#C678DD;">            async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;Authorization&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Bearer &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> qltoken}, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:</span></span>
<span class="line"><span style="color:#ABB2BF;">                rjson </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> rjson[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ–°å»º</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">notes</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ç¯å¢ƒå˜é‡æˆåŠŸ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ–°å»º</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">notes</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ç¯å¢ƒå˜é‡å¤±è´¥ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rjson[</span><span style="color:#98C379;">&#39;message&#39;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                    return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> get_verification_code</span><span style="color:#ABB2BF;">():  </span><span style="color:#7F848E;font-style:italic;"># äº¤äº’è¾“å…¥éªŒè¯ç </span></span>
<span class="line"><span style="color:#ABB2BF;">    code </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        code </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;éªŒè¯ç å·²å‘é€ï¼Œè¯·è¾“å…¥éªŒè¯ç : &quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(code) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 6</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> code.</span><span style="color:#61AFEF;">isdigit</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">            break</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥6ä½æ•°å­—ä½œä¸ºéªŒè¯ç ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> code</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> duanxin</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">page</span><span style="color:#ABB2BF;">):   </span><span style="color:#7F848E;font-style:italic;">#çŸ­ä¿¡éªŒè¯å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitForXPath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/div[2]/span/a&#39;</span><span style="color:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;">#ç­‰æ‰‹æœºçŸ­ä¿¡è®¤è¯å…ƒç´   //*[@id=&quot;app&quot;]/div/div[2]</span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…1-3ç§’</span></span>
<span class="line"><span style="color:#ABB2BF;">        elements </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/div[2]/span/a&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é€‰æ‹©å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> elements[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ç‚¹å‡»å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitForXPath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/div[2]/button&#39;</span><span style="color:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;">#ç­‰è·å–éªŒè¯ç å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…1-3ç§’</span></span>
<span class="line"><span style="color:#ABB2BF;">        elements </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/div[2]/button&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é€‰æ‹©å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> elements[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ç‚¹å‡»å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">        await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…3ç§’ï¼Œç­‰å¾…æ˜¯å¦è¦æ»‘å—</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:                              </span><span style="color:#7F848E;font-style:italic;">#æ£€æµ‹æ˜¯å¦è¦è¿‡æ»‘å—</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;captcha_modal&quot;]/div/div[3]/div&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">                await</span><span style="color:#61AFEF;"> verification</span><span style="color:#ABB2BF;">(page)  </span><span style="color:#7F848E;font-style:italic;">#è¿‡æ»‘å—</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitForXPath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/div[2]/div/input&#39;</span><span style="color:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…è¾“å…¥æ¡†å…ƒç´ å‡ºç°</span></span>
<span class="line"><span style="color:#ABB2BF;">            code </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> get_verification_code</span><span style="color:#ABB2BF;">()   </span><span style="color:#7F848E;font-style:italic;">#äº¤äº’è¾“å…¥éªŒè¯ç </span></span>
<span class="line"><span style="color:#ABB2BF;">            input_elements </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/div[2]/div/input&#39;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;"># é€‰æ‹©è¾“å…¥æ¡†å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> input_elements[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">type</span><span style="color:#ABB2BF;">(code)       </span><span style="color:#7F848E;font-style:italic;"># è¾“å…¥éªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitForXPath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/a[1]&#39;</span><span style="color:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;">#ç­‰ç™»å½•æŒ‰é’®å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…1-3ç§’</span></span>
<span class="line"><span style="color:#ABB2BF;">            elements </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">xpath</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;//*[@id=&quot;app&quot;]/div/div[2]/a[1]&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é€‰æ‹©å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> elements[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ç‚¹å‡»å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">            await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;">#éšæœºç­‰å¾…2-3ç§’</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#C678DD;">            pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> verification</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">page</span><span style="color:#ABB2BF;">):            </span><span style="color:#7F848E;font-style:italic;">#è¿‡æ»‘å—</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitForSelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#cpc_img&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    image_src </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">Jeval</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#cpc_img&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;el =&gt; el.getAttribute(&quot;src&quot;)&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è·å–æ»‘å—èƒŒæ™¯å›¾çš„åœ°å€</span></span>
<span class="line"><span style="color:#ABB2BF;">    request.</span><span style="color:#61AFEF;">urlretrieve</span><span style="color:#ABB2BF;">(image_src, </span><span style="color:#98C379;">&#39;image.png&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ä¸‹è½½æ»‘å—èƒŒæ™¯å›¾</span></span>
<span class="line"><span style="color:#ABB2BF;">    width </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">evaluate</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;() =&gt; { return document.getElementById(&quot;cpc_img&quot;).clientWidth; }&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#è·å–ç½‘é¡µçš„å›¾ç‰‡å°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    height </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">evaluate</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;() =&gt; { return document.getElementById(&quot;cpc_img&quot;).clientHeight; }&#39;</span><span style="color:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;">#è·å–ç½‘é¡µçš„å›¾ç‰‡å°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;image.png&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#æ‰“å¼€å›¾åƒ</span></span>
<span class="line"><span style="color:#ABB2BF;">    resized_image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> image.</span><span style="color:#61AFEF;">resize</span><span style="color:#ABB2BF;">((width, height))</span><span style="color:#7F848E;font-style:italic;"># è°ƒæ•´å›¾åƒå°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    resized_image.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;image.png&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"># ä¿å­˜è°ƒæ•´åçš„å›¾åƒ</span></span>
<span class="line"><span style="color:#ABB2BF;">    template_src </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">Jeval</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#small_img&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;el =&gt; el.getAttribute(&quot;src&quot;)&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è·å–æ»‘å—å›¾ç‰‡çš„åœ°å€</span></span>
<span class="line"><span style="color:#ABB2BF;">    request.</span><span style="color:#61AFEF;">urlretrieve</span><span style="color:#ABB2BF;">(template_src, </span><span style="color:#98C379;">&#39;template.png&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ä¸‹è½½æ»‘å—å›¾ç‰‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    width </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">evaluate</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;() =&gt; { return document.getElementById(&quot;small_img&quot;).clientWidth; }&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#è·å–ç½‘é¡µçš„å›¾ç‰‡å°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    height </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">evaluate</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;() =&gt; { return document.getElementById(&quot;small_img&quot;).clientHeight; }&#39;</span><span style="color:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;">#è·å–ç½‘é¡µçš„å›¾ç‰‡å°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;template.png&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#æ‰“å¼€å›¾åƒ</span></span>
<span class="line"><span style="color:#ABB2BF;">    resized_image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> image.</span><span style="color:#61AFEF;">resize</span><span style="color:#ABB2BF;">((width, height))</span><span style="color:#7F848E;font-style:italic;"># è°ƒæ•´å›¾åƒå°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    resized_image.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;template.png&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"># ä¿å­˜è°ƒæ•´åçš„å›¾åƒ</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…1ç§’ï¼Œç¡®ä¿å›¾ç‰‡å¤„ç†å®Œæˆ</span></span>
<span class="line"><span style="color:#ABB2BF;">    el </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;#captcha_modal &gt; div &gt; div.captcha_footer &gt; div &gt; img&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;"># å®šä½åˆ°æ»‘å—æŒ‰é’®</span></span>
<span class="line"><span style="color:#ABB2BF;">    box </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> el.</span><span style="color:#61AFEF;">boundingBox</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">#è·å–æ»‘å—æŒ‰é’®ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">    distance </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> get_distance</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‰é¢å®šä¹‰çš„get_distanceå‡½æ•°è®¡ç®—æ»‘å—ç§»åŠ¨è·ç¦»</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.mouse.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(box[</span><span style="color:#98C379;">&#39;x&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;"> , box[</span><span style="color:#98C379;">&#39;y&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.mouse.</span><span style="color:#61AFEF;">down</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># æ¨¡æ‹Ÿé¼ æ ‡æŒ‰ä¸‹</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.mouse.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(box[</span><span style="color:#98C379;">&#39;x&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> distance </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> random.</span><span style="color:#61AFEF;">uniform</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">), box[</span><span style="color:#98C379;">&#39;y&#39;</span><span style="color:#ABB2BF;">], {</span><span style="color:#98C379;">&#39;steps&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">})  </span><span style="color:#7F848E;font-style:italic;"># æ¨¡æ‹Ÿé¼ æ ‡æ‹–åŠ¨ï¼Œè€ƒè™‘åˆ°å®é™…æ“ä½œä¸­å¯èƒ½å­˜åœ¨çš„è½»å¾®è¯¯å·®å’Œæ³¢åŠ¨ï¼ŒåŠ å…¥éšæœºåç§»é‡</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># éšæœºç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œæ¨¡ä»¿äººç±»æ“ä½œçš„ä¸ç¡®å®šæ€§</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.mouse.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(box[</span><span style="color:#98C379;">&#39;x&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> distance, box[</span><span style="color:#98C379;">&#39;y&#39;</span><span style="color:#ABB2BF;">], {</span><span style="color:#98C379;">&#39;steps&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">})  </span><span style="color:#7F848E;font-style:italic;"># ç»§ç»­æ‹–åŠ¨æ»‘å—åˆ°ç›®æ ‡ä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.mouse.</span><span style="color:#61AFEF;">up</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># æ¨¡æ‹Ÿé¼ æ ‡é‡Šæ”¾ï¼Œå®Œæˆæ»‘å—æ‹–åŠ¨</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">waitFor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…3ç§’ï¼Œç­‰å¾…æ»‘å—éªŒè¯ç»“æœ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> get_distance</span><span style="color:#ABB2BF;">():   </span><span style="color:#7F848E;font-style:italic;">#å›¾å½¢å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">    img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">imread</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;image.png&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è¯»å–å…¨å±æˆªå›¾ï¼Œç°åº¦æ¨¡å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    template </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">imread</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;template.png&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è¯»å–æ»‘å—å›¾ç‰‡ï¼Œç°åº¦æ¨¡å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">GaussianBlur</span><span style="color:#ABB2BF;">(img, (</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">), </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#å›¾åƒé«˜æ–¯æ¨¡ç³Šå¤„ç†</span></span>
<span class="line"><span style="color:#ABB2BF;">    template </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">GaussianBlur</span><span style="color:#ABB2BF;">(template, (</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">), </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#å›¾åƒé«˜æ–¯æ¨¡ç³Šå¤„ç†</span></span>
<span class="line"><span style="color:#ABB2BF;">    bg_edge </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">Canny</span><span style="color:#ABB2BF;">(img, </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#è¯†åˆ«è¾¹ç¼˜</span></span>
<span class="line"><span style="color:#ABB2BF;">    cut_edge </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">Canny</span><span style="color:#ABB2BF;">(template, </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">#è¯†åˆ«è¾¹ç¼˜</span></span>
<span class="line"><span style="color:#ABB2BF;">    img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">cvtColor</span><span style="color:#ABB2BF;">(bg_edge, cv2.</span><span style="color:#D19A66;">COLOR_GRAY2RGB</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#è½¬æ¢å›¾ç‰‡æ ¼å¼ï¼Œä¸çŸ¥é“æ˜¯å•¥</span></span>
<span class="line"><span style="color:#ABB2BF;">    template </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">cvtColor</span><span style="color:#ABB2BF;">(cut_edge, cv2.</span><span style="color:#D19A66;">COLOR_GRAY2RGB</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">#è½¬æ¢å›¾ç‰‡æ ¼å¼ï¼Œä¸çŸ¥é“æ˜¯å•¥</span></span>
<span class="line"><span style="color:#ABB2BF;">    res </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">matchTemplate</span><span style="color:#ABB2BF;">(img, template, cv2.</span><span style="color:#D19A66;">TM_CCOEFF_NORMED</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨æ¨¡æ¿åŒ¹é…å¯»æ‰¾æœ€ä½³åŒ¹é…ä½ç½®</span></span>
<span class="line"><span style="color:#ABB2BF;">    value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">minMaxLoc</span><span style="color:#ABB2BF;">(res)[</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]  </span><span style="color:#7F848E;font-style:italic;"># è·å–åŒ¹é…ç»“æœçš„æœ€å°å€¼ä½ç½®ï¼Œå³ä¸ºæ»‘å—èµ·å§‹ä½ç½®</span></span>
<span class="line"><span style="color:#ABB2BF;">    distance </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> value </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 10</span><span style="color:#7F848E;font-style:italic;"> # è®¡ç®—å®é™…æ»‘åŠ¨è·ç¦»ï¼Œè¿™é‡Œæ ¹æ®å®é™…é¡µé¢æ¯”ä¾‹è¿›è¡Œè°ƒæ•´ï¼Œ+10åƒç´ æ ¡å‡†ç®—æ³•è¿™å‚»é€¼ç©æ„</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> distance</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> init_proxy_server</span><span style="color:#ABB2BF;">():                                             </span><span style="color:#7F848E;font-style:italic;">#åˆå§‹åŒ–ä»£ç†</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> proxy_server:                 </span><span style="color:#7F848E;font-style:italic;">#å¦‚æœæœ‰é…ç½®ä»£ç†</span></span>
<span class="line"><span style="color:#ABB2BF;">        argszhi </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;--no-sandbox&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;--disable-setuid-sandbox&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;--proxy-server=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">proxy_server[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#7F848E;font-style:italic;">        #è®¾ç½®æµè§ˆå™¨å‚æ•°åŠ äº†ä¸ªä»£ç†å‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> argszhi</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        argszhi </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;--no-sandbox&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;--disable-setuid-sandbox&#39;</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> argszhi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> get_latest_version</span><span style="color:#ABB2BF;">():                                             </span><span style="color:#7F848E;font-style:italic;">#è·å–ç‰ˆæœ¬å·å‡½æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">    url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;https://api.github.com/repos/dsmggm/svjdck/releases/latest&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> aiohttp.</span><span style="color:#61AFEF;">ClientSession</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> session:</span></span>
<span class="line"><span style="color:#C678DD;">            async</span><span style="color:#C678DD;"> with</span><span style="color:#ABB2BF;"> session.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> response:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> response.status </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    data </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> await</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    tag_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&quot;tag_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æœ€æ–°ç‰ˆæœ¬ï¼š&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> tag_name)</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è·å–æœ€æ–°ç‰ˆæœ¬å·å¤±è´¥&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> aiohttp.ClientError </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;æœ€æ–°ç‰ˆæœ¬ï¼šä½ ç½‘ç»œä¸è¡Œå•Šè€å¼Ÿï¼Œéƒ½è¿ä¸ä¸Šgithubï¼Œæ€ä¹ˆè·å–æœ€æ–°ç‰ˆæœ¬å·&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> def</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">():  </span><span style="color:#7F848E;font-style:italic;"># æ‰“å¼€å¹¶è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¸»ç¨‹åº</span></span>
<span class="line"><span style="color:#ABB2BF;">    os.</span><span style="color:#61AFEF;">system</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;cls&#39;</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> os.name </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;nt&#39;</span><span style="color:#C678DD;"> else</span><span style="color:#98C379;"> &#39;clear&#39;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;">#æ¸…ç©ºå±å¹•</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;**********autojdckè‡ªåŠ¨ç™»é™†äº¬ä¸œè·å–ckç¨‹åº**********&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ³¨ï¼šè´¦æˆ·å¯†ç å·²ä»é’é¾™å˜é‡è¿ç§»åˆ°jdck.iniæ–‡ä»¶ä¸­ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œè´¦å¯†è®¾ç½®&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;è„šæœ¬éœ€è¦é’é¾™åº”ç”¨æƒé™â€”â€”ç¯å¢ƒå˜é‡è·Ÿè„šæœ¬ç®¡ç†&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;é¡¹ç›®åœ°å€ï¼šhttps://github.com/dsmggm/svjdck&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å½“å‰ç‰ˆæœ¬ï¼šjdck20240405&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> get_latest_version</span><span style="color:#ABB2BF;">()       </span><span style="color:#7F848E;font-style:italic;">#è·å–æœ€æ–°ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> ifconfigfile</span><span style="color:#ABB2BF;">()    </span><span style="color:#7F848E;font-style:italic;">#æ£€æµ‹é…ç½®æ–‡ä»¶å¹¶åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> init_chrome</span><span style="color:#ABB2BF;">()     </span><span style="color:#7F848E;font-style:italic;">#æ£€æµ‹åˆå§‹åŒ–chrome</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> logon_main</span><span style="color:#ABB2BF;">()    </span><span style="color:#7F848E;font-style:italic;">#ç™»å½•æ“ä½œï¼Œå†™å…¥ckåˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    os.</span><span style="color:#61AFEF;">remove</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;image.png&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;image.png&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">else</span><span style="color:#D19A66;"> None</span><span style="color:#7F848E;font-style:italic;">     #åˆ é™¤ç¼“å­˜ç…§ç‰‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    os.</span><span style="color:#61AFEF;">remove</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;template.png&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;template.png&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">else</span><span style="color:#D19A66;"> None</span><span style="color:#7F848E;font-style:italic;">     #åˆ é™¤ç¼“å­˜ç…§ç‰‡</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#61AFEF;"> print_message</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å®Œæˆå…¨éƒ¨ç™»å½•&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ç­‰å¾…10ç§’ï¼Œç­‰å¾…</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">asyncio.</span><span style="color:#61AFEF;">get_event_loop</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">run_until_complete</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">())  </span><span style="color:#7F848E;font-style:italic;">#ä½¿ç”¨å¼‚æ­¥I/Oå¾ªç¯è¿è¡Œmain()å‡½æ•°ï¼Œå¯åŠ¨æ•´ä¸ªè‡ªåŠ¨ç™»å½•å’Œæ»‘å—éªŒè¯æµç¨‹ã€‚</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br><span class="line-number">494</span><br><span class="line-number">495</span><br><span class="line-number">496</span><br><span class="line-number">497</span><br><span class="line-number">498</span><br><span class="line-number">499</span><br><span class="line-number">500</span><br><span class="line-number">501</span><br><span class="line-number">502</span><br><span class="line-number">503</span><br><span class="line-number">504</span><br><span class="line-number">505</span><br><span class="line-number">506</span><br><span class="line-number">507</span><br><span class="line-number">508</span><br><span class="line-number">509</span><br><span class="line-number">510</span><br><span class="line-number">511</span><br><span class="line-number">512</span><br><span class="line-number">513</span><br><span class="line-number">514</span><br><span class="line-number">515</span><br><span class="line-number">516</span><br><span class="line-number">517</span><br><span class="line-number">518</span><br><span class="line-number">519</span><br><span class="line-number">520</span><br><span class="line-number">521</span><br><span class="line-number">522</span><br><span class="line-number">523</span><br><span class="line-number">524</span><br><span class="line-number">525</span><br><span class="line-number">526</span><br><span class="line-number">527</span><br><span class="line-number">528</span><br><span class="line-number">529</span><br><span class="line-number">530</span><br><span class="line-number">531</span><br><span class="line-number">532</span><br><span class="line-number">533</span><br><span class="line-number">534</span><br><span class="line-number">535</span><br><span class="line-number">536</span><br><span class="line-number">537</span><br></div></div><h3 id="è„šæœ¬è¯´æ˜" tabindex="-1">è„šæœ¬è¯´æ˜ï¼š <a class="header-anchor" href="#è„šæœ¬è¯´æ˜" aria-label="Permalink to &quot;è„šæœ¬è¯´æ˜ï¼š&quot;">â€‹</a></h3><p>1ã€è„šæœ¬ç”¨äºä½¿ç”¨è´¦å·å¯†ç è‡ªåŠ¨ç™»å½•äº¬ä¸œè·å– ckï¼Œè‡ªåŠ¨æ›´æ–° ck åˆ°é’é¾™</p><p>2ã€å»ºè®®æœ¬åœ°ç™»å½•ï¼Œä¸å»ºè®®ä½¿ç”¨ä»£ç†ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æ‰‹æœºéªŒè¯ç ä¹‹åä¸€èˆ¬ä¸éœ€è¦éªŒè¯ç å°±å¯ä»¥å¯†ç ç™»å½•</p><p>3ã€ç¨‹åºä»…æ›´æ–°è¢«ç¦ç”¨çš„ ck</p><p>4ã€è„šæœ¬æœ‰ py æºç ä»¥åŠ windows ç‰ˆæœ¬ exe ç¨‹åº</p><p>5ã€py è„šæœ¬éœ€è¦ opencv-pythonã€pyppeteerã€Pillowã€asyncioã€aiohttp ç­‰ä¾èµ–</p><p>6ã€linux éœ€è¦æ¡Œé¢ç¯å¢ƒï¼Œæ¯”å¦‚ gnome ç”¨äºå›¾å½¢å¤„ç†</p><p>7ã€ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¼šä¸‹è½½ chrome æµè§ˆå™¨ï¼Œç”Ÿæˆ jdck.ini é…ç½®æ–‡ä»¶ï¼Œç­‰å¾…å³å¯ï¼Œåç»­æ— éœ€ç­‰å¾…</p><p>8ã€æ­¤è„šæœ¬é€‚åˆäºé’é¾™å†…éƒ¨è¿è¡Œï¼Œå› é’é¾™å¤§éƒ¨åˆ†ä¸æ”¯æŒ opencv æ’ä»¶ï¼Œä»…æ”¯æŒ linux ä»¥åŠ windows è¿è¡Œï¼Œå»ºè®®ä½¿ç”¨ windows ç‰ˆæœ¬ï¼Œå®šæ—¶è¿è¡Œå³å¯ã€‚</p><p>9ã€è„šæœ¬åŸºäº python3.12.1 ç¼–å†™ï¼Œç›®å‰ 3.11 å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå…¶å®ƒç‰ˆæœ¬æœªæµ‹è¯•</p><p>10ã€è„šæœ¬éœ€è¦é’é¾™åº”ç”¨æƒé™â€”â€”ç¯å¢ƒå˜é‡è·Ÿè„šæœ¬ç®¡ç†</p><h1 id="æŸæ˜Ÿçƒé¢„çº¦æŠ¢ç¥¨è„šæœ¬" tabindex="-1">æŸæ˜Ÿçƒé¢„çº¦æŠ¢ç¥¨è„šæœ¬ <a class="header-anchor" href="#æŸæ˜Ÿçƒé¢„çº¦æŠ¢ç¥¨è„šæœ¬" aria-label="Permalink to &quot;æŸæ˜Ÿçƒé¢„çº¦æŠ¢ç¥¨è„šæœ¬&quot;">â€‹</a></h1><p><strong>ä»£ç å¦‚ä¸‹</strong>ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> asyncio</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> remove_duplicates</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">dict_list</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    seen </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> set</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    new_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> d </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> dict_list:</span></span>
<span class="line"><span style="color:#ABB2BF;">        frozen_dict </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> frozenset</span><span style="color:#ABB2BF;">(d.</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> frozen_dict </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> seen:</span></span>
<span class="line"><span style="color:#ABB2BF;">            seen.</span><span style="color:#61AFEF;">add</span><span style="color:#ABB2BF;">(frozen_dict)</span></span>
<span class="line"><span style="color:#ABB2BF;">            new_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(d)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> new_list</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> PxqShowMonitor</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.http </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">Session</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        ua </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) &#39;</span></span>
<span class="line"><span style="color:#98C379;">              &#39;Version/16.6 Mobile/15E148 Safari/604.1&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.http.headers.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#98C379;">            &#39;User-Agent&#39;</span><span style="color:#ABB2BF;">: ua,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Src&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;H5&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;Terminal-Src&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;H5&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.api_src </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;H5&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.api_ver </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;4.3.5-20240408181716&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_city_list</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://m.xxxx.com/cyy_gatewayapi/home/pub/v3/citys&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">                &#39;src&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.api_src,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;ver&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.api_ver</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">            response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.http.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params)</span></span>
<span class="line"><span style="color:#ABB2BF;">            data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            city_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;allCities&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                city_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;city_id&#39;</span><span style="color:#ABB2BF;">: item[</span><span style="color:#98C379;">&#39;cities&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;cityId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;city_name&#39;</span><span style="color:#ABB2BF;">: item[</span><span style="color:#98C379;">&#39;cities&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;cityName&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">                    &#39;site_id&#39;</span><span style="color:#ABB2BF;">: item[</span><span style="color:#98C379;">&#39;cities&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;siteId&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                })</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> city_list</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;è·å–åŸå¸‚åˆ—è¡¨å¤±è´¥, </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e.args</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_show_list</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">city_id</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        è·å–å³å°†å¼€æŠ¢çš„æ¼”å”±ä¼šåˆ—è¡¨</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://m.xxxxx.com/cyy_gatewayapi/home/pub/v3/floors&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">                &#39;src&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.api_src,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;ver&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.api_ver,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;cityId&#39;</span><span style="color:#ABB2BF;">: city_id</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">            response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.http.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params)</span></span>
<span class="line"><span style="color:#ABB2BF;">            data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            show_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> show </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> item[</span><span style="color:#98C379;">&#39;rooms&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;items&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#98C379;"> &#39;latestSaleTime&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> show:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        show_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(show)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> show_list</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;è·å–æ¼”å‡ºå¤±è´¥:</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e.args</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> run</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        city_list </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_city_list</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> city_list:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è·å–åŸå¸‚åˆ—è¡¨å¤±è´¥, é€€å‡ºç¨‹åº...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        all_show_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> city </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> city_list:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ­£åœ¨è·å–</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">å³å°†å¼€æŠ¢çš„æ¼”å”±ä¼šåˆ—è¡¨...&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(city[</span><span style="color:#98C379;">&#39;city_name&#39;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">            show_list </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_show_list</span><span style="color:#ABB2BF;">(city[</span><span style="color:#98C379;">&#39;city_id&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">,è·å–åˆ°</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">ä¸ªæ¼”å”±ä¼š&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(city[</span><span style="color:#98C379;">&#39;city_name&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(show_list)))</span></span>
<span class="line"><span style="color:#ABB2BF;">            all_show_list.</span><span style="color:#61AFEF;">extend</span><span style="color:#ABB2BF;">(show_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        show_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> all_show_list:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è®¡ç®—ä¸‰å¤©åçš„æ—¥æœŸæ—¶é—´å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">            three_days_later </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> datetime.</span><span style="color:#61AFEF;">timedelta</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">days</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å°†ä¸‰å¤©åçš„æ—¥æœŸæ—¶é—´å¯¹è±¡è½¬æ¢ä¸ºæ¯«ç§’æ—¶é—´æˆ³</span></span>
<span class="line"><span style="color:#ABB2BF;">            three_days_later_timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> three_days_later.</span><span style="color:#61AFEF;">timestamp</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> item.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;saleTime&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> item[</span><span style="color:#98C379;">&#39;saleTime&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> three_days_later_timestamp:</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> item.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;saleTime&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                sale_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.datetime.</span><span style="color:#61AFEF;">fromtimestamp</span><span style="color:#ABB2BF;">(item[</span><span style="color:#98C379;">&#39;saleTime&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">/</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                sale_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> item[</span><span style="color:#98C379;">&#39;latestSaleTime&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            show_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#98C379;">                &#39;city_name&#39;</span><span style="color:#ABB2BF;">: item[</span><span style="color:#98C379;">&#39;cityName&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">                &#39;show_name&#39;</span><span style="color:#ABB2BF;">: item[</span><span style="color:#98C379;">&#39;title&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#98C379;">                &#39;sale_time&#39;</span><span style="color:#ABB2BF;">: sale_time,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;id&#39;</span><span style="color:#ABB2BF;">: item[</span><span style="color:#98C379;">&#39;id&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            })</span></span>
<span class="line"><span style="color:#ABB2BF;">        unique_dict_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">(t) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> t </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> {</span><span style="color:#56B6C2;">tuple</span><span style="color:#ABB2BF;">(d.</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">()) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> d </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> show_list}]</span></span>
<span class="line"><span style="color:#ABB2BF;">        msg </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;### è¿‘æœŸå¼€å”®çš„æ¼”å‡ºåˆ—è¡¨: </span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> unique_dict_list:</span></span>
<span class="line"><span style="color:#ABB2BF;">            msg </span><span style="color:#56B6C2;">+=</span><span style="color:#98C379;"> &#39;- </span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">(id:</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">), å¼€å”®æ—¶é—´:</span><span style="color:#D19A66;">{}</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(item[</span><span style="color:#98C379;">&#39;show_name&#39;</span><span style="color:#ABB2BF;">], item[</span><span style="color:#98C379;">&#39;id&#39;</span><span style="color:#ABB2BF;">], item[</span><span style="color:#98C379;">&#39;sale_time&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> msg</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> server_jiang_notify</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">key</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">msg</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">        :param key:</span></span>
<span class="line"><span style="color:#98C379;">        :param title:</span></span>
<span class="line"><span style="color:#98C379;">        :param msg:</span></span>
<span class="line"><span style="color:#98C379;">        :return:</span></span>
<span class="line"><span style="color:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;https://sctapi.ftqq.com/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">key</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.send&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">            &#39;title&#39;</span><span style="color:#ABB2BF;">: title,</span></span>
<span class="line"><span style="color:#98C379;">            &#39;desp&#39;</span><span style="color:#ABB2BF;">: msg,</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å‘é€é€šçŸ¥å¤±è´¥, </span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()[</span><span style="color:#98C379;">&#39;message&#39;</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å‘é€é€šçŸ¥å¤±è´¥:</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e.args</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    app </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> PxqShowMonitor</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    message </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> app.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;README.md&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">        content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> f.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">sub</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;&lt;!-- SHOW_START --&gt;([\s\S]*?)&lt;!-- SHOW_END --&gt;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#C678DD;">                     f</span><span style="color:#98C379;">&#39;&lt;!-- SHOW_START --&gt;</span><span style="color:#56B6C2;">\n</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">message</span><span style="color:#D19A66;">}</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&lt;!-- SHOW_END --&gt;&#39;</span><span style="color:#ABB2BF;">, content)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;README.md&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;w&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">        f.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(content)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">    main</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br></div></div><p><strong>è¯´æ˜</strong></p><p>æœ¬æ–‡çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œç”¨äºç›‘æ§å³å°†å¼€å”®çš„æ¼”å‡ºç¥¨åŠ¡ä¿¡æ¯ï¼Œå¹¶æ›´æ–°ä¸€ä¸ª Markdown æ–‡ä»¶(<code>README.md</code>)æ¥æ˜¾ç¤ºå³å°†å¼€å”®çš„æ¼”å‡ºåˆ—è¡¨ã€‚å®ƒåˆ©ç”¨äº†ç½‘ç»œè¯·æ±‚æ¥è·å–ä¿¡æ¯ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œäº†å¤„ç†å’Œæ ¼å¼åŒ–ï¼Œæœ€åé€šè¿‡ç‰¹å®šçš„ API å‘é€é€šçŸ¥ã€‚è®©æˆ‘ä»¬é€æ­¥åˆ†æè¿™æ®µä»£ç çš„ä¸»è¦åŠŸèƒ½å’Œç»„æˆéƒ¨åˆ†ã€‚</p><p><strong>ç±»å’Œå‡½æ•°</strong></p><p>PxqShowMonitor ç±»</p><p>- åˆå§‹åŒ–ï¼šè®¾ç½® HTTP ä¼šè¯å¤´éƒ¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·ä»£ç†å’Œ API ç‰ˆæœ¬ã€‚</p><p>- get_city_list æ–¹æ³•ï¼šè·å–ä¸€ä¸ªåŸå¸‚åˆ—è¡¨ï¼Œæ¯ä¸ªåŸå¸‚å…·æœ‰ ID å’Œåç§°ï¼Œä»é¢„è®¾çš„ URL è·å–æ•°æ®ã€‚</p><p>- get_show_list æ–¹æ³•ï¼šæ ¹æ®åŸå¸‚ ID è·å–è¯¥åŸå¸‚å³å°†å¼€å”®çš„æ¼”å‡ºåˆ—è¡¨ï¼Œç­›é€‰å‡ºåŒ…å«<code>latestSaleTime</code>çš„æ¼”å‡ºã€‚</p><p>- run æ–¹æ³•ï¼šä¸»è¦çš„æ‰§è¡Œæµç¨‹ï¼Œè·å–æ‰€æœ‰åŸå¸‚çš„æ¼”å‡ºåˆ—è¡¨ï¼Œç­›é€‰å‡ºä¸‰å¤©å†…å³å°†å¼€å”®çš„æ¼”å‡ºï¼Œå¹¶å»é‡ï¼Œç„¶åæ ¼å¼åŒ–æˆæ¶ˆæ¯å­—ç¬¦ä¸²ã€‚</p><p><strong>è¾…åŠ©å‡½æ•°</strong></p><p>- remove_duplicateï¼šä»åˆ—è¡¨ä¸­ç§»é™¤é‡å¤çš„å­—å…¸é¡¹ã€‚</p><p>- server_jiang_notifyï¼šå‘é€é€šçŸ¥åˆ° Server é…±ï¼Œä¸€ä¸ªå¸¸ç”¨äºå¾®ä¿¡æ¶ˆæ¯æ¨é€çš„æœåŠ¡ã€‚</p><p>- main<code> å‡½æ•°ï¼šå®ä¾‹åŒ–</code>PxqShowMonitor<code>ï¼Œè¿è¡Œå¹¶è·å–æ¶ˆæ¯ï¼Œç„¶åå°†æ¶ˆæ¯æ’å…¥åˆ°</code>README.md`çš„æŒ‡å®šéƒ¨åˆ†ã€‚</p><p><strong>å·¥ä½œæµç¨‹</strong></p><ol><li>åˆå§‹åŒ–ï¼šåˆ›å»º<code>PxqShowMonitor</code>å®ä¾‹ï¼Œé…ç½®å¿…è¦çš„ HTTP å¤´éƒ¨ä¿¡æ¯ã€‚</li><li>è·å–æ•°æ®ï¼šé¦–å…ˆè·å–åŸå¸‚åˆ—è¡¨ï¼Œç„¶åéå†æ¯ä¸ªåŸå¸‚è·å–å³å°†å¼€å”®çš„æ¼”å‡ºä¿¡æ¯ã€‚</li><li>æ•°æ®å¤„ç†ï¼šå¯¹è·å–çš„æ¼”å‡ºæ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œåªä¿ç•™ä¸‰å¤©å†…å¼€å§‹å”®ç¥¨çš„æ¼”å‡ºï¼Œå¹¶è¿›è¡Œå»é‡å¤„ç†ã€‚</li><li>æ¶ˆæ¯æ ¼å¼åŒ–ï¼šå°†ç­›é€‰åçš„æ¼”å‡ºä¿¡æ¯æ ¼å¼åŒ–ä¸º Markdown æ–‡æœ¬ã€‚</li><li>æ›´æ–°æ–‡ä»¶ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›´æ–°<code>README.md</code>æ–‡ä»¶ä¸­çš„ç‰¹å®šéƒ¨åˆ†ã€‚</li><li>å‘é€é€šçŸ¥ï¼šå¯é€‰åœ°é€šè¿‡ Server é…±å‘é€é€šçŸ¥ã€‚</li></ol><p><strong>åº”ç”¨åœºæ™¯</strong></p><p>è¿™ä¸ªè„šæœ¬å¯ä»¥ç”¨äºè‡ªåŠ¨åŒ–ç›‘æ§ç¥¨åŠ¡ç½‘ç«™ä¸Šå³å°†å¼€å”®çš„æ¼”å‡ºä¿¡æ¯ï¼Œä¸ºç”¨æˆ·æä¾›åŠæ—¶çš„æ›´æ–°ï¼Œéå¸¸é€‚åˆé‚£äº›éœ€è¦ç¬¬ä¸€æ—¶é—´æŠ¢è´­æ¼”å‡ºç¥¨çš„ç”¨æˆ·ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å¯ä»¥è¢«é›†æˆåˆ°æ›´å¤§çš„ç³»ç»Ÿä¸­ï¼Œæä¾›å®šæ—¶ä»»åŠ¡è¿è¡Œï¼Œè‡ªåŠ¨æ›´æ–°ä¿¡æ¯å’Œé€šçŸ¥ç”¨æˆ·ã€‚</p><p><strong>æ€»ç»“</strong></p><p>æ­¤è„šæœ¬æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œé€šè¿‡é›†æˆå¤šä¸ªæœåŠ¡å’Œå¤„ç†æ­¥éª¤æ¥å®ç°ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æµç¨‹ï¼šä»è·å–æ•°æ®åˆ°å¤„ç†ã€å±•ç¤ºå’Œé€šçŸ¥ã€‚å®ƒå±•ç¤ºäº† Python åœ¨æ•°æ®æŠ“å–ã€å¤„ç†å’Œè‡ªåŠ¨åŒ–æ–¹é¢çš„å¼ºå¤§èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†ç½‘ç»œæ•°æ®å’Œè‡ªåŠ¨åŒ–æ–‡ä»¶æ“ä½œæ–¹é¢ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>æœ¬æ–‡éƒ¨åˆ†å˜é‡å·²åšè„±æ•å¤„ç†ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚æŠ€æœ¯å±‚é¢éœ€è¦æä¾›å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡æ‰“èµçš„æ–¹å¼è¿›è¡Œæ¢è®¨ã€‚</p><h1 id="ç®€å•ç®—å‘½è„šæœ¬" tabindex="-1">ç®€å•ç®—å‘½è„šæœ¬ <a class="header-anchor" href="#ç®€å•ç®—å‘½è„šæœ¬" aria-label="Permalink to &quot;ç®€å•ç®—å‘½è„šæœ¬&quot;">â€‹</a></h1><h3 id="æ•ˆæœå±•ç¤º" tabindex="-1">æ•ˆæœå±•ç¤º <a class="header-anchor" href="#æ•ˆæœå±•ç¤º" aria-label="Permalink to &quot;æ•ˆæœå±•ç¤º&quot;">â€‹</a></h3><p><img src="/ProgramLearnNotes/assets/640-1714148021231-28.D_D7v7f8.webp" alt="å›¾ç‰‡"></p><h3 id="æ–‡ä»¶å†…å®¹" tabindex="-1">æ–‡ä»¶å†…å®¹ <a class="header-anchor" href="#æ–‡ä»¶å†…å®¹" aria-label="Permalink to &quot;æ–‡ä»¶å†…å®¹&quot;">â€‹</a></h3><h4 id="main-py-æ–‡ä»¶å†…å®¹" tabindex="-1">main.py æ–‡ä»¶å†…å®¹ <a class="header-anchor" href="#main-py-æ–‡ä»¶å†…å®¹" aria-label="Permalink to &quot;main.py æ–‡ä»¶å†…å®¹&quot;">â€‹</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ«æŒ‚é…ç½®æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">gua_data_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;data.json&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ«å¦æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">gua_data_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">fake_delay </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 10</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¯»å–åˆ«å¦æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> init_gua_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">json_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(gua_data_path, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> fp:</span></span>
<span class="line"><span style="color:#C678DD;">        global</span><span style="color:#ABB2BF;"> gua_data_map</span></span>
<span class="line"><span style="color:#ABB2BF;">        gua_data_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">load</span><span style="color:#ABB2BF;">(fp)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># çˆ»å›¾æ ‡æ˜ å°„</span></span>
<span class="line"><span style="color:#ABB2BF;">yao_icon_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D19A66;">    0</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;- -&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">    1</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;---&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç»å¦å</span></span>
<span class="line"><span style="color:#ABB2BF;">base_gua_name_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D19A66;">    0</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;éœ‡&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…‘&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è‰®&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç¦»&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å·½&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¹¾&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ•°å­—è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ•°ç»„</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> base_gua_to_yao</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">gua</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">yao_length</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#ABB2BF;"> gua </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        level </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> gua </span><span style="color:#56B6C2;">%</span><span style="color:#D19A66;"> 2</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> else</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">        gua </span><span style="color:#56B6C2;">//=</span><span style="color:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#ABB2BF;">        result.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(level)</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(result) </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> yao_length:</span></span>
<span class="line"><span style="color:#ABB2BF;">        result.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> result</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># äºŒè¿›åˆ¶æ•°ç»„è½¬åŒ–ä¸ºæ•°å­—</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">array</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    array </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> array[:]</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(array) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> array[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        array.</span><span style="color:#61AFEF;">pop</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    result </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(array)):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> array[i] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            continue</span></span>
<span class="line"><span style="color:#ABB2BF;">        result </span><span style="color:#56B6C2;">+=</span><span style="color:#56B6C2;"> pow</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, i)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> result</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ‰“å°ä¸€ä¸ªæŒ‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> print_gua</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">gua</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_gua_to_yao</span><span style="color:#ABB2BF;">(gua, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> yao_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    up </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(up_yao_list)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(yao_icon_map[up_yao_list[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(yao_icon_map[up_yao_list[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]] </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot; &quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> base_gua_name_map[up])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(yao_icon_map[up_yao_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    down_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> yao_list[</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    down </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(down_yao_list)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(yao_icon_map[down_yao_list[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(yao_icon_map[down_yao_list[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]] </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot; &quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> base_gua_name_map[down])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(yao_icon_map[down_yao_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]])</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨æ¢…èŠ±æ˜“æ•°</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> calculate_with_plum_flower</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # èµ·ä¸Šå¦</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä½¿ç”¨æ¢…èŠ±æ˜“æ•°â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸â™£ï¸&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">    print_a_wait_animation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;åœä¸Šå¦ï¼š&quot;</span><span style="color:#ABB2BF;">, fake_delay)</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_base_gua </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">%</span><span style="color:#D19A66;"> 8</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_yao_array </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_gua_to_yao</span><span style="color:#ABB2BF;">(up_base_gua)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¸Šå¦è·å–æˆåŠŸ,ä¸Šå¦ä¸º:&quot;</span><span style="color:#ABB2BF;">, base_gua_name_map[up_base_gua])</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # èµ·ä¸‹å¦</span></span>
<span class="line"><span style="color:#61AFEF;">    print_a_wait_animation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ­£åœ¨è·å–ä¸‹å¦ï¼š&quot;</span><span style="color:#ABB2BF;">, fake_delay)</span></span>
<span class="line"><span style="color:#ABB2BF;">    down_base_gua </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">999999999999</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">%</span><span style="color:#D19A66;"> 8</span></span>
<span class="line"><span style="color:#ABB2BF;">    down_yao_array </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_gua_to_yao</span><span style="color:#ABB2BF;">(down_base_gua)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¸Šå¦è·å–æˆåŠŸ,ä¸‹å¦ä¸º:&quot;</span><span style="color:#ABB2BF;">, base_gua_name_map[down_base_gua])</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç»„æˆå¦è±¡</span></span>
<span class="line"><span style="color:#61AFEF;">    print_a_wait_animation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ­£åœ¨ç»„æˆæœ¬å¦ï¼š&quot;</span><span style="color:#ABB2BF;">, fake_delay)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;------------------------------------------------æœ¬å¦------------------------------------------------&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> up_yao_array </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> down_yao_array</span></span>
<span class="line"><span style="color:#ABB2BF;">    gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(yao_list)</span></span>
<span class="line"><span style="color:#61AFEF;">    print_gua</span><span style="color:#ABB2BF;">(gua)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è¯»å–æœ¬å¦è±¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">    gua_code </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(base_gua_name_map[up_base_gua]) </span><span style="color:#56B6C2;">+</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(base_gua_name_map[down_base_gua])</span></span>
<span class="line"><span style="color:#ABB2BF;">    gua_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> gua_data_map[gua_code]</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æœ¬å¦ä¸º:&quot;</span><span style="color:#ABB2BF;">, gua_data[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾:&quot;</span><span style="color:#ABB2BF;">, gua_data[</span><span style="color:#98C379;">&#39;words&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;è¯‘:&quot;</span><span style="color:#ABB2BF;">, gua_data[</span><span style="color:#98C379;">&#39;white_words&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è±¡:&quot;</span><span style="color:#ABB2BF;">, gua_data[</span><span style="color:#98C379;">&#39;picture&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;è¯‘:&quot;</span><span style="color:#ABB2BF;">, gua_data[</span><span style="color:#98C379;">&#39;white_picture&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#61AFEF;">    print_a_wait_animation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ­£åœ¨ç»„æˆäº’å¦ï¼š&quot;</span><span style="color:#ABB2BF;">, fake_delay)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;------------------------------------------------äº’å¦------------------------------------------------&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è¯»å–äº’å¦è±¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_hu_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [yao_list[</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">], yao_list[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">], yao_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_hu_gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(up_hu_yao_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">    down_hu_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [yao_list[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">], yao_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">], yao_list[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"><span style="color:#ABB2BF;">    down_hu_gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(down_hu_yao_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">    hu_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> up_hu_yao_list </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> down_hu_yao_list</span></span>
<span class="line"><span style="color:#ABB2BF;">    hu_gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(hu_yao_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">    hu_gua_code </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(base_gua_name_map[up_hu_gua]) </span><span style="color:#56B6C2;">+</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(base_gua_name_map[down_hu_gua])</span></span>
<span class="line"><span style="color:#ABB2BF;">    hu_gua_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> gua_data_map[hu_gua_code]</span></span>
<span class="line"><span style="color:#61AFEF;">    print_gua</span><span style="color:#ABB2BF;">(hu_gua)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;äº’å¦ä¸º:&quot;</span><span style="color:#ABB2BF;">, hu_gua_data[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾:&quot;</span><span style="color:#ABB2BF;">, hu_gua_data[</span><span style="color:#98C379;">&#39;words&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;è¯‘:&quot;</span><span style="color:#ABB2BF;">, hu_gua_data[</span><span style="color:#98C379;">&#39;white_words&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è±¡:&quot;</span><span style="color:#ABB2BF;">, hu_gua_data[</span><span style="color:#98C379;">&#39;picture&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;è¯‘:&quot;</span><span style="color:#ABB2BF;">, hu_gua_data[</span><span style="color:#98C379;">&#39;white_picture&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#61AFEF;">    print_a_wait_animation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ­£åœ¨ç»„æˆå˜å¦ï¼š&quot;</span><span style="color:#ABB2BF;">, fake_delay)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;------------------------------------------------å˜å¦------------------------------------------------&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    change_index </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">%</span><span style="color:#D19A66;"> 6</span></span>
<span class="line"><span style="color:#ABB2BF;">    change_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> yao_list[:]</span></span>
<span class="line"><span style="color:#ABB2BF;">    change_yao_list[change_index] </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> change_yao_list[change_index] </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#C678DD;"> else</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_change_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> change_yao_list[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    up_change_gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(up_change_yao_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">    down_change_yao_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> change_yao_list[</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    down_change_gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(down_change_yao_list)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    change_gua </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> base_yao_to_gua</span><span style="color:#ABB2BF;">(change_yao_list)</span></span>
<span class="line"><span style="color:#61AFEF;">    print_gua</span><span style="color:#ABB2BF;">(change_gua)</span></span>
<span class="line"><span style="color:#ABB2BF;">    change_gua_code </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(base_gua_name_map[up_change_gua]) </span><span style="color:#56B6C2;">+</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(base_gua_name_map[down_change_gua])</span></span>
<span class="line"><span style="color:#ABB2BF;">    change_gua_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> gua_data_map[change_gua_code]</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å˜å¦ä¸º:&quot;</span><span style="color:#ABB2BF;">, change_gua_data[</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾:&quot;</span><span style="color:#ABB2BF;">, change_gua_data[</span><span style="color:#98C379;">&#39;words&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;è¯‘:&quot;</span><span style="color:#ABB2BF;">, change_gua_data[</span><span style="color:#98C379;">&#39;white_words&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è±¡:&quot;</span><span style="color:#ABB2BF;">, change_gua_data[</span><span style="color:#98C379;">&#39;picture&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;è¯‘:&quot;</span><span style="color:#ABB2BF;">, change_gua_data[</span><span style="color:#98C379;">&#39;white_picture&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> print_a_wait_animation</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">tips</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">times</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    animation </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;|/-</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    idx </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(times):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(tips </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> animation[idx </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(animation)], animation[idx </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(animation)], animation[idx </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(animation)],</span></span>
<span class="line"><span style="color:#ABB2BF;">              animation[idx </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(animation)], animation[idx </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(animation)], </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\r</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">        idx </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;">        time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">init_gua_data</span><span style="color:#ABB2BF;">(gua_data_path)</span></span>
<span class="line"><span style="color:#61AFEF;">calculate_with_plum_flower</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br></div></div><h4 id="data-json-æ–‡ä»¶å†…å®¹" tabindex="-1">data.json æ–‡ä»¶å†…å®¹ <a class="header-anchor" href="#data-json-æ–‡ä»¶å†…å®¹" aria-label="Permalink to &quot;data.json æ–‡ä»¶å†…å®¹&quot;">â€‹</a></h4><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¹¾ä¸ºå¤©&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒäº¨åˆ©è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;çœŸä¸é”™ï¼Œè¿™ä¸ªæŒ‚çœŸä¸é”™ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©é“åˆšå¥ï¼Œè¿è¡Œä¸å·²ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œä»¥å¤©ä¸ºæ³•ï¼Œè‡ªå¼ºä¸æ¯ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½å¤©å¤¬&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ‰¬äºç‹åº­ï¼Œå­šå·ï¼Œæœ‰å‰ã€‚å‘Šè‡ªé‚‘ï¼Œä¸åˆ©å³æˆï¼Œåˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç‹åº­é‡Œæ­£è·³èˆä½œä¹ã€‚æœ‰äººå‘¼å‘Šï¼šâ€œæœ‰æ•Œäººæ¥çŠ¯ã€‚â€é‚‘ä¸­ä¼ æ¥å‘½ä»¤ï¼šâ€œå‡ºå‡»ä¸åˆ©ï¼Œè¦ä¸¥é˜µä»¥å¾…ã€‚â€ç­®é‡æ­¤çˆ»ï¼Œå‡ºå¤–æ—…è¡Œåˆ™å‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šäºå¤©ï¼Œå¤¬ã€‚å›å­ä»¥æ–½ç¦„åŠä¸‹ï¼Œå±…å¾·åˆ™å¿Œã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸Šå¦ä¸ºå…‘ï¼Œå…‘ä¸ºæ³½ï¼›ä¸‹å¦ä¸ºä¹¾ï¼Œä¹¾ä¸ºå¤©ï¼Œå¯è§æ³½æ°´ä¸Šæ¶¨ï¼Œæµ‡çŒå¤§åœ°ï¼Œæ˜¯å¤¬å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œæ³½æƒ ä¸‹æ–½ï¼Œä¸æ•¢å±…åŠŸè‡ªå‚²ï¼Œå¹¶ä»¥æ­¤ä¸ºå¿Œã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«å¤©å¤§æœ‰&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒäº¨ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ˜Œéš†é€šæ³°ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«åœ¨å¤©ä¸Šï¼Œå¤§æœ‰ã€‚å›å­ä»¥éæ¶æ‰¬å–„ï¼Œé¡ºå¤©ä¼‘å‘½ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«åœ¨å¤©ä¸Šï¼Œæ˜çƒ›å››æ–¹ï¼Œå›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºç«ï¼Œæ´å¯Ÿå–„æ¶ï¼ŒæŠ‘æ¶æ‰¬å–„ï¼Œä»è€Œé¡ºåº”å¤©å‘½ï¼Œç¥ˆè·å¥½è¿ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·å¤©å¤§å£®&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‰åˆ©&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·åœ¨å¤©ä¸Šï¼Œå¤§å£®ã€‚å›å­ä»¥éç¤¼å¼—å±¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸Šé¸£é›·æ˜¯å¤§å£®çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥è¿…é›·å¯ç•ï¼Œç¤¼æ³•æ£®ä¸¥ï¼Œä»è€Œç•å¨çŸ¥æƒ§ï¼Œå”¯ç¤¼æ˜¯éµã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£å¤©å°ç•œ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚å¯†äº‘ä¸é›¨ï¼Œè‡ªæˆ‘è¥¿éƒŠã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‰åˆ©ã€‚åœ¨è¥¿éƒŠä¸€å¸¦æµ“äº‘å¯†å¸ƒï¼Œä½†é›¨æ²¡æœ‰ä¸‹æ¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£è¡Œå¤©ä¸Šï¼Œå°ç•œã€‚å›å­ä»¥æ‡¿æ–‡å¾·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸Šå¦ä¸ºå·½ï¼Œå·½ä¸ºé£ï¼›ä¸‹å¦ä¸ºä¹¾ï¼Œä¹¾ä¸ºå¤©ï¼Œå’Œé£æ‹‚åœ°ï¼Œè‰æœ¨ä½æ˜‚ï¼Œå‹ƒå‹ƒæ»‹ç”Ÿï¼Œè¿™æ˜¯å°ç•œçš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•å‚¬å‘ä¸‡ç‰©çš„å’Œé£ï¼Œè‡ªåŠ±é£èŒƒï¼Œæ¨è¡Œå¾·æ•™ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´å¤©éœ€&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ‰å­šï¼Œå…‰äº¨ï¼Œè´å‰ã€‚åˆ©æ¶‰å¤§å·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æŠ“åˆ°ä¿˜è™ã€‚å¤§å‰å¤§åˆ©ï¼Œå‰åˆ©çš„åœé—®ã€‚æœ‰åˆ©äºæ¶‰æ°´æ¸¡æ²³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº‘ä¸Šäºå¤©ï¼Œéœ€ï¼›å›å­ä»¥é¥®é£Ÿå®´ä¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº‘æµ®èšäºå¤©ä¸Šï¼Œå¾…æ—¶é™é›¨æ˜¯éœ€å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå¯ä»¥å®´é¥®å®‰ä¹ï¼Œå¾…æ—¶è€ŒåŠ¨ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±å¤©å¤§ç•œ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©è´ï¼Œä¸å®¶é£Ÿï¼Œå‰ã€‚åˆ©æ¶‰å¤§å·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‰åˆ©çš„è´å…†ã€‚ä¸é£Ÿäºå®¶ï¼Œé£Ÿäºæœå»·ï¼Œå‰åˆ©ã€‚ç­®é‡æ­¤å¦ï¼Œæœ‰åˆ©äºæ¶‰æ°´æ¸¡æ²³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©åœ¨å±±ä¸­ï¼Œå¤§ç•œã€‚å›å­ä»¥å¤šè¯†å‰è¨€å¾€è¡Œï¼Œä»¥ç•œå…¶å¾·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤ªé˜³ç…§è€€äºå±±ä¸­ï¼Œä¸‡ç‰©æ‘„å–é˜³å…‰é›¨éœ²ï¼Œå„é‚å…¶ç”Ÿï¼Œè¿™æ˜¯å¤§ç•œçš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œå¹¿æ³›åœ°äº†è§£å¤äººçš„å˜‰è¨€å–„è¡Œï¼Œæ¥åŸ¹å…»è‡ªå·±çš„å¾·è¡Œã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤ä¹¾&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°å¤©æ³°&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å°å¾€å¤§æ¥ï¼Œå‰ï¼Œäº¨ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä»˜å‡ºå°ï¼Œæ”¶ç›Šå¤§ï¼Œå‰ç¥¥ï¼Œé¡ºåˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©åœ°äº¤ï¼Œæ³°ï¼›åä»¥è´¢æˆå¤©åœ°ä¹‹é“ï¼Œè¾…ç›¸å¤©åœ°ä¹‹å®œï¼Œä»¥å·¦å³æ°‘ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°æ°”ä¸Šå‡ï¼Œä¹¾æ°”ä¸‹é™ï¼Œä¸ºåœ°æ°”å±…äºä¹¾æ°”ä¹‹ä¸Šä¹‹è¡¨è±¡ï¼Œé˜´é˜³äºŒæ°”ä¸€å‡ä¸€é™ï¼Œäº’ç›¸äº¤åˆï¼Œé¡ºç•…é€šè¾¾ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©æ³½å±¥&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±¥è™å°¾ï¼Œä¸å’¥äººï¼Œäº¨ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è¸©ç€è™å°¾å·´ï¼Œè€è™ä¸å’¬äººï¼Œå‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸Šå¤©ä¸‹æ³½ï¼Œå±¥ã€‚å›å­ä»¥è¾¨ä¸Šä¸‹ï¼Œå®šæ°‘å¿—ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸Šå¤©ä¸‹æ³½ï¼Œå°Šå‘æ˜¾åˆ«ï¼Œè¿™æ˜¯å±¥å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œåˆ†åˆ«ä¸Šä¸‹å°Šå‘ï¼Œä½¿äººæ°‘å¾ªè§„è¹ˆçŸ©ï¼Œå®‰ä»½å®ˆçºªã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…‘ä¸ºæ³½&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œåˆ©ï¼Œè´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨é€šã€‚å‰åˆ©çš„è´åœã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸½æ³½ï¼Œå…‘ã€‚å›å­ä»¥æœ‹å‹è®²ä¹ ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸¤æ³½ç›¸è¿ï¼Œä¸¤æ°´äº¤æµæ˜¯å…‘å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œå¹¿äº¤æœ‹å‹ï¼Œè®²ä¹ æ¢ç´¢ï¼Œæ¨å¹¿è§é—»ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«æ³½ç½&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å°äº‹å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç­®é‡æ­¤å¦ï¼Œå°äº‹å‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸Šç«ä¸‹æ³½ï¼Œç½ã€‚å›å­ä»¥åŒè€Œå¼‚ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸Šç«ä¸‹æ³½ï¼Œä¸¤ç›¸ä¹–ç¦»ï¼Œæ˜¯ç½å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œç»¼åˆä¸‡ç‰©ä¹‹æ‰€åŒï¼Œåˆ†æä¸‡ç‰©ä¹‹æ‰€å¼‚ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·æ³½å½’å¦¹&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¾å‡¶ï¼Œæ— æ”¸åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç­®é‡æ­¤çˆ»ï¼Œå‡ºå¾å‡¶é™©ã€‚æ— æ‰€åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šæœ‰é›·ï¼Œå½’å¦¹ã€‚å›å­ä»¥æ°¸ç»ˆçŸ¥æ•ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šé›·é¸£ï¼Œé›·é¸£æ°´åŠ¨ï¼Œç”¨ä»¥å–»ç”·å¥³å¿ƒåŠ¨ç›¸çˆ±è€Œæˆçœ·å±ã€‚è¿™æ˜¯å½’å¦¹å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œåœ¨é•¿æœŸçš„å©šå§»ç”Ÿæ´»ä¸­ï¼Œä½“å¯Ÿåˆ°å©šå§»çš„æˆåŠŸä¸å¤±è´¥ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£æ³½ä¸­å­š&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è±šé±¼ï¼Œå‰ã€‚åˆ©æ¶‰å¤§å·ï¼Œåˆ©è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è±šé±¼çŒ®ç¥­ï¼Œè™½ç‰©è–„ä½†å¿ƒè¯šï¼Œå‰åˆ©ã€‚å¹¶åˆ©äºæ¶‰æ°´è¿‡æ²³ã€‚è¿™æ˜¯å‰åˆ©çš„è´åœã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šæœ‰é£ï¼Œä¸­å­šã€‚å›å­ä»¥è®®ç‹±ç¼“æ­»ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šæœ‰é£ï¼Œé£èµ·æ³¢æ¶Œã€‚è¿™æ˜¯ä¸­å­šçš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæœ‰æ„Ÿäºé£åŒ–é‚¦å›½ï¼Œå”¯å¾·æ•™ä¸ºå…ˆï¼Œå› è€Œå®¡è®®è®¼ç‹±ï¼Œä¸è½»ç½®é‡å…¸ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åå…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´æ³½èŠ‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œè‹¦èŠ‚ä¸å¯è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨é€šã€‚å¦‚æœä»¥èŠ‚åˆ¶ä¸ºè‹¦ï¼Œå…¶å‡¶å‰åˆ™ä¸å¯åœé—®ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šæœ‰æ°´ï¼ŒèŠ‚ã€‚å›å­ä»¥åˆ¶æ•°åº¦ï¼Œè®®å¾·è¡Œã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸­æ°´æ»¡ï¼Œå› è€Œé¡»é«˜ç­‘å ¤é˜²ï¼Œè¿™æ˜¯èŠ‚å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œå»ºç«‹æ”¿çº²åˆ¶åº¦ï¼Œç¡®ç«‹ä¼¦ç†åŸåˆ™ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±æ³½æŸ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ‰å­šï¼Œå…ƒå‰ï¼Œæ— å’ï¼Œå¯è´ã€‚åˆ©æœ‰æ”¸å¾€ã€‚æ›·ä¹‹ç”¨ï¼ŸäºŒç°‹å¯ç”¨äº«ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç­®é‡æ­¤å¦ï¼Œå°†æœ‰æ‰€ä¿˜è·ï¼Œå¤§å‰å¤§åˆ©ï¼Œæ²¡æœ‰ç¾éš¾ï¼Œæ˜¯ç§°å¿ƒçš„åœé—®ã€‚è€Œä¸”æ‰€å¾€å°†è·åˆ©ã€‚å°†æœ‰äººé€æ¥ä¸¤ç›†é£Ÿç‰©ï¼Œå¯äº«å£ç¦ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰æ³½ï¼ŒæŸã€‚å›å­ä»¥å¾å¿¿çª’æ¬²ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰æ³½æ˜¯æŸå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥æ³½æ°´æµ¸èš€å±±è„šä¸ºæˆ’ï¼Œä»è€Œåˆ¶æ­¢å…¶å¿¿æ€’ï¼Œæœå¡å…¶è´ªæ¬²ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤å…‘&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°æ³½ä¸´&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒï¼Œäº¨ï¼Œåˆ©ï¼Œè´ã€‚è‡³äºå…«æœˆæœ‰å‡¶ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å‰å¤§åˆ©ï¼Œå‰åˆ©çš„åœé—®ã€‚åˆ°äº†å…«æœˆï¼Œå¯èƒ½æœ‰å‡¶é™©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šæœ‰åœ°ï¼Œä¸´ã€‚å›å­ä»¥æ•™æ€æ— ç©·ï¼Œå®¢ä¿æ°‘æ— ç–†ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å ¤å²¸é«˜å‡ºå¤§æ³½ï¼Œæ²³æ³½å®¹äºå¤§åœ°ï¼Œè¿™æ˜¯ä¸´å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå›ä¸´å¤©ä¸‹ï¼Œæ•™åŒ–ä¸‡æ°‘ï¼Œè¦ƒæ©æè™‘ï¼Œä¿å®¹ä¸‡æ°‘ï¼Œå¾·ä¸šæ— ç–†ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ç«åŒäºº&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åŒäººäºé‡ï¼Œäº¨ã€‚åˆ©æ¶‰å¤§å·ï¼Œåˆ©å›å­è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;èšä¼—äºéƒŠå¤–ï¼Œå°†è¡Œå¤§äº‹ï¼Œå‰åˆ©ã€‚æœ‰åˆ©äºæ¶‰æ°´æ¸¡æ²³ï¼Œæœ‰åˆ©äºå›å­çš„åœé—®ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸ç«ï¼ŒåŒäººï¼›å›å­ä»¥ç±»æ—è¾¨ç‰©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åŒäººä¹‹å¦ï¼Œä¸Šå¦ä¸ºä¹¾ä¸ºå¤©ä¸ºå›ç‹ï¼Œä¸‹å¦ä¸ºç¦»ä¸ºç«ä¸ºè‡£æ°‘ï¼Œä¸Šä¹¾ä¸‹ç¦»è±¡å¾å›ç‹ä¸Šæƒ…ä¸‹è¾¾ï¼Œè‡£æ°‘ä¸‹æƒ…ä¸Šè¾¾ï¼Œå›è‡£æ„å¿—å’ŒåŒï¼Œè¿™æ˜¯åŒäººçš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºç«ï¼Œæ˜çƒ›å¤©åœ°ï¼Œç…§äº®å¹½éšï¼Œä»è€Œå»åˆ†æç‰©ç±»ï¼Œè¾¨æ˜æƒ…çŠ¶ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ç«é©&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å·±æ—¥ä¹ƒå­šã€‚å…ƒäº¨åˆ©è´ã€‚æ‚”äº¡ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç¥­ç¥€ä¹‹æ—¥ç”¨ä¿˜è™ä½œäººç‰²ï¼Œäº¨é€šï¼Œå‰åˆ©çš„åœé—®ã€‚æ²¡æœ‰æ‚”æ¨ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸­æœ‰ç«ï¼Œé©ã€‚å›å­ä»¥æ²»å†æ˜æ—¶ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å†…è’¸å¤–ç…ï¼Œæ°´æ¶¸è‰æ¯ï¼Œå¦‚åŒæ°´æ³½ä¹‹ä¸­ï¼Œå¤§ç«ç‡ƒçƒ§ï¼Œè¿™æ˜¯é©å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œäº†è§£åˆ°æ³½æ°´æ¶¨è½ï¼Œè‰æœ¨æ¯è£çš„å‘¨æœŸå˜åŒ–ï¼Œä»è€Œä¿®æ²»å†æ³•ï¼Œæ˜ç¡®æ—¶ä»¤ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç¦»ä¸ºç«&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©è´ï¼Œäº¨ã€‚ç•œç‰ç‰›ï¼Œå‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‰åˆ©çš„å é—®ï¼Œé€šæ³°ã€‚é¥²å…»æ¯ç‰›ï¼Œå‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ˜ä¸¤ä½œï¼Œç¦»ã€‚å¤§äººä»¥ç»§æ˜ç…§å››æ–¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä»Šæœå¤ªé˜³å‡ï¼Œæ˜æœå¤ªé˜³å‡ï¼Œç›¸ç»§ä¸åœé¡¿ï¼Œè¿™æ˜¯ç¦»å¦çš„å¦è±¡ã€‚è´µæ—ç‹å…¬è§‚æ­¤å¦è±¡ï¼Œä»è€Œä»¥æºæºä¸æ–­çš„å…‰æ˜ç…§ä¸´å››æ–¹ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·ç«ä¸°&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚ç‹å‡ä¹‹ï¼Œå‹¿å¿§ï¼Œå®œæ—¥ä¸­ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸¾è¡Œç¥­ç¥€ï¼Œå›ç‹å°†äº²ä¸´å®—åº™ã€‚ä¸è¦æ‹…å¿ƒï¼Œæœ€ä½³æ—¶åˆ»å½“åœ¨æ­£åˆæ—¶åˆ†ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·ç”µçš†è‡³ï¼Œä¸°ã€‚å›å­ä»¥æŠ˜ç‹±è‡´åˆ‘ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç”µé—ªé›·é¸£ï¼Œæ˜¯ä¸Šå¤©å‚ç¤ºçš„é‡å¤§å¤©è±¡ï¼Œè¿™ä¹Ÿæ˜¯ä¸°å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæœ‰æ„Ÿäºç”µå…‰é›·é¸£çš„ç²¾æ˜å’Œå¨ä¸¥ï¼Œä»è€Œè£æ–­è®¼ç‹±ï¼Œæ–½è¡Œåˆ‘ç½šã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£ç«å®¶äºº&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©å¥³è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœé—®å¦‡å¥³ä¹‹äº‹å‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£è‡ªç«å‡ºï¼Œå®¶äººã€‚å›å­ä»¥è¨€æœ‰ç‰©ï¼Œè€Œè¡Œæœ‰æ’ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å†…ç«å¤–é£ï¼Œé£åŠ©ç«åŠ¿ï¼Œç«åŠ©é£å¨ï¼Œç›¸è¾…ç›¸æˆï¼Œæ˜¯å®¶äººçš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œçœæ‚Ÿåˆ°è¨€è¾é¡»æœ‰å†…å®¹æ‰ä¸è‡´äºç©ºæ´ï¼Œå¾·è¡Œé¡»æŒä¹‹ä»¥æ’æ‰èƒ½å……æ²›ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´ç«æ—¢æµ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œå°åˆ©è´ï¼Œåˆå‰ç»ˆä¹±ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨é€šã€‚è¿™æ˜¯å°è§å‰åˆ©çš„è´åœã€‚èµ·åˆå‰åˆ©ï¼Œæœ€åå°†å‘ç”Ÿå˜æ•…ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´åœ¨ç«ä¸Šï¼Œæ—¢æµã€‚å›å­ä»¥æ€æ‚£è€Œé¢„é˜²ä¹‹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´ä¸Šç«ä¸‹ï¼Œæ°´æµ‡ç«ç†„ï¼Œæ˜¯æ—¢æµä¹‹å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œæœ‰å¤‡äºæ— æ‚£ä¹‹æ—¶ï¼Œé˜²èŒƒäºæœªç„¶ä¹‹é™…ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ç«è´²&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚å°åˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šè¾¾ã€‚æœ‰æ‰€å¾€åˆ™æœ‰å°åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰ç«ï¼Œè´²ã€‚å›å­ä»¥æ˜åº¶æ”¿ï¼Œæ— æ•¢æŠ˜ç‹±ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰ç«ï¼Œç«ç‡ç¾¤å±±ï¼Œè¿™æ˜¯è´²å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæ€åŠçŒ›ç«ç‡å±±ï¼Œç‰çŸ³ä¿±ç„šï¼Œè‰æœ¨çš†å°½ï¼Œä»¥æ­¤ä¸ºæˆ’ï¼Œä»è€Œæ˜å¯Ÿå„é¡¹æ”¿äº‹ï¼Œä¸æ•¢ä»¥å¨çŒ›æ–­ç‹±ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤ç¦»&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ç«æ˜å¤·&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©è‰°è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœé—®è‰°éš¾ä¹‹äº‹åˆ™åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ˜å…¥åœ°ä¸­ï¼Œæ˜å¤·ã€‚å›å­ä»¥è…ä¼—ï¼Œç”¨æ™¦è€Œæ˜ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤ªé˜³æ²¡å…¥åœ°ä¸­ï¼Œæ˜¯æ˜å¤·çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæ²»æ°‘ç†æ”¿ï¼Œä¸ä»¥è‹›å¯Ÿä¸ºæ˜ï¼Œè€Œæ˜¯å¤–æ„šå†…æ…§ï¼Œå®¹ç‰©äº²ä¼—ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©é›·æ— å¦„&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒï¼Œäº¨ï¼Œåˆ©ï¼Œè´ã€‚å…¶åŒªæ­£æœ‰çœšï¼Œä¸åˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å˜‰ç¾é€šæ³°ï¼Œåœé—®å¾—å‰å…†ã€‚è¡Œä¸ºä¸æ­£å½“ï¼Œåˆ™æœ‰ç¾æ®ƒï¼Œæœ‰æ‰€å¾€åˆ™ä¸åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸‹é›·è¡Œï¼Œç‰©ä¸æ— å¦„ã€‚å…ˆç‹ä»¥èŒ‚å¯¹æ—¶ï¼Œè‚²ä¸‡ç‰©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©å®‡ä¹‹ä¸‹ï¼Œæ˜¥é›·æ»šåŠ¨ï¼Œä¸‡ç‰©èŒå‘ï¼Œå­³ç”Ÿç¹è¡ï¼Œè¿™æ˜¯æ— å¦„çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡ï¼Œä»è€Œå¥‹å‹‰åŠªåŠ›ï¼Œé¡ºåº”æ—¶ä»¤ï¼Œä¿è‚²ä¸‡ç‰©ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½é›·éš&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒäº¨ï¼Œåˆ©è´ï¼Œæ— å’ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å‰å¤§åˆ©ï¼Œåœå¾—å‰å…†ï¼Œæ²¡æœ‰ç¾å®³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸­æœ‰é›·ï¼Œéšã€‚å›å­ä»¥å‘æ™¦å…¥å®´æ¯ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·å…¥æ³½ä¸­ï¼Œå¤§åœ°å¯’å‡ï¼Œä¸‡ç‰©è›°ä¼ï¼Œæ˜¯éšå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºéšå¤©æ—¶è€Œæ²‰å¯‚çš„é›·å£°ï¼Œéšæ—¶ä½œæ¯ï¼Œå‘æ™šåˆ™å…¥å®¤ä¼‘æ¯ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«é›·å™¬å—‘&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚åˆ©ç”¨ç‹±ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šæ³°ã€‚åˆ©äºè®¼ç‹±ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·ç”µå™¬å—‘ã€‚å…ˆç‹ä»¥æ˜ç½šæ••æ³•ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·ç”µäº¤åˆæ˜¯å™¬å—‘çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºå¨é£å‡›å‡›çš„é›·ã€ç…§å½»å¹½éšçš„ç”µï¼Œæ€ä»¥ä¸¥æ˜æ²»æ”¿ï¼Œä»è€Œæ˜å¯Ÿå…¶åˆ‘ç½šï¼Œä¿®æ­£å…¶æ³•å¾‹ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;éœ‡ä¸ºé›·&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚éœ‡æ¥è™©è™©ï¼Œç¬‘è¨€å“‘å“‘ã€‚éœ‡æƒŠç™¾é‡Œï¼Œä¸ä¸§åŒ•é¬¯ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸´ç¥­ä¹‹æ—¶ï¼Œé›·å£°ä¼ æ¥ï¼Œæœ‰çš„äººå“å¾—æµ‘èº«å‘æŠ–ï¼Œç‰‡åˆ»ä¹‹åï¼Œæ‰èƒ½è°ˆç¬‘å¦‚å¸¸ã€‚å·¨é›·çŒå“ï¼Œéœ‡æƒŠç™¾é‡Œï¼Œæœ‰çš„äººå´ç¥æ€è‡ªè‹¥ï¼Œæ‰‹é‡Œæ‹¿ç€é…’å‹ºå­ï¼Œè¿ä¸€æ»´é…’éƒ½æ²¡æœ‰æ´’å‡ºæ¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ´Šé›·ï¼Œéœ‡ã€‚å›å­ä»¥ææƒ§ä¿®çœã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å·¨é›·è¿å‡»ï¼Œæ˜¯éœ‡å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œæˆ’æƒ§ææƒ§ï¼Œä¿®çœå…¶èº«ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£é›·ç›Š&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©æœ‰æ”¸å¾€ï¼Œåˆ©æ¶‰å¤§å·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç­®é‡æ­¤çˆ»ï¼Œåˆ©äºæœ‰æ‰€å¾€ï¼Œåˆ©äºæ¶‰æ°´æ¸¡æ²³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£é›·ï¼Œç›Šã€‚å›å­ä»¥è§å–„åˆ™è¿ï¼Œæœ‰è¿‡åˆ™æ”¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£é›·æ¿€è¡ï¼Œæ˜¯ç›Šå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼ŒæƒŠæäºé£é›·çš„å¨åŠ›ï¼Œä»è€Œè§å–„åˆ™ä»ä¹‹ï¼Œæœ‰è¿‡åˆ™æ”¹ä¹‹ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åéœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´é›·å±¯&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒï¼Œäº¨ï¼Œåˆ©ï¼Œè´ã€‚å‹¿ç”¨ï¼Œæœ‰æ”¸å¾€ï¼Œåˆ©å»ºä¾¯ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å‰å¤§åˆ©ï¼Œå‰åˆ©çš„å åœã€‚ä¸åˆ©äºå‡ºé—¨ã€‚æœ‰åˆ©äºå»ºå›½å°ä¾¯ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº‘ï¼Œé›·ï¼Œå±¯ï¼›å›å­ä»¥ç»çº¶ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº‘è¡Œäºä¸Šï¼Œé›·åŠ¨äºä¸‹ï¼Œæ˜¯å±¯å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºäº‘é›·ï¼Œç”¨äº‘çš„æ©æ³½ï¼Œé›·çš„å¨ä¸¥æ¥æ²»ç†å›½äº‹ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±é›·é¢&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è´å‰ã€‚è§‚é¢ï¼Œè‡ªæ±‚å£å®ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å åœå¾—å‰å…†ã€‚ç ”ç©¶é¢å…»ä¹‹é“ï¼Œåœ¨äºè‡ªé£Ÿå…¶åŠ›ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰é›·ï¼Œé¢ã€‚å›å­ä»¥æ…è¨€è¯­ï¼ŒèŠ‚é¥®é£Ÿã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·å‡ºå±±ä¸­ï¼Œä¸‡ç‰©èŒå‘ï¼Œè¿™æ˜¯é¢å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæ€ç”Ÿå…»ä¹‹ä¸æ˜“ï¼Œä»è€Œè°¨æ…è¨€è¯­ï¼Œé¿å…ç¾ç¥¸ã€‚èŠ‚åˆ¶é¥®é£Ÿï¼Œä¿®èº«å…»æ€§ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤éœ‡&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°é›·å¤&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚å‡ºå…¥æ— ç–¾ï¼Œæœ‹æ¥æ— å’ã€‚åå¤å…¶é“ï¼Œä¸ƒæ—¥æ¥å¤ï¼Œåˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šæ³°ã€‚å‡ºé—¨ã€å±…å¤„å‡æ— ç–¾ç—…ã€‚æœ‰é’±å¯èµšè€Œå¯ä»¥æ— ç¾ç¥¸ã€‚å¾€è¿”é€”ä¸­ï¼Œä¸ƒæ—¥å¯å½’ã€‚æœ‰æ‰€å¾€åˆ™æœ‰æ‰€åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·åœ¨åœ°ä¸­ï¼Œå¤ã€‚å…ˆç‹ä»¥è‡³æ—¥é—­å…³ï¼Œå•†æ—…ä¸è¡Œï¼Œåä¸çœæ–¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©å¯’åœ°å†»ï¼Œé›·è¿”å½’åœ°ä¸­ï¼Œå¾€è€Œæœ‰å¤ï¼Œä¾æ—¶å›å½’ï¼Œè¿™æ˜¯å¤å¦çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºé›·ï¼Œåœ¨å†¬è‡³ä¹‹æ—¥å…³é—­åŸé—¨ï¼Œä¸æ¥çº³å•†æ—…ï¼Œå›ç‹ä¹Ÿä¸å·¡è§†é‚¦å›½&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©é£å§¤&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¥³å£®ï¼Œå‹¿ç”¨å–å¥³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ¢¦è§å¥³å­å—ä¼¤ã€‚ç­®é‡æ­¤å¦ï¼Œä¸åˆ©äºå¨¶å¥³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸‹æœ‰é£ï¼Œå§¤ã€‚åä»¥æ–½å‘½è¯°å››æ–¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸‹æœ‰é£ï¼Œæ˜¯å§¤å¦çš„å¦è±¡ï¼Œå›ç‹è§‚æ­¤å¦è±¡ï¼Œä»è€Œæ•ˆæ³•äºé£ä¹‹å¹æ‹‚ä¸‡ç‰©ï¼Œæ–½æ•™åŒ–äºå¤©ä¸‹ï¼Œæ˜­å‘Šå››æ–¹ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½é£å¤§è¿‡&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ ‹æ¡¡ã€‚åˆ©æœ‰æ”¸å¾€ï¼Œäº¨ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±‹ç²±å‹å¾—å¼¯æ›²äº†ã€‚æœ‰æ‰€å¾€åˆ™æœ‰åˆ©ï¼Œé€šæ³°ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ç­æœ¨ï¼Œå¤§è¿‡ã€‚å›å­ä»¥ç‹¬ç«‹ä¸æƒ§ï¼Œéä¸–æ— é—·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½æ°´æ·¹æ²¡æœ¨èˆŸï¼Œè¿™æ˜¯å¤§è¿‡çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥èˆŸé‡åˆ™è¦†ä¸ºæˆ’ï¼Œé¢†æ‚Ÿåˆ°é­é€¢ç¥¸å˜ï¼Œåº”å®ˆèŠ‚ä¸å±ˆï¼Œç¨³å±…ä¸ä»•ï¼Œæ¸…é™æ·¡æ³Šã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«é£é¼&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒå‰ï¼Œäº¨ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å‰å¤§åˆ©ï¼Œäº¨é€šã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ¨ä¸Šæœ‰ç«ï¼Œé¼ã€‚å›å­ä»¥æ­£ä½å‡å‘½ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ¨ä¸Šæœ‰ç«ï¼Œä»¥é¼çƒ¹ç‰©ï¼Œè¿™æ˜¯ã€Šé¼ã€‹å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºé¼è¶³ä¸‰åˆ†ï¼Œæ­£ç«‹ä¸å€šï¼Œä»è€ŒæŒæ­£å®ˆä½ï¼Œä¸ºå›ä¸Šæ‰€å€šé‡ï¼Œä¸è´Ÿä½¿å‘½ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;é›·å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·é£æ’&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œæ— å’ï¼Œåˆ©è´ã€‚åˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šè¾¾ï¼Œæ²¡æœ‰è¿‡å¤±ï¼Œå‰åˆ©çš„åœé—®ã€‚æœ‰æ‰€å¾€åˆ™æœ‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·é£ï¼Œæ’ã€‚å›å­ä»¥ç«‹ä¸æ˜“æ–¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£é›·è¡æ¶¤ï¼Œå®‡å®™å¸¸æ–°ï¼Œè¿™æ˜¯æ’å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œç«‹äºæ­£é“ï¼Œåšå®ˆä¸æ˜“ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å·½ä¸ºé£&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å°äº¨ã€‚åˆ©æœ‰æ”¸å¾€ï¼Œåˆ©è§å¤§äººã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç¨è§äº¨é€šã€‚åˆ©äºå‡ºè¡Œï¼Œåˆ©äºä¼šè§ç‹å…¬è´µæ—ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;éšé£ï¼Œå·½ã€‚å›å­ä»¥ç”³å‘½è¡Œäº‹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é•¿é£ç›¸éšï¼Œå¹æ‹‚ä¸æ–­ï¼Œæ˜¯å·½å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºé•¿å¹ä¸æ–­çš„é£ï¼Œä»è€Œä¸æ–­åœ°ç”³æ˜æ•™ä¹‰ï¼Œåå¤åœ°é¢è¡Œæ”¿ä»¤ï¼ŒçŒè¾“çº²å¸¸å¤§ä¹‰ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åå·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´é£äº•&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ”¹é‚‘ä¸æ”¹äº•ï¼Œæ— ä¸§æ— å¾—ã€‚å¾€æ¥äº•äº•ã€‚æ±”è‡³ï¼Œäº¦æœªç¹˜äº•ï¼Œç¾¸å…¶ç“¶ï¼Œå‡¶ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ”¹å»ºé‚‘è½è€Œä¸æ”¹å»ºæ°´äº•ï¼Œç­‰äºä»€ä¹ˆä¹Ÿæ²¡æœ‰å¹²ã€‚äººä»¬å¾€æ¥äº•è¾¹æ±²æ°´ï¼Œæ°´äº•å¹²æ¶¸æ·¤å¡ï¼Œä¸å»åŠ ä»¥æ·˜æ´—ï¼Œåè€Œå°†åŠæ°´ç½æ‰“ç ´ï¼Œè¿™æ˜¯å‡¶é™©ä¹‹è±¡ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ¨ä¸Šæœ‰æ°´ï¼Œäº•ã€‚å›å­ä»¥åŠ³æ°‘åŠç›¸ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´ä¸‹æµ¸è€Œæ ‘æœ¨ç”Ÿé•¿ï¼Œè¿™æ˜¯äº•å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºäº•æ°´å…»äººï¼Œä»è€Œé¼“åŠ±äººæ°‘å‹¤åŠ³è€Œäº’ç›¸åŠå‹‰ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±é£è›Š&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒäº¨ï¼Œåˆ©æ¶‰å¤§å·ã€‚å…ˆç”²ä¸‰æ—¥ï¼Œåç”²ä¸‰æ—¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å‰å¤§åˆ©ã€‚åˆ©äºæ¶‰æ°´æ¸¡æ²³ï¼Œä½†é¡»åœ¨ç”²å‰ä¸‰æ—¥ä¹‹è¾›æ—¥ä¸ç”²åä¸‰æ—¥ä¹‹ä¸æ—¥å¯ç¨‹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰é£ï¼Œè›Šã€‚å›å­ä»¥æŒ¯æ°‘è‚²å¾·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è´¤äººå¦‚å±±å±…äºä¸Šï¼Œå®£å¸ƒå¾·æ•™æ–½äºä¸‹ï¼Œæ‰€è°“å±±ä¸‹æœ‰é£ï¼Œè¿™æ˜¯å·½å¦ç›¼å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºå¹æ‹‚ä¸‡ç‰©çš„é£ï¼Œä»è€ŒæŒ¯æ•‘ä¸‡æ°‘ï¼Œæ–½è¡Œå¾·æ•™ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤å·½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°é£å‡&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒäº¨ã€‚ç”¨è§å¤§äººï¼Œå‹¿æ¤ï¼Œå—å¾å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;éå¸¸äº¨é€šï¼Œæœ‰åˆ©äºä¼šè§ç‹å…¬è´µæ—ï¼Œä¸ç”¨æ‹…å¿§ã€‚å å¾—æ­¤çˆ»ï¼Œå‡ºå¾å—æ–¹å‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ä¸­ç”Ÿæœ¨ï¼Œå‡ã€‚å›å­ä»¥é¡ºå¾·ï¼Œç§¯å°ä»¥é«˜å¤§ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ¨æ¤äºåœ°ä¸­ï¼Œæ˜¯å‡å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œéµå¾ªå¾·ä¹‰ï¼ŒåŠ å¼ºä¿®å…»ï¼Œä»ç»†å°èµ·æ­¥ï¼Œé€æ­¥åŸ¹è‚²å´‡é«˜çš„å“å¾·ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©æ°´è®¼&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ‰å­šï¼Œçª’æƒ•ï¼Œä¸­å‰ï¼Œç»ˆå‡¶ã€‚åˆ©è§å¤§äººï¼Œä¸åˆ©æ¶‰å¤§å·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è™½æœ‰åˆ©å¯å›¾(è·å¾—ä¿˜è™)ï¼Œä½†è¦è­¦æƒ•æˆ’æƒ§ã€‚å…¶äº‹ä¸­é—´å‰åˆ©ï¼Œåæ¥å‡¶é™©ã€‚å ç­®å¾—æ­¤çˆ»ï¼Œæœ‰åˆ©äºä¼šè§è´µæ—ç‹å…¬ï¼Œä¸åˆ©äºæ¶‰æ°´æ¸¡æ²³ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸æ°´è¿è¡Œï¼Œè®¼ã€‚å›å­ä»¥åšäº‹è°‹å§‹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©æ°´éš”ç»ï¼Œæµå‘ç›¸èƒŒï¼Œäº‹ç†ä¹–èˆ›ï¼Œè¿™æ˜¯è®¼å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥æœç»äº‰è®¼ä¸ºæ„ï¼Œä»è€Œåœ¨è°‹äº‹ä¹‹åˆå¿…é¡»æ…ä¹‹åˆæ…ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½æ°´å›°&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œè´ï¼Œå¤§äººå‰ï¼Œæ— å’ã€‚æœ‰è¨€ä¸ä¿¡ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šæ³°ã€‚åœé—®ç‹å…¬è´µæ—ä¹‹äº‹å‰åˆ©ï¼Œæ²¡æœ‰ç¾éš¾ã€‚ç­®é‡æ­¤çˆ»ï¼Œæœ‰ç½ªä¹‹äººæ— æ³•ç”³è¾©æ¸…æ¥šã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½æ— æ°´ï¼Œå›°ã€‚å›å­ä»¥è‡´å‘½é‚å¿—ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´æ¸—æ³½åº•ï¼Œæ³½ä¸­å¹²æ¶¸ï¼Œæ˜¯å›°å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥å¤„å¢ƒè‰°éš¾è‡ªåŠ±ï¼Œç©·ä¸”ç›Šåšï¼Œèˆèº«æå‘½ï¼Œä»¥è¡Œå…¶å¤™å¿—ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«æ°´æœªæµ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œå°ç‹æ±”æµï¼Œæ¿¡å…¶å°¾ï¼Œæ— æ”¸åˆ©&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å°ç‹ç‹¸å¿«è¦æ¸¡è¿‡æ²³ï¼Œå´æ‰“æ¹¿äº†å°¾å·´ã€‚çœ‹æ¥æ­¤è¡Œæ— æ‰€åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«åœ¨æ°´ä¸Šï¼Œæœªæµã€‚å›å­ä»¥æ…è¾¨ç‰©å±…æ–¹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«åœ¨æ°´ä¸Šï¼Œæ°´ä¸èƒ½å…‹ç«ï¼Œæ˜¯æœªæµå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæœ‰æ„Ÿäºæ°´ç«é”™ä½ä¸èƒ½ç›¸å…‹ï¼Œä»è€Œä»¥è°¨æ…çš„æ€åº¦è¾¨è¾©äº‹ç‰©çš„æ€§è´¨ï¼Œå®¡è§†å…¶æ–¹ä½ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·æ°´è§£&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©è¥¿å—ã€‚æ— æ‰€å¾€ï¼Œå…¶æ¥å¤å‰ã€‚æœ‰æ”¸å¾€ï¼Œå¤™å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©äºè¥¿å—è¡Œï¼Œä½†æ˜¯ï¼Œè‹¥æ²¡æœ‰ç¡®å®šçš„ç›®æ ‡ï¼Œåˆ™ä¸å¦‚è¿”å›ï¼Œè¿”å›å‰åˆ©ã€‚å¦‚æœæœ‰ç¡®å®šçš„ç›®æ ‡ï¼Œåˆ™å®œæ—©è¡Œï¼Œæ—©è¡Œå‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·é›¨ä½œï¼Œè§£ã€‚å›å­ä»¥èµ¦è¿‡å®¥ç½ªã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·é›¨å¹¶ä½œï¼ŒåŒ–è‚²ä¸‡ç‰©ï¼Œæ˜¯è§£å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œèµ¦å…è¿‡å¤±ï¼Œå®½å®¥ç½ªäººã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£æ°´æ¶£&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œç‹å‡æœ‰åº™ã€‚åˆ©æ¶‰å¤§å·ï¼Œåˆ©è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨é€šï¼Œå› ä¸ºå›ç‹äº²ä¸´å®—åº™ï¼Œç¦³ç¾ç¥ˆç¦ã€‚åˆ©äºæ¶‰æ°´è¿‡æ±Ÿæ²³ã€‚è¿™æ˜¯å‰åˆ©çš„è´åœ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£è¡Œæ°´ä¸Šï¼Œæ¶£ã€‚å…ˆç‹ä»¥äº«äºå¸ï¼Œç«‹åº™ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£è¡Œæ°´ä¸Šï¼Œæ˜¯æ¶£å¦çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡ï¼Œä»è€Œäº«ç¥­å¤©å¸ï¼Œå»ºç«‹å®—åº™ï¼Œæ¨è¡Œå°Šå¤©å­ç¥–çš„â€œå¾·æ•™â€&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åå&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åä¸ºæ°´&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¹ åï¼Œæœ‰å­šï¼Œç»´å¿ƒäº¨ï¼Œè¡Œæœ‰å°šã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æŠ“è·ä¿˜è™ï¼ŒåŠæ…°å®‰æŠšä»–ä»¬ï¼Œé€šæ³°ã€‚é€”ä¸­å°†å¾—åˆ°å¸®åŠ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´æ´Šè‡³ï¼Œä¹ åã€‚å›å­ä»¥å¸¸å¾·è¡Œï¼Œä¹ æ•™äº‹ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åä¸ºæ°¸ï¼Œæ°´é•¿æµä¸æ»ï¼Œæ˜¯åå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œå°Šå°šå¾·è¡Œï¼Œå–æ³•äºç»†æ°´é•¿æµä¹‹è±¡ï¼Œå­¦ä¹ æ•™åŒ–äººæ°‘çš„æ–¹æ³•ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±æ°´è’™&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚åŒªæˆ‘æ±‚ç«¥è’™ï¼Œç«¥è’™æ±‚æˆ‘ã€‚åˆç­®å‘Šï¼Œå†ä¸‰æ¸ï¼Œæ¸åˆ™ä¸å‘Šã€‚åˆ©è´ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šæ³°ã€‚ä¸æ˜¯æˆ‘æœ‰æ±‚äºå¹¼ç¨šæ„šæ˜§çš„äººï¼Œè€Œæ˜¯å¹¼ç¨šæ„šæ˜§çš„äººæœ‰æ±‚äºæˆ‘ã€‚ç¬¬ä¸€æ¬¡å ç­®ï¼Œç¥çµå‘Šè¯‰äº†ä»–ã€‚è½»æ…¢ä¸æ•¬çš„å†ä¸‰å ç­®ï¼Œè½»æ…¢ä¸æ•¬çš„å ç­®ï¼Œç¥çµå°±ä¸ä¼šå‘Šè¯‰ä»–ã€‚ä½†è¿˜æ˜¯å‰åˆ©çš„åœé—®ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹å‡ºæ³‰ï¼Œè’™ã€‚å›å­ä»¥æœè¡Œè‚²å¾·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸‹æœ‰æ³‰ï¼Œæ³‰æ°´å–·æ¶Œè€Œå‡ºï¼Œè¿™æ˜¯è’™å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºä¸€å¾€æ— å‰çš„å±±æ³‰ï¼Œä»è€Œä»¥æœæ•¢åšæ¯…çš„è¡ŒåŠ¨æ¥åŸ¹å…»è‡ªèº«çš„å“å¾·ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤å&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°æ°´å¸ˆ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è´ï¼Œä¸ˆäººå‰ï¼Œæ— å’ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å é—®æ€»æŒ‡æŒ¥çš„å†›æƒ…ï¼Œæ²¡æœ‰ç¾ç¥¸ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ä¸­æœ‰æ°´ï¼Œå¸ˆã€‚å›å­ä»¥å®¹æ°‘ç•œä¼—ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;â€œåœ°ä¸­æœ‰æ°´â€ï¼Œè¿™æ˜¯å¸ˆå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºå®¹çº³æ±Ÿæ²³çš„å¤§åœ°ï¼Œæ”¶å®¹å’Œç•œå…»å¤§ä¼—ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©å±±é&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ã€‚å°åˆ©è´&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šè¾¾ã€‚å°æœ‰åˆ©ä¹‹å é—®ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸‹æœ‰å±±ï¼Œéã€‚å›å­ä»¥è¿œå°äººï¼Œä¸æ¶è€Œä¸¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©ä¸‹æœ‰å±±ï¼Œå¤©é«˜å±±è¿œï¼Œæ˜¯éå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œä¸ç”¨ä»¥æ¶æŠ¥æ¶çš„æ–¹æ³•å¯¹ä»˜å°äººï¼Œè€Œæ˜¯é‡‡å–ä¸¥å‰çš„æ€åº¦ï¼ŒæŒ‚å† æ‚¬ç¬ï¼Œè‡ªç”˜é€€éšï¼Œè¿œç¦»å°äººã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½å±±å’¸&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œåˆ©è´ã€‚å–å¥³å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šè¾¾ï¼Œå‰åˆ©çš„è´åœã€‚å¨¶å¥³ï¼Œå‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸Šæœ‰æ³½ï¼Œå’¸ã€‚å›å­ä»¥è™šå—äººã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸­æœ‰æ³½ï¼Œå±±æ°”æ°´æ¯ï¼Œäº’ç›¸æ„Ÿåº”ï¼Œæ˜¯å’¸å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºæ·±é‚ƒçš„å±±è°·ï¼Œæ·±å¹¿çš„å¤§æ³½ï¼Œä»è€Œè™šæ€€è‹¥è°·ï¼Œä»¥è°¦è™šçš„æ€åº¦ï¼Œæ¥å—ä»–äººçš„æ•™ç›Šã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«å±±æ—…&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å°äº¨ï¼Œæ—…è´å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç¨è§äº¨é€šã€‚è´åœæ—…è¡Œï¼Œå‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸Šæœ‰ç«ï¼Œæ—…ã€‚å›å­ä»¥æ˜æ…ç”¨åˆ‘ï¼Œè€Œä¸ç•™ç‹±ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸Šæœ‰ç«ï¼Œæ´ç…§å¹½éšï¼Œè¿™æ˜¯æ—…å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œæ˜å¯Ÿåˆ‘ç‹±ï¼Œæ…é‡åˆ¤å†³ï¼Œæ—¢ä¸æ•¢æ»¥æ–½åˆ‘ç½šï¼Œä¹Ÿä¸æ•¢å»¶å®•æ»ç•™ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·å±±å°è¿‡&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œåˆ©è´ã€‚å¯å°äº‹ï¼Œä¸å¯å¤§äº‹ã€‚é£é¸Ÿé—ä¹‹éŸ³ã€‚ä¸å®œä¸Šï¼Œå®œä¸‹ï¼Œå¤§å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨é€šï¼Œè¿™æ˜¯å‰åˆ©çš„è´åœã€‚ä½†æ˜¯åªé€‚å®œäºå°äº‹ï¼Œä¸é€‚å®œå¤§äº‹ã€‚é£é¸Ÿç©ºä¸­è¿‡ï¼Œå«å£°è€³è¾¹ç•™ï¼Œè­¦æƒ•äººä»¬ï¼šç™»é«˜å¿…é‡é™©ï¼Œä¸‹è¡Œåˆ™å‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸Šæœ‰é›·ï¼Œå°è¿‡ã€‚å›å­ä»¥è¡Œè¿‡ä¹æ­ï¼Œä¸§è¿‡ä¹è¡°ï¼Œç”¨è¿‡ä¹ä¿­ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸Šæœ‰é›·ï¼Œæ˜¯å°è¿‡çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæƒ§ç•å¤©é›·ï¼Œä¸æ•¢æœ‰è¿‡å¤±ã€‚å› è€Œè¡Œäº‹ä¸æ•¢è¿‡äºæ­è°¦ï¼Œå±…ä¸§ä¸æ•¢è¿‡åº¦å“€ä¼¤ï¼Œç”¨åº¦ä¸æ•¢è¿‡äºèŠ‚ä¿­ï¼Œå”¯é€‚ä¸­è€Œå·²ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£å±±æ¸&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©è¥¿å—ï¼Œä¸åˆ©ä¸œåŒ—ã€‚åˆ©è§å¤§äººï¼Œè´å‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç­®é‡æ­¤å¦ï¼Œåˆ©è¥¿å—è¡Œï¼Œä¸åˆ©ä¸œåŒ—è¡Œã€‚åˆ©è§è´µæ—ç‹å…¬ï¼Œè·å‰ç¥¥ä¹‹å…†ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±ä¸Šæœ‰æ°´ï¼Œè¹‡ã€‚å›å­ä»¥åèº«ä¿®å¾·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±çŸ³ç£·å³‹ï¼Œæ°´æµæ›²æŠ˜ï¼Œæ˜¯è¹‡å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œæ‚Ÿè¡Œé“ä¹‹ä¸æ˜“ï¼Œä»è€Œåæ±‚è¯¸å·±ï¼Œä¿®å…»å¾·è¡Œã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è‰®ä¸ºå±±&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;è‰®å…¶èƒŒï¼Œä¸è·å…¶èº«ã€‚è¡Œå…¶åº­ï¼Œä¸è§å…¶äººã€‚æ— å’ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¸æ‰è´£ä»»ï¼ŒæŒ‚ç¬éšé€€ï¼Œæœåˆ—ä¹‹ä¸­å·²çœ‹ä¸åˆ°ä»–çš„èº«å½±ï¼Œåœ¨ä»–çš„åº­é™¢ä¸­å¯»æ‰¾ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°ã€‚å…¶äººè¿œèµ°é«˜é£ï¼Œè‡ªæ— ç¾ç¥¸ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…¼å±±ï¼Œè‰®ã€‚å›å­ä»¥æ€ä¸å‡ºå…¶ä½ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸¤è‰®å¦ç›¸é‡ï¼Œè‰®ä¸ºå±±ï¼Œå¯è§è‰®å¦çš„å¦è±¡æ˜¯é«˜å±±é‡ç«‹ï¼Œæ¸Šæ·±ç¨³é‡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥æ­¤ä¸ºæˆ’ï¼Œè°‹ä¸è¸°ä½ï¼Œæ˜å“²ä¿èº«ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤è‰®&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°å±±è°¦&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œå›å­æœ‰ç»ˆã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šæ³°ã€‚ç­®é‡æ­¤å¦ï¼Œå›å­å°†æœ‰æ‰€æˆå°±ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ä¸­æœ‰å±±ï¼Œè°¦ã€‚å›å­ä»¥è£’å¤šç›Šå¯¡ï¼Œç§°ç‰©å¹³æ–½ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ä¸­æœ‰å±±ï¼Œå†…é«˜å¤–å‘ï¼Œå±…é«˜ä¸å‚²ï¼Œè¿™æ˜¯è°¦å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥è°¦è®©ä¸ºæ€€ï¼Œè£å–å¤šä½™æ˜€ï¼Œå¢ç›Šç¼ºä¹çš„ï¼Œè¡¡é‡è´¢ç‰©çš„å¤šå¯¡è€Œå…¬å¹³æ–½äºˆã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	&quot;ä¹¾å¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©åœ°å¦&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¦ä¹‹åŒªäººã€‚ä¸åˆ©å›å­è´ã€‚å¤§å¾€å°æ¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸ºå°äººæ‰€éš”é˜‚ï¼Œè¿™æ˜¯ä¸åˆ©äºå›å­çš„å åœï¼Œäº‹ä¸šä¹Ÿå°†ç”±ç››è½¬è¡°ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©åœ°ä¸äº¤ï¼Œå¦ã€‚å›å­ä»¥ä¿­å¾·è¾Ÿéš¾ï¼Œä¸å¯è£ä»¥ç¦„ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤©åœ°éš”é˜‚ä¸èƒ½äº¤æ„Ÿï¼Œä¸‡ç‰©å’½çª’ä¸èƒ½ç•…é‡œï¼Œè¿™æ˜¯å¦å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œåœ¨å›½å®¶æ”¿æ²»å¦å¡ä¹‹æ—¶ï¼Œåº”æ€éšå±…ä¸ä»•ï¼Œä»¥å´‡å°šä¿­çº¦æ¥èº²é¿ç¾éš¾ï¼Œä¸è¦ä»¥åˆ©ç¦„ä¸ºè£ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å…‘æ³½&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½åœ°èƒ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äº¨ï¼Œç‹å‡æœ‰åº™ã€‚åˆ©è§å¤§äººï¼Œäº¨ï¼Œåˆ©è´ã€‚ç”¨å¤§ç‰²å‰ã€‚åˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é€šæ³°ã€‚ç‹åˆ°å®—åº™ä¸¾è¡Œç¥­ç¥€ã€‚å å¾—æ­¤å¦ï¼Œåˆ©äºä¼šè§è´µæ—ç‹å…¬ï¼Œäº¨é€šï¼Œè¿™æ˜¯å‰åˆ©çš„è´å…†ã€‚ç”¨ç‰›ç‰²ç¥­ç¥€ï¼Œä¹Ÿå¾ˆå‰åˆ©ï¼Œå¹¶ä¸”å‡ºè¡Œå‰åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½ä¸Šäºåœ°ï¼Œèƒã€‚å›å­ä»¥é™¤æˆå™¨ï¼Œæˆ’ä¸è™ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ³½æ°´æ·¹åœ°ï¼Œæ˜¯èƒå¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥æ´ªæ°´æ¨ªæµï¼Œç¥¸ä¹±ä¸›èšä¸ºæˆ’ï¼Œä»è€Œä¿®æ²»å…µå™¨ï¼Œæˆ’å¤‡æ„å¤–çš„å˜ä¹±ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;ç¦»å¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç«åœ°æ™‹&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åº·ä¾¯ç”¨é”¡é©¬è•ƒåº¶ï¼Œæ˜¼æ—¥ä¸‰æ¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åº·ä¾¯ç”¨æˆç‹èµäºˆçš„è‰¯é©¬æ¥ç¹æ®–é©¬åŒ¹ï¼Œä¸€å¤©å¤šæ¬¡é…ç§ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ˜å‡ºåœ°ä¸Šï¼Œæ™‹ã€‚å›å­ä»¥è‡ªæ˜­æ˜å¾·ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤ªé˜³ç…§å¤§åœ°ï¼Œä¸‡ç‰©æ²å…‰è¾‰â€ï¼Œæ˜¯æ™‹å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»è€Œå…‰å¤§è‡ªèº«çš„å…‰æ˜ä¹‹å¾·ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;éœ‡å¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·åœ°è±«&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ©å»ºä¾¯è¡Œå¸ˆã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ‰åˆ©äºå°ä¾¯å»ºå›½ï¼Œå‡ºå…µæ‰“ä»—ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é›·å‡ºåœ°å¥‹ï¼Œè±«ã€‚å…ˆç‹ä»¥ä½œä¹å´‡å¾·ï¼Œæ®·èä¹‹ä¸Šå¸ï¼Œä»¥é…ç¥–è€ƒã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ˜¥é›·è½°é¸£ï¼Œå¤§åœ°éœ‡åŠ¨ï¼Œå‚¬å‘ä¸‡ç‰©ï¼Œè¿™æ˜¯è±«å¦çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºå£°æ»¡å¤§åœ°çš„é›·é¸£ï¼Œåˆ¶ä½œéŸ³ä¹ï¼Œæ­ŒåŠŸé¢‚å¾·ï¼Œå…‰è£å½’äºä¸Šå¸ï¼Œå…‰è£å½’äºç¥–è€ƒã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å·½å¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£åœ°è§‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç›¥è€Œä¸èï¼Œæœ‰å­šé¡’è‹¥ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç¥­ç¥€æ—¶çŒé…’é™ç¥è€Œä¸çŒ®äººç‰²ï¼Œå› ä¸ºç”¨ä½œç¥­ç¥€çš„ä¿˜è™çš„å¤´éƒ¨è‚¿äº†ï¼Œä¸èƒ½ç”¨ä½œç¥­å“ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£è¡Œåœ°ä¸Šï¼Œè§‚ã€‚å…ˆç‹ä»¥çœæ–¹ï¼Œè§‚æ°‘è®¾æ•™&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;é£è¡Œå¤§åœ°å¹æ‹‚ä¸‡ç‰©ï¼Œè¿™æ˜¯è§‚çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡å–æ³•äºå‘¨æµå…«æ–¹çš„é£ï¼Œä»è€Œå·¡è§†é‚¦å›½ï¼Œè§‚å¯Ÿæ°‘æƒ…ï¼Œæ¨è¡Œæ•™åŒ–ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;åå¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æ°´åœ°æ¯”&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‰ã€‚åŸç­®ï¼Œå…ƒæ°¸è´ï¼Œæ— å’ã€‚ä¸å®æ–¹æ¥ï¼Œåå¤«å‡¶ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‰åˆ©ã€‚åŒæ—¶å†åœç­®ï¼Œä»ç„¶å¤§å‰å¤§åˆ©ã€‚åœé—®é•¿æ—¶æœŸçš„å‰å‡¶ï¼Œä¹Ÿæ²¡æœ‰ç¾ç¥¸ã€‚ä¸æ„¿è‡£æœçš„é‚¦å›½æ¥æœï¼Œè¿Ÿè¿Ÿä¸æ¥è€…æœ‰éš¾ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ä¸Šæœ‰æ°´ï¼Œæ¯”ã€‚å…ˆç‹ä»¥å»ºä¸‡å›½ï¼Œäº²è¯¸ä¾¯ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°ä¸Šæœ‰æ°´ï¼Œè¿™æ˜¯æ¯”å¦çš„å¦è±¡ã€‚å…ˆç‹è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºæ°´é™„å¤§åœ°ï¼Œåœ°çº³æ±Ÿæ²³ä¹‹è±¡ï¼Œå°å»ºä¸‡å›½ï¼Œäº²è¿‘è¯¸ä¾¯ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;è‰®å¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±åœ°å‰¥&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ä¸åˆ©æœ‰æ”¸å¾€ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æœ‰æ‰€å¾€åˆ™ä¸åˆ©ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±é™„äºåœ°ï¼Œå‰¥ã€‚ä¸Šä»¥åšä¸‹ï¼Œå®‰å®…ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å±±åœ¨åœ°ä¸Šï¼Œé£é›¨å‰¥èš€ï¼Œè¿™æ˜¯å‰¥å¦çš„å¦è±¡ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œä»¥å±±çŸ³å‰¥è½ï¼Œå²©è§’å´©å¡Œä¸ºæˆ’ï¼Œä»è€Œåšç»“æ°‘å¿ƒï¼Œä½¿äººæ°‘å®‰å±…ä¹ä¸šã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#E06C75;">	&quot;å¤å¤&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤ä¸ºåœ°&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å…ƒï¼Œäº¨ï¼Œåˆ©ç‰é©¬ä¹‹è´ã€‚å›å­æœ‰æ”¸å¾€ï¼Œå…ˆè¿·åå¾—ä¸»ã€‚åˆ©è¥¿å—å¾—æœ‹ï¼Œä¸œåŒ—ä¸§æœ‹ã€‚å®‰è´ï¼Œå‰ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_words&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å‰å¤§åˆ©ã€‚å é—®é›Œé©¬å¾—åˆ°å‰å…†ã€‚å›å­å‰å»æ—…è¡Œï¼Œå…ˆè¿·å¤±è·¯é€”ï¼Œåæ¥æ‰¾åˆ°ä¸»äººï¼Œå‰åˆ©ã€‚è¥¿å—è¡Œè·å¾—è´¢ç‰©ï¼Œä¸œåŒ—è¡Œä¸§å¤±è´¢ç‰©ã€‚å é—®å®šå±…ï¼Œå¾—åˆ°å‰å…†ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åœ°åŠ¿å¤ï¼Œå›å­ä»¥åšå¾·è½½ç‰©ã€‚ã€‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		&quot;white_picture&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§åœ°çš„å½¢åŠ¿å¹³é“ºèˆ’å±•ï¼Œé¡ºæ‰¿å¤©é“ã€‚å›å­è§‚æ­¤å¦è±¡ï¼Œå–æ³•äºåœ°ï¼Œä»¥æ·±åšçš„å¾·è¡Œæ¥æ‰¿æ‹…é‡å¤§çš„è´£ä»»ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br></div></div><h3 id="æ‰§è¡Œæ–¹å¼" tabindex="-1">æ‰§è¡Œæ–¹å¼ <a class="header-anchor" href="#æ‰§è¡Œæ–¹å¼" aria-label="Permalink to &quot;æ‰§è¡Œæ–¹å¼&quot;">â€‹</a></h3><p>æ‰‹åŠ¨æ‰§è¡Œ main.py æ–‡ä»¶</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h1 id="è‡ªåŠ¨æ”¶é›†æ¯æ—¥é»„é‡‘ä»·æ ¼" tabindex="-1">è‡ªåŠ¨æ”¶é›†æ¯æ—¥é»„é‡‘ä»·æ ¼ <a class="header-anchor" href="#è‡ªåŠ¨æ”¶é›†æ¯æ—¥é»„é‡‘ä»·æ ¼" aria-label="Permalink to &quot;è‡ªåŠ¨æ”¶é›†æ¯æ—¥é»„é‡‘ä»·æ ¼&quot;">â€‹</a></h1><h2 id="åœºæ™¯éœ€æ±‚" tabindex="-1">åœºæ™¯éœ€æ±‚ <a class="header-anchor" href="#åœºæ™¯éœ€æ±‚" aria-label="Permalink to &quot;åœºæ™¯éœ€æ±‚&quot;">â€‹</a></h2><p>é»„é‡‘ä»·æ ¼æŒç»­ä¸Šæ¶¨ï¼Œå·²ç»æˆä¸ºä»Šå¹´æœ€çƒ­çš„æŠ•èµ„èµ„äº§ã€‚</p><p>å‡†å¤‡åœ¨å·¥å•†é“¶è¡Œä¹° 100g å®ä½“é»„é‡‘ï¼Œåˆæ‹¿ä¸å‡†è¿‘æœŸçš„é‡‘ä»·èµ°åŠ¿ï¼Œæœ€è¿‘ç»å¸¸ä¸Šé“¶è¡Œç½‘ç«™çœ‹ä»·æ ¼ï¼Œç­‰é‡‘ä»·ä¸‹è·Œæ—¶æ‰¾ä¸ªç¼ºå£å…¥æ‰‹ã€‚</p><p>æ¯å¤©æ‰‹åŠ¨æŸ¥çœ‹é»„é‡‘ä»·æ ¼å«Œéº»çƒ¦ï¼Œè®© AI å¸®å¿™å†™ä¸ªè„šæœ¬è‡ªåŠ¨æ”¶é›†æ¯æ—¥é»„é‡‘ä»·æ ¼ï¼Œç”¨é£ä¹¦æ”¶é›†æ•°æ®æ±‡æ€»åå±•ç¤ºä»·æ ¼èµ°åŠ¿ã€‚</p><h2 id="å·¥å…·" tabindex="-1">å·¥å…· <a class="header-anchor" href="#å·¥å…·" aria-label="Permalink to &quot;å·¥å…·&quot;">â€‹</a></h2><blockquote><p><strong>Claude 3 Opus</strong> ç¼–å†™ Pythonã€Github Action è„šæœ¬</p><p><strong>Github Action</strong> è„šæœ¬æ‰˜ç®¡ï¼Œæ¯æ—¥å®šæ—¶æ‰§è¡Œè„šæœ¬</p><p><strong>é£ä¹¦</strong> æ•°æ®æ”¶é›†ã€æ±‡æ€»ã€å±•ç¤º</p></blockquote><h2 id="ğŸ“-å®ç°æ­¥éª¤" tabindex="-1">ğŸ“ å®ç°æ­¥éª¤ <a class="header-anchor" href="#ğŸ“-å®ç°æ­¥éª¤" aria-label="Permalink to &quot;ğŸ“ å®ç°æ­¥éª¤&quot;">â€‹</a></h2><p><img src="/ProgramLearnNotes/assets/640-4984949.B8gyXfRS.webp" alt="å›¾ç‰‡"></p><p>é¦–å…ˆï¼Œè®¿é—®é“¶è¡Œç½‘ç«™åˆ†æä¸‹ç½‘é¡µçš„å¸ƒå±€ï¼ŒæŸ¥çœ‹ç½‘é¡µå…ƒç´ åˆ†æé»„é‡‘ä»·æ ¼çš„æ•°å€¼å¯¹åº” prodSkuJson å­—æ®µã€‚</p><h3 id="_1-ä½¿ç”¨-prompt-æç¤ºè¯-è®©-ai-ç¼–å†™-pythonã€github-action-è„šæœ¬" tabindex="-1">1.ä½¿ç”¨ Prompt æç¤ºè¯ï¼Œè®© AI ç¼–å†™ Pythonã€Github Action è„šæœ¬ <a class="header-anchor" href="#_1-ä½¿ç”¨-prompt-æç¤ºè¯-è®©-ai-ç¼–å†™-pythonã€github-action-è„šæœ¬" aria-label="Permalink to &quot;1.ä½¿ç”¨ Prompt æç¤ºè¯ï¼Œè®© AI ç¼–å†™ Pythonã€Github Action è„šæœ¬&quot;">â€‹</a></h3><p>**æ³¨ï¼š**Prompt æç¤ºè¯ä»…ä¾›å‚è€ƒï¼ŒAI å¤§æ¨¡å‹åœ¨å®é™…é—®ç­”ä¸­ç»å¸¸ä¼šæœ‰äº›å°å·®å¼‚ï¼Œé‡åˆ°è„šæœ¬æ‰§è¡Œé—®é¢˜è¿˜éœ€è¦æœ‰ä¸€å®šçš„æŠ€æœ¯åŸºç¡€è¿›è¡Œæ‰‹åŠ¨è°ƒè¯•ã€‚</p><h4 id="prompt-æç¤ºè¯" tabindex="-1">Prompt æç¤ºè¯ï¼š <a class="header-anchor" href="#prompt-æç¤ºè¯" aria-label="Permalink to &quot;Prompt æç¤ºè¯ï¼š&quot;">â€‹</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span># æ–°å»ºä¸€ä¸ªpythonè„šæœ¬dailygoldprice.pyï¼Œ</span></span>
<span class="line"><span>è®¿é—®é“¾æ¥ï¼šhttps://mall.icbc.com.cn/products/pd_9003867817.jhtmlï¼Œ</span></span>
<span class="line"><span>åŒ¹é…å“åº”æ–‡æœ¬ä¸­prodSkuJsonè·å¾—100gé»„é‡‘çš„ä»·æ ¼ã€‚</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1714914507252-739.B9PbVu6P.webp" alt="å›¾ç‰‡"></p><h4 id="prompt-æç¤ºè¯-1" tabindex="-1">Prompt æç¤ºè¯ï¼š <a class="header-anchor" href="#prompt-æç¤ºè¯-1" aria-label="Permalink to &quot;Prompt æç¤ºè¯ï¼š&quot;">â€‹</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span># è¯·æ±‚é£ä¹¦webhookåœ°å€ï¼Œæ”¶é›†æ•°æ®</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1714914507252-740.DzIiYSEb.webp" alt="å›¾ç‰‡"></p><h4 id="prompt-æç¤ºè¯-2" tabindex="-1">Prompt æç¤ºè¯ï¼š <a class="header-anchor" href="#prompt-æç¤ºè¯-2" aria-label="Permalink to &quot;Prompt æç¤ºè¯ï¼š&quot;">â€‹</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span># æ–°å»ºgithub actionæ¯å¤©æ‰§è¡Œä¸€æ¬¡dailygoldprice.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1714914507252-741.kRrCkDGS.webp" alt="å›¾ç‰‡"></p><h3 id="_2-é…ç½®-github-action" tabindex="-1">2.é…ç½® Github Action <a class="header-anchor" href="#_2-é…ç½®-github-action" aria-label="Permalink to &quot;2.é…ç½® Github Action&quot;">â€‹</a></h3><p>é…ç½® Github Action å¯ä»¥å‚è€ƒ AI æä¾›çš„æ­¥éª¤å’Œå®˜æ–¹æ•™ç¨‹ï¼Œä¹‹ååœ¨ Actions é¡µé¢èƒ½å¤Ÿçœ‹åˆ°è„šæœ¬çš„è¿è¡ŒçŠ¶å†µã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1714914507252-742._RxZ7UF8.webp" alt="å›¾ç‰‡"></p><h3 id="_3-ä½¿ç”¨é£ä¹¦æ”¶é›†æ•°æ®" tabindex="-1">3.ä½¿ç”¨é£ä¹¦æ”¶é›†æ•°æ® <a class="header-anchor" href="#_3-ä½¿ç”¨é£ä¹¦æ”¶é›†æ•°æ®" aria-label="Permalink to &quot;3.ä½¿ç”¨é£ä¹¦æ”¶é›†æ•°æ®&quot;">â€‹</a></h3><p>å…ˆåˆ›å»ºä¸€ä¸ªå¤šç»´è¡¨æ ¼ï¼Œå†åˆ›å»ºé£ä¹¦æœºå™¨äººåŠ©æ‰‹æ¥æ”¶æ•°æ®ã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1714914507252-743.B-Z_0nnJ.webp" alt="å›¾ç‰‡"></p><h2 id="å®ç°æ•ˆæœ" tabindex="-1">å®ç°æ•ˆæœ <a class="header-anchor" href="#å®ç°æ•ˆæœ" aria-label="Permalink to &quot;å®ç°æ•ˆæœ&quot;">â€‹</a></h2><p>æ¯æ—¥é»„é‡‘ä»·æ ¼åˆ—è¡¨</p><p><img src="/ProgramLearnNotes/assets/640-1714914507252-744.BofPRy5P.webp" alt="å›¾ç‰‡"></p><p>æ¯æ—¥é»„é‡‘ä»·æ ¼èµ°åŠ¿</p><p><img src="/ProgramLearnNotes/assets/640-1714914507252-745.6z6V3NNR.webp" alt="å›¾ç‰‡"></p><h1 id="æºç¨‹æœºç¥¨çˆ¬å–è„šæœ¬" tabindex="-1">æºç¨‹æœºç¥¨çˆ¬å–è„šæœ¬ <a class="header-anchor" href="#æºç¨‹æœºç¥¨çˆ¬å–è„šæœ¬" aria-label="Permalink to &quot;æºç¨‹æœºç¥¨çˆ¬å–è„šæœ¬&quot;">â€‹</a></h1><p>æ•ˆæœå±•ç¤º</p><p><img src="/ProgramLearnNotes/assets/640-1715068197611-193.CU9E9797.webp" alt="å›¾ç‰‡"></p><p>å…¨ä»£ç å¦‚ä¸‹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> magic</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> io</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> gzip</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> seleniumwire </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> webdriver</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> dt, timedelta</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.by </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> By</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.common.keys </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Keys</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> expected_conditions </span><span style="color:#C678DD;">as</span><span style="color:#D19A66;"> EC</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> selenium.webdriver.support.ui </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> WebDriverWait</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># çˆ¬å–çš„åŸå¸‚</span></span>
<span class="line"><span style="color:#ABB2BF;">crawal_citys </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;ä¸Šæµ·&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;é¦™æ¸¯&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;ä¸œäº¬&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># çˆ¬å–æ—¥æœŸèŒƒå›´ï¼šèµ·å§‹æ—¥æœŸã€‚æ ¼å¼&#39;2023-12-01&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">begin_date </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># çˆ¬å–æ—¥æœŸèŒƒå›´ï¼šç»“æŸæ—¥æœŸã€‚æ ¼å¼&#39;2023-12-31&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">end_date </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># çˆ¬å–T+Nï¼Œå³Nå¤©å</span></span>
<span class="line"><span style="color:#ABB2BF;">start_interval </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># çˆ¬å–çš„æ—¥æœŸ</span></span>
<span class="line"><span style="color:#ABB2BF;">crawal_days </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 60</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®å„åŸå¸‚çˆ¬å–çš„æ—¶é—´é—´éš”ï¼ˆå•ä½ï¼šç§’ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">crawal_interval </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ—¥æœŸé—´éš”</span></span>
<span class="line"><span style="color:#ABB2BF;">days_interval </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®é¡µé¢åŠ è½½çš„æœ€é•¿ç­‰å¾…æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">max_wait_time </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æœ€å¤§é”™è¯¯é‡è¯•æ¬¡æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">max_retry_time </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦åªæŠ“å–ç›´é£ä¿¡æ¯ï¼ˆTrue: åªæŠ“å–ç›´é£ï¼ŒFalse: æŠ“å–æ‰€æœ‰èˆªç­ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">direct_flight </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦åˆ é™¤ä¸é‡è¦çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">del_info </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¯å¦é‡å‘½åDataFrameçš„åˆ—å</span></span>
<span class="line"><span style="color:#ABB2BF;">rename_col </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒè¯•æˆªå›¾</span></span>
<span class="line"><span style="color:#ABB2BF;">enable_screenshot </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å…è®¸ç™»å½•ï¼ˆå¯èƒ½å¿…é¡»è¦ç™»å½•æ‰èƒ½è·å–æ•°æ®ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">login_allowed </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è´¦å·</span></span>
<span class="line"><span style="color:#ABB2BF;">accounts </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯†ç </span></span>
<span class="line"><span style="color:#ABB2BF;">passwords </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#åˆ©ç”¨stealth.min.jséšè—seleniumç‰¹å¾</span></span>
<span class="line"><span style="color:#ABB2BF;">stealth_js_path</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;./stealth.min.js&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸‹è½½stealth.min.jsçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> download_stealth_js</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;https://raw.githubusercontent.com/requireCool/stealth.min.js/main/stealth.min.js&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(file_path):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">file_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> not found, downloading...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url)</span></span>
<span class="line"><span style="color:#ABB2BF;">        response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ç¡®ä¿è¯·æ±‚æˆåŠŸ</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;w&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">            file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(response.text)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">file_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> downloaded.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">file_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> already exists, no need to download.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> init_driver</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # options = webdriver.ChromeOptions() # åˆ›å»ºä¸€ä¸ªé…ç½®å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">    options </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">EdgeOptions</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªé…ç½®å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--incognito&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># éšèº«æ¨¡å¼ï¼ˆæ— ç—•æ¨¡å¼ï¼‰</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # options.add_argument(&#39;--headless&#39;)  # å¯ç”¨æ— å¤´æ¨¡å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--no-sandbox&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-dev-shm-usage&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-blink-features&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-blink-features=AutomationControlled&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-extensions&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--pageLoadStrategy=eager&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-gpu&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-software-rasterizer&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--disable-dev-shm-usage&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--ignore-certificate-errors&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--ignore-certificate-errors-spki-list&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_argument</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;--ignore-ssl-errors&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    options.</span><span style="color:#61AFEF;">add_experimental_option</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;excludeSwitches&quot;</span><span style="color:#ABB2BF;">, [</span><span style="color:#98C379;">&quot;enable-automation&quot;</span><span style="color:#ABB2BF;">])  </span><span style="color:#7F848E;font-style:italic;"># ä¸æ˜¾ç¤ºæ­£åœ¨å—è‡ªåŠ¨åŒ–è½¯ä»¶æ§åˆ¶çš„æç¤º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # chromeDriverPath = &#39;C:/Program Files/Google/Chrome/Application/chromedriver&#39; #chromedriverä½ç½®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # options.add_argument(&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.69&quot;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # driver = webdriver.Chrome(executable_path=self.chromeDriverPath,chrome_options=self.options)</span></span>
<span class="line"><span style="color:#ABB2BF;">    driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> webdriver.</span><span style="color:#61AFEF;">Edge</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">options</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">options)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;">        download_stealth_js</span><span style="color:#ABB2BF;">(stealth_js_path)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è¯»å–å¹¶æ³¨å…¥stealth.min.js</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(stealth_js_path, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            stealth_js </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            driver.</span><span style="color:#61AFEF;">execute_cdp_cmd</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Page.addScriptToEvaluateOnNewDocument&quot;</span><span style="color:#ABB2BF;">, {</span><span style="color:#98C379;">&quot;source&quot;</span><span style="color:#ABB2BF;">: stealth_js})</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    driver.</span><span style="color:#61AFEF;">maximize_window</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> driver</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> gen_citys</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">crawal_citys</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç”ŸæˆåŸå¸‚ç»„åˆåˆ—è¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;">    citys </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#ABB2BF;">    ytic </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> list</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">reversed</span><span style="color:#ABB2BF;">(crawal_citys))</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> m </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> crawal_citys:</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> n </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> ytic:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> m </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> n:</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                citys.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">([m, n])</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> citys</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> generate_flight_dates</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">n</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">begin_date</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">end_date</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">start_interval</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">days_interval</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    flight_dates </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> begin_date:</span></span>
<span class="line"><span style="color:#ABB2BF;">        begin_date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(begin_date, </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    elif</span><span style="color:#ABB2BF;"> start_interval:</span></span>
<span class="line"><span style="color:#ABB2BF;">        begin_date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#61AFEF;"> timedelta</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">days</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">start_interval)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, n, days_interval):</span></span>
<span class="line"><span style="color:#ABB2BF;">        flight_date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> begin_date </span><span style="color:#56B6C2;">+</span><span style="color:#61AFEF;"> timedelta</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">days</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">i)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        flight_dates.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(flight_date.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å¦‚æœæœ‰ç»“æŸæ—¥æœŸï¼Œç¡®ä¿ç”Ÿæˆçš„æ—¥æœŸä¸è¶…è¿‡ç»“æŸæ—¥æœŸ</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> end_date:</span></span>
<span class="line"><span style="color:#ABB2BF;">        end_date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(end_date, </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        flight_dates </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [date </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> date </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> flight_dates </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(date, </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#ABB2BF;"> end_date]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ç»§ç»­ç”Ÿæˆæ—¥æœŸç›´åˆ°è¾¾åˆ°æˆ–è¶…è¿‡ç»“æŸæ—¥æœŸ</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(flight_dates[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> end_date:</span></span>
<span class="line"><span style="color:#ABB2BF;">            next_date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(flight_dates[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#61AFEF;"> timedelta</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">days</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">days_interval)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> next_date </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#ABB2BF;"> end_date:</span></span>
<span class="line"><span style="color:#ABB2BF;">                flight_dates.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(next_date.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> flight_dates</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># element_to_be_clickable å‡½æ•°æ¥æ›¿ä»£ expected_conditions.element_to_be_clickable æˆ– expected_conditions.visibility_of_element_located</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> element_to_be_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">element</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> check_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> element.</span><span style="color:#61AFEF;">is_enabled</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> element.</span><span style="color:#61AFEF;">is_displayed</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#ABB2BF;"> element  </span><span style="color:#7F848E;font-style:italic;"># å½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œè¿”å›å…ƒç´ æœ¬èº«</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> check_clickable</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> DataFetcher</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">object</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#56B6C2;"> __init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">driver</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> driver</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.date </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.city </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;">  # é”™è¯¯é‡è¯•æ¬¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.switch_acc </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> #åˆ‡æ¢è´¦æˆ·</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> refresh_driver</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">refresh</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> refresh_driver:åˆ·æ–°é¡µé¢å¤±è´¥ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆ·æ–°é¡µé¢</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> refresh_driverï¼šåˆ·æ–°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­é”™è¯¯æ¬¡æ•°</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,refresh_driver:ä¸ç»§ç»­é‡è¯•&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> remove_btn</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            #WebDriverWait(self.driver, max_wait_time).until(lambda d: d.execute_script(&#39;return typeof jQuery !== &quot;undefined&quot;&#39;))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç§»é™¤æé†’</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;document.querySelectorAll(&#39;.notice-box&#39;).forEach(element =&gt; element.remove());&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç§»é™¤åœ¨çº¿å®¢æœ</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;document.querySelectorAll(&#39;.shortcut, .shortcut-link&#39;).forEach(element =&gt; element.remove());&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç§»é™¤åˆ†äº«é“¾æ¥</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">execute_script</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;document.querySelectorAll(&#39;.shareline&#39;).forEach(element =&gt; element.remove());&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#98C379;">            &#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#98C379;">            # ä½¿ç”¨JavaScriptåˆ é™¤æ‰€æœ‰çš„&lt;dl&gt;æ ‡ç­¾</span></span>
<span class="line"><span style="color:#98C379;">            self.driver.execute_script(&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">                var elements = document.getElementsByTagName(&#39;dl&#39;);</span></span>
<span class="line"><span style="color:#98C379;">                while(elements.length &gt; 0){</span></span>
<span class="line"><span style="color:#98C379;">                    elements[0].parentNode.removeChild(elements[0]);</span></span>
<span class="line"><span style="color:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;">            &quot;&quot;&quot;)</span></span>
<span class="line"><span style="color:#98C379;">            &#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> remove_btn:æé†’ç§»é™¤å¤±è´¥ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> check_verification_code</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥æ˜¯å¦æœ‰éªŒè¯ç å…ƒç´ ï¼Œå¦‚æœæœ‰ï¼Œåˆ™éœ€è¦äººå·¥å¤„ç†</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">ID</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;verification-code&quot;</span><span style="color:#ABB2BF;">))</span><span style="color:#56B6C2;">+len</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;alert-title&quot;</span><span style="color:#ABB2BF;">))):</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> check_verification_codeï¼šéªŒè¯ç è¢«è§¦å‘verification-code/alert-titleï¼Œç­‰å¾…</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">crawal_interval</span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;">100}</span><span style="color:#98C379;">åé‡è¯•ã€‚&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(crawal_interval</span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> init_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.switch_acc </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç§»é™¤æ³¨æ„äº‹é¡¹</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">remove_btn</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å¦‚æœæ²¡æœ‰æ‰¾åˆ°éªŒè¯ç å…ƒç´ ï¼Œåˆ™è¯´æ˜é¡µé¢åŠ è½½æˆåŠŸï¼Œæ²¡æœ‰è§¦å‘éªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> check_verification_code:æœªçŸ¥é”™è¯¯ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> login</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> login_allowed:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            account </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> accounts[</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.switch_acc </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(accounts)]</span></span>
<span class="line"><span style="color:#ABB2BF;">            password </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> passwords[</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.switch_acc </span><span style="color:#56B6C2;">%</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(passwords)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;lg_loginbox_modal&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> login:æœªå¼¹å‡ºç™»å½•ç•Œé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">                    WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;tl_nfes_home_header_login_wrapper_siwkn&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ç‚¹å‡»é£æœºå›¾æ ‡ï¼Œè¿”å›ä¸»ç•Œé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;tl_nfes_home_header_login_wrapper_siwkn&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    #ç­‰å¾…é¡µé¢åŠ è½½</span></span>
<span class="line"><span style="color:#61AFEF;">                    WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">((By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;lg_loginwrap&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> login:å·²ç»å¼¹å‡ºç™»å½•ç•Œé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;r_input.bbz-js-iconable-input&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(account)</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> login:è¾“å…¥è´¦æˆ·æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;div[data-testid=&#39;accountPanel&#39;] input[data-testid=&#39;passwordInput&#39;]&quot;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(password)</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> login:è¾“å…¥å¯†ç æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;[for=&quot;checkboxAgreementInput&quot;]&#39;</span><span style="color:#ABB2BF;">)))</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> login:å‹¾é€‰åŒæ„æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">element_to_be_clickable</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form_btn.form_btn--block&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> loginï¼šç™»å½•æˆåŠŸ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ä¿å­˜ç™»å½•æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                        f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(crawal_interval</span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç”¨få­—ç¬¦ä¸²æ ¼å¼åŒ–é”™è¯¯ç±»å‹å’Œé”™è¯¯ä¿¡æ¯ï¼Œæä¾›æ›´å¤šçš„è°ƒè¯•ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> loginï¼šé¡µé¢åŠ è½½æˆ–å…ƒç´ æ“ä½œå¤±è´¥ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                        f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # åˆ·æ–°é¡µé¢</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> loginï¼šåˆ·æ–°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # é‡è¯•</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆ¤æ–­é”™è¯¯æ¬¡æ•°</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                        f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,login:é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">reset_to_homepage</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        next_stage_flag </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> reset_to_homepage </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å‰å¾€é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;https://flights.ctrip.com/online/channel/domestic&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#61AFEF;">                WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                    EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                        (By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;pc_home-jipiao&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç‚¹å‡»é£æœºå›¾æ ‡ï¼Œè¿”å›ä¸»ç•Œé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                    element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                            By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;pc_home-jipiao&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å•ç¨‹</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                    element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                            By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;radio-label&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æœç´¢</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                    element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;search-btn&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"><span style="color:#ABB2BF;">                ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                next_stage_flag </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç”¨få­—ç¬¦ä¸²æ ¼å¼åŒ–é”™è¯¯ç±»å‹å’Œé”™è¯¯ä¿¡æ¯ï¼Œæä¾›æ›´å¤šçš„è°ƒè¯•ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> get_pageï¼šé¡µé¢åŠ è½½æˆ–å…ƒç´ æ“ä½œå¤±è´¥ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> next_stage_flag:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç»§ç»­ä¸‹ä¸€æ­¥</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">change_city</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> change_city</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        next_stage_flag </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> False</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç­‰å¾…é¡µé¢å®ŒæˆåŠ è½½</span></span>
<span class="line"><span style="color:#61AFEF;">            WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#D19A66;">                EC</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">presence_of_element_located</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    (By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è‹¥å‡ºå‘åœ°ä¸ç›®æ ‡å€¼ä¸ç¬¦ï¼Œåˆ™æ›´æ”¹å‡ºå‘åœ°</span></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(Keys.</span><span style="color:#D19A66;">CONTROL</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot;a&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢åŸå¸‚ã€0ã€‘-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è‹¥ç›®çš„åœ°ä¸ç›®æ ‡å€¼ä¸ç¬¦ï¼Œåˆ™æ›´æ”¹ç›®çš„åœ°</span></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(Keys.</span><span style="color:#D19A66;">CONTROL</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot;a&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">send_keys</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢åŸå¸‚ã€1ã€‘-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;form-input-v3&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;[aria-label=è¯·é€‰æ‹©æ—¥æœŸ]&quot;</span><span style="color:#ABB2BF;">)[</span></span>
<span class="line"><span style="color:#D19A66;">                        0</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">                    !=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.date</span></span>
<span class="line"><span style="color:#ABB2BF;">                ):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ç‚¹å‡»æ—¥æœŸé€‰æ‹©</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;modifyDate.depart-date&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                            By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ) </span><span style="color:#56B6C2;">&lt;</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                            element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                                    &quot;in-date-picker.icon.next-ico.iconf-right&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                            f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢æ—¥æœŸ</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">).text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">å°äº </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> å‘å³ç‚¹å‡»&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                            By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                            element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                                    &quot;in-date-picker.icon.prev-ico.iconf-left&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                            f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢æ—¥æœŸ</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">).text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">å¤§äº </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> å‘å·¦ç‚¹å‡»&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                            By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ) </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#C678DD;">                        if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                            .</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                            .text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#ABB2BF;">                            ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                                element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                                    self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                        By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                                        &quot;in-date-picker.icon.prev-ico.iconf-left&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                                )</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#56B6C2;">                            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢æ—¥æœŸ</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">).text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">å¤§äº </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> å‘å·¦ç‚¹å‡»&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#ABB2BF;">                            ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                            By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                        .text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ) </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#C678DD;">                        if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                            .</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                            .text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ) </span><span style="color:#56B6C2;">&lt;</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#ABB2BF;">                            ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                                element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                                    self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                        By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                                        &quot;in-date-picker.icon.next-ico.iconf-right&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                                )</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#56B6C2;">                            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢æ—¥æœŸ</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">).text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">å°äº </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">])</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> å‘å³ç‚¹å‡»&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )</span></span>
<span class="line"><span style="color:#ABB2BF;">                            ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                    for</span><span style="color:#ABB2BF;"> m </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                        By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-picker.date-picker-block&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ):</span></span>
<span class="line"><span style="color:#C678DD;">                        if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(m.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;year&quot;</span><span style="color:#ABB2BF;">).text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.date[:</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ):</span></span>
<span class="line"><span style="color:#C678DD;">                            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                        if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(m.</span><span style="color:#61AFEF;">find_element</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">).text[:</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.date[</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        ):</span></span>
<span class="line"><span style="color:#C678DD;">                            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                        for</span><span style="color:#ABB2BF;"> d </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> m.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;date-d&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">                            if</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(d.text) </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> int</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">:]):</span></span>
<span class="line"><span style="color:#ABB2BF;">                                ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                                    element_to_be_clickable</span><span style="color:#ABB2BF;">(d)</span></span>
<span class="line"><span style="color:#ABB2BF;">                                )</span></span>
<span class="line"><span style="color:#ABB2BF;">                                ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                                break</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ›´æ¢æ—¥æœŸ-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CSS_SELECTOR</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;[aria-label=è¯·é€‰æ‹©æ—¥æœŸ]&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#98C379;"> &quot;(&quot;</span><span style="color:#C678DD;"> not</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # Enteræœç´¢</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ele=WebDriverWait(self.driver, max_wait_time).until(element_to_be_clickable(its[1]))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ele.send_keys(Keys.ENTER)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é€šè¿‡ä½ä»·æé†’æŒ‰é’®å®ç°enteré”®æ¢é¡µ</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;low-price-remind&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                while</span><span style="color:#98C379;"> &quot;(&quot;</span><span style="color:#C678DD;"> not</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;form-input-v3&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get_attribute</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # Enteræœç´¢</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ele=WebDriverWait(self.driver, max_wait_time).until(element_to_be_clickable(its[1]))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # ele.send_keys(Keys.ENTER)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é€šè¿‡ä½ä»·æé†’æŒ‰é’®å®ç°enteré”®æ¢é¡µ</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> WebDriverWait</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver, max_wait_time).</span><span style="color:#61AFEF;">until</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">                        element_to_be_clickable</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">                            self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                                By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;low-price-remind&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            )[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"><span style="color:#ABB2BF;">                    ele.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                next_stage_flag </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,change_cityï¼šæ›´æ¢åŸå¸‚å’Œæ—¥æœŸå¤±è´¥ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">find_elements</span><span style="color:#ABB2BF;">(By.</span><span style="color:#D19A66;">CLASS_NAME</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;lg_loginbox_modal&quot;</span><span style="color:#ABB2BF;">)):</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                            f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæ£€æµ‹åˆ°ç™»å½•å¼¹çª—ï¼Œéœ€è¦ç™»å½•&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡è¯•</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šé‡è¯•&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">change_city</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆ¤æ–­é”™è¯¯æ¬¡æ•°</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                        f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,change_city:é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # åˆ é™¤æœ¬æ¬¡è¯·æ±‚</span></span>
<span class="line"><span style="color:#C678DD;">                    del</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> next_stage_flag:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è‹¥æ— é”™è¯¯ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> change_cityï¼šæˆåŠŸæ›´æ¢åŸå¸‚å’Œæ—¥æœŸï¼Œå½“å‰è·¯çº¿ä¸ºï¼š</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> get_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç­‰å¾…å“åº”åŠ è½½å®Œæˆ</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.predata </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">wait_for_request</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">                &quot;/international/search/api/search/batchSearch?.*&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">max_wait_time</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            rb </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">(json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.predata.body).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;flightSegments&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,get_data:è·å–æ•°æ®è¶…æ—¶ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, é”™è¯¯è¯¦ç»†ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ é™¤æœ¬æ¬¡è¯·æ±‚</span></span>
<span class="line"><span style="color:#C678DD;">            del</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆ·æ–°é¡µé¢</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> get_dataï¼šåˆ·æ–°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡è¯•</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­é”™è¯¯æ¬¡æ•°</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,get_data:é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ é™¤æœ¬æ¬¡è¯·æ±‚</span></span>
<span class="line"><span style="color:#C678DD;">            del</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥æ•°æ®è·å–æ­£ç¡®æ€§</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">                rb[</span><span style="color:#98C379;">&quot;departureCityName&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">                and</span><span style="color:#ABB2BF;"> rb[</span><span style="color:#98C379;">&quot;arrivalCityName&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">                and</span><span style="color:#ABB2BF;"> rb[</span><span style="color:#98C379;">&quot;departureDate&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.date</span></span>
<span class="line"><span style="color:#ABB2BF;">            ):</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;get_data:åŸå¸‚åŒ¹é…æˆåŠŸï¼šå‡ºå‘åœ°-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ï¼Œç›®çš„åœ°-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è‹¥æ— é”™è¯¯ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">decode_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,get_data:åˆ·æ–°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                        f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡æ–°æ›´æ¢åŸå¸‚</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> get_dataï¼šé‡æ–°æ›´æ¢åŸå¸‚:</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rb[</span><span style="color:#98C379;">&quot;departureCityName&quot;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rb[</span><span style="color:#98C379;">&quot;arrivalCityName&quot;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">rb[</span><span style="color:#98C379;">&quot;departureDate&quot;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡è¯•</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">change_city</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> decode_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä½¿ç”¨python-magicåº“æ£€æŸ¥MIMEç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">            mime </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> magic.</span><span style="color:#61AFEF;">Magic</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            file_type </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mime.</span><span style="color:#61AFEF;">from_buffer</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.predata.response.body)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            buf </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> io.</span><span style="color:#61AFEF;">BytesIO</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.predata.response.body)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#98C379;"> &quot;gzip&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> file_type:</span></span>
<span class="line"><span style="color:#ABB2BF;">                gf </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> gzip.</span><span style="color:#61AFEF;">GzipFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">fileobj</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">buf)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.dedata </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> gf.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#98C379;"> &quot;JSON data&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> file_type:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(buf.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> æœªçŸ¥çš„å‹ç¼©æ ¼å¼ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">file_type</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.dedata </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">loads</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.dedata)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,decode_data:æ•°æ®è§£ç å¤±è´¥ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, é”™è¯¯è¯¦ç»†ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä¿å­˜é”™è¯¯æˆªå›¾</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> enable_screenshot:</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.driver.</span><span style="color:#61AFEF;">save_screenshot</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;screenshot/screenshot_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.png&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ é™¤æœ¬æ¬¡è¯·æ±‚</span></span>
<span class="line"><span style="color:#C678DD;">            del</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.driver.requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆ·æ–°é¡µé¢</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> decode_dataï¼šåˆ·æ–°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡è¯•</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­é”™è¯¯æ¬¡æ•°</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,decode_data:é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è‹¥æ— é”™è¯¯ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> check_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.flightItineraryList </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.dedata[</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;flightItineraryList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å€’åºéå†,åˆ é™¤è½¬æœºèˆªç­</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.flightItineraryList) </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.flightItineraryList[i][</span><span style="color:#98C379;">&quot;flightSegments&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;transferCount&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#56B6C2;">                    !=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;">                ):</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.flightItineraryList.</span><span style="color:#61AFEF;">pop</span><span style="color:#ABB2BF;">(i)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.flightItineraryList) </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> and</span><span style="color:#ABB2BF;"> direct_flight:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> ä¸å­˜åœ¨ç›´èˆªèˆªç­:</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é”™è¯¯æ¬¡æ•°+1</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> æ•°æ®æ£€æŸ¥å‡ºé”™ï¼šä¸å­˜åœ¨èˆªç­ï¼Œé”™è¯¯ç±»å‹ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">type</span><span style="color:#ABB2BF;">(e).</span><span style="color:#E06C75;">__name__</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">, é”™è¯¯è¯¦ç»†ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.dedata)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#98C379;"> &#39;searchErrorInfo&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.dedata[</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">                    return</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">                else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#98C379;"> &quot;&#39;needUserLogin&#39;: True&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.dedata[</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">]):</span></span>
<span class="line"><span style="color:#56B6C2;">                        print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                            f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,check_data:å¿…é¡»è¦ç™»å½•æ‰èƒ½æŸ¥çœ‹æ•°æ®ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        )</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # åˆ·æ–°é¡µé¢</span></span>
<span class="line"><span style="color:#56B6C2;">                    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> check_dataï¼šåˆ·æ–°é¡µé¢&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">refresh_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # æ£€æŸ¥æ³¨æ„äº‹é¡¹å’ŒéªŒè¯ç </span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">check_verification_code</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # é‡è¯•</span></span>
<span class="line"><span style="color:#E5C07B;">                        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ¤æ–­é”™è¯¯æ¬¡æ•°</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;"> max_retry_time:</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> é”™è¯¯æ¬¡æ•°ã€</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.err</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">max_retry_time</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ã€‘,check_data:é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # é‡æ–°å°è¯•åŠ è½½é¡µé¢ï¼Œè¿™æ¬¡æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°é¦–é¡µ</span></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # é‡ç½®é”™è¯¯è®¡æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.err </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">proc_flightSegments</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">proc_priceList</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">mergedata</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> proc_flightSegments</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.flights </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> flightlist </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.flightItineraryList:</span></span>
<span class="line"><span style="color:#ABB2BF;">            flightlist </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightlist[</span><span style="color:#98C379;">&quot;flightSegments&quot;</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&quot;flightList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            flightUnitList </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">(flightlist[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            departureday </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightUnitList[</span><span style="color:#98C379;">&quot;departureDateTime&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            departuretime </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightUnitList[</span><span style="color:#98C379;">&quot;departureDateTime&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            arrivalday </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightUnitList[</span><span style="color:#98C379;">&quot;arrivalDateTime&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            arrivaltime </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightUnitList[</span><span style="color:#98C379;">&quot;arrivalDateTime&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> del_info:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆ é™¤ä¸€äº›ä¸é‡è¦çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">                dellist </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;sequenceNo&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;marketAirlineCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureProvinceId&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureCityId&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureCityCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureAirportShortName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureTerminal&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalProvinceId&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalCityId&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalCityCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalAirportShortName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalTerminal&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;transferDuration&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;stopList&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;leakedVisaTagSwitch&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;trafficType&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;highLightPlaneNo&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;mealType&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;operateAirlineCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalDateTime&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureDateTime&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;operateFlightNo&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;operateAirlineName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                ]</span></span>
<span class="line"><span style="color:#C678DD;">                for</span><span style="color:#ABB2BF;"> value </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> dellist:</span></span>
<span class="line"><span style="color:#C678DD;">                    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        flightUnitList.</span><span style="color:#61AFEF;">pop</span><span style="color:#ABB2BF;">(value)</span></span>
<span class="line"><span style="color:#C678DD;">                    except</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                        continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ›´æ–°æ—¥æœŸæ ¼å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">            flightUnitList.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                {</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureday&quot;</span><span style="color:#ABB2BF;">: departureday,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departuretime&quot;</span><span style="color:#ABB2BF;">: departuretime,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalday&quot;</span><span style="color:#ABB2BF;">: arrivalday,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivaltime&quot;</span><span style="color:#ABB2BF;">: arrivaltime,</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.flights </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                [</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.flights,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    pd.DataFrame.</span><span style="color:#61AFEF;">from_dict</span><span style="color:#ABB2BF;">(flightUnitList, </span><span style="color:#E06C75;font-style:italic;">orient</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;index&quot;</span><span style="color:#ABB2BF;">).T,</span></span>
<span class="line"><span style="color:#ABB2BF;">                ],</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> proc_priceList</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.prices </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> flightlist </span><span style="color:#C678DD;">in</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.flightItineraryList:</span></span>
<span class="line"><span style="color:#ABB2BF;">            flightNo </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightlist[</span><span style="color:#98C379;">&quot;itineraryId&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;_&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            priceList </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flightlist[</span><span style="color:#98C379;">&quot;priceList&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ç»æµèˆ±ï¼Œç»æµèˆ±æŠ˜æ‰£</span></span>
<span class="line"><span style="color:#ABB2BF;">            economy, economy_tax, economy_total, economy_full </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [], [], [], []</span></span>
<span class="line"><span style="color:#ABB2BF;">            economy_origin_price, economy_tax_price, economy_total_price, economy_full_price </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å•†åŠ¡èˆ±ï¼Œå•†åŠ¡èˆ±æŠ˜æ‰£</span></span>
<span class="line"><span style="color:#ABB2BF;">            bussiness, bussiness_tax, bussiness_total, bussiness_full </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [], [], [], []</span></span>
<span class="line"><span style="color:#ABB2BF;">            bussiness_origin_price, bussiness_tax_price, bussiness_total_price, bussiness_full_price </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> price </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> priceList:</span></span>
<span class="line"><span style="color:#ABB2BF;">                adultPrice </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price[</span><span style="color:#98C379;">&quot;adultPrice&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                adultTax </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price[</span><span style="color:#98C379;">&quot;adultTax&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                miseryIndex </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price[</span><span style="color:#98C379;">&quot;miseryIndex&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                cabin </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> price[</span><span style="color:#98C379;">&quot;cabin&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ç»æµèˆ±</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> cabin </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;Y&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    economy.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(adultPrice)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    economy_tax.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(adultTax)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    economy_full.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(miseryIndex)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    economy_total.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(adultPrice</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">adultTax)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å•†åŠ¡èˆ±</span></span>
<span class="line"><span style="color:#C678DD;">                elif</span><span style="color:#ABB2BF;"> cabin </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;C&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    bussiness.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(adultPrice)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    bussiness_tax.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(adultTax)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    bussiness_full.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(miseryIndex)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    bussiness_total.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(adultPrice</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">adultTax)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆå§‹åŒ–å˜é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">            economy_min_index </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#ABB2BF;">            bussiness_min_index </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> economy_total </span><span style="color:#56B6C2;">!=</span><span style="color:#ABB2BF;"> []:</span></span>
<span class="line"><span style="color:#ABB2BF;">                economy_total_price </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> min</span><span style="color:#ABB2BF;">(economy_total)</span></span>
<span class="line"><span style="color:#ABB2BF;">                economy_min_index </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> economy_total.</span><span style="color:#61AFEF;">index</span><span style="color:#ABB2BF;">(economy_total_price)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> bussiness_total </span><span style="color:#56B6C2;">!=</span><span style="color:#ABB2BF;"> []:</span></span>
<span class="line"><span style="color:#ABB2BF;">                bussiness_total_price </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> min</span><span style="color:#ABB2BF;">(bussiness_total)</span></span>
<span class="line"><span style="color:#ABB2BF;">                bussiness_min_index </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> bussiness_total.</span><span style="color:#61AFEF;">index</span><span style="color:#ABB2BF;">(bussiness_total_price)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> economy_min_index </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                economy_origin_price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> economy[economy_min_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">                economy_tax_price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> economy_tax[economy_min_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">                economy_full_price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> economy_full[economy_min_index]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> bussiness_min_index </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                bussiness_origin_price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> bussiness[bussiness_min_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">                bussiness_tax_price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> bussiness_tax[bussiness_min_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">                bussiness_full_price </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> bussiness_full[bussiness_min_index]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            price_info </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">                &quot;flightNo&quot;</span><span style="color:#ABB2BF;">: flightNo,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;economy_origin&quot;</span><span style="color:#ABB2BF;">: economy_origin_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;economy_tax&quot;</span><span style="color:#ABB2BF;">: economy_tax_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;economy_total&quot;</span><span style="color:#ABB2BF;">: economy_total_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;economy_full&quot;</span><span style="color:#ABB2BF;">: economy_full_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;bussiness_origin&quot;</span><span style="color:#ABB2BF;">: bussiness_origin_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;bussiness_tax&quot;</span><span style="color:#ABB2BF;">: bussiness_tax_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;bussiness_total&quot;</span><span style="color:#ABB2BF;">: bussiness_total_price,</span></span>
<span class="line"><span style="color:#98C379;">                &quot;bussiness_full&quot;</span><span style="color:#ABB2BF;">: bussiness_full_price,</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # self.prices=self.prices.append(price_info,ignore_index=True)</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.prices </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                [</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.prices, pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">(price_info, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])], </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> mergedata</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.df </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.flights.</span><span style="color:#61AFEF;">merge</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.prices, </span><span style="color:#E06C75;font-style:italic;">on</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;flightNo&quot;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.df[</span><span style="color:#98C379;">&quot;dateGetTime&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> dt.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> rename_col:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å¯¹pandasçš„columnsè¿›è¡Œé‡å‘½å</span></span>
<span class="line"><span style="color:#ABB2BF;">                order </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;æ•°æ®è·å–æ—¥æœŸ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;èˆªç­å·&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;èˆªç©ºå…¬å¸&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;å‡ºå‘æ—¥æœŸ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;å‡ºå‘æ—¶é—´&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾æ—¥æœŸ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾æ—¶é—´&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;é£è¡Œæ—¶é•¿&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;å‡ºå‘å›½å®¶&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;å‡ºå‘åŸå¸‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;å‡ºå‘æœºåœº&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;å‡ºå‘æœºåœºä¸‰å­—ç &quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾å›½å®¶&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾åŸå¸‚&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾æœºåœº&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾æœºåœºä¸‰å­—ç &quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;é£æœºå‹å·&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;é£æœºå°ºå¯¸&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;é£æœºå‹å·ä¸‰å­—ç &quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åˆ°è¾¾å‡†ç‚¹ç‡&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;åœç•™æ¬¡æ•°&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                origin </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;dateGetTime&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;flightNo&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;marketAirlineName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureday&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departuretime&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalday&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivaltime&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;duration&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureCountryName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureCityName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureAirportName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;departureAirportCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalCountryName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalCityName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalAirportName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalAirportCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;aircraftName&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;aircraftSize&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;aircraftCode&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;arrivalPunctuality&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                    &quot;stopCount&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                columns </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> dict</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">zip</span><span style="color:#ABB2BF;">(origin, order))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">                self</span><span style="color:#ABB2BF;">.df </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.df.</span><span style="color:#61AFEF;">rename</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">columns</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">columns)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> del_info:</span></span>
<span class="line"><span style="color:#E5C07B;">                    self</span><span style="color:#ABB2BF;">.df </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.df[order]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            files_dir </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                os.</span><span style="color:#61AFEF;">getcwd</span><span style="color:#ABB2BF;">(), </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.date, dt.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(files_dir):</span></span>
<span class="line"><span style="color:#ABB2BF;">                os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(files_dir)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            filename </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                files_dir, </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.csv&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">            self</span><span style="color:#ABB2BF;">.df.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(filename, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> æ•°æ®çˆ¬å–å®Œæˆ </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">            print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> åˆå¹¶æ•°æ®å¤±è´¥ </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e).</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Stacktrace:&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    driver </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> init_driver</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    citys </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> gen_citys</span><span style="color:#ABB2BF;">(crawal_citys)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    flight_dates </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> generate_flight_dates</span><span style="color:#ABB2BF;">(crawal_days, begin_date, end_date, start_interval, days_interval)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    Flight_DataFetcher </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> DataFetcher</span><span style="color:#ABB2BF;">(driver)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> city </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> citys:</span></span>
<span class="line"><span style="color:#ABB2BF;">        Flight_DataFetcher.city </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> city</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> flight_date </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> flight_dates:</span></span>
<span class="line"><span style="color:#ABB2BF;">            Flight_DataFetcher.date </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> flight_date</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.</span><span style="color:#61AFEF;">getcwd</span><span style="color:#ABB2BF;">(), flight_date, dt.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">), </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.csv&quot;</span><span style="color:#ABB2BF;">)):</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#C678DD;">                    f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> æ–‡ä»¶å·²å­˜åœ¨:</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.</span><span style="color:#61AFEF;">getcwd</span><span style="color:#ABB2BF;">(), flight_date, dt.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">), </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">city[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">-</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">city[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.csv&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;http&#39;</span><span style="color:#C678DD;"> not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> Flight_DataFetcher.driver.current_url):</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> å½“å‰çš„URLæ˜¯ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">driver.current_url</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆå§‹åŒ–é¡µé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">                Flight_DataFetcher.</span><span style="color:#61AFEF;">get_page</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åç»­è¿è¡Œåªéœ€æ›´æ¢å‡ºå‘ä¸ç›®çš„åœ°</span></span>
<span class="line"><span style="color:#ABB2BF;">                Flight_DataFetcher.</span><span style="color:#61AFEF;">change_city</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(crawal_interval)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è¿è¡Œç»“æŸé€€å‡º</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Flight_DataFetcher.driver</span></span>
<span class="line"><span style="color:#ABB2BF;">        driver.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> An error occurred while quitting the driver: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">_%H-%M-%S&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> ç¨‹åºè¿è¡Œå®Œæˆï¼ï¼ï¼ï¼&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br><span class="line-number">494</span><br><span class="line-number">495</span><br><span class="line-number">496</span><br><span class="line-number">497</span><br><span class="line-number">498</span><br><span class="line-number">499</span><br><span class="line-number">500</span><br><span class="line-number">501</span><br><span class="line-number">502</span><br><span class="line-number">503</span><br><span class="line-number">504</span><br><span class="line-number">505</span><br><span class="line-number">506</span><br><span class="line-number">507</span><br><span class="line-number">508</span><br><span class="line-number">509</span><br><span class="line-number">510</span><br><span class="line-number">511</span><br><span class="line-number">512</span><br><span class="line-number">513</span><br><span class="line-number">514</span><br><span class="line-number">515</span><br><span class="line-number">516</span><br><span class="line-number">517</span><br><span class="line-number">518</span><br><span class="line-number">519</span><br><span class="line-number">520</span><br><span class="line-number">521</span><br><span class="line-number">522</span><br><span class="line-number">523</span><br><span class="line-number">524</span><br><span class="line-number">525</span><br><span class="line-number">526</span><br><span class="line-number">527</span><br><span class="line-number">528</span><br><span class="line-number">529</span><br><span class="line-number">530</span><br><span class="line-number">531</span><br><span class="line-number">532</span><br><span class="line-number">533</span><br><span class="line-number">534</span><br><span class="line-number">535</span><br><span class="line-number">536</span><br><span class="line-number">537</span><br><span class="line-number">538</span><br><span class="line-number">539</span><br><span class="line-number">540</span><br><span class="line-number">541</span><br><span class="line-number">542</span><br><span class="line-number">543</span><br><span class="line-number">544</span><br><span class="line-number">545</span><br><span class="line-number">546</span><br><span class="line-number">547</span><br><span class="line-number">548</span><br><span class="line-number">549</span><br><span class="line-number">550</span><br><span class="line-number">551</span><br><span class="line-number">552</span><br><span class="line-number">553</span><br><span class="line-number">554</span><br><span class="line-number">555</span><br><span class="line-number">556</span><br><span class="line-number">557</span><br><span class="line-number">558</span><br><span class="line-number">559</span><br><span class="line-number">560</span><br><span class="line-number">561</span><br><span class="line-number">562</span><br><span class="line-number">563</span><br><span class="line-number">564</span><br><span class="line-number">565</span><br><span class="line-number">566</span><br><span class="line-number">567</span><br><span class="line-number">568</span><br><span class="line-number">569</span><br><span class="line-number">570</span><br><span class="line-number">571</span><br><span class="line-number">572</span><br><span class="line-number">573</span><br><span class="line-number">574</span><br><span class="line-number">575</span><br><span class="line-number">576</span><br><span class="line-number">577</span><br><span class="line-number">578</span><br><span class="line-number">579</span><br><span class="line-number">580</span><br><span class="line-number">581</span><br><span class="line-number">582</span><br><span class="line-number">583</span><br><span class="line-number">584</span><br><span class="line-number">585</span><br><span class="line-number">586</span><br><span class="line-number">587</span><br><span class="line-number">588</span><br><span class="line-number">589</span><br><span class="line-number">590</span><br><span class="line-number">591</span><br><span class="line-number">592</span><br><span class="line-number">593</span><br><span class="line-number">594</span><br><span class="line-number">595</span><br><span class="line-number">596</span><br><span class="line-number">597</span><br><span class="line-number">598</span><br><span class="line-number">599</span><br><span class="line-number">600</span><br><span class="line-number">601</span><br><span class="line-number">602</span><br><span class="line-number">603</span><br><span class="line-number">604</span><br><span class="line-number">605</span><br><span class="line-number">606</span><br><span class="line-number">607</span><br><span class="line-number">608</span><br><span class="line-number">609</span><br><span class="line-number">610</span><br><span class="line-number">611</span><br><span class="line-number">612</span><br><span class="line-number">613</span><br><span class="line-number">614</span><br><span class="line-number">615</span><br><span class="line-number">616</span><br><span class="line-number">617</span><br><span class="line-number">618</span><br><span class="line-number">619</span><br><span class="line-number">620</span><br><span class="line-number">621</span><br><span class="line-number">622</span><br><span class="line-number">623</span><br><span class="line-number">624</span><br><span class="line-number">625</span><br><span class="line-number">626</span><br><span class="line-number">627</span><br><span class="line-number">628</span><br><span class="line-number">629</span><br><span class="line-number">630</span><br><span class="line-number">631</span><br><span class="line-number">632</span><br><span class="line-number">633</span><br><span class="line-number">634</span><br><span class="line-number">635</span><br><span class="line-number">636</span><br><span class="line-number">637</span><br><span class="line-number">638</span><br><span class="line-number">639</span><br><span class="line-number">640</span><br><span class="line-number">641</span><br><span class="line-number">642</span><br><span class="line-number">643</span><br><span class="line-number">644</span><br><span class="line-number">645</span><br><span class="line-number">646</span><br><span class="line-number">647</span><br><span class="line-number">648</span><br><span class="line-number">649</span><br><span class="line-number">650</span><br><span class="line-number">651</span><br><span class="line-number">652</span><br><span class="line-number">653</span><br><span class="line-number">654</span><br><span class="line-number">655</span><br><span class="line-number">656</span><br><span class="line-number">657</span><br><span class="line-number">658</span><br><span class="line-number">659</span><br><span class="line-number">660</span><br><span class="line-number">661</span><br><span class="line-number">662</span><br><span class="line-number">663</span><br><span class="line-number">664</span><br><span class="line-number">665</span><br><span class="line-number">666</span><br><span class="line-number">667</span><br><span class="line-number">668</span><br><span class="line-number">669</span><br><span class="line-number">670</span><br><span class="line-number">671</span><br><span class="line-number">672</span><br><span class="line-number">673</span><br><span class="line-number">674</span><br><span class="line-number">675</span><br><span class="line-number">676</span><br><span class="line-number">677</span><br><span class="line-number">678</span><br><span class="line-number">679</span><br><span class="line-number">680</span><br><span class="line-number">681</span><br><span class="line-number">682</span><br><span class="line-number">683</span><br><span class="line-number">684</span><br><span class="line-number">685</span><br><span class="line-number">686</span><br><span class="line-number">687</span><br><span class="line-number">688</span><br><span class="line-number">689</span><br><span class="line-number">690</span><br><span class="line-number">691</span><br><span class="line-number">692</span><br><span class="line-number">693</span><br><span class="line-number">694</span><br><span class="line-number">695</span><br><span class="line-number">696</span><br><span class="line-number">697</span><br><span class="line-number">698</span><br><span class="line-number">699</span><br><span class="line-number">700</span><br><span class="line-number">701</span><br><span class="line-number">702</span><br><span class="line-number">703</span><br><span class="line-number">704</span><br><span class="line-number">705</span><br><span class="line-number">706</span><br><span class="line-number">707</span><br><span class="line-number">708</span><br><span class="line-number">709</span><br><span class="line-number">710</span><br><span class="line-number">711</span><br><span class="line-number">712</span><br><span class="line-number">713</span><br><span class="line-number">714</span><br><span class="line-number">715</span><br><span class="line-number">716</span><br><span class="line-number">717</span><br><span class="line-number">718</span><br><span class="line-number">719</span><br><span class="line-number">720</span><br><span class="line-number">721</span><br><span class="line-number">722</span><br><span class="line-number">723</span><br><span class="line-number">724</span><br><span class="line-number">725</span><br><span class="line-number">726</span><br><span class="line-number">727</span><br><span class="line-number">728</span><br><span class="line-number">729</span><br><span class="line-number">730</span><br><span class="line-number">731</span><br><span class="line-number">732</span><br><span class="line-number">733</span><br><span class="line-number">734</span><br><span class="line-number">735</span><br><span class="line-number">736</span><br><span class="line-number">737</span><br><span class="line-number">738</span><br><span class="line-number">739</span><br><span class="line-number">740</span><br><span class="line-number">741</span><br><span class="line-number">742</span><br><span class="line-number">743</span><br><span class="line-number">744</span><br><span class="line-number">745</span><br><span class="line-number">746</span><br><span class="line-number">747</span><br><span class="line-number">748</span><br><span class="line-number">749</span><br><span class="line-number">750</span><br><span class="line-number">751</span><br><span class="line-number">752</span><br><span class="line-number">753</span><br><span class="line-number">754</span><br><span class="line-number">755</span><br><span class="line-number">756</span><br><span class="line-number">757</span><br><span class="line-number">758</span><br><span class="line-number">759</span><br><span class="line-number">760</span><br><span class="line-number">761</span><br><span class="line-number">762</span><br><span class="line-number">763</span><br><span class="line-number">764</span><br><span class="line-number">765</span><br><span class="line-number">766</span><br><span class="line-number">767</span><br><span class="line-number">768</span><br><span class="line-number">769</span><br><span class="line-number">770</span><br><span class="line-number">771</span><br><span class="line-number">772</span><br><span class="line-number">773</span><br><span class="line-number">774</span><br><span class="line-number">775</span><br><span class="line-number">776</span><br><span class="line-number">777</span><br><span class="line-number">778</span><br><span class="line-number">779</span><br><span class="line-number">780</span><br><span class="line-number">781</span><br><span class="line-number">782</span><br><span class="line-number">783</span><br><span class="line-number">784</span><br><span class="line-number">785</span><br><span class="line-number">786</span><br><span class="line-number">787</span><br><span class="line-number">788</span><br><span class="line-number">789</span><br><span class="line-number">790</span><br><span class="line-number">791</span><br><span class="line-number">792</span><br><span class="line-number">793</span><br><span class="line-number">794</span><br><span class="line-number">795</span><br><span class="line-number">796</span><br><span class="line-number">797</span><br><span class="line-number">798</span><br><span class="line-number">799</span><br><span class="line-number">800</span><br><span class="line-number">801</span><br><span class="line-number">802</span><br><span class="line-number">803</span><br><span class="line-number">804</span><br><span class="line-number">805</span><br><span class="line-number">806</span><br><span class="line-number">807</span><br><span class="line-number">808</span><br><span class="line-number">809</span><br><span class="line-number">810</span><br><span class="line-number">811</span><br><span class="line-number">812</span><br><span class="line-number">813</span><br><span class="line-number">814</span><br><span class="line-number">815</span><br><span class="line-number">816</span><br><span class="line-number">817</span><br><span class="line-number">818</span><br><span class="line-number">819</span><br><span class="line-number">820</span><br><span class="line-number">821</span><br><span class="line-number">822</span><br><span class="line-number">823</span><br><span class="line-number">824</span><br><span class="line-number">825</span><br><span class="line-number">826</span><br><span class="line-number">827</span><br><span class="line-number">828</span><br><span class="line-number">829</span><br><span class="line-number">830</span><br><span class="line-number">831</span><br><span class="line-number">832</span><br><span class="line-number">833</span><br><span class="line-number">834</span><br><span class="line-number">835</span><br><span class="line-number">836</span><br><span class="line-number">837</span><br><span class="line-number">838</span><br><span class="line-number">839</span><br><span class="line-number">840</span><br><span class="line-number">841</span><br><span class="line-number">842</span><br><span class="line-number">843</span><br><span class="line-number">844</span><br><span class="line-number">845</span><br><span class="line-number">846</span><br><span class="line-number">847</span><br><span class="line-number">848</span><br><span class="line-number">849</span><br><span class="line-number">850</span><br><span class="line-number">851</span><br><span class="line-number">852</span><br><span class="line-number">853</span><br><span class="line-number">854</span><br><span class="line-number">855</span><br><span class="line-number">856</span><br><span class="line-number">857</span><br><span class="line-number">858</span><br><span class="line-number">859</span><br><span class="line-number">860</span><br><span class="line-number">861</span><br><span class="line-number">862</span><br><span class="line-number">863</span><br><span class="line-number">864</span><br><span class="line-number">865</span><br><span class="line-number">866</span><br><span class="line-number">867</span><br><span class="line-number">868</span><br><span class="line-number">869</span><br><span class="line-number">870</span><br><span class="line-number">871</span><br><span class="line-number">872</span><br><span class="line-number">873</span><br><span class="line-number">874</span><br><span class="line-number">875</span><br><span class="line-number">876</span><br><span class="line-number">877</span><br><span class="line-number">878</span><br><span class="line-number">879</span><br><span class="line-number">880</span><br><span class="line-number">881</span><br><span class="line-number">882</span><br><span class="line-number">883</span><br><span class="line-number">884</span><br><span class="line-number">885</span><br><span class="line-number">886</span><br><span class="line-number">887</span><br><span class="line-number">888</span><br><span class="line-number">889</span><br><span class="line-number">890</span><br><span class="line-number">891</span><br><span class="line-number">892</span><br><span class="line-number">893</span><br><span class="line-number">894</span><br><span class="line-number">895</span><br><span class="line-number">896</span><br><span class="line-number">897</span><br><span class="line-number">898</span><br><span class="line-number">899</span><br><span class="line-number">900</span><br><span class="line-number">901</span><br><span class="line-number">902</span><br><span class="line-number">903</span><br><span class="line-number">904</span><br><span class="line-number">905</span><br><span class="line-number">906</span><br><span class="line-number">907</span><br><span class="line-number">908</span><br><span class="line-number">909</span><br><span class="line-number">910</span><br><span class="line-number">911</span><br><span class="line-number">912</span><br><span class="line-number">913</span><br><span class="line-number">914</span><br><span class="line-number">915</span><br><span class="line-number">916</span><br><span class="line-number">917</span><br><span class="line-number">918</span><br><span class="line-number">919</span><br><span class="line-number">920</span><br><span class="line-number">921</span><br><span class="line-number">922</span><br><span class="line-number">923</span><br><span class="line-number">924</span><br><span class="line-number">925</span><br><span class="line-number">926</span><br><span class="line-number">927</span><br><span class="line-number">928</span><br><span class="line-number">929</span><br><span class="line-number">930</span><br><span class="line-number">931</span><br><span class="line-number">932</span><br><span class="line-number">933</span><br><span class="line-number">934</span><br><span class="line-number">935</span><br><span class="line-number">936</span><br><span class="line-number">937</span><br><span class="line-number">938</span><br><span class="line-number">939</span><br><span class="line-number">940</span><br><span class="line-number">941</span><br><span class="line-number">942</span><br><span class="line-number">943</span><br><span class="line-number">944</span><br><span class="line-number">945</span><br><span class="line-number">946</span><br><span class="line-number">947</span><br><span class="line-number">948</span><br><span class="line-number">949</span><br><span class="line-number">950</span><br><span class="line-number">951</span><br><span class="line-number">952</span><br><span class="line-number">953</span><br><span class="line-number">954</span><br><span class="line-number">955</span><br><span class="line-number">956</span><br><span class="line-number">957</span><br><span class="line-number">958</span><br><span class="line-number">959</span><br><span class="line-number">960</span><br><span class="line-number">961</span><br><span class="line-number">962</span><br><span class="line-number">963</span><br><span class="line-number">964</span><br><span class="line-number">965</span><br><span class="line-number">966</span><br><span class="line-number">967</span><br><span class="line-number">968</span><br><span class="line-number">969</span><br><span class="line-number">970</span><br><span class="line-number">971</span><br><span class="line-number">972</span><br><span class="line-number">973</span><br><span class="line-number">974</span><br><span class="line-number">975</span><br><span class="line-number">976</span><br><span class="line-number">977</span><br><span class="line-number">978</span><br><span class="line-number">979</span><br><span class="line-number">980</span><br><span class="line-number">981</span><br><span class="line-number">982</span><br><span class="line-number">983</span><br><span class="line-number">984</span><br><span class="line-number">985</span><br><span class="line-number">986</span><br><span class="line-number">987</span><br><span class="line-number">988</span><br><span class="line-number">989</span><br><span class="line-number">990</span><br><span class="line-number">991</span><br><span class="line-number">992</span><br><span class="line-number">993</span><br><span class="line-number">994</span><br><span class="line-number">995</span><br><span class="line-number">996</span><br><span class="line-number">997</span><br><span class="line-number">998</span><br><span class="line-number">999</span><br><span class="line-number">1000</span><br><span class="line-number">1001</span><br><span class="line-number">1002</span><br><span class="line-number">1003</span><br><span class="line-number">1004</span><br><span class="line-number">1005</span><br><span class="line-number">1006</span><br><span class="line-number">1007</span><br><span class="line-number">1008</span><br><span class="line-number">1009</span><br><span class="line-number">1010</span><br><span class="line-number">1011</span><br><span class="line-number">1012</span><br><span class="line-number">1013</span><br><span class="line-number">1014</span><br><span class="line-number">1015</span><br><span class="line-number">1016</span><br><span class="line-number">1017</span><br><span class="line-number">1018</span><br><span class="line-number">1019</span><br><span class="line-number">1020</span><br><span class="line-number">1021</span><br><span class="line-number">1022</span><br><span class="line-number">1023</span><br><span class="line-number">1024</span><br><span class="line-number">1025</span><br><span class="line-number">1026</span><br><span class="line-number">1027</span><br><span class="line-number">1028</span><br><span class="line-number">1029</span><br><span class="line-number">1030</span><br><span class="line-number">1031</span><br><span class="line-number">1032</span><br><span class="line-number">1033</span><br><span class="line-number">1034</span><br><span class="line-number">1035</span><br><span class="line-number">1036</span><br><span class="line-number">1037</span><br><span class="line-number">1038</span><br><span class="line-number">1039</span><br><span class="line-number">1040</span><br><span class="line-number">1041</span><br><span class="line-number">1042</span><br><span class="line-number">1043</span><br><span class="line-number">1044</span><br><span class="line-number">1045</span><br><span class="line-number">1046</span><br><span class="line-number">1047</span><br><span class="line-number">1048</span><br><span class="line-number">1049</span><br><span class="line-number">1050</span><br><span class="line-number">1051</span><br><span class="line-number">1052</span><br><span class="line-number">1053</span><br><span class="line-number">1054</span><br><span class="line-number">1055</span><br><span class="line-number">1056</span><br><span class="line-number">1057</span><br><span class="line-number">1058</span><br><span class="line-number">1059</span><br><span class="line-number">1060</span><br><span class="line-number">1061</span><br><span class="line-number">1062</span><br><span class="line-number">1063</span><br><span class="line-number">1064</span><br><span class="line-number">1065</span><br><span class="line-number">1066</span><br><span class="line-number">1067</span><br><span class="line-number">1068</span><br><span class="line-number">1069</span><br><span class="line-number">1070</span><br><span class="line-number">1071</span><br><span class="line-number">1072</span><br><span class="line-number">1073</span><br><span class="line-number">1074</span><br><span class="line-number">1075</span><br><span class="line-number">1076</span><br><span class="line-number">1077</span><br><span class="line-number">1078</span><br><span class="line-number">1079</span><br><span class="line-number">1080</span><br><span class="line-number">1081</span><br><span class="line-number">1082</span><br><span class="line-number">1083</span><br><span class="line-number">1084</span><br><span class="line-number">1085</span><br><span class="line-number">1086</span><br><span class="line-number">1087</span><br><span class="line-number">1088</span><br><span class="line-number">1089</span><br><span class="line-number">1090</span><br><span class="line-number">1091</span><br><span class="line-number">1092</span><br><span class="line-number">1093</span><br><span class="line-number">1094</span><br><span class="line-number">1095</span><br><span class="line-number">1096</span><br><span class="line-number">1097</span><br><span class="line-number">1098</span><br><span class="line-number">1099</span><br><span class="line-number">1100</span><br><span class="line-number">1101</span><br><span class="line-number">1102</span><br><span class="line-number">1103</span><br><span class="line-number">1104</span><br><span class="line-number">1105</span><br><span class="line-number">1106</span><br><span class="line-number">1107</span><br><span class="line-number">1108</span><br><span class="line-number">1109</span><br><span class="line-number">1110</span><br><span class="line-number">1111</span><br><span class="line-number">1112</span><br><span class="line-number">1113</span><br><span class="line-number">1114</span><br><span class="line-number">1115</span><br><span class="line-number">1116</span><br><span class="line-number">1117</span><br><span class="line-number">1118</span><br><span class="line-number">1119</span><br><span class="line-number">1120</span><br><span class="line-number">1121</span><br><span class="line-number">1122</span><br><span class="line-number">1123</span><br><span class="line-number">1124</span><br><span class="line-number">1125</span><br><span class="line-number">1126</span><br><span class="line-number">1127</span><br><span class="line-number">1128</span><br><span class="line-number">1129</span><br><span class="line-number">1130</span><br><span class="line-number">1131</span><br><span class="line-number">1132</span><br><span class="line-number">1133</span><br><span class="line-number">1134</span><br><span class="line-number">1135</span><br><span class="line-number">1136</span><br><span class="line-number">1137</span><br><span class="line-number">1138</span><br></div></div><p><strong>ä»£ç è¯´æ˜</strong></p><ol><li>å¯¼å…¥æ¨¡å—ï¼šä»£ç å¼€å§‹å¤„å¯¼å…¥äº†å¤šä¸ªæ¨¡å—ï¼ŒåŒ…æ‹¬ç½‘ç»œè¯·æ±‚ï¼ˆrequestsï¼‰ã€æ•°æ®å¤„ç†ï¼ˆpandasï¼‰ã€è‡ªåŠ¨åŒ–ç½‘é¡µæ“ä½œï¼ˆseleniumï¼‰ã€æ—¥æœŸå¤„ç†ï¼ˆdatetimeï¼‰ç­‰ã€‚</li><li>é…ç½®å’Œåˆå§‹åŒ–ï¼šå®šä¹‰äº†ä¸€ç³»åˆ—å˜é‡æ¥è®¾ç½®çˆ¬è™«çš„å‚æ•°ï¼Œå¦‚çˆ¬å–çš„åŸå¸‚ã€æ—¥æœŸèŒƒå›´ã€æ—¶é—´é—´éš”ã€æ˜¯å¦åªæŠ“å–ç›´é£ä¿¡æ¯ç­‰ã€‚</li><li>é©±åŠ¨å™¨åˆå§‹åŒ–ï¼šinit_driver() å‡½æ•°åˆå§‹åŒ–äº†ä¸€ä¸ª web é©±åŠ¨å™¨ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ Edge é©±åŠ¨å™¨ã€‚é…ç½®äº†å¤šä¸ªæµè§ˆå™¨é€‰é¡¹ï¼ŒåŒ…æ‹¬éšèº«æ¨¡å¼ã€ç¦ç”¨ GPU ç­‰ï¼Œå¹¶ä¸”é€šè¿‡è¯»å–å¤–éƒ¨çš„ JavaScript æ–‡ä»¶ï¼ˆstealth.min.jsï¼‰æ¥å°è¯•éšè—è‡ªåŠ¨åŒ–æ“ä½œçš„ç—•è¿¹ã€‚</li><li>åŸå¸‚å’Œæ—¥æœŸç”Ÿæˆï¼šgen_citys()å‡½æ•°ç”Ÿæˆäº†ä¸€ä¸ªåŸå¸‚ç»„åˆåˆ—è¡¨ï¼Œç”¨äºåç»­çˆ¬å–ä¸åŒåŸå¸‚é—´çš„èˆªç­ã€‚generate_flight_dates() å‡½æ•°æ ¹æ®è®¾ç½®çš„å‚æ•°ç”Ÿæˆäº†éœ€è¦çˆ¬å–çš„æ—¥æœŸåˆ—è¡¨ã€‚</li></ol><p>5.æ•°æ®æŠ“å–é€»è¾‘ï¼šDataFetcher ç±»å®šä¹‰äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥æŠ“å–å’Œå¤„ç†æ•°æ®ã€‚åŒ…æ‹¬ç™»å½•æ“ä½œã€é¡µé¢å…ƒç´ ç‚¹å‡»ä¸äº¤äº’ã€èˆªç­æ•°æ®è¯·æ±‚ã€æ•°æ®è§£æå’Œå¤„ç†ç­‰ã€‚</p><ol start="6"><li>æ‰§è¡Œæµç¨‹ï¼šåœ¨ if <strong>name</strong> == &quot;<strong>main</strong>&quot;: å—ä¸­ï¼Œè„šæœ¬åˆå§‹åŒ–é©±åŠ¨å™¨ï¼Œç”ŸæˆåŸå¸‚å’Œæ—¥æœŸåˆ—è¡¨ï¼Œç„¶åéå†æ¯ä¸ªåŸå¸‚å¯¹å’Œæ—¥æœŸï¼Œä½¿ç”¨ <code>DataFetcher</code> ç±»çš„å®ä¾‹æ¥æ‰§è¡Œæ•°æ®æŠ“å–å’Œå¤„ç†çš„å„ä¸ªæ­¥éª¤ã€‚</li><li>ç»“æœä¿å­˜ï¼šæŠ“å–åˆ°çš„æ•°æ®è¢«å¤„ç†å’Œåˆå¹¶ä¸º DataFrameï¼Œç„¶åä¿å­˜åˆ° CSV æ–‡ä»¶ä¸­ã€‚</li><li>å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—ï¼šè„šæœ¬ä¸­åŒ…å«äº†å¤šå¤„å¼‚å¸¸å¤„ç†ï¼Œä»¥ä¾¿åœ¨æŠ“å–è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æ—¶è®°å½•æ—¥å¿—å¹¶è¿›è¡Œé‡è¯•ã€‚</li><li>é€€å‡ºï¼šæœ€åï¼Œè„šæœ¬å°è¯•å…³é—­é©±åŠ¨å™¨ä»¥ç»“æŸçˆ¬è™«ä»»åŠ¡ã€‚</li></ol><p>è¿™ä¸ªè„šæœ¬æ˜¾ç¤ºäº†é«˜çº§åˆ«çš„è‡ªåŠ¨åŒ–å’Œæ•°æ®å¤„ç†èƒ½åŠ›ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„ç»´æŠ¤å’Œæ‰§è¡Œæ­¤è„šæœ¬å¯èƒ½éœ€è¦å¯¹ selenium åº“å’Œç½‘é¡µè‡ªåŠ¨åŒ–æœ‰ç›¸å½“çš„äº†è§£ã€‚ç”±äºå®ƒä¸å®é™…çš„ç½‘é¡µäº¤äº’ï¼Œå…¶æŒç»­è¿è¡Œå¯èƒ½éœ€è¦å®šæœŸæ›´æ–°ä»¥é€‚åº”ç›®æ ‡ç½‘ç«™çš„æ›´æ”¹ã€‚æ­¤å¤–ï¼Œé•¿æ—¶é—´æˆ–å¤§è§„æ¨¡çš„è‡ªåŠ¨åŒ–çˆ¬è™«å¯èƒ½è¿åæŸäº›ç½‘ç«™çš„æœåŠ¡æ¡æ¬¾ã€‚</p><p>æ³¨æ„äº‹é¡¹</p><p>IP é™åˆ¶è§£å†³æ–¹æ¡ˆï¼šåˆ©ç”¨é¡µé¢ç‰¹æ€§å’Œç”¨æˆ·æ¨¡æ‹Ÿï¼Œè§„é¿äº† IP é™åˆ¶ï¼Œæé«˜äº†çˆ¬å–ç¨³å®šæ€§ã€‚</p><p>æ•°æ®æ ¡éªŒä¸è§£æï¼šå¯¹è·å–çš„æ•°æ®è¿›è¡Œä¸¥æ ¼çš„æ•°æ®è´¨é‡å’Œå®Œæ•´æ€§æ ¡éªŒï¼ŒåŒ…æ‹¬ gzip è§£å‹ç¼©å’Œ JSON æ ¼å¼è§£æã€‚</p><h1 id="python-æŠ¢ç¥¨ç¥å™¨åŠ©ä½ ä¸€ç¥¨åœ¨æ‰‹" tabindex="-1">Python æŠ¢ç¥¨ç¥å™¨åŠ©ä½ ä¸€ç¥¨åœ¨æ‰‹ <a class="header-anchor" href="#python-æŠ¢ç¥¨ç¥å™¨åŠ©ä½ ä¸€ç¥¨åœ¨æ‰‹" aria-label="Permalink to &quot;Python æŠ¢ç¥¨ç¥å™¨åŠ©ä½ ä¸€ç¥¨åœ¨æ‰‹&quot;">â€‹</a></h1><p>äº”ä¸€å°é•¿å‡æ¥ä¸´ï¼Œç«è½¦ç¥¨æŠ¢ç¥¨å¤§æˆ˜å†åº¦ä¸Šæ¼”ï¼æ¯åˆ°è¿™ä¸ªæ—¶å€™ï¼Œä¸å°‘äººéƒ½ä¸ºäº†ä¸€å¼ å›å®¶çš„ç«è½¦ç¥¨è€Œç„¦å¤´çƒ‚é¢ï¼Œå¾®ä¿¡ç¾¤é‡Œå„ç§è½¬å‘å¸®åŠ©æŠ¢ç¥¨ã€‚é¢å¯¹ç«è½¦ç¥¨ä¾›ä¸åº”æ±‚çš„å±€é¢ï¼Œè®¸å¤šäººåªèƒ½æœ›ç¥¨å…´å¹ã€‚ç„¶è€Œï¼Œç°åœ¨æœ‰äº† Python ç¥å™¨ py12306ï¼Œæˆ–è®¸èƒ½å¸®ä½ åœ¨è¿™åœºæŠ¢ç¥¨å¤§æˆ˜ä¸­è„±é¢–è€Œå‡ºï¼Œè½»æ¾æ‹¿åˆ°å›å®¶çš„è½¦ç¥¨ï¼Œè®©å‡ºè¡Œå˜å¾—æ›´åŠ æ— å¿§ï¼</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/pjialin/py12306" target="_blank" rel="noreferrer">https://github.com/pjialin/py12306</a></p><p><code>py12306</code> é¡¹ç›®æ˜¯ä¸€ä¸ªè‡ªåŠ¨æŠ¢ç¥¨å·¥å…·ï¼Œç”¨äºåœ¨ 12306 ç½‘ç«™ä¸Šè‡ªåŠ¨åŒ–åœ°ä¸ºç”¨æˆ·æŠ¢è´­ç«è½¦ç¥¨ã€‚è€Œä¸”åŠŸèƒ½å¼ºå¤§ã€‚</p><p>ä½¿ç”¨ py12306 æŠ¢ç¥¨å·¥å…·çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><p><strong>é…ç½® python ç¯å¢ƒ</strong></p><p>é¦–å…ˆä½ éœ€è¦é…ç½® python ç¯å¢ƒï¼Œpy12306 éœ€è¦è¿è¡Œåœ¨ python 3.6 ä»¥ä¸Šç‰ˆæœ¬ï¼Œä¸‹è½½ python æˆ–è€… anaconda é…ç½®ç¯å¢ƒ</p><p><strong>å…‹éš†ä»“åº“å¹¶å®‰è£…ä¾èµ–ï¼š</strong></p><p>ä½ éœ€è¦ä» GitHub ä¸Šå…‹éš† py12306 çš„ä»“åº“åˆ°æœ¬åœ°ï¼Œå¹¶ä½¿ç”¨ pip å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">git</span><span style="color:#98C379;"> clone</span><span style="color:#98C379;"> https://github.com/pjialin/py12306</span></span>
<span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#98C379;"> py12306</span></span>
<span class="line"><span style="color:#61AFEF;">pip</span><span style="color:#98C379;"> install</span><span style="color:#D19A66;"> -r</span><span style="color:#98C379;"> requirements.txt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>é…ç½®å·¥å…·ï¼š</strong></p><p>ç„¶åï¼Œä½ éœ€è¦å¤åˆ¶ç¤ºä¾‹é…ç½®æ–‡ä»¶å¹¶å¯¹å…¶è¿›è¡Œç¼–è¾‘ï¼Œå¡«å…¥è‡ªå·±çš„ 12306 è´¦å·ã€å¯†ç ã€ä¹˜å®¢ä¿¡æ¯ç­‰ã€‚</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">cp</span><span style="color:#98C379;"> env.py.example</span><span style="color:#98C379;"> env.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ç¼–è¾‘ env.py æ–‡ä»¶ï¼Œå¡«å…¥æ­£ç¡®çš„é…ç½®ä¿¡æ¯ã€‚</p><p><strong>æµ‹è¯•è¿è¡Œï¼š</strong></p><p>åœ¨æ­£å¼è¿è¡ŒæŠ¢ç¥¨ä¹‹å‰ï¼Œå¯ä»¥å…ˆè¿›è¡Œä¸€äº›æµ‹è¯•ï¼Œç¡®ä¿é…ç½®æ­£ç¡®ä»¥åŠé€šçŸ¥åŠŸèƒ½å¯ç”¨ã€‚</p><p>å¼€å§‹æµ‹è¯• -t</p><p>æµ‹è¯•é€šçŸ¥æ¶ˆæ¯ (è¯­éŸ³, é‚®ä»¶) -t -n</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">python</span><span style="color:#98C379;"> main.py</span><span style="color:#D19A66;"> -t</span><span style="color:#7F848E;font-style:italic;">  # è¿è¡Œæµ‹è¯•</span></span>
<span class="line"><span style="color:#61AFEF;">python</span><span style="color:#98C379;"> main.py</span><span style="color:#D19A66;"> -t</span><span style="color:#D19A66;"> -n</span><span style="color:#7F848E;font-style:italic;">  # è¿è¡Œæµ‹è¯•å¹¶æµ‹è¯•é€šçŸ¥åŠŸèƒ½</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>æ­£å¼è¿è¡Œï¼š</strong></p><p>å½“æ‰€æœ‰é…ç½®å’Œæµ‹è¯•éƒ½å®Œæˆåï¼Œä½ å¯ä»¥å¼€å§‹æ­£å¼è¿è¡ŒæŠ¢ç¥¨è„šæœ¬ã€‚</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">python</span><span style="color:#98C379;"> main.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240511170544803.DW5W9uH1.png" alt="image-20240511170544803"></p><p>æ­¤å¤–ï¼Œpy12306 è¿˜æä¾›äº† Web ç®¡ç†é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ Web ç•Œé¢æ¥é…ç½®æŠ¢ç¥¨ä»»åŠ¡ã€æŸ¥çœ‹æŠ¢ç¥¨ç»“æœç­‰ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨è‡ªåŠ¨åŒ–æŠ¢ç¥¨å·¥å…·å¯èƒ½ä¼šè¿å 12306 ç½‘ç«™çš„ä½¿ç”¨åè®®ï¼Œç”šè‡³å¯èƒ½æ¶‰åŠè¿æ³•è¡Œä¸ºã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨æ­¤ç±»å·¥å…·æ—¶ï¼Œè¯·åŠ¡å¿…äº†è§£å¹¶éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œç½‘ç«™è§„å®šã€‚åŒæ—¶ï¼Œç”±äºæŠ¢ç¥¨è¿‡ç¨‹æ¶‰åŠåˆ°å¤§é‡ç½‘ç»œè¯·æ±‚å’Œæ•°æ®å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¹ 12306 æœåŠ¡å™¨é€ æˆä¸€å®šå‹åŠ›ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶è¯·ä¿æŒç†æ€§ï¼Œé¿å…è¿‡åº¦å ç”¨èµ„æºã€‚</p><p>æœ€åï¼ŒæŠ¢ç¥¨æˆåŠŸç‡ä¸ä»…å–å†³äºå·¥å…·æœ¬èº«ï¼Œè¿˜å—åˆ°å¤šç§å› ç´ çš„å½±å“ï¼Œå¦‚è½¦æ¬¡ã€åº§ä½ç±»å‹ã€è´­ç¥¨æ—¶é—´ç­‰ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨è‡ªåŠ¨åŒ–æŠ¢ç¥¨å·¥å…·æ—¶ï¼Œè¯·ä¿æŒè€å¿ƒå’Œç†æ€§ï¼Œä¸è¦è¿‡åˆ†ä¾èµ–å·¥å…·è€Œå¿½ç•¥äº†å…¶ä»–è´­ç¥¨é€”å¾„ã€‚</p><h1 id="python-å†™èº«ä»½è¯ä¿¡æ¯æŸ¥è¯¢-åœ°åŒºã€æ˜Ÿåº§ã€å¹´é¾„ã€æ€§åˆ«-ç­‰" tabindex="-1">Python å†™èº«ä»½è¯ä¿¡æ¯æŸ¥è¯¢, åœ°åŒºã€æ˜Ÿåº§ã€å¹´é¾„ã€æ€§åˆ« ç­‰ <a class="header-anchor" href="#python-å†™èº«ä»½è¯ä¿¡æ¯æŸ¥è¯¢-åœ°åŒºã€æ˜Ÿåº§ã€å¹´é¾„ã€æ€§åˆ«-ç­‰" aria-label="Permalink to &quot;Python å†™èº«ä»½è¯ä¿¡æ¯æŸ¥è¯¢, åœ°åŒºã€æ˜Ÿåº§ã€å¹´é¾„ã€æ€§åˆ« ç­‰&quot;">â€‹</a></h1><p><strong>ä»£ç ï¼š</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> tkinter </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> tk</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tkinter </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ttk</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tkinter </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> messagebox</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_id_card_info</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    id_card </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> id_entry.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    url </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;https://tools.mgtv100.com/external/v1/identity_info/query?idCard=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">id_card</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url)</span></span>
<span class="line"><span style="color:#ABB2BF;">    result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æå–è¿”å›çš„æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">        status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> result[</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        code </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(result[</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> result[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æå–ä¸ªäººä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">        area </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;area&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        province </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;province&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        city </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;city&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        county </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;county&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        gender </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;gender&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        birthday </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;birthday&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        zodiac </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;zodiac&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        age </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;age&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        constellation </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#98C379;">&#39;constellation&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ›´æ–°ç•Œé¢æ˜¾ç¤º</span></span>
<span class="line"><span style="color:#ABB2BF;">        status_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;çŠ¶æ€ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> status)</span></span>
<span class="line"><span style="color:#ABB2BF;">        code_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;çŠ¶æ€ç ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> code)</span></span>
<span class="line"><span style="color:#ABB2BF;">        area_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;åœ°åŒºï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> area)</span></span>
<span class="line"><span style="color:#ABB2BF;">        province_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;çœä»½ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> province)</span></span>
<span class="line"><span style="color:#ABB2BF;">        city_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;åŸå¸‚ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> city)</span></span>
<span class="line"><span style="color:#ABB2BF;">        county_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;å¿åŒºï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> county)</span></span>
<span class="line"><span style="color:#ABB2BF;">        gender_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æ€§åˆ«ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> gender)</span></span>
<span class="line"><span style="color:#ABB2BF;">        birthday_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;ç”Ÿæ—¥ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> birthday)</span></span>
<span class="line"><span style="color:#ABB2BF;">        zodiac_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;ç”Ÿè‚–ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> zodiac)</span></span>
<span class="line"><span style="color:#ABB2BF;">        age_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;å¹´é¾„ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(age))</span></span>
<span class="line"><span style="color:#ABB2BF;">        constellation_label.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æ˜Ÿåº§ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> constellation)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> KeyError:</span></span>
<span class="line"><span style="color:#ABB2BF;">        messagebox.</span><span style="color:#61AFEF;">showerror</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é”™è¯¯&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æ­£ç¡®çš„èº«ä»½è¯å·&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºç•Œé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">window </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Tk</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">window.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;èº«ä»½è¯ä¿¡æ¯æŸ¥è¯¢--å¾®ä¿¡å…¬ä¼—å·:è“èƒ–å­ä¹‹å®¶&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">window.</span><span style="color:#61AFEF;">geometry</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;400x500&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span>
<span class="line"><span style="color:#ABB2BF;">window.</span><span style="color:#61AFEF;">configure</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºè¾“å…¥æ¡†å’ŒæŒ‰é’®</span></span>
<span class="line"><span style="color:#ABB2BF;">id_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;èº«ä»½è¯å·ç ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">id_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">pady</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">id_entry </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Entry</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#333333&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">insertbackground</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">relief</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;flat&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">id_entry.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">pady</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">search_button </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ttk.</span><span style="color:#61AFEF;">Button</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æŸ¥è¯¢&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">command</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">get_id_card_info, </span><span style="color:#E06C75;font-style:italic;">style</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;TButton&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">search_button.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">pady</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">search_button.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">pady</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºæ˜¾ç¤ºç»“æœçš„æ ‡ç­¾</span></span>
<span class="line"><span style="color:#ABB2BF;">status_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;çŠ¶æ€ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">status_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">code_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;çŠ¶æ€ç ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">code_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">area_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;åœ°åŒºï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">area_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">province_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;çœä»½ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">province_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">city_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;åŸå¸‚ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">city_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">county_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;å¿åŒºï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">county_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">gender_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æ€§åˆ«ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">gender_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">birthday_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;ç”Ÿæ—¥ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">birthday_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">zodiac_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;ç”Ÿè‚–ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">zodiac_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">age_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;å¹´é¾„ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">age_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">constellation_label </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(window, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;æ˜Ÿåº§ï¼š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">fg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">constellation_label.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®æŒ‰é’®æ ·å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">style </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ttk.</span><span style="color:#61AFEF;">Style</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">style.</span><span style="color:#61AFEF;">configure</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;TButton&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">foreground</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#00FF00&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">background</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#000000&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">font</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Consolas&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">window.</span><span style="color:#61AFEF;">mainloop</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br></div></div><ol><li>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥äº†<strong>requests</strong>åº“ç”¨äºå‘é€ HTTP è¯·æ±‚ï¼Œä»¥åŠ<strong>tkinter</strong>åº“ç”¨äºåˆ›å»º GUI ç•Œé¢ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º<strong>get_id_card_info()<strong>çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨ç”¨æˆ·ç‚¹å‡»â€œæŸ¥è¯¢â€æŒ‰é’®æ—¶è¢«è°ƒç”¨ã€‚è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯è·å–ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥çš„èº«ä»½è¯å·ç ï¼Œå¹¶æ„å»ºäº†ä¸€ä¸ª</strong>API</strong>çš„<strong>URL</strong>ï¼Œè¯¥ URL åŒ…å«äº†èº«ä»½è¯å·ç ä½œä¸ºæŸ¥è¯¢å‚æ•°ã€‚</li><li>åœ¨<strong>get_id_card_info()<strong>å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨</strong>requests</strong>åº“å‘é€äº†ä¸€ä¸ª<strong>GET</strong>è¯·æ±‚åˆ°<strong>API</strong>ï¼Œå¹¶è·å–åˆ°äº†è¿”å›çš„å“åº”ã€‚æˆ‘ä»¬å°†å“åº”çš„å†…å®¹è§£æä¸º<strong>JSON</strong>æ ¼å¼ï¼Œå¹¶æå–å‡ºäº†å…¶ä¸­çš„ä¸€äº›å­—æ®µï¼Œå¦‚çŠ¶æ€ã€çŠ¶æ€ç å’Œæ•°æ®ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ›´æ–°äº†<strong>GUI</strong>ç•Œé¢ä¸Šçš„æ ‡ç­¾ï¼Œå°†è·å–åˆ°çš„ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥ã€‚æˆ‘ä»¬åˆ›å»ºäº†å¤šä¸ªæ ‡ç­¾ï¼Œç”¨äºæ˜¾ç¤ºçŠ¶æ€ã€çŠ¶æ€ç ã€åœ°åŒºã€çœä»½ã€åŸå¸‚ã€å¿åŒºã€æ€§åˆ«ã€ç”Ÿæ—¥ã€ç”Ÿè‚–ã€å¹´é¾„å’Œæ˜Ÿåº§ç­‰ä¿¡æ¯ã€‚</li><li>åœ¨ä¸»ç¨‹åºä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<strong>tkinter</strong>çš„ä¸»çª—å£ï¼Œå¹¶è®¾ç½®äº†çª—å£çš„æ ‡é¢˜å’Œå¤§å°ã€‚</li><li><strong>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ ‡ç­¾å’Œä¸€ä¸ªè¾“å…¥æ¡†ï¼Œç”¨äºç”¨æˆ·è¾“å…¥èº«ä»½è¯å·ç ï¼Œä»¥åŠä¸€ä¸ªæŒ‰é’®ç”¨äºæŸ¥è¯¢ä¿¡æ¯ã€‚</strong></li><li>æˆ‘ä»¬å°†æŒ‰é’®ç»‘å®šåˆ°**get_id_card_info()****å‡½æ•°ï¼Œè¿™æ ·å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œå°±ä¼šè°ƒç”¨è¯¥å‡½æ•°è¿›è¡ŒæŸ¥è¯¢ã€‚</li><li><strong>æˆ‘ä»¬è¿˜è®¾ç½®äº†æŒ‰é’®çš„æ ·å¼ï¼Œä½¿å…¶å…·æœ‰ä¸€å®šçš„å¤–è§‚æ•ˆæœã€‚</strong></li><li>æœ€åï¼Œæˆ‘ä»¬å¯åŠ¨äº†<strong>tkinter</strong>çš„ä¸»å¾ªç¯ï¼Œè¿™æ ·<strong>GUI</strong>ç•Œé¢å°±ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†ç”¨æˆ·çš„äº¤äº’ã€‚</li></ol><p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p><p><img src="/ProgramLearnNotes/assets/image-20240428021246470.BPgsfZ8q.png" alt="image-20240428021246470"></p><h1 id="python-è‡ªåŠ¨åŒ–åŠå…¬å®æˆ˜è„šæœ¬åˆé›†" tabindex="-1">Python è‡ªåŠ¨åŒ–åŠå…¬å®æˆ˜è„šæœ¬åˆé›† <a class="header-anchor" href="#python-è‡ªåŠ¨åŒ–åŠå…¬å®æˆ˜è„šæœ¬åˆé›†" aria-label="Permalink to &quot;Python è‡ªåŠ¨åŒ–åŠå…¬å®æˆ˜è„šæœ¬åˆé›†&quot;">â€‹</a></h1><h2 id="_1ã€æ‰¹é‡æ–‡ä»¶é‡å‘½åç¥å™¨" tabindex="-1">1ã€æ‰¹é‡æ–‡ä»¶é‡å‘½åç¥å™¨ <a class="header-anchor" href="#_1ã€æ‰¹é‡æ–‡ä»¶é‡å‘½åç¥å™¨" aria-label="Permalink to &quot;1ã€æ‰¹é‡æ–‡ä»¶é‡å‘½åç¥å™¨&quot;">â€‹</a></h2><p>åœ¨å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å¯¹å¤§é‡æ–‡ä»¶è¿›è¡Œæ‰¹é‡é‡å‘½åï¼ŒPython å¸®ä½ è½»æ¾æå®šï¼</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> batch_rename</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">prefix</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">suffix</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i, filename </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(path)):</span></span>
<span class="line"><span style="color:#ABB2BF;">        new_name </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">prefix</span><span style="color:#D19A66;">}{</span><span style="color:#ABB2BF;">i</span><span style="color:#C678DD;">:03d</span><span style="color:#D19A66;">}{</span><span style="color:#ABB2BF;">suffix</span><span style="color:#D19A66;">}{</span><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(filename)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        old_file </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(path, filename)</span></span>
<span class="line"><span style="color:#ABB2BF;">        new_file </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(path, new_name)</span></span>
<span class="line"><span style="color:#ABB2BF;">        os.</span><span style="color:#61AFEF;">rename</span><span style="color:#ABB2BF;">(old_file, new_file)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">batch_rename</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/path/to/your/directory&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;file_&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.txt&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_2ã€è‡ªåŠ¨å‘é€é‚®ä»¶é€šçŸ¥" tabindex="-1">2ã€è‡ªåŠ¨å‘é€é‚®ä»¶é€šçŸ¥ <a class="header-anchor" href="#_2ã€è‡ªåŠ¨å‘é€é‚®ä»¶é€šçŸ¥" aria-label="Permalink to &quot;2ã€è‡ªåŠ¨å‘é€é‚®ä»¶é€šçŸ¥&quot;">â€‹</a></h2><p>å‘Šåˆ«æ‰‹åŠ¨å‘é€ï¼Œç”¨ Python ç¼–å†™å®šæ—¶å‘é€é‚®ä»¶çš„è‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.text </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEText</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">to_addr</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">subject</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">content</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    smtp_server </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;smtp.example.com&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    username </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;your-email@example.com&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    password </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;your-password&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    msg </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MIMEText</span><span style="color:#ABB2BF;">(content)</span></span>
<span class="line"><span style="color:#ABB2BF;">    msg[</span><span style="color:#98C379;">&#39;Subject&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> subject</span></span>
<span class="line"><span style="color:#ABB2BF;">    msg[</span><span style="color:#98C379;">&#39;From&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> username</span></span>
<span class="line"><span style="color:#ABB2BF;">    msg[</span><span style="color:#98C379;">&#39;To&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> to_addr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    server </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> smtplib.</span><span style="color:#61AFEF;">SMTP</span><span style="color:#ABB2BF;">(smtp_server, </span><span style="color:#D19A66;">587</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">starttls</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(username, password)</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(username, to_addr, msg.</span><span style="color:#61AFEF;">as_string</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;receiver@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;æ¯æ—¥æŠ¥å‘Šæé†’&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ä»Šæ—¥æŠ¥å‘Šå·²ç”Ÿæˆï¼Œè¯·æŸ¥æ”¶ã€‚&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="_3ã€å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒ–æ‰§è¡Œ" tabindex="-1">3ã€å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒ–æ‰§è¡Œ <a class="header-anchor" href="#_3ã€å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒ–æ‰§è¡Œ" aria-label="Permalink to &quot;3ã€å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒ–æ‰§è¡Œ&quot;">â€‹</a></h2><p>ä½¿ç”¨ Python è°ƒåº¦åº“ï¼Œå®ç°å®šæ—¶æ‰§è¡Œä»»åŠ¡çš„è‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> schedule</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> job_to_schedule</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å½“å‰æ—¶é—´ï¼š&quot;</span><span style="color:#ABB2BF;">, time.</span><span style="color:#61AFEF;">ctime</span><span style="color:#ABB2BF;">(), </span><span style="color:#98C379;">&quot;ä»»åŠ¡æ­£åœ¨æ‰§è¡Œ...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰æ¯å¤©9ç‚¹æ‰§è¡Œä»»åŠ¡</span></span>
<span class="line"><span style="color:#ABB2BF;">schedule.</span><span style="color:#61AFEF;">every</span><span style="color:#ABB2BF;">().day.</span><span style="color:#61AFEF;">at</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;09:00&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">do</span><span style="color:#ABB2BF;">(job_to_schedule)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">while</span><span style="color:#D19A66;"> True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    schedule.</span><span style="color:#61AFEF;">run_pending</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¿è¡Œæ­¤è„šæœ¬åï¼Œæ¯å¤©ä¸Šåˆ9ç‚¹ä¼šè‡ªåŠ¨æ‰“å°å½“å‰æ—¶é—´åŠæç¤ºä¿¡æ¯</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_4ã€æ•°æ®åº“æ“ä½œè‡ªåŠ¨åŒ–" tabindex="-1">4ã€æ•°æ®åº“æ“ä½œè‡ªåŠ¨åŒ– <a class="header-anchor" href="#_4ã€æ•°æ®åº“æ“ä½œè‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;4ã€æ•°æ®åº“æ“ä½œè‡ªåŠ¨åŒ–&quot;">â€‹</a></h2><p>ç®€åŒ–æ•°æ®åº“ç®¡ç†ï¼ŒPython å¸®ä½ è‡ªåŠ¨åŒ–æ‰§è¡Œ CRUD æ“ä½œã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> sqlite3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> create_connection</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">db_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    conn </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        conn </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sqlite3.</span><span style="color:#61AFEF;">connect</span><span style="color:#ABB2BF;">(db_file)</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æˆåŠŸè¿æ¥åˆ°SQLiteæ•°æ®åº“ï¼š</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">db_file</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Error </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> conn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> insert_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">conn</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">table_name</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">data_dict</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    keys </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;, &#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(data_dict.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    values </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;, &#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">v</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;&quot;</span><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> v </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data_dict.</span><span style="color:#61AFEF;">values</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    sql </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;INSERT INTO </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">table_name</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> (</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">keys</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">) VALUES (</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">values</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">);&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        cursor </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> conn.</span><span style="color:#61AFEF;">cursor</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        cursor.</span><span style="color:#61AFEF;">execute</span><span style="color:#ABB2BF;">(sql)</span></span>
<span class="line"><span style="color:#ABB2BF;">        conn.</span><span style="color:#61AFEF;">commit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ•°æ®æ’å…¥æˆåŠŸï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> sqlite3.Error </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#ABB2BF;">conn </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> create_connection</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;my_database.db&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;John Doe&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;age&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">insert_data</span><span style="color:#ABB2BF;">(conn, </span><span style="color:#98C379;">&#39;users&#39;</span><span style="color:#ABB2BF;">, data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åœ¨é€‚å½“æ—¶å€™å…³é—­æ•°æ®åº“è¿æ¥</span></span>
<span class="line"><span style="color:#ABB2BF;">conn.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="_5ã€ç½‘é¡µå†…å®¹è‡ªåŠ¨åŒ–æŠ“å–" tabindex="-1">5ã€ç½‘é¡µå†…å®¹è‡ªåŠ¨åŒ–æŠ“å– <a class="header-anchor" href="#_5ã€ç½‘é¡µå†…å®¹è‡ªåŠ¨åŒ–æŠ“å–" aria-label="Permalink to &quot;5ã€ç½‘é¡µå†…å®¹è‡ªåŠ¨åŒ–æŠ“å–&quot;">â€‹</a></h2><p>åˆ©ç”¨ BeautifulSoup å’Œ requests åº“ï¼Œç¼–å†™ Python çˆ¬è™«è·å–æ‰€éœ€ç½‘é¡µä¿¡æ¯ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> bs4 </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> BeautifulSoup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> fetch_web_content</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url)</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        soup </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> BeautifulSoup</span><span style="color:#ABB2BF;">(response.text, </span><span style="color:#98C379;">&#39;html.parser&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # ç¤ºä¾‹æå–é¡µé¢æ ‡é¢˜</span></span>
<span class="line"><span style="color:#ABB2BF;">        title </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> soup.</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;title&#39;</span><span style="color:#ABB2BF;">).text</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> title</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#98C379;"> &quot;æ— æ³•è·å–ç½‘é¡µå†…å®¹&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#ABB2BF;">url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;https://example.com&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">web_title </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> fetch_web_content</span><span style="color:#ABB2BF;">(url)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç½‘é¡µæ ‡é¢˜ï¼š&quot;</span><span style="color:#ABB2BF;">, web_title)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="_6ã€æ•°æ®æ¸…æ´—è‡ªåŠ¨åŒ–" tabindex="-1">6ã€æ•°æ®æ¸…æ´—è‡ªåŠ¨åŒ– <a class="header-anchor" href="#_6ã€æ•°æ®æ¸…æ´—è‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;6ã€æ•°æ®æ¸…æ´—è‡ªåŠ¨åŒ–&quot;">â€‹</a></h2><p>ä½¿ç”¨ Pandas åº“ï¼Œå®ç°å¤æ‚æ•°æ®å¤„ç†å’Œæ¸…æ´—çš„è‡ªåŠ¨åŒ–ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> clean_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç¤ºä¾‹ï¼šå¤„ç†ç¼ºå¤±å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    df.</span><span style="color:#61AFEF;">fillna</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;N/A&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">inplace</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç¤ºä¾‹ï¼šå»é™¤é‡å¤è¡Œ</span></span>
<span class="line"><span style="color:#ABB2BF;">    df.</span><span style="color:#61AFEF;">drop_duplicates</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">inplace</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç¤ºä¾‹ï¼šè½¬æ¢åˆ—ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">    df[</span><span style="color:#98C379;">&#39;date_column&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">to_datetime</span><span style="color:#ABB2BF;">(df[</span><span style="color:#98C379;">&#39;date_column&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> df</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#ABB2BF;">cleaned_df </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> clean_data</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data.csv&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ•°æ®æ¸…æ´—å®Œæˆï¼Œå·²å‡†å¤‡å°±ç»ªï¼&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_7ã€å›¾ç‰‡æ‰¹é‡å‹ç¼©" tabindex="-1">7ã€å›¾ç‰‡æ‰¹é‡å‹ç¼© <a class="header-anchor" href="#_7ã€å›¾ç‰‡æ‰¹é‡å‹ç¼©" aria-label="Permalink to &quot;7ã€å›¾ç‰‡æ‰¹é‡å‹ç¼©&quot;">â€‹</a></h2><p>ç”¨ Python å¿«é€Ÿå‹ç¼©å¤§é‡å›¾ç‰‡ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> compress_images</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">dir_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">quality</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> filename </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(dir_path):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> filename.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.jpg&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> filename.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.png&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(dir_path, filename))</span></span>
<span class="line"><span style="color:#ABB2BF;">            img.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(dir_path, </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;compressed_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;font-style:italic;">optimize</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">quality</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">quality)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">compress_images</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/path/to/images&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">quality</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_8ã€æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ›¿æ¢" tabindex="-1">8ã€æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ›¿æ¢ <a class="header-anchor" href="#_8ã€æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ›¿æ¢" aria-label="Permalink to &quot;8ã€æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ›¿æ¢&quot;">â€‹</a></h2><p>Python è„šæœ¬å¸®åŠ©ä½ ä¸€é”®åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å¹¶æ›¿æ¢æŒ‡å®šå†…å®¹ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> fileinput</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> search_replace_in_files</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">dir_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">search_text</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">replace_text</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> line </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> fileinput.</span><span style="color:#61AFEF;">input</span><span style="color:#ABB2BF;">([</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">dir_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/*&quot;</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;font-style:italic;">inplace</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(line.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(search_text, replace_text), </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">search_replace_in_files</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/path/to/files&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;old_text&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;new_text&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_9ã€æ—¥å¿—æ–‡ä»¶åˆ†æè‡ªåŠ¨åŒ–" tabindex="-1">9ã€æ—¥å¿—æ–‡ä»¶åˆ†æè‡ªåŠ¨åŒ– <a class="header-anchor" href="#_9ã€æ—¥å¿—æ–‡ä»¶åˆ†æè‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;9ã€æ—¥å¿—æ–‡ä»¶åˆ†æè‡ªåŠ¨åŒ–&quot;">â€‹</a></h2><p>é€šè¿‡ Python è§£ææ—¥å¿—æ–‡ä»¶ï¼Œæå–å…³é”®ä¿¡æ¯è¿›è¡Œç»Ÿè®¡åˆ†æã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> analyze_log</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">log_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(log_file, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">        lines </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> f.</span><span style="color:#61AFEF;">readlines</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    error_count </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> line </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> lines:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#98C379;"> &quot;ERROR&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> line:</span></span>
<span class="line"><span style="color:#ABB2BF;">            error_count </span><span style="color:#56B6C2;">+=</span><span style="color:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ—¥å¿—æ–‡ä»¶ä¸­åŒ…å« </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">error_count</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> æ¡é”™è¯¯è®°å½•ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">analyze_log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;application.log&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_10ã€æ•°æ®å¯è§†åŒ–è‡ªåŠ¨åŒ–" tabindex="-1">10ã€æ•°æ®å¯è§†åŒ–è‡ªåŠ¨åŒ– <a class="header-anchor" href="#_10ã€æ•°æ®å¯è§†åŒ–è‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;10ã€æ•°æ®å¯è§†åŒ–è‡ªåŠ¨åŒ–&quot;">â€‹</a></h2><p>åˆ©ç”¨ Matplotlib åº“ï¼Œå®ç°æ•°æ®çš„è‡ªåŠ¨å›¾è¡¨ç”Ÿæˆã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> matplotlib.pyplot </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> plt</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> visualize_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">data_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_csv</span><span style="color:#ABB2BF;">(data_file)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç¤ºä¾‹ï¼šç»˜åˆ¶æŸ±çŠ¶å›¾</span></span>
<span class="line"><span style="color:#ABB2BF;">    df.</span><span style="color:#61AFEF;">plot</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">kind</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;bar&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;category&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ•°æ®åˆ†å¸ƒ&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">xlabel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç±»åˆ«&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">ylabel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;å€¼&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    plt.</span><span style="color:#61AFEF;">show</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">visualize_data</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data.csv&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_11ã€é‚®ä»¶é™„ä»¶æ‰¹é‡ä¸‹è½½" tabindex="-1">11ã€é‚®ä»¶é™„ä»¶æ‰¹é‡ä¸‹è½½ <a class="header-anchor" href="#_11ã€é‚®ä»¶é™„ä»¶æ‰¹é‡ä¸‹è½½" aria-label="Permalink to &quot;11ã€é‚®ä»¶é™„ä»¶æ‰¹é‡ä¸‹è½½&quot;">â€‹</a></h2><p>é€šè¿‡ Python è§£æé‚®ä»¶ï¼Œè‡ªåŠ¨åŒ–ä¸‹è½½æ‰€æœ‰é™„ä»¶ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> imaplib</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> email</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.header </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> decode_header</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> download_attachments</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">email_addr</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">password</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">imap_server</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">folder</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;INBOX&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    mail </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> imaplib.</span><span style="color:#61AFEF;">IMAP4_SSL</span><span style="color:#ABB2BF;">(imap_server)</span></span>
<span class="line"><span style="color:#ABB2BF;">    mail.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(email_addr, password)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    mail.</span><span style="color:#61AFEF;">select</span><span style="color:#ABB2BF;">(folder)</span></span>
<span class="line"><span style="color:#ABB2BF;">    result, data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mail.</span><span style="color:#61AFEF;">uid</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;search&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;ALL&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    uids </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> uid </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> uids:</span></span>
<span class="line"><span style="color:#ABB2BF;">        _, msg_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mail.</span><span style="color:#61AFEF;">uid</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;fetch&#39;</span><span style="color:#ABB2BF;">, uid, </span><span style="color:#98C379;">&#39;(RFC822)&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        raw_email </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> msg_data[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;utf-8&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        email_message </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> email.</span><span style="color:#61AFEF;">message_from_string</span><span style="color:#ABB2BF;">(raw_email)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> part </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> email_message.</span><span style="color:#61AFEF;">walk</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> part.</span><span style="color:#61AFEF;">get_content_maintype</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;multipart&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> part.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Content-Disposition&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            filename </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> part.</span><span style="color:#61AFEF;">get_filename</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> bool</span><span style="color:#ABB2BF;">(filename):</span></span>
<span class="line"><span style="color:#ABB2BF;">                file_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> part.</span><span style="color:#61AFEF;">get_payload</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">decode</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/path/to/download&#39;</span><span style="color:#ABB2BF;">, filename), </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    f.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(file_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    mail.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    mail.</span><span style="color:#61AFEF;">logout</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">download_attachments</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;your-email@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;your-password&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;imap.example.com&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="_12ã€å®šæ—¶å‘é€æŠ¥å‘Šè‡ªåŠ¨åŒ–" tabindex="-1">12ã€å®šæ—¶å‘é€æŠ¥å‘Šè‡ªåŠ¨åŒ– <a class="header-anchor" href="#_12ã€å®šæ—¶å‘é€æŠ¥å‘Šè‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;12ã€å®šæ—¶å‘é€æŠ¥å‘Šè‡ªåŠ¨åŒ–&quot;">â€‹</a></h2><p>æ ¹æ®æ•°æ®åº“æˆ–æ–‡ä»¶å†…å®¹ï¼Œè‡ªåŠ¨ç”Ÿæˆå¹¶å®šæ—¶å‘é€æ—¥æŠ¥/å‘¨æŠ¥ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.text </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEText</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.multipart </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEMultipart</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> generate_report</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">source</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">to_addr</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">subject</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å‡è®¾è¿™é‡Œæ˜¯ä»æ•°æ®åº“æˆ–æ–‡ä»¶ä¸­è·å–æ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Šå†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">    report_content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">({</span><span style="color:#98C379;">&quot;Data&quot;</span><span style="color:#ABB2BF;">: [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&quot;Info&quot;</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&quot;A&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C&quot;</span><span style="color:#ABB2BF;">]}).</span><span style="color:#61AFEF;">to_html</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    msg </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MIMEMultipart</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    msg[</span><span style="color:#98C379;">&#39;From&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;your-email@example.com&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    msg[</span><span style="color:#98C379;">&#39;To&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> to_addr</span></span>
<span class="line"><span style="color:#ABB2BF;">    msg[</span><span style="color:#98C379;">&#39;Subject&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> subject</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    msg.</span><span style="color:#61AFEF;">attach</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">MIMEText</span><span style="color:#ABB2BF;">(report_content, </span><span style="color:#98C379;">&#39;html&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    server </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> smtplib.</span><span style="color:#61AFEF;">SMTP</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;smtp.example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">587</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">starttls</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;your-email@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;your-password&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    text </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> msg.</span><span style="color:#61AFEF;">as_string</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;your-email@example.com&#39;</span><span style="color:#ABB2BF;">, to_addr, text)</span></span>
<span class="line"><span style="color:#ABB2BF;">    server.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">generate_report</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;receiver@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;æ¯æ—¥æ•°æ®æŠ¥å‘Š&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç»“åˆå‰é¢çš„å®šæ—¶ä»»åŠ¡è„šæœ¬ï¼Œå¯å®ç°å®šæ—¶å‘é€åŠŸèƒ½</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="_13ã€è‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯•" tabindex="-1">13ã€è‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯• <a class="header-anchor" href="#_13ã€è‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯•" aria-label="Permalink to &quot;13ã€è‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯•&quot;">â€‹</a></h2><p>ä½¿ç”¨ Python çš„<code>locust</code>åº“è¿›è¡Œ API æ¥å£çš„å‹åŠ›æµ‹è¯•ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> locust </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> HttpUser, task, between</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> WebsiteUser</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">HttpUser</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    wait_time </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> between</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ç”¨æˆ·æ“ä½œä¹‹é—´çš„ç­‰å¾…æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @task</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> load_test_api</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.client.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/api/data&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        assert</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 200</span><span style="color:#7F848E;font-style:italic;">  # éªŒè¯è¿”å›çŠ¶æ€ç ä¸º200</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    @task</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æŒ‡å®šè¯¥ä»»åŠ¡åœ¨æ€»ä»»åŠ¡ä¸­çš„æ‰§è¡Œé¢‘ç‡æ˜¯å…¶ä»–ä»»åŠ¡çš„3å€</span></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> post_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;key&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.client.</span><span style="color:#61AFEF;">post</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/api/submit&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">json</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data)</span></span>
<span class="line"><span style="color:#C678DD;">        assert</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 201</span><span style="color:#7F848E;font-style:italic;">  # éªŒè¯æ•°æ®æˆåŠŸæäº¤åçš„å“åº”çŠ¶æ€ç </span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¿è¡ŒLocustå‘½ä»¤å¯åŠ¨æ€§èƒ½æµ‹è¯•ï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># locust -f your_test_script.py --host=http://your-api-url.com</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_14ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸å›æ»šè„šæœ¬" tabindex="-1">14ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸å›æ»šè„šæœ¬ <a class="header-anchor" href="#_14ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸å›æ»šè„šæœ¬" aria-label="Permalink to &quot;14ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸å›æ»šè„šæœ¬&quot;">â€‹</a></h2><p>ä½¿ç”¨ Fabric åº“ç¼–å†™ SSH è¿œç¨‹éƒ¨ç½²å·¥å…·ï¼Œè¿™é‡Œä»¥éƒ¨ç½² Django é¡¹ç›®ä¸ºä¾‹ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> fabric </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Connection</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> deploy</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">host_string</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">user</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">password</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">project_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">remote_dir</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    c </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Connection</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">host</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">host_string, </span><span style="color:#E06C75;font-style:italic;">user</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">user, </span><span style="color:#E06C75;font-style:italic;">connect_kwargs</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&quot;password&quot;</span><span style="color:#ABB2BF;">: password})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#ABB2BF;"> c.</span><span style="color:#61AFEF;">cd</span><span style="color:#ABB2BF;">(remote_dir):</span></span>
<span class="line"><span style="color:#ABB2BF;">        c.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;git pull origin master&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ›´æ–°ä»£ç </span></span>
<span class="line"><span style="color:#ABB2BF;">        c.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;pip install -r requirements.txt&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># å®‰è£…ä¾èµ–</span></span>
<span class="line"><span style="color:#ABB2BF;">        c.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;python manage.py migrate&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ‰§è¡Œæ•°æ®åº“è¿ç§»</span></span>
<span class="line"><span style="color:#ABB2BF;">        c.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;python manage.py collectstatic --noinput&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é™æ€æ–‡ä»¶æ”¶é›†</span></span>
<span class="line"><span style="color:#ABB2BF;">        c.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;supervisorctl restart your_project_name&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é‡å¯æœåŠ¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="color:#61AFEF;">deploy</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">    host_string</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;your-server-ip&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">    user</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;deploy_user&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">    password</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;deploy_password&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">    project_path</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;/path/to/local/project&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">    remote_dir</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;/path/to/remote/project&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¹äºå›æ»šæ“ä½œï¼Œå¯ä»¥åŸºäºç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå®ç°æˆ–åˆ›å»ºå¤‡ä»½ï¼Œåœ¨å‡ºç°é—®é¢˜æ—¶æ¢å¤ä¸Šä¸€ç‰ˆæœ¬çš„éƒ¨ç½²ã€‚</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h1 id="python-è‡ªåŠ¨åŒ–è„šæœ¬" tabindex="-1">Python è‡ªåŠ¨åŒ–è„šæœ¬ <a class="header-anchor" href="#python-è‡ªåŠ¨åŒ–è„šæœ¬" aria-label="Permalink to &quot;Python è‡ªåŠ¨åŒ–è„šæœ¬&quot;">â€‹</a></h1><p>è‡ªåŠ¨åŒ–æ˜¯ç°ä»£æ•ˆç‡èƒŒåçš„æ¨åŠ¨åŠ›ï¼Œåœ¨ Python ä¸­æ‰¾åˆ°äº†æœ€ä½³ä¼™ä¼´â€”â€”è¿™æ˜¯ä¸€ç§ä»¥å…¶å¤šæ ·åŒ–çš„è§£å†³æ–¹æ¡ˆè€Œè‘—ç§°çš„è¯­è¨€ï¼Œæ—¨åœ¨æ— ç¼ç®€åŒ–ä»»åŠ¡ã€‚å‡­å€Ÿå…¶å¹¿æ³›çš„åº“æ”¯æŒã€å†…ç½®åŠŸèƒ½å’Œè“¬å‹ƒå‘å±•çš„è´¡çŒ®è€…ç¤¾åŒºï¼ŒPython æˆä¸ºäº†ç®€åŒ–å·¥ä½œæµç¨‹çš„ç»ˆæç›Ÿå‹ï¼Œæä¾›äº†æ— ä¸ä¼¦æ¯”çš„ä¾¿åˆ©ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ 10 ä¸ªä»¤äººéœ‡æƒŠçš„ä½¿ç”¨ Python çš„è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œä½ éœ€è¦å°è¯•ã€‚ è¿™æ˜¯ä½ éœ€è¦å°è¯•çš„è‡ªåŠ¨åŒ–è„šæœ¬ç³»åˆ—çš„ç¬¬å…«éƒ¨åˆ†ã€‚</p><h2 id="_1ã€å‰ªè´´æ¿ç®¡ç†å™¨" tabindex="-1">1ã€å‰ªè´´æ¿ç®¡ç†å™¨ <a class="header-anchor" href="#_1ã€å‰ªè´´æ¿ç®¡ç†å™¨" aria-label="Permalink to &quot;1ã€å‰ªè´´æ¿ç®¡ç†å™¨&quot;">â€‹</a></h2><p>ğŸ“‹ ä½ æ˜¯å¦æ›¾ç»åœ¨å¤„ç†å¤šä¸ªæ–‡æœ¬ç‰‡æ®µæ—¶ï¼Œå¤±å»äº†å¯¹ä½ æ‰€å¤åˆ¶å†…å®¹çš„è·Ÿè¸ªï¼Ÿæ˜¯å¦æƒ³è¿‡æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥è·Ÿè¸ªä½ ä¸€å¤©æ‰€å¤åˆ¶æ‰€æœ‰å†…å®¹çš„å·¥å…·ï¼Ÿ</p><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ç›‘è§†ä½ å¤åˆ¶çš„ä¸€åˆ‡ï¼Œæ— ç¼åœ°å°†æ¯ä¸ªå¤åˆ¶çš„æ–‡æœ¬å­˜å‚¨åœ¨ä¸€ä¸ªæµç•…çš„å›¾å½¢ç•Œé¢ä¸­ï¼Œè¿™æ ·ä½ å°±ä¸å¿…åœ¨æ— å°½çš„æ ‡ç­¾é¡µä¸­æœç´¢ï¼Œä»è€Œé¿å…ä¸¢å¤±å®è´µçš„ä¿¡æ¯ã€‚</p><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬åˆ©ç”¨ Pyperclip åº“æ— ç¼æ•æ‰å¤åˆ¶çš„æ•°æ®ï¼Œå¹¶é›†æˆ Tkinter æ¥è§†è§‰è·Ÿè¸ªå’Œç®¡ç†å¤åˆ¶çš„æ–‡æœ¬ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥tkinteråº“ï¼Œç”¨äºåˆ›å»ºGUIåº”ç”¨ç¨‹åºï¼Œttkæ˜¯tkinterçš„æ‰©å±•æ¨¡å—ï¼Œç”¨äºæä¾›æ›´ç°ä»£çš„ç•Œé¢å…ƒç´ ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> tkinter astk</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tkinter </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ttk</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥pyperclipåº“ï¼Œå¯ä»¥ç”¨æ¥å¤åˆ¶å’Œç²˜è´´å‰ªè´´æ¿å†…å®¹ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pyperclip</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç”¨äºæ›´æ–°åˆ—è¡¨æ¡†çš„å†…å®¹ï¼Œå°†æ–°çš„å‰ªè´´æ¿å†…å®¹æ·»åŠ åˆ°åˆ—è¡¨ä¸­ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">update_listbox</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;"> new_item </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pyperclip.</span><span style="color:#61AFEF;">paste</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è·å–å½“å‰å‰ªè´´æ¿çš„å†…å®¹</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> new_item </span><span style="color:#C678DD;">not</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> X:  </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœå†…å®¹ä¸åœ¨æˆ‘ä»¬çš„åˆ—è¡¨ä¸­ï¼Œåˆ™æ·»åŠ å®ƒ</span></span>
<span class="line"><span style="color:#ABB2BF;"> X.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(new_item)</span></span>
<span class="line"><span style="color:#ABB2BF;"> listbox.</span><span style="color:#61AFEF;">insert</span><span style="color:#ABB2BF;">(tk.</span><span style="color:#D19A66;">END</span><span style="color:#ABB2BF;">, new_item)  </span><span style="color:#7F848E;font-style:italic;"># åœ¨åˆ—è¡¨æ¡†æœ«å°¾æ·»åŠ æ–°é¡¹ç›®</span></span>
<span class="line"><span style="color:#ABB2BF;"> listbox.</span><span style="color:#61AFEF;">insert</span><span style="color:#ABB2BF;">(tk.</span><span style="color:#D19A66;">END</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&quot;----------------------&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ·»åŠ åˆ†éš”çº¿</span></span>
<span class="line"><span style="color:#ABB2BF;"> listbox.</span><span style="color:#61AFEF;">yview</span><span style="color:#ABB2BF;">(tk.</span><span style="color:#D19A66;">END</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è‡ªåŠ¨æ»šåŠ¨åˆ°åˆ—è¡¨æ¡†çš„åº•éƒ¨</span></span>
<span class="line"><span style="color:#ABB2BF;"> root.</span><span style="color:#61AFEF;">after</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">, update_listbox)  </span><span style="color:#7F848E;font-style:italic;"># æ¯1000æ¯«ç§’ï¼ˆ1ç§’ï¼‰è°ƒç”¨ä¸€æ¬¡æ­¤å‡½æ•°ï¼Œä¸æ–­æ›´æ–°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç”¨äºå¤„ç†åˆ—è¡¨æ¡†ä¸­å…ƒç´ çš„åŒå‡»äº‹ä»¶ï¼Œå°†é€‰ä¸­çš„å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">copy_to_clipboard</span><span style="color:#ABB2BF;">(event):</span></span>
<span class="line"><span style="color:#ABB2BF;"> selected_item </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">listbox.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(listbox.</span><span style="color:#61AFEF;">curselection</span><span style="color:#ABB2BF;">())  </span><span style="color:#7F848E;font-style:italic;"># è·å–å½“å‰é€‰ä¸­çš„åˆ—è¡¨é¡¹</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> selected_item:</span></span>
<span class="line"><span style="color:#ABB2BF;"> pyperclip.</span><span style="color:#61AFEF;">copy</span><span style="color:#ABB2BF;">(selected_item)  </span><span style="color:#7F848E;font-style:italic;"># å°†é€‰ä¸­çš„å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨å‰ªè´´æ¿å†…å®¹ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;">X </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸»çª—å£</span></span>
<span class="line"><span style="color:#ABB2BF;">root </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tk.</span><span style="color:#61AFEF;">Tk</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">root.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Clipboard</span></span>
<span class="line"><span style="color:#ABB2BF;">Manager</span><span style="color:#98C379;">&quot;)  # è®¾ç½®çª—å£æ ‡é¢˜</span></span>
<span class="line"><span style="color:#ABB2BF;">root.</span><span style="color:#61AFEF;">geometry</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;500x500&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®çª—å£å¤§å°</span></span>
<span class="line"><span style="color:#ABB2BF;">root.</span><span style="color:#61AFEF;">configure</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#f0f0f0&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®çª—å£èƒŒæ™¯é¢œè‰²</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªæ¡†æ¶ç»„ä»¶ï¼Œç”¨äºæ”¾ç½®å…¶ä»–ç•Œé¢å…ƒç´ </span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">frame</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">tk.</span><span style="color:#61AFEF;">Frame</span><span style="color:#ABB2BF;">(root, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#f0f0f0&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">frame.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">padx</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">pady</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ”¾ç½®æ¡†æ¶å¹¶è®¾ç½®è¾¹è·</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åœ¨æ¡†æ¶å†…åˆ›å»ºä¸€ä¸ªæ ‡ç­¾ï¼Œæ˜¾ç¤ºæ–‡æœ¬æç¤º</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">label</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">tk.</span><span style="color:#61AFEF;">Label</span><span style="color:#ABB2BF;">(frame, </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;Clipboard Contents:&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">bg</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;#f0f0f0&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">label.</span><span style="color:#61AFEF;">grid</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨gridå¸ƒå±€ç®¡ç†å™¨æ”¾ç½®æ ‡ç­¾</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªæ»šåŠ¨æ¡</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">scrollbar</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">tk.</span><span style="color:#61AFEF;">Scrollbar</span><span style="color:#ABB2BF;">(root)</span></span>
<span class="line"><span style="color:#ABB2BF;">scrollbar.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">side</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">tk.</span><span style="color:#D19A66;">RIGHT</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">fill</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">tk.Y)  </span><span style="color:#7F848E;font-style:italic;"># æ”¾ç½®æ»šåŠ¨æ¡åœ¨çª—å£çš„å³ä¾§ï¼Œå¡«å……Yæ–¹å‘</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªåˆ—è¡¨æ¡†ï¼Œç”¨äºæ˜¾ç¤ºå‰ªè´´æ¿çš„å†…å®¹</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">listbox</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">tk.</span><span style="color:#61AFEF;">Listbox</span><span style="color:#ABB2BF;">(root, </span><span style="color:#E06C75;font-style:italic;">width</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">height</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">yscrollcommand</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">scrollbar.set)</span></span>
<span class="line"><span style="color:#ABB2BF;">listbox.</span><span style="color:#61AFEF;">pack</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">pady</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ”¾ç½®åˆ—è¡¨æ¡†å¹¶è®¾ç½®å‚ç›´è¾¹è·</span></span>
<span class="line"><span style="color:#ABB2BF;">scrollbar.</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">command</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">listbox.yview)  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®æ»šåŠ¨æ¡æ§åˆ¶åˆ—è¡¨æ¡†çš„å‚ç›´æ»šåŠ¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°ï¼Œå¼€å§‹æ›´æ–°åˆ—è¡¨æ¡†å†…å®¹</span></span>
<span class="line"><span style="color:#61AFEF;">update_listbox</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç»‘å®šåŒå‡»å·¦é”®äº‹ä»¶åˆ°copy_to_clipboardå‡½æ•°ï¼Œå®ç°åŒå‡»å¤åˆ¶åŠŸèƒ½</span></span>
<span class="line"><span style="color:#ABB2BF;">listbox.</span><span style="color:#61AFEF;">bind</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&lt;Double-Button-1&gt;&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">copy_to_clipboard)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¿è¡Œä¸»äº‹ä»¶å¾ªç¯ï¼Œç­‰å¾…ç”¨æˆ·äº¤äº’</span></span>
<span class="line"><span style="color:#ABB2BF;">root.</span><span style="color:#61AFEF;">mainloop</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h3 id="è„šæœ¬åº”ç”¨" tabindex="-1">è„šæœ¬åº”ç”¨ï¼š <a class="header-anchor" href="#è„šæœ¬åº”ç”¨" aria-label="Permalink to &quot;è„šæœ¬åº”ç”¨ï¼š&quot;">â€‹</a></h3><p>â€¢æ•è·å¹¶åˆ†ç±»ä»å„ç§æ¥æºå¤åˆ¶çš„ç ”ç©¶ç¬”è®°ã€‚</p><p>â€¢æ‰©å±•è„šæœ¬å¯ä»¥æ•è·é‡è¦çš„æ—¥å†äº‹ä»¶ã€æé†’ã€å¯†ç ç­‰ã€‚</p><h2 id="_2ã€ä»£ç è´¨é‡æ£€æŸ¥å™¨" tabindex="-1">2ã€ä»£ç è´¨é‡æ£€æŸ¥å™¨ <a class="header-anchor" href="#_2ã€ä»£ç è´¨é‡æ£€æŸ¥å™¨" aria-label="Permalink to &quot;2ã€ä»£ç è´¨é‡æ£€æŸ¥å™¨&quot;">â€‹</a></h2><p>æ¯ä¸ªå¼€å‘è€…éƒ½ç»å†è¿‡åœ¨ Python ä»£ç ä¸­è¿½è¸ªé”™è¯¯çš„æŒ«è´¥æ„Ÿï¼Œåªæ˜¯ä¸ºäº†å‘ç°è‡ªå·±è¿·å¤±åœ¨é”™è¯¯è¿·å®«ä¸­ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬ç†è§£ç¼–å†™å¹²å‡€é«˜æ•ˆä»£ç çš„é‡è¦æ€§â€”â€”ä½†æ‰‹åŠ¨åˆ†æä»£ç è´¨é‡å¯èƒ½æ˜¯ä¸€é¡¹å‹åŠ›å·¨å¤§çš„ä»»åŠ¡ã€‚ è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬åˆ©ç”¨ Pylint å’Œ Flake8 Python åŒ…è¿›è¡Œå…¨é¢çš„ä»£ç è´¨é‡å®¡æŸ¥ã€‚æ¯”è¾ƒä½ çš„ä»£ç ä¸ç¼–ç æ ‡å‡†ï¼Œå¹¶è¯†åˆ«é€»è¾‘é”™è¯¯ã€‚å®ƒç¡®ä¿ä½ çš„ä»£ç ç¬¦åˆè¡Œä¸šæœ€ä½³å®è·µï¼Œå¹¶ä¿æŒæ— é”™è¯¯ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥osæ¨¡å—ï¼Œç”¨äºæ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥subprocessæ¨¡å—ï¼Œç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> subprocess</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°analyze_codeï¼Œæ¥å—ä¸€ä¸ªå‚æ•°directoryï¼Œå³è¦åˆ†æçš„ç›®å½•è·¯å¾„ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">analyze_code</span><span style="color:#ABB2BF;">(directory):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ—å‡ºç›®å½•ä¸­æ‰€æœ‰ä»¥.pyç»“å°¾çš„æ–‡ä»¶ï¼Œæ„æˆä¸€ä¸ªåˆ—è¡¨ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> python_files </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">file</span><span style="color:#C678DD;"> for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span></span>
<span class="line"><span style="color:#ABB2BF;">os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(directory) </span><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.py&#39;</span><span style="color:#ABB2BF;">)]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¦‚æœæ²¡æœ‰æ‰¾åˆ°Pythonæ–‡ä»¶ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯å¹¶è¿”å›ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> python_files:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;No Python files found in</span></span>
<span class="line"><span style="color:#ABB2BF;">the specified directory.</span><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#C678DD;"> return</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # éå†æ‰¾åˆ°çš„Pythonæ–‡ä»¶ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> python_files:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Analyzing file:</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#E06C75;">file</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ‰“å°æ­£åœ¨åˆ†æçš„æ–‡ä»¶åã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> file_path</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory,</span></span>
<span class="line"><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è·å–æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨pylintå·¥å…·åˆ†æä»£ç è´¨é‡ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">Running</span></span>
<span class="line"><span style="color:#ABB2BF;">pylint</span><span style="color:#D19A66;">...</span><span style="color:#98C379;">&quot;)  # æç¤ºå¼€å§‹è¿è¡Œpylintã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> pylint_command</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;pylint</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">file_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#7F848E;font-style:italic;">  # æ„é€ pylintå‘½ä»¤ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> subprocess.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(pylint_command,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">shell</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ‰§è¡Œå‘½ä»¤ï¼Œshell=Trueå…è®¸åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨flake8å·¥å…·åˆ†æä»£ç é£æ ¼ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">Running</span></span>
<span class="line"><span style="color:#ABB2BF;">flake8</span><span style="color:#D19A66;">...</span><span style="color:#98C379;">&quot;)  # æç¤ºå¼€å§‹è¿è¡Œflake8ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> flake8_command</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;flake8</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">file_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#7F848E;font-style:italic;">  # æ„é€ flake8å‘½ä»¤ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> subprocess.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(flake8_command,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">shell</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ‰§è¡Œå‘½ä»¤ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ­¤è„šæœ¬è¢«ç›´æ¥è¿è¡Œï¼Œè€Œä¸æ˜¯è¢«å¯¼å…¥åˆ°å¦ä¸€ä¸ªè„šæœ¬ä¸­ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span></span>
<span class="line"><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> directory</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;C:</span><span style="color:#56B6C2;">\U</span><span style="color:#E06C75;">sers</span><span style="color:#56B6C2;">\a</span><span style="color:#E06C75;">bhay</span><span style="color:#56B6C2;">\O</span><span style="color:#E06C75;">neDrive\Desktop</span><span style="color:#56B6C2;">\P</span><span style="color:#E06C75;">art7&quot;</span><span style="color:#7F848E;font-style:italic;">  # æŒ‡å®šè¦åˆ†æçš„ç›®å½•ã€‚</span></span>
<span class="line"><span style="color:#61AFEF;"> analyze_code</span><span style="color:#ABB2BF;">(directory)  </span><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨åˆ†æå‡½æ•°ã€‚</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715065766658-149.Dl-ol-jx.webp" alt="å›¾ç‰‡"></p><p>è„šæœ¬åº”ç”¨ï¼š</p><p>â€¢è‡ªåŠ¨ä»£ç å¢å¼ºå™¨â€”â€”ç¨ä½œæ‰©å±•ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ª Python è„šæœ¬ï¼Œè¯†åˆ«ä»£ç ä¸­çš„é—®é¢˜å¹¶ç›¸åº”åœ°è¿›è¡Œæ›´æ”¹ã€‚</p><p>è‡ªåŠ¨ä»£ç å®¡æŸ¥ã€‚</p><h2 id="_3ã€é˜²ç¯¡æ”¹-ğŸš«" tabindex="-1">3ã€é˜²ç¯¡æ”¹ ğŸš« <a class="header-anchor" href="#_3ã€é˜²ç¯¡æ”¹-ğŸš«" aria-label="Permalink to &quot;3ã€é˜²ç¯¡æ”¹ ğŸš«&quot;">â€‹</a></h2><p>æ–‡ä»¶ç¯¡æ”¹ï¼Œä¹Ÿç§°ä¸ºæ•°æ®ç¯¡æ”¹ï¼Œæ˜¯æŒ‡æœªç»æˆæƒæ•…æ„æ”¹å˜ä¿¡æ¯ï¼Œå¯èƒ½åŒ…æ‹¬é”€æ¯ã€æ“çºµæˆ–ç¼–è¾‘æ•°æ®ã€‚ ä¸–ç•Œå„åœ°çš„è®¸å¤šå¨èƒè€…æ»¥ç”¨æ–‡ä»¶ç¯¡æ”¹æŠ€æœ¯ï¼Œå¹¶åœ¨å…³é”®ç³»ç»Ÿæ–‡ä»¶ä¸­å¼•å…¥ä¸åŒçš„æ¼æ´æˆ–åé—¨ï¼Œå±å®³å®‰å…¨å¹¶å®ç°æœªç»æˆæƒçš„è®¿é—®ã€‚ ä¸ºäº†é™ä½è¿™ç§é£é™©ï¼ŒéªŒè¯æ–‡ä»¶çš„å®Œæ•´æ€§è‡³å…³é‡è¦ï¼Œç¡®ä¿å®ƒä»¬ä¿æŒåŸå§‹çŠ¶æ€æœªè¢«æ”¹å˜ã€‚è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬å¯ä»¥å¸®åŠ©ä½ æµ‹è¯•ä»»ä½•æ–‡ä»¶ï¼Œå¹¶è¯†åˆ«å®ƒæ˜¯å¦è¢«ç¯¡æ”¹ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥hashlibæ¨¡å—ï¼Œç”¨äºåŠ å¯†å“ˆå¸ŒåŠŸèƒ½ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> hashlib</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥osæ¨¡å—ï¼Œç”¨äºæ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°calculate_sha256ï¼Œè®¡ç®—æ–‡ä»¶çš„SHA-256å“ˆå¸Œå€¼ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">calculate_sha256</span><span style="color:#ABB2BF;">(file_path):</span></span>
<span class="line"><span style="color:#ABB2BF;"> sha256 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> hashlib.</span><span style="color:#61AFEF;">sha256</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªsha256å“ˆå¸Œå¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä»¥äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;"> with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ¯æ¬¡è¯»å–4096å­—èŠ‚</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> chunk </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> iter</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">lambda</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4096</span><span style="color:#ABB2BF;">), </span><span style="color:#C678DD;">b</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;"> sha256.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(chunk)  </span><span style="color:#7F848E;font-style:italic;"># æ›´æ–°å“ˆå¸Œå¯¹è±¡çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> sha256.</span><span style="color:#61AFEF;">hexdigest</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è¿”å›å“ˆå¸Œå€¼çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°check_integrityï¼ŒéªŒè¯æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">check_integrity</span><span style="color:#ABB2BF;">(file_path, expected_checksum):</span></span>
<span class="line"><span style="color:#ABB2BF;"> actual_checksum </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">calculate_sha256</span><span style="color:#ABB2BF;">(file_path)  </span><span style="color:#7F848E;font-style:italic;"># è®¡ç®—æ–‡ä»¶çš„å®é™…SHA-256å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> actual_checksum </span><span style="color:#56B6C2;">==</span></span>
<span class="line"><span style="color:#ABB2BF;">expected_checksum  </span><span style="color:#7F848E;font-style:italic;"># æ¯”è¾ƒå®é™…å“ˆå¸Œå€¼ä¸é¢„æœŸå“ˆå¸Œå€¼æ˜¯å¦ç›¸åŒ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ­¤è„šæœ¬è¢«ç›´æ¥è¿è¡Œã€‚</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span></span>
<span class="line"><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_path </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Enter the path to</span></span>
<span class="line"><span style="color:#ABB2BF;">the </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;)  # è·å–ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> expected_checksum</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Enter the</span></span>
<span class="line"><span style="color:#ABB2BF;">expected </span><span style="color:#D19A66;">SHA</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">256</span><span style="color:#ABB2BF;"> checksum: </span><span style="color:#98C379;">&quot;)  #è·å–ç”¨æˆ·è¾“å…¥çš„é¢„æœŸSHA-256å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">isfile</span><span style="color:#ABB2BF;">(file_path):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è°ƒç”¨check_integrityå‡½æ•°éªŒè¯æ–‡ä»¶å®Œæ•´æ€§</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#61AFEF;"> check_integrity</span><span style="color:#ABB2BF;">(file_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">expected_checksum):</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;File integrity</span></span>
<span class="line"><span style="color:#ABB2BF;">verified: The </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;"> has </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> been tampered </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;">.</span><span style="color:#98C379;">&quot;)  # éªŒè¯æˆåŠŸ</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;File integrity check</span></span>
<span class="line"><span style="color:#ABB2BF;">failed: The </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;"> may have been tampered </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;">.</span><span style="color:#98C379;">&quot;)  # éªŒè¯å¤±è´¥</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Error: File not</span></span>
<span class="line"><span style="color:#ABB2BF;">found.</span><span style="color:#98C379;">&quot;)  # æ–‡ä»¶ä¸å­˜åœ¨é”™è¯¯æç¤º</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715065809363-152.H_voUQy5.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1715065809363-153.DTL-PJHQ.webp" alt="å›¾ç‰‡"></p><h2 id="_4ã€æ™ºèƒ½äº¤æ˜“" tabindex="-1">4ã€æ™ºèƒ½äº¤æ˜“ <a class="header-anchor" href="#_4ã€æ™ºèƒ½äº¤æ˜“" aria-label="Permalink to &quot;4ã€æ™ºèƒ½äº¤æ˜“&quot;">â€‹</a></h2><p>äº¤æ˜“æŒ‡çš„æ˜¯è´­ä¹°å’Œå‡ºå”®é‡‘èå·¥å…·ï¼Œå¦‚è‚¡ç¥¨ã€å€ºåˆ¸ã€è´§å¸ã€å•†å“æˆ–è¡ç”Ÿå“ï¼Œç›®çš„æ˜¯ä¸ºäº†è·åˆ©ã€‚æœŸåˆŠäº¤æ˜“è€…æ•´å¤©éƒ½åœ¨æŸ¥çœ‹ä¸åŒçš„ä»ªè¡¨æ¿ï¼Œè¯•å›¾æ‰¾å‡ºæ˜¯å¦ä¹°å…¥æˆ–å–å‡ºçš„é‚£ä¸€ä¸ªå®Œç¾å†³å®šã€‚ è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬å¯ä»¥å¸®åŠ©äº¤æ˜“è€…å’ŒæŠ•èµ„è€…å¾ˆå¥½åœ°äº†è§£ä½ æƒ³æŠ•èµ„çš„ä»»ä½•è‚¡ç¥¨ã€‚å®ƒä½¿ç”¨ Python çš„ Prophet åº“ï¼ŒåŸºäºä»é›…è™è´¢ç»è·å–çš„å†å²è‚¡ç¥¨æ•°æ®æ¥é¢„æµ‹è¿‘æœŸçš„è‚¡ç¥¨ä»·æ ¼ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥Streamlitåº“ç”¨äºåˆ›å»ºWebåº”ç”¨</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> streamlit</span></span>
<span class="line"><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> st</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥dateç”¨äºå¤„ç†æ—¥æœŸ</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> date</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥yfinanceåº“ï¼Œç”¨äºä»Yahoo Financeè·å–è‚¡ç¥¨æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> yfinance</span></span>
<span class="line"><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> yf</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥Prophetåº“ï¼Œç”¨äºè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> prophet</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Prophet</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥Prophetçš„Plotlyç»˜å›¾æ¥å£å’ŒPlotlyå›¾å½¢å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> prophet.plot</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> plot_plotly</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> plotly</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> graph_objs </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> go</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®é¢„æµ‹çš„èµ·å§‹æ—¥æœŸå’Œå½“å‰æ—¥æœŸ</span></span>
<span class="line"><span style="color:#D19A66;">START</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#98C379;">&quot;2015-01-01&quot;</span></span>
<span class="line"><span style="color:#D19A66;">TODAY</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">date.</span><span style="color:#61AFEF;">today</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨Streamlitåˆ›å»ºåº”ç”¨æ ‡é¢˜</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Stock</span></span>
<span class="line"><span style="color:#ABB2BF;">Forecast App</span><span style="color:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®ä¸€ä¸ªé€‰æ‹©æ¡†ï¼Œè®©ç”¨æˆ·é€‰æ‹©è‚¡ç¥¨</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">stocks</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;MSFT&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&quot;TSLA&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;GOOG&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;AAPL&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;NVDA&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">selected_stock</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">selectbox</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Select dataset for prediction&#39;</span><span style="color:#ABB2BF;">, stocks)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªæ»‘åŠ¨æ¡ï¼Œè®©ç”¨æˆ·é€‰æ‹©é¢„æµ‹çš„å¹´æ•°ï¼ŒèŒƒå›´ä»1åˆ°4å¹´</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">n_years</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">slider</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Years of prediction:&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">period</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> n_years</span></span>
<span class="line"><span style="color:#ABB2BF;">* </span><span style="color:#D19A66;">365</span><span style="color:#7F848E;font-style:italic;">  # å°†å¹´æ•°è½¬æ¢ä¸ºå¤©æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸€ä¸ªç¼“å­˜å‡½æ•°ï¼Œç”¨äºåŠ è½½è‚¡ç¥¨æ•°æ®ï¼Œé¿å…æ¯æ¬¡ä¼šè¯é‡æ–°åŠ è½½</span></span>
<span class="line"><span style="color:#56B6C2;">@</span><span style="color:#ABB2BF;">st.cache</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">load_data</span><span style="color:#ABB2BF;">(ticker):</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> data</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> yf.</span><span style="color:#61AFEF;">download</span><span style="color:#ABB2BF;">(ticker, </span><span style="color:#D19A66;">START</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">TODAY</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ä»Yahoo Financeä¸‹è½½è‚¡ç¥¨æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">inplace</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># é‡ç½®DataFrameçš„ç´¢å¼•</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> data</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºæ•°æ®åŠ è½½çŠ¶æ€</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">data_load_state</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Loading data...&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#61AFEF;">load_data</span><span style="color:#ABB2BF;">(selected_stock)  </span><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°åŠ è½½æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">data_load_state.</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Loading</span></span>
<span class="line"><span style="color:#ABB2BF;">data</span><span style="color:#D19A66;">...</span><span style="color:#ABB2BF;"> done!</span><span style="color:#98C379;">&#39;)  # æ›´æ–°åŠ è½½çŠ¶æ€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºåŸå§‹æ•°æ®çš„æœ€åå‡ è¡Œ</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">subheader</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Raw</span></span>
<span class="line"><span style="color:#ABB2BF;">data</span><span style="color:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(data.</span><span style="color:#61AFEF;">tail</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç»˜åˆ¶åŸå§‹æ•°æ®çš„å¼€ç›˜å’Œæ”¶ç›˜ä»·æ ¼</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">plot_raw_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> fig</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> go.</span><span style="color:#61AFEF;">Figure</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;"> fig.</span><span style="color:#61AFEF;">add_trace</span><span style="color:#ABB2BF;">(go.</span><span style="color:#61AFEF;">Scatter</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data[</span><span style="color:#98C379;">&#39;Date&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data[</span><span style="color:#98C379;">&#39;Open&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;stock_open&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;"> fig.</span><span style="color:#61AFEF;">add_trace</span><span style="color:#ABB2BF;">(go.</span><span style="color:#61AFEF;">Scatter</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data[</span><span style="color:#98C379;">&#39;Date&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">data[</span><span style="color:#98C379;">&#39;Close&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;stock_close&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;"> fig.layout.</span><span style="color:#61AFEF;">update</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">title_text</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;Time Series</span></span>
<span class="line"><span style="color:#ABB2BF;">data </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> Rangeslider</span><span style="color:#98C379;">&#39;, xaxis_rangeslider_visible=True)</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">plotly_chart</span><span style="color:#ABB2BF;">(fig)</span></span>
<span class="line"><span style="color:#61AFEF;">plot_raw_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨Prophetè¿›è¡Œé¢„æµ‹</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">df_train</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">data[[</span><span style="color:#98C379;">&#39;Date&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;Close&#39;</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">df_train</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">df_train.</span><span style="color:#61AFEF;">rename</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">columns</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&quot;Date&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ds&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Close&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">&quot;y&quot;</span><span style="color:#ABB2BF;">})</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">m</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Prophet</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">m.</span><span style="color:#61AFEF;">fit</span><span style="color:#ABB2BF;">(df_train)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">future</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">m.</span><span style="color:#61AFEF;">make_future_dataframe</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">periods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">period)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">forecast</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">m.</span><span style="color:#61AFEF;">predict</span><span style="color:#ABB2BF;">(future)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºå¹¶ç»˜åˆ¶é¢„æµ‹æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">subheader</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Forecast</span></span>
<span class="line"><span style="color:#ABB2BF;">data</span><span style="color:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(forecast.</span><span style="color:#61AFEF;">tail</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;Forecast</span></span>
<span class="line"><span style="color:#98C379;">plot for </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">n_years</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> years&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">fig1</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#61AFEF;">plot_plotly</span><span style="color:#ABB2BF;">(m, forecast)</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">plotly_chart</span><span style="color:#ABB2BF;">(fig1)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºé¢„æµ‹ç»„ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Forecast</span></span>
<span class="line"><span style="color:#ABB2BF;">components</span><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">fig2</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">m.</span><span style="color:#61AFEF;">plot_components</span><span style="color:#ABB2BF;">(forecast)</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(fig2)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715065861345-158.BH83Wu33.webp" alt="å›¾ç‰‡"></p><p>è„šæœ¬åº”ç”¨</p><p>ç®—æ³•äº¤æ˜“</p><p>è‚¡ä»·æ¯”è¾ƒä»ªè¡¨æ¿</p><h2 id="_5ã€autoimage-ä¸‹è½½å™¨" tabindex="-1">5ã€AutoImage ä¸‹è½½å™¨ <a class="header-anchor" href="#_5ã€autoimage-ä¸‹è½½å™¨" aria-label="Permalink to &quot;5ã€AutoImage ä¸‹è½½å™¨&quot;">â€‹</a></h2><p>åœ¨è®¡ç®—æœºè§†è§‰é¡¹ç›®ä¸­ï¼Œæ”¶é›†å›¾åƒæ•°æ®æ˜¯ä¸€ä¸ªå…³é”®æŒ‘æˆ˜ã€‚æ­£å¦‚ Andrew Ng æ‰€è¯´ï¼Œå¦‚æœä½ èƒ½æ”¶é›†åˆ°å¤§é‡æ•°æ®é›†ï¼Œé‚£ä¹ˆç®—æ³•å°±ä¸é‡è¦äº†ã€‚æ•°æ®åœ¨æé«˜æ¨¡å‹æ€§èƒ½å’Œå‡†ç¡®æ€§æ–¹é¢èµ·ç€å…³é”®ä½œç”¨ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥æ‰€éœ€çš„æ¨¡å—å’Œå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">simple_image_download </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> simple_image_download </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> simp</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªå“åº”å¯¹è±¡ï¼Œç”¨äºå¤„ç†å›¾ç‰‡ä¸‹è½½</span></span>
<span class="line"><span style="color:#ABB2BF;">response </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">simp.simple_image_download</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®å…³é”®è¯</span></span>
<span class="line"><span style="color:#ABB2BF;">keyword </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#98C379;">&quot;Dog&quot;</span><span style="color:#7F848E;font-style:italic;">  # æŒ‡å®šä¸‹è½½çš„å›¾ç‰‡å…³é”®è¯ä¸ºâ€œDogâ€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¸‹è½½å›¾ç‰‡</span></span>
<span class="line"><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;"> response</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">download</span><span style="color:#ABB2BF;">(keyword, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨ä¸‹è½½æ–¹æ³•ï¼Œå°è¯•ä¸‹è½½20å¼ å…³é”®è¯ä¸ºâ€œDogâ€çš„å›¾ç‰‡</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Images downloaded</span></span>
<span class="line"><span style="color:#ABB2BF;">successfully.</span><span style="color:#98C379;">&quot;)  # å¦‚æœä¸‹è½½æˆåŠŸï¼Œåˆ™è¾“å‡ºæˆåŠŸæ¶ˆæ¯</span></span>
<span class="line"><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception</span></span>
<span class="line"><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;An error occurred:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">e)  </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœä¸‹è½½è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715065881212-161.DQfEKHTh.webp" alt="å›¾ç‰‡"></p><h2 id="_6ã€ç«¯å£æ‰«æå™¨" tabindex="-1">6ã€ç«¯å£æ‰«æå™¨ <a class="header-anchor" href="#_6ã€ç«¯å£æ‰«æå™¨" aria-label="Permalink to &quot;6ã€ç«¯å£æ‰«æå™¨&quot;">â€‹</a></h2><p>è®©æˆ‘ä»¬è°ˆè°ˆç½‘ç»œå®‰å…¨ï¼ åœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œç«¯å£æ˜¯å…è®¸ä¸åŒè¿›ç¨‹æˆ–æœåŠ¡è¿æ¥å¹¶é€šè¿‡ç½‘ç»œäº¤æ¢æ•°æ®çš„é€šä¿¡ç«¯ç‚¹ã€‚ç«¯å£é€šè¿‡æ•°å€¼æ ‡è¯†ï¼Œå¹¶ä¸ç‰¹å®šåè®®ç›¸å…³è”ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥socketåº“ç”¨äºç½‘ç»œè¿æ¥</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> socket</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥PrettyTableåº“ç”¨äºç”Ÿæˆè¡¨æ ¼ï¼Œä½¿è¾“å‡ºç»“æœæ›´æ˜“äºé˜…è¯»</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> prettytable</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> PrettyTable</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­åŒ…å«å¸¸ç”¨ç«¯å£åŠå…¶æ½œåœ¨çš„å®‰å…¨æ¼æ´æè¿°</span></span>
<span class="line"><span style="color:#ABB2BF;">vulnerabilities </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#D19A66;"> 80</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;HTTPï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰ - ç”¨äºéåŠ å¯†çš„ç½‘é¡µæµé‡&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 443</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;HTTPSï¼ˆå®‰å…¨çš„HTTPï¼‰ -</span></span>
<span class="line"><span style="color:#ABB2BF;">ç”¨äºåŠ å¯†çš„ç½‘é¡µæµé‡</span><span style="color:#98C379;">&quot;,</span></span>
<span class="line"><span style="color:#D19A66;"> 22</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;SSHï¼ˆå®‰å…¨å¤–å£³åè®®ï¼‰ - ç”¨äºå®‰å…¨çš„è¿œç¨‹è®¿é—®&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 21</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;FTPï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰ - ç”¨äºæ–‡ä»¶ä¼ è¾“&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 25</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;SMTPï¼ˆç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰ - ç”¨äºç”µå­é‚®ä»¶ä¼ è¾“&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 23</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Telnet - ç”¨äºè¿œç¨‹ç»ˆç«¯è®¿é—®&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 53</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ - ç”¨äºåŸŸåè§£æ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 110</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;POP3ï¼ˆé‚®å±€åè®®ç¬¬3ç‰ˆï¼‰ - ç”¨äºç”µå­é‚®ä»¶è·å–&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 143</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;IMAPï¼ˆäº’è”ç½‘æ¶ˆæ¯è®¿é—®åè®®ï¼‰ -</span></span>
<span class="line"><span style="color:#ABB2BF;">ç”¨äºç”µå­é‚®ä»¶è·å–</span><span style="color:#98C379;">&quot;,</span></span>
<span class="line"><span style="color:#D19A66;"> 3306</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;MySQL - ç”¨äºMySQLæ•°æ®åº“è®¿é—®&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 3389</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;RDPï¼ˆè¿œç¨‹æ¡Œé¢åè®®ï¼‰ -</span></span>
<span class="line"><span style="color:#ABB2BF;">ç”¨äºWindowsçš„è¿œç¨‹æ¡Œé¢è¿æ¥</span><span style="color:#98C379;">&quot;,</span></span>
<span class="line"><span style="color:#D19A66;"> 8080</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;HTTPå¤‡ç”¨ç«¯å£ - å¸¸ç”¨ä½œHTTPçš„æ¬¡è¦ç«¯å£&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 8000</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;HTTPå¤‡ç”¨ç«¯å£ - å¸¸ç”¨ä½œHTTPçš„æ¬¡è¦ç«¯å£&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;"> 8443</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;HTTPSå¤‡ç”¨ç«¯å£ -</span></span>
<span class="line"><span style="color:#ABB2BF;">å¸¸ç”¨ä½œHTTPSçš„æ¬¡è¦ç«¯å£</span><span style="color:#98C379;">&quot;,</span></span>
<span class="line"><span style="color:#D19A66;"> 5900</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;VNCï¼ˆè™šæ‹Ÿç½‘ç»œè®¡ç®—ï¼‰ - ç”¨äºè¿œç¨‹æ¡Œé¢è®¿é—®&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ ¹æ®éœ€è¦å¯ç»§ç»­æ·»åŠ æ›´å¤šç«¯å£åŠå…¶å®‰å…¨æ¼æ´æè¿°</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ˜¾ç¤ºå¼€æ”¾ç«¯å£åŠå…¶æ½œåœ¨çš„å®‰å…¨é—®é¢˜</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">display_table</span><span style="color:#ABB2BF;">(open_ports):</span></span>
<span class="line"><span style="color:#ABB2BF;"> table </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> PrettyTable</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&quot;å¼€æ”¾ç«¯å£&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&quot;æ½œåœ¨å®‰å…¨é—®é¢˜&quot;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> port </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> open_ports:</span></span>
<span class="line"><span style="color:#ABB2BF;"> vulnerability </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">vulnerabilities.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(port, </span><span style="color:#98C379;">&quot;æ­¤ç«¯å£æ²¡æœ‰ä¸å¸¸è§æœåŠ¡ç›¸å…³è”çš„å·²çŸ¥æ¼æ´&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> table.</span><span style="color:#61AFEF;">add_row</span><span style="color:#ABB2BF;">([port, vulnerability])</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(table)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ‰«æç›®æ ‡ä¸»æœºçš„å¸¸ç”¨ç«¯å£</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">scan_top_ports</span><span style="color:#ABB2BF;">(target):</span></span>
<span class="line"><span style="color:#ABB2BF;"> open_ports </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []  </span><span style="color:#7F848E;font-style:italic;"># å­˜å‚¨å¼€æ”¾ç«¯å£çš„åˆ—è¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;"> top_ports </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">21</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">23</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">53</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">110</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">143</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">443</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3306</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3389</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5900</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">8000</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">8080</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">8443</span><span style="color:#ABB2BF;">] </span><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å¸¸è§çš„15ä¸ªç«¯å£</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> port </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> top_ports:</span></span>
<span class="line"><span style="color:#C678DD;"> try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> sock </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">socket.</span><span style="color:#61AFEF;">socket</span><span style="color:#ABB2BF;">(socket.</span><span style="color:#D19A66;">AF_INET</span><span style="color:#ABB2BF;">, socket.</span><span style="color:#D19A66;">SOCK_STREAM</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> sock.</span><span style="color:#61AFEF;">settimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®è¿æ¥è¶…æ—¶æ—¶é—´</span></span>
<span class="line"><span style="color:#ABB2BF;"> result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sock.</span><span style="color:#61AFEF;">connect_ex</span><span style="color:#ABB2BF;">((target,</span></span>
<span class="line"><span style="color:#ABB2BF;">port))</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> result </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> open_ports.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(port)</span></span>
<span class="line"><span style="color:#ABB2BF;"> sock.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;"> except</span><span style="color:#ABB2BF;"> KeyboardInterrupt:</span></span>
<span class="line"><span style="color:#ABB2BF;"> sys.</span><span style="color:#61AFEF;">exit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;"> except</span><span style="color:#ABB2BF;"> socket.error:</span></span>
<span class="line"><span style="color:#C678DD;"> pass</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> open_ports</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¸»å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;"> target </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥è¦æ‰«æçš„ç½‘ç«™URLæˆ–IPåœ°å€ï¼š&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> open_ports </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> scan_top_ports</span><span style="color:#ABB2BF;">(target)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> open_ports:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç›®æ ‡ä¸»æœºæ²¡æœ‰å¼€æ”¾çš„ç«¯å£ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€æ”¾çš„ç«¯å£åŠå…¶ç›¸å…³çš„æ½œåœ¨å®‰å…¨é—®é¢˜ï¼š&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;"> display_table</span><span style="color:#ABB2BF;">(open_ports)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœè¿™ä¸ªè„šæœ¬è¢«ç›´æ¥è¿è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span></span>
<span class="line"><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715065924848-164.tSv8LTCc.webp" alt="å›¾ç‰‡"></p><h2 id="_7ã€å¯†ç ç®¡ç†å™¨" tabindex="-1">7ã€å¯†ç ç®¡ç†å™¨ <a class="header-anchor" href="#_7ã€å¯†ç ç®¡ç†å™¨" aria-label="Permalink to &quot;7ã€å¯†ç ç®¡ç†å™¨&quot;">â€‹</a></h2><p>å…³äºæˆä¸ºæ•°å­—è‡ªç”±èŒä¸šè€…æœ€ç³Ÿç³•çš„éƒ¨åˆ†ä¹‹ä¸€æ˜¯ï¼Œä½ éœ€è¦è®°ä½è®¸å¤šå¯†ç ï¼Œå› ä¸ºä½ æ¯å¤©éƒ½åœ¨ä¸ºæ–°ç½‘ç«™æ³¨å†Œã€‚ è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬å¯ä»¥å¸®åŠ©ä½ ç®¡ç†æ‰€æœ‰å¯†ç ï¼Œä½¿å®ƒä»¬æ—¢å®‰å…¨åˆåªæœ‰ä½ èƒ½è®¿é—®ï¼Œä½¿ç”¨ä¸åŒçš„åŠ å¯†æŠ€æœ¯ã€‚ è¿™ä¸ªè„šæœ¬çš„æœ€å¥½ä¹‹å¤„åœ¨äºå®ƒæ˜¯ä¸€ä¸ªç½‘ç»œåº”ç”¨ï¼Œè¿™æ„å‘³ç€é€šè¿‡å‡ å¤„ä¿®æ”¹ï¼Œä½ å¯ä»¥å°†å…¶éƒ¨ç½²åœ¨äº‘å­˜å‚¨ä¸Šï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è®¿é—®æ‰€æœ‰å¯†ç ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå®‰å…¨é—®é¢˜ã€‚ å®ƒä½¿ç”¨ä¸€ä¸ªç¡¬ç¼–ç çš„è‡ªå®šä¹‰å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚å¦‚æœä½ è®¡åˆ’åœ¨å…±äº«å¹³å°ä¸Šä½¿ç”¨è¿™ä¸ªè„šæœ¬ï¼Œè¯·ç¡®ä¿å°†è¿™ä¸ªå¯†é’¥ä¿å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„å®‰å…¨æ–‡ä»¶ä¸­ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥æ‰€éœ€çš„åº“</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> streamlit</span></span>
<span class="line"><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> st</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> csv</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">cryptography.fernet </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Fernet</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">cryptography.fernet </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> InvalidToken</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è‡ªå®šä¹‰åŠ å¯†å¯†é’¥ï¼ˆç¡¬ç¼–ç ï¼‰</span></span>
<span class="line"><span style="color:#D19A66;">CUSTOM_ENCRYPTION_KEY</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> b</span><span style="color:#98C379;">&#39;u7wGgNdDFefqpr_kGxb8wJf6XRVsRwvb3QgITsD5Ft4=&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ‚¨è®¡åˆ’åœ¨å…±äº«å¹³å°ä¸Šä½¿ç”¨æ­¤è„šæœ¬ï¼Œè¯·ç¡®ä¿å°†æ­¤å¯†é’¥ä¿å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„å®‰å…¨æ–‡ä»¶ä¸­ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‡½æ•°ç”¨äºåŠ å¯†å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">encrypt_password</span><span style="color:#ABB2BF;">(password):</span></span>
<span class="line"><span style="color:#ABB2BF;"> cipher_suite </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">Fernet</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">CUSTOM_ENCRYPTION_KEY</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">cipher_suite.</span><span style="color:#61AFEF;">encrypt</span><span style="color:#ABB2BF;">(password.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">()) </span><span style="color:#7F848E;font-style:italic;"># å°†å¯†ç ç¼–ç ååŠ å¯†</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> encrypted_password</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‡½æ•°ç”¨äºè§£å¯†å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">decrypt_password</span><span style="color:#ABB2BF;">(encrypted_password):</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#56B6C2;"> isinstance</span><span style="color:#ABB2BF;">(encrypted_password,</span></span>
<span class="line"><span style="color:#56B6C2;">bytes</span><span style="color:#ABB2BF;">):  </span><span style="color:#7F848E;font-style:italic;"># æ£€æŸ¥åŠ å¯†å¯†ç æ˜¯å¦ä¸ºbytesç±»å‹</span></span>
<span class="line"><span style="color:#C678DD;"> try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> cipher_suite </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">Fernet</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">CUSTOM_ENCRYPTION_KEY</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> decrypted_password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">cipher_suite.</span><span style="color:#61AFEF;">decrypt</span><span style="color:#ABB2BF;">(encrypted_password) </span><span style="color:#7F848E;font-style:italic;"># è§£å¯†</span></span>
<span class="line"><span style="color:#C678DD;"> return</span></span>
<span class="line"><span style="color:#ABB2BF;">decrypted_password.</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># å°†bytesè§£ç ä¸ºå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#C678DD;"> except</span><span style="color:#ABB2BF;"> InvalidToken:</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#98C379;"> &quot;Invalid</span></span>
<span class="line"><span style="color:#ABB2BF;">Token</span><span style="color:#98C379;">&quot;  # è‹¥å¯†é’¥ä¸æ­£ç¡®ï¼Œè¿”å›æ— æ•ˆä»¤ç‰Œä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‡½æ•°ç”¨äºå°†ç½‘ç«™åå’Œå¯†ç ä¿å­˜åˆ°CSVæ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">save_credentials</span><span style="color:#ABB2BF;">(website_name, password):</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">encrypt_password</span><span style="color:#ABB2BF;">(password)  </span><span style="color:#7F848E;font-style:italic;"># å…ˆåŠ å¯†å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;"> with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;credentials.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;a&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">newline</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> csvfile:</span></span>
<span class="line"><span style="color:#ABB2BF;"> writer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> csv.</span><span style="color:#61AFEF;">writer</span><span style="color:#ABB2BF;">(csvfile)</span></span>
<span class="line"><span style="color:#ABB2BF;"> writer.</span><span style="color:#61AFEF;">writerow</span><span style="color:#ABB2BF;">([website_name,</span></span>
<span class="line"><span style="color:#ABB2BF;">encrypted_password.</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">()])  </span><span style="color:#7F848E;font-style:italic;">#å°†åŠ å¯†åçš„å¯†ç è§£ç ä¸ºå­—ç¬¦ä¸²åå­˜å‚¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‡½æ•°ç”¨äºä»CSVæ–‡ä»¶æ£€ç´¢å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">retrieve_password</span><span style="color:#ABB2BF;">(website_name):</span></span>
<span class="line"><span style="color:#C678DD;"> with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;credentials.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span></span>
<span class="line"><span style="color:#ABB2BF;">csvfile:</span></span>
<span class="line"><span style="color:#ABB2BF;"> reader </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> csv.</span><span style="color:#61AFEF;">reader</span><span style="color:#ABB2BF;">(csvfile)</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> reader:</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> row[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> website_name:</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">row[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># é‡æ–°ç¼–ç ä¸ºbytes</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> encrypted_password</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨Streamlitåˆ›å»ºWebç•Œé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¯†ç ç®¡ç†å™¨&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¾“å…¥å­—æ®µç”¨äºè¾“å…¥ç½‘ç«™åå’Œå¯†ç </span></span>
<span class="line"><span style="color:#ABB2BF;">website_name </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">text_input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾“å…¥ç½‘ç«™å:&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">text_input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾“å…¥å¯†ç :&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">type</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;password&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¿å­˜æŒ‰é’®ç”¨äºä¿å­˜ç½‘ç«™åå’Œå¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">button</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä¿å­˜&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> website_name </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> password:</span></span>
<span class="line"><span style="color:#61AFEF;"> save_credentials</span><span style="color:#ABB2BF;">(website_name,</span></span>
<span class="line"><span style="color:#ABB2BF;">password)</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç½‘ç«™åå’Œå¯†ç å·²æˆåŠŸä¿å­˜ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·å¡«å†™æ‰€æœ‰å­—æ®µã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ£€ç´¢æŒ‰é’®ç”¨äºæ£€ç´¢å¯†ç </span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">checkbox</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ£€ç´¢å¯†ç &quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;"> website_name </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">selectbox</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;é€‰æ‹©ç½‘ç«™å:&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">options</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> [row[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span></span>
<span class="line"><span style="color:#ABB2BF;">csv.</span><span style="color:#61AFEF;">reader</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;credentials.csv&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">))])</span></span>
<span class="line"><span style="color:#ABB2BF;"> key </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">text_input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¾“å…¥æ‚¨çš„åŠ å¯†å¯†é’¥:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">type</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;password&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">button</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ£€ç´¢å¯†ç &quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> key </span><span style="color:#56B6C2;">==</span></span>
<span class="line"><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">CUSTOM_ENCRYPTION_KEY</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">()):</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> website_name:</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">retrieve_password</span><span style="color:#ABB2BF;">(website_name)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> encrypted_password:</span></span>
<span class="line"><span style="color:#ABB2BF;"> decrypted_password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">decrypt_password</span><span style="color:#ABB2BF;">(encrypted_password)</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;ç½‘ç«™</span></span>
<span class="line"><span style="color:#98C379;">**</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">website_name</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">** çš„å¯†ç  -&gt; **</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">decrypted_password</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">**&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ•°æ®åº“ä¸­æœªæ‰¾åˆ°å¯†ç ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> elif</span><span style="color:#ABB2BF;"> key </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;"> pass</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ— æ•ˆçš„åŠ å¯†å¯†é’¥ï¼&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715065981143-167.D8chce4b.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1715065981143-168.Dh_mLdPY.webp" alt="å›¾ç‰‡"></p><h2 id="_8ã€æ‰¹é‡é‚®ä»¶å‘é€å™¨-ğŸ†•" tabindex="-1">8ã€æ‰¹é‡é‚®ä»¶å‘é€å™¨ ğŸ†• <a class="header-anchor" href="#_8ã€æ‰¹é‡é‚®ä»¶å‘é€å™¨-ğŸ†•" aria-label="Permalink to &quot;8ã€æ‰¹é‡é‚®ä»¶å‘é€å™¨ ğŸ†•&quot;">â€‹</a></h2><p>ç”µå­é‚®ä»¶åˆ—è¡¨æ˜¯åœ¨çº¿äº’åŠ¨çš„è´§å¸ï¼Œæ¯ä¸ªè®¢é˜…è€…éƒ½æ˜¯ä½ æ•°å­—éƒ¨è½ä¸­çš„å®è´µæˆå‘˜ã€‚å®ƒä»¬æ˜¯æœ‰æ•ˆæ•°å­—è¥é”€çš„æ ¸å¿ƒã€‚ ä½œä¸ºä¸€ä¸ªæ•°å­—å½±å“è€…ï¼Œä¸ä½ çš„ç²‰ä¸ä¿æŒäº’åŠ¨å¾ˆé‡è¦ï¼Œä½†æ‰‹åŠ¨è¿›è¡Œè¿™ä¸€å·¥ä½œå¾ˆå›°éš¾ï¼Œä½¿ç”¨å·¥å…·åˆ™å¯èƒ½èŠ±è´¹ä¸€å¤§ç¬”é’±ã€‚ è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬åˆ©ç”¨ Gmail è‡ªå·±çš„ SMTP æœåŠ¡å™¨å‘é€æ‰¹é‡ç”µå­é‚®ä»¶ï¼Œä»…éœ€å‡ åˆ†é’Ÿï¼Œå…è®¸ä½ å®Œå…¨è‡ªå®šä¹‰å¹¶æŒæ§ã€‚ ç¡®ä¿ä½ ä¸è¦å‘é€åƒåœ¾é‚®ä»¶ç»™æ¥æ”¶è€…ï¼Œå¦åˆ™ä½ ä¼šè¢« Gmail åˆ—å…¥é»‘åå•ã€‚å°è¯•å°†ä½ çš„é‚®ä»¶é™åˆ¶åœ¨æ¯å¤©å°‘äº 100 å°ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥smtplibåº“ç”¨äºé‚®ä»¶ä¼ è¾“</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥sslåº“ç”¨äºå»ºç«‹å®‰å…¨çš„è¿æ¥</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ssl</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># SMTPæœåŠ¡å™¨çš„è¯¦ç»†ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">smtp_server </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#98C379;">&#39;smtp.gmail.com&#39;</span><span style="color:#7F848E;font-style:italic;">  # ä½¿ç”¨çš„Gmailçš„SMTPæœåŠ¡å™¨åœ°å€</span></span>
<span class="line"><span style="color:#ABB2BF;">smtp_port </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#D19A66;">465</span><span style="color:#7F848E;font-style:italic;">  # ä½¿ç”¨çš„ç«¯å£å·ï¼ŒGmailçš„SSLç«¯å£æ˜¯465</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‘é€è€…å’Œæ¥æ”¶è€…çš„è¯¦ç»†ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">from_address </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#98C379;">&#39;Winzo Shop&#39;</span><span style="color:#7F848E;font-style:italic;">  # å‘ä»¶äººåœ°å€æˆ–åç§°</span></span>
<span class="line"><span style="color:#ABB2BF;">to_address </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">]  </span><span style="color:#7F848E;font-style:italic;"># æ¥æ”¶è€…åˆ—è¡¨ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªæ¥æ”¶é‚®ç®±åœ°å€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¤è¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">username </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;</span><span style="color:#7F848E;font-style:italic;">  # å‘ä»¶äººçš„é‚®ç®±è´¦å·</span></span>
<span class="line"><span style="color:#ABB2BF;">password </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;</span><span style="color:#7F848E;font-style:italic;">  # å‘ä»¶äººçš„é‚®ç®±å¯†ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># é‚®ä»¶å†…å®¹çš„è¯¦ç»†ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">subject</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;ğŸ‰ ç‹¬å®¶ä¼˜æƒ ï¼æ‚¨ä¸‹æ¬¡è´­ç‰©å¯äº«å—10%çš„æŠ˜æ‰£&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">body </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;&#39;</span><span style="color:#D19A66;">\</span></span>
<span class="line"><span style="color:#98C379;">äº²çˆ±çš„é¡¾å®¢ï¼Œ</span></span>
<span class="line"><span style="color:#98C379;">ä½œä¸ºæˆ‘ä»¬å°Šè´µçš„å®¢æˆ·ï¼Œä¸ºäº†è¡¨è¾¾æˆ‘ä»¬çš„æ„Ÿæ¿€ä¹‹æƒ…ï¼Œæˆ‘ä»¬ä¸ºæ‚¨çš„ä¸‹æ¬¡è´­ä¹°æä¾›äº†ä¸€é¡¹ç‹¬å®¶æŠ˜æ‰£ã€‚åœ¨ç»“è´¦æ—¶ä½¿ç”¨ä¸‹é¢çš„ä¼˜æƒ ç ï¼Œæ‚¨å¯ä»¥äº«å—è®¢å•10%çš„æŠ˜æ‰£ï¼š</span></span>
<span class="line"><span style="color:#98C379;">ä¼˜æƒ ç ï¼šDISCOUNT10</span></span>
<span class="line"><span style="color:#98C379;">æ— è®ºæ‚¨æ˜¯åœ¨å¯»æ‰¾æ—¶å°šçš„æœé¥°ã€æ½®æµçš„é…é¥°è¿˜æ˜¯é«˜è´¨é‡çš„äº§å“ï¼Œç°åœ¨æ˜¯è´­ç‰©å¹¶èŠ‚çœå¼€æ”¯çš„æœ€ä½³æ—¶æœºï¼æ¢ç´¢æˆ‘ä»¬çš„æœ€æ–°ç³»åˆ—ï¼Œå¹¶ç»™è‡ªå·±ä¹°äº›ç‰¹åˆ«çš„ä¸œè¥¿ã€‚</span></span>
<span class="line"><span style="color:#98C379;">æŠ“ç´§æ—¶é—´ï¼æ­¤ä¼˜æƒ ä»…é™æ—¶æœ‰æ•ˆã€‚ä¸è¦é”™è¿‡èŠ‚çœæ‚¨æœ€çˆ±ç‰©å“çš„æœºä¼šã€‚</span></span>
<span class="line"><span style="color:#98C379;">ç«‹å³è´­ç‰©ï¼šhttps://xyz.com</span></span>
<span class="line"><span style="color:#98C379;">æ„Ÿè°¢æ‚¨é€‰æ‹©WinzoShopã€‚æˆ‘ä»¬æœŸå¾…ç€ä¸ä¹…å†æ¬¡ä¸ºæ‚¨æœåŠ¡ï¼</span></span>
<span class="line"><span style="color:#98C379;">æœ€å¥½çš„ç¥ç¦ï¼Œ</span></span>
<span class="line"><span style="color:#98C379;">Winzo Shop</span></span>
<span class="line"><span style="color:#98C379;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªSSL/TLSçš„ä¸Šä¸‹æ–‡ç¯å¢ƒ</span></span>
<span class="line"><span style="color:#ABB2BF;">context </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">ssl.</span><span style="color:#61AFEF;">create_default_context</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨SSL/TLSé€šè¿‡SMTPæœåŠ¡å™¨è¿æ¥</span></span>
<span class="line"><span style="color:#C678DD;">with</span></span>
<span class="line"><span style="color:#ABB2BF;">smtplib.</span><span style="color:#61AFEF;">SMTP_SSL</span><span style="color:#ABB2BF;">(smtp_server, smtp_port, </span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">context) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> server:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¯ç”¨è°ƒè¯•çº§åˆ«ï¼Œæ‰“å°æœåŠ¡å™¨çš„å“åº”ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;"> server.</span><span style="color:#61AFEF;">set_debuglevel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ç™»å½•SMTPæœåŠ¡å™¨</span></span>
<span class="line"><span style="color:#ABB2BF;"> server.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(username, password)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºç”µå­é‚®ä»¶æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#ABB2BF;"> message </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;From:</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">from_address</span><span style="color:#D19A66;">}</span><span style="color:#56B6C2;">\r\n</span><span style="color:#98C379;">Subject: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">subject</span><span style="color:#D19A66;">}</span><span style="color:#56B6C2;">\r\n</span><span style="color:#98C379;">To: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">to_address</span><span style="color:#D19A66;">}</span><span style="color:#56B6C2;">\r\n\r\n</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">body</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;"> message </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> message.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># å°†æ¶ˆæ¯è½¬æ¢ä¸ºå­—èŠ‚æ ¼å¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å‘é€é‚®ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;"> server.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(from_address, to_address,</span></span>
<span class="line"><span style="color:#ABB2BF;">message)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715066020051-173.DMgCzdxE.webp" alt="å›¾ç‰‡"></p><h2 id="_9ã€readme-md-ç”Ÿæˆå™¨" tabindex="-1">9ã€Readme.md ç”Ÿæˆå™¨ <a class="header-anchor" href="#_9ã€readme-md-ç”Ÿæˆå™¨" aria-label="Permalink to &quot;9ã€Readme.md ç”Ÿæˆå™¨&quot;">â€‹</a></h2><p>README.md æ–‡ä»¶ä½œä¸ºä½ é¡¹ç›®çš„é—¨æˆ·ï¼Œæä¾›å¿…è¦ä¿¡æ¯å¹¶å¸å¼•è®¿å®¢è¿›ä¸€æ­¥æ¢ç´¢ã€‚å®ƒè¢«è®¤ä¸ºæ˜¯ä½ ä»“åº“ä¸­æœ€é‡è¦çš„æ–‡ä»¶ä¹‹ä¸€ï¼Œä½†åŒæ—¶ä¹Ÿæ˜¯åˆ›å»ºèµ·æ¥ç›¸å½“è€—æ—¶çš„ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥æ‰€éœ€çš„æ¨¡å—</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> hashlib</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> shutil</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç”¨äºè·å–æ–‡ä»¶çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">get_file_hash</span><span style="color:#ABB2BF;">(file_path):</span></span>
<span class="line"><span style="color:#C678DD;"> with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:  </span><span style="color:#7F848E;font-style:italic;"># ä»¥äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;"> return</span></span>
<span class="line"><span style="color:#ABB2BF;">hashlib.</span><span style="color:#61AFEF;">sha256</span><span style="color:#ABB2BF;">(f.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()).</span><span style="color:#61AFEF;">hexdigest</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨SHA-256ç®—æ³•è®¡ç®—æ–‡ä»¶çš„å“ˆå¸Œå€¼å¹¶è¿”å›</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç”¨äºæ•´ç†æ–‡ä»¶å¤¹å¹¶ç§»åŠ¨é‡å¤çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">organize_and_move_duplicates</span><span style="color:#ABB2BF;">(folder_path):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨åŸºäºæ–‡ä»¶æ‰©å±•åçš„ç›®æ ‡æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;"> extension_folders </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¦‚æœä¸å­˜åœ¨â€œDuplicatesâ€æ–‡ä»¶å¤¹ï¼Œåˆ™åˆ›å»ºå®ƒ</span></span>
<span class="line"><span style="color:#ABB2BF;"> duplicates_folder </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path, </span><span style="color:#98C379;">&#39;Duplicates&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(duplicates_folder,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä½¿ç”¨exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">Trueé¿å…åœ¨æ–‡ä»¶å¤¹å·²å­˜åœ¨æ—¶å¼•å‘é”™è¯¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨æ–‡ä»¶å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_hashes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # éå†æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> filename </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(folder_path):</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">filename)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">isfile</span><span style="color:#ABB2BF;">(file_path):  </span><span style="color:#7F848E;font-style:italic;"># ç¡®ä¿æ˜¯æ–‡ä»¶è€Œä¸æ˜¯ç›®å½•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–æ–‡ä»¶æ‰©å±•å</span></span>
<span class="line"><span style="color:#ABB2BF;"> _, extension </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(filename)</span></span>
<span class="line"><span style="color:#ABB2BF;"> extension </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> extension.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># å°†æ‰©å±•åè½¬æ¢ä¸ºå°å†™ï¼Œä»¥é¿å…å¤§å°å†™å·®å¼‚å¯¼è‡´çš„åˆ†ç±»é”™è¯¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ç¡®å®šç›®æ ‡æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> extension </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> extension_folders:</span></span>
<span class="line"><span style="color:#ABB2BF;"> destination_folder </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">extension_folders[extension]</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> destination_folder </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path, extension[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:]) </span><span style="color:#7F848E;font-style:italic;"># ç§»é™¤æ‰©å±•åå‰çš„ç‚¹å¹¶åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(destination_folder,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> extension_folders[extension] </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">destination_folder</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è®¡ç®—æ–‡ä»¶å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_hash </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">get_file_hash</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦é‡å¤</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> file_hash </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> file_hashes:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ–‡ä»¶æ˜¯é‡å¤çš„ï¼Œå°†å…¶ç§»åŠ¨åˆ°â€œDuplicatesâ€æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;"> shutil.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(file_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(duplicates_folder, filename))</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å°†é‡å¤æ–‡ä»¶ </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">ç§»åŠ¨åˆ° Duplicates æ–‡ä»¶å¤¹ã€‚</span><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å­˜å‚¨æ–‡ä»¶å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_hashes[file_hash] </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">filename</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;"> shutil.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(file_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">destination_folder)</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å°† </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> ç§»åŠ¨åˆ°</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">destination_folder</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœè¿™ä¸ªè„šæœ¬è¢«ç›´æ¥è¿è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span></span>
<span class="line"><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> folder_path</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æ‚¨è¦æ•´ç†çš„æ–‡ä»¶å¤¹è·¯å¾„:</span></span>
<span class="line"><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#61AFEF;"> organize_and_move_duplicates</span><span style="color:#ABB2BF;">(folder_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715066058661-176.CuABF-IV.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1715066058661-177.BPkv5Pb9.webp" alt="å›¾ç‰‡"></p><h2 id="_10ã€organizeit-2-0" tabindex="-1">10ã€OrganizeIT 2.0 <a class="header-anchor" href="#_10ã€organizeit-2-0" aria-label="Permalink to &quot;10ã€OrganizeIT 2.0&quot;">â€‹</a></h2><p>ä½ çš„ä¸‹è½½æ–‡ä»¶å¤¹æ˜¯ä¸€å›¢ä¹±éº»å—ï¼Ÿ</p><p>å½“ä½ æœ€éœ€è¦æ—¶ï¼Œä½ æ˜¯å¦å‘ç°è‡ªå·±åœ¨å¯»æ‰¾å…³é”®æ–‡ä»¶æ—¶æ‰‹å¿™è„šä¹±ï¼Ÿ</p><p>ä½ æ˜¯å¦å°è¯•è¿‡å¤šæ¬¡ç»„ç»‡æ–‡ä»¶å¤¹ï¼Œä½†æ€»æ˜¯æ— æ³•æˆåŠŸï¼Ÿ</p><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬å¯ä»¥å¸®åŠ©ä½ åœ¨å‡ åˆ†é’Ÿå†…æ•´ç†ä½ çš„æ–‡ä»¶å¤¹ã€‚ä½ åªéœ€è¦æŒ‡å®šä½ æƒ³è¦æ¸…ç†çš„è·¯å¾„ï¼Œè¿™ä¸ªè„šæœ¬å°†è‡ªåŠ¨æ ¹æ®æ–‡ä»¶æ‰©å±•åå°†æ‰€æœ‰æ–‡ä»¶åˆ†åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥æ‰€éœ€çš„æ¨¡å—</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> hashlib</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> shutil</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç”¨äºè·å–æ–‡ä»¶çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">get_file_hash</span><span style="color:#ABB2BF;">(file_path):</span></span>
<span class="line"><span style="color:#C678DD;"> with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:  </span><span style="color:#7F848E;font-style:italic;"># ä»¥äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;"> return</span></span>
<span class="line"><span style="color:#ABB2BF;">hashlib.</span><span style="color:#61AFEF;">sha256</span><span style="color:#ABB2BF;">(f.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()).</span><span style="color:#61AFEF;">hexdigest</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨SHA-256ç®—æ³•è®¡ç®—æ–‡ä»¶çš„å“ˆå¸Œå€¼å¹¶è¿”å›</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰å‡½æ•°ï¼Œç”¨äºæ•´ç†æ–‡ä»¶å¤¹å¹¶ç§»åŠ¨é‡å¤çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">organize_and_move_duplicates</span><span style="color:#ABB2BF;">(folder_path):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨åŸºäºæ–‡ä»¶æ‰©å±•åçš„ç›®æ ‡æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;"> extension_folders </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¦‚æœä¸å­˜åœ¨â€œDuplicatesâ€æ–‡ä»¶å¤¹ï¼Œåˆ™åˆ›å»ºå®ƒ</span></span>
<span class="line"><span style="color:#ABB2BF;"> duplicates_folder </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path, </span><span style="color:#98C379;">&#39;Duplicates&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(duplicates_folder,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨exist_ok=Trueé¿å…åœ¨æ–‡ä»¶å¤¹å·²å­˜åœ¨æ—¶å¼•å‘é”™è¯¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨æ–‡ä»¶å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_hashes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # éå†æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> filename </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(folder_path):</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">filename)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">isfile</span><span style="color:#ABB2BF;">(file_path):  </span><span style="color:#7F848E;font-style:italic;"># ç¡®ä¿æ˜¯æ–‡ä»¶è€Œä¸æ˜¯ç›®å½•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–æ–‡ä»¶æ‰©å±•å</span></span>
<span class="line"><span style="color:#ABB2BF;"> _, extension </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(filename)</span></span>
<span class="line"><span style="color:#ABB2BF;"> extension </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> extension.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># å°†æ‰©å±•åè½¬æ¢ä¸ºå°å†™ï¼Œä»¥é¿å…å¤§å°å†™å·®å¼‚å¯¼è‡´çš„åˆ†ç±»é”™è¯¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ç¡®å®šç›®æ ‡æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> extension </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> extension_folders:</span></span>
<span class="line"><span style="color:#ABB2BF;"> destination_folder </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">extension_folders[extension]</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> destination_folder </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path, extension[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:]) </span><span style="color:#7F848E;font-style:italic;"># ç§»é™¤æ‰©å±•åå‰çš„ç‚¹å¹¶åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(destination_folder,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> extension_folders[extension] </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">destination_folder</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è®¡ç®—æ–‡ä»¶å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_hash </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">get_file_hash</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦é‡å¤</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> file_hash </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> file_hashes:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ–‡ä»¶æ˜¯é‡å¤çš„ï¼Œå°†å…¶ç§»åŠ¨åˆ°â€œDuplicatesâ€æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;"> shutil.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(file_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(duplicates_folder, filename))</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å°†é‡å¤æ–‡ä»¶ </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">ç§»åŠ¨åˆ° Duplicates æ–‡ä»¶å¤¹ã€‚</span><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å­˜å‚¨æ–‡ä»¶å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> file_hashes[file_hash] </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">filename</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;"> shutil.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(file_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">destination_folder)</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;å°† </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> ç§»åŠ¨åˆ°</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">destination_folder</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¦‚æœè¿™ä¸ªè„šæœ¬è¢«ç›´æ¥è¿è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span></span>
<span class="line"><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> folder_path</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¯·è¾“å…¥æ‚¨è¦æ•´ç†çš„æ–‡ä»¶å¤¹è·¯å¾„:</span></span>
<span class="line"><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#61AFEF;"> organize_and_move_duplicates</span><span style="color:#ABB2BF;">(folder_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715066085164-182.BWTQyKIj.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1715066085164-183.Bl24ruLA.webp" alt="å›¾ç‰‡"></p><h2 id="_10è¡Œä»£ç å®ç°æ‰€æœ‰è¡¨æ ¼è‡ªåŠ¨åŒ–æˆªå›¾" tabindex="-1">10è¡Œä»£ç å®ç°æ‰€æœ‰è¡¨æ ¼è‡ªåŠ¨åŒ–æˆªå›¾ <a class="header-anchor" href="#_10è¡Œä»£ç å®ç°æ‰€æœ‰è¡¨æ ¼è‡ªåŠ¨åŒ–æˆªå›¾" aria-label="Permalink to &quot;10è¡Œä»£ç å®ç°æ‰€æœ‰è¡¨æ ¼è‡ªåŠ¨åŒ–æˆªå›¾&quot;">â€‹</a></h2><h3 id="ä¸€ã€é—®é¢˜ç—›ç‚¹-æ¯æ—¥æ•°æ®æˆªå›¾-ç¹çä¸”è€—æ—¶" tabindex="-1">ä¸€ã€é—®é¢˜ç—›ç‚¹ï¼šæ¯æ—¥æ•°æ®æˆªå›¾ï¼Œç¹çä¸”è€—æ—¶ <a class="header-anchor" href="#ä¸€ã€é—®é¢˜ç—›ç‚¹-æ¯æ—¥æ•°æ®æˆªå›¾-ç¹çä¸”è€—æ—¶" aria-label="Permalink to &quot;ä¸€ã€é—®é¢˜ç—›ç‚¹ï¼šæ¯æ—¥æ•°æ®æˆªå›¾ï¼Œç¹çä¸”è€—æ—¶&quot;">â€‹</a></h3><p>ä½ æ˜¯å¦ä¹Ÿæ›¾ç»å†è¿‡è¿™æ ·çš„åœºæ™¯ï¼šä½œä¸ºæ‰“å·¥äººï¼Œæ¯å¤©éƒ½éœ€è¦æ±‡æ€»å½“å¤©å…¬å¸è¿è¥æƒ…å†µå¦‚ï¼šé”€å”®æƒ…å†µå’Œåº“å­˜æƒ…å†µç­‰ï¼Œç„¶åä¸€å¼ ä¸€å¼ åœ°å°†è¡¨æ ¼æˆªå›¾å‘å¾®ä¿¡ç»™è€æ¿çœ‹ã€‚è¿™æ ·çš„å·¥ä½œæµç¨‹ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚æ¯å½“æœ‰æ–°çš„è¡¨æ ¼éœ€è¦æ±‡æ€»æ—¶ï¼Œéƒ½éœ€è¦é‡æ–°è¿›è¡Œæˆªå›¾æ“ä½œï¼Œç®€ç›´æ˜¯é‡å¤åŠ³åŠ¨çš„å™©æ¢¦ã€‚</p><p>éœ€è¦å°†Excelè½¬ä¸ºå›¾ç‰‡ï¼Œè¯´ç™½äº†å°±æ˜¯éœ€è¦å°†è¡¨æ ¼è¿›è¡Œè‡ªåŠ¨åŒ–æˆªå›¾ã€‚</p><h3 id="äºŒã€è§£å†³æ–¹æ¡ˆ-pythonè‡ªåŠ¨åŒ–åŠå…¬-åè¡Œä»£ç è§£å†³ç¹ç" tabindex="-1">äºŒã€è§£å†³æ–¹æ¡ˆï¼šPythonè‡ªåŠ¨åŒ–åŠå…¬ï¼Œåè¡Œä»£ç è§£å†³ç¹ç <a class="header-anchor" href="#äºŒã€è§£å†³æ–¹æ¡ˆ-pythonè‡ªåŠ¨åŒ–åŠå…¬-åè¡Œä»£ç è§£å†³ç¹ç" aria-label="Permalink to &quot;äºŒã€è§£å†³æ–¹æ¡ˆï¼šPythonè‡ªåŠ¨åŒ–åŠå…¬ï¼Œåè¡Œä»£ç è§£å†³ç¹ç&quot;">â€‹</a></h3><p>åœ¨è¿™ä¸ªç§‘æŠ€æ—¥æ–°æœˆå¼‚çš„æ—¶ä»£ï¼Œæˆ‘ä»¬ä¸ºä½•è¿˜è¦è¢«è¿™ç§ç¹ççš„å·¥ä½œæ‰€æŸç¼šå‘¢ï¼ŸPythonï¼Œä½œä¸ºä¸€ç§å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç»ä½³çš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡Pythonçš„è‡ªåŠ¨åŒ–åŠå…¬åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°è¡¨æ ¼æˆªå›¾çš„è‡ªåŠ¨åŒ–å¤„ç†ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å°†ä¸ºä½ å±•ç¤ºä¸€æ®µä»…éœ€åè¡Œä»£ç çš„Pythonä»£ç ï¼Œè®©ä½ è½»æ¾å®ç°è¡¨æ ¼æ•°æ®æˆªå›¾çš„è‡ªåŠ¨åŒ–å¤„ç†ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> excel2img</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> out_img</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">excel_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">sheet_list</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å¼€å§‹æˆªå›¾ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚ã€‚ã€‚&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(sheet_list)):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # sheet_list[i] + &quot;.png&quot; ä¸ºä¿å­˜çš„å›¾ç‰‡åç§°ï¼ˆä»¥sheetåç§°.pngå‘½åï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">            excel2img.</span><span style="color:#61AFEF;">export_img</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                excel_file, sheet_list[i] </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;.png&quot;</span><span style="color:#ABB2BF;">, sheet_list[i], </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æˆªå›¾å¤±è´¥ï¼&quot;</span><span style="color:#ABB2BF;">, e)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">    file</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;mergeEx.xlsx&#39;</span></span>
<span class="line"><span style="color:#C678DD;">    from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sheet_names </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.</span><span style="color:#61AFEF;">get_sheet_names</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è·å¾—å·¥ä½œç°¿çš„æ‰€æœ‰å·¥ä½œè¡¨å</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(sheet_names)</span></span>
<span class="line"><span style="color:#61AFEF;">    out_img</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">, sheet_names)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="ä¸‰ã€æ•ˆæœå±•ç¤º-ç§’çº§å®ç°æˆªå›¾-æ•ˆç‡ç¿»å€" tabindex="-1">ä¸‰ã€æ•ˆæœå±•ç¤ºï¼šç§’çº§å®ç°æˆªå›¾ï¼Œæ•ˆç‡ç¿»å€ <a class="header-anchor" href="#ä¸‰ã€æ•ˆæœå±•ç¤º-ç§’çº§å®ç°æˆªå›¾-æ•ˆç‡ç¿»å€" aria-label="Permalink to &quot;ä¸‰ã€æ•ˆæœå±•ç¤ºï¼šç§’çº§å®ç°æˆªå›¾ï¼Œæ•ˆç‡ç¿»å€&quot;">â€‹</a></h3><p>é€šè¿‡è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå¯ä»¥è½»æ¾å®ç°è¡¨æ ¼æ•°æ®æˆªå›¾çš„è‡ªåŠ¨åŒ–å¤„ç†ã€‚æ— è®ºæ–‡ä»¶ä¸­æœ‰å¤šå°‘ä¸ªSheetè¡¨æ ¼éœ€è¦æˆªå›¾ï¼Œåªéœ€ä¸€é”®è¿è¡ŒPythonè„šæœ¬ï¼Œå³å¯åœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆå¯¹åº”çš„æˆªå›¾æ–‡ä»¶ã€‚è¿™æ ·çš„æ“ä½œä¸ä»…å¤§å¤§æé«˜äº†å·¥ä½œæ•ˆç‡ï¼Œè€Œä¸”å‡å°‘äº†å‡ºé”™çš„å¯èƒ½æ€§ã€‚</p><h2 id="æ‰¹é‡å»é™¤ç”µè„‘ä¸­çš„é‡å¤å›¾åƒ" tabindex="-1">æ‰¹é‡å»é™¤ç”µè„‘ä¸­çš„é‡å¤å›¾åƒ <a class="header-anchor" href="#æ‰¹é‡å»é™¤ç”µè„‘ä¸­çš„é‡å¤å›¾åƒ" aria-label="Permalink to &quot;æ‰¹é‡å»é™¤ç”µè„‘ä¸­çš„é‡å¤å›¾åƒ&quot;">â€‹</a></h2><p>åœ¨æ•°å­—åŒ–æ—¶ä»£ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å›¾åƒæ–‡ä»¶å¤§é‡å †ç§¯çš„æƒ…å†µï¼Œå…¶ä¸­ä¸ä¹é‡å¤çš„å›¾ç‰‡ã€‚è¿™äº›é‡å¤çš„å›¾ç‰‡ä¸ä»…å ç”¨äº†å®è´µçš„å­˜å‚¨ç©ºé—´ï¼Œè¿˜ä½¿å¾—æ–‡ä»¶ç®¡ç†å’Œå¤‡ä»½å˜å¾—ç¹çã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Python ç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥è‡ªåŠ¨æ£€æµ‹å’Œåˆ é™¤é‡å¤çš„å›¾åƒæ–‡ä»¶ã€‚</p><h3 id="å‡†å¤‡å·¥ä½œ" tabindex="-1">å‡†å¤‡å·¥ä½œ <a class="header-anchor" href="#å‡†å¤‡å·¥ä½œ" aria-label="Permalink to &quot;å‡†å¤‡å·¥ä½œ&quot;">â€‹</a></h3><p>åœ¨å¼€å§‹ç¼–å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å·²ç»å®‰è£…äº† Python ç¯å¢ƒï¼Œå¹¶å®‰è£…äº†ä¸€ä¸ªç”¨äºæ¯”è¾ƒå›¾åƒç›¸ä¼¼åº¦çš„åº“ï¼Œå¦‚<code>imagehash</code>å’Œ<code>Pillow</code>ï¼ˆPIL çš„åˆ†æ”¯ï¼‰ã€‚è¿™ä¸¤ä¸ªåº“å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆå›¾åƒçš„å“ˆå¸Œå€¼ï¼Œå¹¶åŸºäºè¿™äº›å“ˆå¸Œå€¼æ¥æ¯”è¾ƒå›¾åƒçš„ç›¸ä¼¼æ€§ã€‚</p><p>ä½ å¯ä»¥ä½¿ç”¨ pip æ¥å®‰è£…è¿™ä¸¤ä¸ªåº“ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install imagehash pillow</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="ç¼–å†™ä»£ç " tabindex="-1">ç¼–å†™ä»£ç  <a class="header-anchor" href="#ç¼–å†™ä»£ç " aria-label="Permalink to &quot;ç¼–å†™ä»£ç &quot;">â€‹</a></h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ Python è„šæœ¬ï¼Œç”¨äºæŸ¥æ‰¾å¹¶åˆ é™¤é‡å¤çš„å›¾åƒæ–‡ä»¶ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> imagehash</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> itertools </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> combinations</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> image_hash</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    hash_object </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> imagehash.</span><span style="color:#61AFEF;">average_hash</span><span style="color:#ABB2BF;">(Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(file_path))</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> hash_object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> find_duplicate_images</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    images </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [f </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> f </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(directory) </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">isfile</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory, f)) </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> f.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">((</span><span style="color:#98C379;">&#39;.png&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.jpg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.jpeg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.gif&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.bmp&#39;</span><span style="color:#ABB2BF;">))]</span></span>
<span class="line"><span style="color:#ABB2BF;">    hashes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {f: </span><span style="color:#61AFEF;">image_hash</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory, f)) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> f </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> images}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    duplicates </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> img1, img2 </span><span style="color:#C678DD;">in</span><span style="color:#61AFEF;"> combinations</span><span style="color:#ABB2BF;">(images, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> hashes[img1] </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> hashes[img2] </span><span style="color:#56B6C2;">&lt;</span><span style="color:#D19A66;"> 5</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># è®¾å®šä¸€ä¸ªé˜ˆå€¼æ¥åˆ¤æ–­æ˜¯å¦ç›¸ä¼¼</span></span>
<span class="line"><span style="color:#ABB2BF;">            duplicates.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">((img1, img2))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> duplicates</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> remove_duplicates</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">duplicates</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> img1, img2 </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> duplicates:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å‡è®¾æˆ‘ä»¬ä¿ç•™ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ é™¤ç¬¬äºŒä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">        os.</span><span style="color:#61AFEF;">remove</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory, img2))</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Removed duplicate: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">img2</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#ABB2BF;">directory </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;path/to/your/image/directory&#39;</span><span style="color:#7F848E;font-style:italic;">  # æ›¿æ¢ä¸ºä½ çš„å›¾åƒç›®å½•</span></span>
<span class="line"><span style="color:#ABB2BF;">duplicates </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> find_duplicate_images</span><span style="color:#ABB2BF;">(directory)</span></span>
<span class="line"><span style="color:#61AFEF;">remove_duplicates</span><span style="color:#ABB2BF;">(directory, duplicates)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>æ³¨æ„ï¼šè¿™ä¸ªè„šæœ¬ä½¿ç”¨äº†ç®€å•çš„å¹³å‡å“ˆå¸Œç®—æ³•æ¥æ¯”è¾ƒå›¾åƒï¼Œå¹¶è®¾å®šäº†ä¸€ä¸ªé˜ˆå€¼ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ 5ï¼‰æ¥åˆ¤æ–­ä¸¤ä¸ªå“ˆå¸Œå€¼æ˜¯å¦è¶³å¤Ÿæ¥è¿‘ï¼Œä»è€Œè®¤ä¸ºå›¾åƒæ˜¯ç›¸ä¼¼çš„ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çš„å‡†ç¡®æ€§å¯èƒ½å› å›¾åƒè´¨é‡å’Œå†…å®¹çš„å¤æ‚æ€§è€Œæœ‰æ‰€ä¸åŒã€‚ä½ å¯èƒ½éœ€è¦æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚æ¥è°ƒæ•´è¿™ä¸ªé˜ˆå€¼ã€‚</p><p>æ­¤å¤–ï¼Œè¿™ä¸ªè„šæœ¬ä¼šåˆ é™¤æ‰€æœ‰ç›¸ä¼¼çš„å›¾åƒä¸­çš„ç¬¬äºŒä¸ªå›¾åƒï¼Œä¿ç•™ç¬¬ä¸€ä¸ªå›¾åƒã€‚å¦‚æœä½ æƒ³è¦æ›´å¤æ‚çš„é€»è¾‘ï¼ˆä¾‹å¦‚ï¼Œåªåˆ é™¤å®Œå…¨ç›¸åŒçš„å›¾åƒï¼Œæˆ–è€…åŸºäºæŸç§ç­–ç•¥æ¥é€‰æ‹©è¦ä¿ç•™çš„å›¾åƒï¼‰ï¼Œä½ éœ€è¦åœ¨ remove_duplicates å‡½æ•°ä¸­æ·»åŠ æ›´å¤šçš„é€»è¾‘ã€‚</p><p>æœ€åï¼Œè¿™ä¸ªè„šæœ¬å¹¶æ²¡æœ‰æä¾›å¤‡ä»½æˆ–æ’¤é”€åˆ é™¤çš„é€‰é¡¹ï¼Œå› æ­¤è¯·ç¡®ä¿åœ¨è¿è¡Œè„šæœ¬ä¹‹å‰å¤‡ä»½ä½ çš„å›¾åƒæ–‡ä»¶ï¼Œä»¥é˜²æ­¢è¯¯åˆ é™¤é‡è¦æ–‡ä»¶ã€‚</p><h3 id="ä»£ç å®æˆ˜" tabindex="-1">ä»£ç å®æˆ˜ <a class="header-anchor" href="#ä»£ç å®æˆ˜" aria-label="Permalink to &quot;ä»£ç å®æˆ˜&quot;">â€‹</a></h3><p><img src="/ProgramLearnNotes/assets/image-20240511163904249.CLM0lYvO.png" alt="image-20240511163904249"></p><p>æˆ‘æœ‰ä¸€æ‰¹å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡éƒ½è¢«å¤‡ä»½äº†ä¸¤æ¬¡ï¼Œåˆ©ç”¨ä»¥ä¸Šä»£ç è¯†åˆ«å‡ºé‡å¤å›¾ç‰‡</p><p><img src="/ProgramLearnNotes/assets/image-20240511163922849.Bja4wW3s.png" alt="image-20240511163922849"></p><p>åˆ é™¤å›¾ç‰‡åï¼Œæ‰€æœ‰çš„å›¾ç‰‡éƒ½åªå‰©ä¸‹ä¸€å¼ åŸå›¾</p><p><img src="/ProgramLearnNotes/assets/image-20240511163942229.2S7_d-Xw.png" alt="image-20240511163942229"></p><h2 id="å®ç°ä»-word-åˆ°-excel-çš„æ•°æ®æå–ä¸è½¬æ¢" tabindex="-1">å®ç°ä» Word åˆ° Excel çš„æ•°æ®æå–ä¸è½¬æ¢ <a class="header-anchor" href="#å®ç°ä»-word-åˆ°-excel-çš„æ•°æ®æå–ä¸è½¬æ¢" aria-label="Permalink to &quot;å®ç°ä» Word åˆ° Excel çš„æ•°æ®æå–ä¸è½¬æ¢&quot;">â€‹</a></h2><p>åœ¨æ•°å­—åŒ–åŠå…¬çš„æµªæ½®ä¸­ï¼Œæ•°æ®çš„é«˜æ•ˆå¤„ç†ä¸è½¬æ¢å·²æˆä¸ºä¼ä¸šå’Œæ•™è‚²æœºæ„ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ é¢å¯¹æˆç™¾ä¸Šåƒçš„ Word æ–‡æ¡£ï¼Œéœ€è¦ä»ä¸­æå–å…³é”®ä¿¡æ¯å¹¶æ•´ç†åˆ° Excel è¡¨æ ¼ä¸­è¿›è¡Œæ·±å…¥åˆ†ææ—¶ï¼Œæ‰‹åŠ¨æ“ä½œä¸ä»…è€—æ—¶è´¹åŠ›ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚ç°åœ¨ï¼Œå€ŸåŠ© Python çš„å¼ºå¤§åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°è¿™ä¸€è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ï¼Œæé«˜æ•°æ®å¤„ç†æ•ˆç‡ï¼Œå‡å°‘äººä¸ºé”™è¯¯ã€‚</p><h3 id="æ­£æ–‡" tabindex="-1">æ­£æ–‡ï¼š <a class="header-anchor" href="#æ­£æ–‡" aria-label="Permalink to &quot;æ­£æ–‡ï¼š&quot;">â€‹</a></h3><p>åœ¨ä¼ä¸šè¿è¥å’Œå­¦æœ¯ç ”ç©¶ä¸­ï¼Œç»å¸¸éœ€è¦ä» Word æ–‡æ¡£ä¸­æå–æ–‡æœ¬æ•°æ®ï¼Œå¹¶æ•´ç†åˆ° Excel è¡¨æ ¼ä¸­è¿›è¡Œåç»­çš„åˆ†æå’ŒæŠ¥å‘Šã€‚ä¾‹å¦‚ï¼Œä»åˆåŒã€æŠ¥å‘Šæˆ–è°ƒæŸ¥è¡¨æ ¼ä¸­æå–å…³é”®ä¿¡æ¯ï¼Œæ˜¯æ—¥å¸¸å·¥ä½œä¸­çš„å¸¸è§éœ€æ±‚ã€‚é€šè¿‡è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥æ˜¾è‘—æé«˜æ•°æ®å¤„ç†æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚</p><h3 id="æŠ€æœ¯å®ç°" tabindex="-1">æŠ€æœ¯å®ç°ï¼š <a class="header-anchor" href="#æŠ€æœ¯å®ç°" aria-label="Permalink to &quot;æŠ€æœ¯å®ç°ï¼š&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šåŒ…å«éœ€è¦æå–çš„æ–‡æœ¬æ•°æ®çš„ Word æ–‡æ¡£ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>ä½¿ç”¨<code>python-docx</code>åº“è¯»å– Word æ–‡æ¡£ä¸­çš„æ–‡æœ¬ã€‚</li><li>ä½¿ç”¨<code>openpyxl</code>æˆ–<code>pandas</code>åº“å°†æå–çš„æ•°æ®å†™å…¥ Excelã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šåŒ…å« Word æ–‡æ¡£æ•°æ®çš„ Excel æ–‡ä»¶ã€‚</p></li></ul><p><strong>å®æˆ˜æ“ä½œ</strong>ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Word æ–‡æ¡£ï¼Œå…¶ä¸­åŒ…å«å¤šä¸ªéƒ¨åˆ†çš„æ ‡é¢˜å’Œå¯¹åº”çš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›å†…å®¹æå–åˆ° Excel çš„ä¸åŒå•å…ƒæ ¼ä¸­ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·ä½“çš„ Python è„šæœ¬ç¤ºä¾‹ï¼Œç”¨äºå®ç°è¿™ä¸€éœ€æ±‚ï¼š</p><h3 id="python-è„šæœ¬" tabindex="-1">Python è„šæœ¬ï¼š <a class="header-anchor" href="#python-è„šæœ¬" aria-label="Permalink to &quot;Python è„šæœ¬ï¼š&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Document</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> extract_text_from_word</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">doc_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½Wordæ–‡æ¡£</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Document</span><span style="color:#ABB2BF;">(doc_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æå–æ¯ä¸ªæ®µè½çš„æ–‡æœ¬</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> para </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> doc.paragraphs:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> para.text:  </span><span style="color:#7F848E;font-style:italic;"># ç¡®ä¿æ®µè½åŒ…å«æ–‡æœ¬</span></span>
<span class="line"><span style="color:#ABB2BF;">            data.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(para.text)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> save_data_to_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">excel_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åˆ›å»ºDataFrame</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">(data, </span><span style="color:#E06C75;font-style:italic;">columns</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;Text&quot;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜åˆ°Excel</span></span>
<span class="line"><span style="color:#ABB2BF;">    df.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(excel_path, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Wordæ–‡æ¡£è·¯å¾„å’ŒExcelæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">doc_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;example.docx&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">excel_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;output.xlsx&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æå–Wordå†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">extracted_data </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> extract_text_from_word</span><span style="color:#ABB2BF;">(doc_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¿å­˜åˆ°Excel</span></span>
<span class="line"><span style="color:#61AFEF;">save_data_to_excel</span><span style="color:#ABB2BF;">(extracted_data, excel_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="æ€»ç»“" tabindex="-1"><strong>æ€»ç»“</strong>ï¼š <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;**æ€»ç»“**ï¼š&quot;">â€‹</a></h3><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä½•åˆ©ç”¨<code>python-docx</code>å’Œ<code>pandas</code>åº“ï¼Œè½»æ¾å®ç°ä» Word æ–‡æ¡£ä¸­æå–æ–‡æœ¬æ•°æ®ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ° Excel æ–‡ä»¶ä¸­çš„è‡ªåŠ¨åŒ–è¿‡ç¨‹ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºéœ€è¦ä»å¤§é‡æ–‡æ¡£ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯å¹¶è¿›è¡Œè¿›ä¸€æ­¥æ•°æ®åˆ†ææˆ–æŠ¥å‘Šçš„åœºæ™¯ã€‚é€šè¿‡è‡ªåŠ¨åŒ–ä» Word åˆ° Excel çš„æ•°æ®è½¬ç§»ï¼Œç”¨æˆ·å¯ä»¥èŠ‚çœå¤§é‡çš„æ‰‹åŠ¨æ•°æ®å½•å…¥æ—¶é—´ï¼Œå¹¶å‡å°‘å› äººå·¥å¤„ç†å¯¼è‡´çš„é”™è¯¯ã€‚</p><h2 id="ä¸€è¡Œä»£ç å®ç°-pdf-è½¬ä¸º-word" tabindex="-1">ä¸€è¡Œä»£ç å®ç° PDF è½¬ä¸º Word <a class="header-anchor" href="#ä¸€è¡Œä»£ç å®ç°-pdf-è½¬ä¸º-word" aria-label="Permalink to &quot;ä¸€è¡Œä»£ç å®ç° PDF è½¬ä¸º Word&quot;">â€‹</a></h2><p>åœ¨æ—¥å¸¸çš„åŠå…¬åœºæ™¯ä¸­ï¼ŒPDF æ–‡ä»¶å› å…¶ä¼˜ç§€çš„æ’ç‰ˆæ•ˆæœå’Œå…¼å®¹æ€§ï¼Œæˆä¸ºäº†æ–‡æ¡£äº¤æ¢çš„å¸¸ç”¨æ ¼å¼ã€‚ç„¶è€Œï¼ŒPDF æ–‡ä»¶çš„ä¸€ä¸ªæ˜¾è‘—ç¼ºç‚¹æ˜¯å…¶å¯ç¼–è¾‘æ€§æä½ï¼Œä¸€æ—¦æˆ‘ä»¬éœ€è¦å¯¹å…¶ä¸­çš„å†…å®¹è¿›è¡Œä¿®æ”¹æˆ–å¤åˆ¶ç²˜è´´æ—¶ï¼Œå°±ä¼šé¢ä¸´è¯¸å¤šä¸ä¾¿ã€‚è¿™æ—¶ï¼Œå°† PDF æ–‡ä»¶è½¬æ¢ä¸º Word æ ¼å¼å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œå› ä¸º Word æ–‡æ¡£ä¸ä»…æ˜“äºç¼–è¾‘ï¼Œè¿˜æ”¯æŒå„ç§æ ¼å¼è°ƒæ•´å’Œæ–‡æœ¬æ“ä½œã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼ŒPython è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç®€å•é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ Python çš„ç¬¬ä¸‰æ–¹åº“ pdf2docxï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è„šæœ¬ï¼Œä»…éœ€ä¸€è¡Œä»£ç å°±å¯ä»¥å®ç° PDF åˆ° Word çš„è‡ªåŠ¨è½¬æ¢ï¼Œä»è€Œå¤§å¤§æé«˜å·¥ä½œæ•ˆç‡ï¼Œå‡å°‘å› æ‰‹åŠ¨æ“ä½œå¸¦æ¥çš„é”™è¯¯<code>ã€‚</code></p><h3 id="åœºæ™¯åˆ†æ" tabindex="-1">åœºæ™¯åˆ†æ <a class="header-anchor" href="#åœºæ™¯åˆ†æ" aria-label="Permalink to &quot;åœºæ™¯åˆ†æ&quot;">â€‹</a></h3><p>æˆ‘ä»¬ç»å¸¸éœ€è¦å¤åˆ¶æˆ–å€Ÿé‰´ç½‘ä¸Šä¸‹è½½çš„ PDF æ–‡æ¡£å†…å®¹ï¼Œæ¯”å¦‚è¡Œæ”¿äººå‘˜å¯èƒ½éœ€è¦å‚è€ƒå…¶ä»–å…¬å¸çš„åˆ¶åº¦æµç¨‹ï¼Œè€Œå­¦ç”Ÿåˆ™å¯èƒ½éœ€è¦å€Ÿé‰´å·²ç»å‘è¡¨çš„è®ºæ–‡èµ„æ–™ã€‚ç„¶è€Œï¼Œç›´æ¥å¤åˆ¶ PDF æ–‡æ¡£çš„å†…å®¹å¾€å¾€ä¼šå‡ºç°æ ¼å¼é”™ä¹±ã€æ–‡å­—ä¸¢å¤±æˆ–ä¹±ç ç­‰é—®é¢˜ï¼Œè¿™ç»™æˆ‘ä»¬çš„å·¥ä½œå’Œå­¦ä¹ å¸¦æ¥äº†æå¤§çš„ä¸ä¾¿ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511164342838.C-9dWmLR.png" alt="image-20240511164342838"></p><h3 id="æ•°æ®åˆ†æ" tabindex="-1">æ•°æ®åˆ†æ <a class="header-anchor" href="#æ•°æ®åˆ†æ" aria-label="Permalink to &quot;æ•°æ®åˆ†æ&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šPDF æ–‡æ¡£</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>ä½¿ç”¨<code>pdf2docx</code>åº“è¯»å– PDF çš„å†…å®¹ã€‚</li><li>æå–æ¯ä¸€é¡µçš„æ–‡å­—</li><li>å°†æ–‡æœ¬å­˜å‚¨åˆ° word æ–‡æ¡£ä¸­</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰æŠ¥å‘Šçš„åˆå¹¶æ–‡æ¡£ã€‚</p></li></ul><h3 id="å®æˆ˜ä»£ç " tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç " aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pdf2docx</span></span>
<span class="line"><span style="color:#ABB2BF;">pdf2docx.</span><span style="color:#61AFEF;">parse</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ä¸€å¥é¡¶ä¸€ä¸‡å¥.pdf&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;output_word.docx&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240511164423298.DPiLbdvd.png" alt="image-20240511164423298"></p><h3 id="æ€»ç»“-1" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-1" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>å°† PDF è½¬æ¢ä¸º Word åï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å¯¹æ–‡æ¡£è¿›è¡Œç¼–è¾‘ã€ä¿®æ”¹å’Œå¤åˆ¶ç²˜è´´ã€‚æ— è®ºæ˜¯è°ƒæ•´æ–‡æœ¬å†…å®¹ã€æ›´æ”¹æ ¼å¼è¿˜æ˜¯æ·»åŠ æ³¨é‡Šï¼Œéƒ½å˜å¾—ç®€å•å¿«æ·ã€‚æ­¤å¤–ï¼ŒWord æ–‡æ¡£è¿˜æ”¯æŒä¸°å¯Œçš„æ–‡æœ¬æ ·å¼å’Œæ’ç‰ˆåŠŸèƒ½ï¼Œä½¿å¾—æ–‡æ¡£æ›´åŠ ç¾è§‚æ˜“è¯»ã€‚</p><p>Python è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿å¿«æ·çš„ PDF åˆ° Word è½¬æ¢æ–¹æ¡ˆã€‚é€šè¿‡ç¼–å†™ç®€å•çš„ Python è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç° PDF æ–‡ä»¶çš„è‡ªåŠ¨è½¬æ¢å’Œç¼–è¾‘å¤„ç†ï¼Œä»è€Œå¤§å¤§æé«˜å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚</p><h2 id="ä¸€é”®ä»-pdf-ä¸­æ‰¹é‡æå–-excel-è¡¨æ ¼" tabindex="-1">ä¸€é”®ä» PDF ä¸­æ‰¹é‡æå– Excel è¡¨æ ¼ <a class="header-anchor" href="#ä¸€é”®ä»-pdf-ä¸­æ‰¹é‡æå–-excel-è¡¨æ ¼" aria-label="Permalink to &quot;ä¸€é”®ä» PDF ä¸­æ‰¹é‡æå– Excel è¡¨æ ¼&quot;">â€‹</a></h2><p>åœ¨å½“ä»Šé«˜æ•ˆã€å¿«é€Ÿçš„å·¥ä½œç¯å¢ƒä¸­ï¼Œè‡ªåŠ¨åŒ–åŠå…¬å·²æˆä¸ºæé«˜å·¥ä½œæ•ˆç‡ã€èŠ‚çœæ—¶é—´æˆæœ¬çš„å¿…å¤‡æŠ€èƒ½ã€‚Pythonï¼Œä½œä¸ºä¸€ç§å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ï¼Œå‡­å€Ÿå…¶ä¸°å¯Œçš„åº“å’Œå¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œåœ¨è‡ªåŠ¨åŒ–åŠå…¬é¢†åŸŸå¤§æ”¾å¼‚å½©ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åˆ©ç”¨ Python å®ç°ä» PDF ä¸­è‡ªåŠ¨æ‰¹é‡æå– Excel è¡¨æ ¼çš„åŠŸèƒ½ï¼Œè®©åŠå…¬å˜å¾—æ›´åŠ è½»æ¾ã€é«˜æ•ˆã€‚</p><p>åœ¨æ—¥å¸¸åŠå…¬ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†å¤§é‡çš„ PDF æ–‡ä»¶ï¼Œå¦‚ç½‘ä¸Šä¸‹è½½çš„å‚è€ƒèµ„æ–™ã€åŒäº‹æˆ–é¢†å¯¼å‘é€çš„å·¥ä½œäº¤æ¥æ–‡ä»¶ç­‰ã€‚ç„¶è€Œï¼ŒPDF æ–‡ä»¶çš„å¯ç¼–è¾‘æ€§å¹¶ä¸é«˜ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä»ä¸­æå–æ•°æ®å¹¶ç¼–è¾‘ï¼Œé€šå¸¸åªèƒ½ä¾èµ–æ‰‹åŠ¨å¤åˆ¶ç²˜è´´çš„æ–¹å¼ï¼Œè¿™ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚Python è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯çš„å¼•å…¥ï¼Œå¯ä»¥æå¤§åœ°æ”¹å–„è¿™ä¸€é—®é¢˜ã€‚é€šè¿‡ç¼–å†™ Python è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€é”®å¼æ‰¹é‡å¤„ç† PDF æ–‡ä»¶ï¼Œè‡ªåŠ¨æå–å…¶ä¸­çš„è¡¨æ ¼æ•°æ®ï¼Œå¹¶è½¬æ¢ä¸º Excel æ ¼å¼ï¼Œæå¤§åœ°æé«˜äº†å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚</p><h3 id="åœºæ™¯åˆ†æ-1" tabindex="-1">åœºæ™¯åˆ†æ <a class="header-anchor" href="#åœºæ™¯åˆ†æ-1" aria-label="Permalink to &quot;åœºæ™¯åˆ†æ&quot;">â€‹</a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ‹¥æœ‰æ•°åç”šè‡³æ•°ç™¾ä¸ªéœ€è¦è¡¨æ ¼çš„ PDF æ–‡æ¡£ã€‚æ‰‹åŠ¨å¤åˆ¶ç²˜è´´è¿™äº›è¡¨æ ¼ï¼Œæ— ç–‘æ˜¯ä¸€é¡¹ç¹çä¸”å®¹æ˜“å‡ºé”™çš„ä»»åŠ¡ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511164510019.CiIshtl7.png" alt="image-20240511164510019"></p><h3 id="æ•°æ®å¤„ç†æµç¨‹" tabindex="-1">æ•°æ®å¤„ç†æµç¨‹ <a class="header-anchor" href="#æ•°æ®å¤„ç†æµç¨‹" aria-label="Permalink to &quot;æ•°æ®å¤„ç†æµç¨‹&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šåŒ…å«å¤šä¸ªè¡¨æ ¼çš„ PDF æ–‡æ¡£ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>ä½¿ç”¨<code>tabula-py</code>åº“è¯»å–æ–‡æ¡£ä¸­çš„è¡¨æ ¼</li><li>éå†è¡¨æ ¼å¹¶ç”¨ pandas è½¬åŒ–ä¸º DataFrame å½¢å¼</li><li>å°† DataFrame æ ¼å¼ä¿å­˜åˆ° Excel ä¸­ã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šæ–‡æ¡£ä¸­æ‰€æœ‰è¡¨æ ¼çš„ Excel æ–‡ä»¶ã€‚</p></li></ul><h3 id="å®æˆ˜æ¼”ç»ƒ" tabindex="-1">å®æˆ˜æ¼”ç»ƒ <a class="header-anchor" href="#å®æˆ˜æ¼”ç»ƒ" aria-label="Permalink to &quot;å®æˆ˜æ¼”ç»ƒ&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> tabula</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># PDFæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">pdf_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;ä½ çš„å¾…æå–æ–‡æ¡£.pdf&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¯»å–PDFä¸­çš„æ‰€æœ‰è¡¨æ ¼</span></span>
<span class="line"><span style="color:#ABB2BF;">tables </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tabula.</span><span style="color:#61AFEF;">read_pdf</span><span style="color:#ABB2BF;">(pdf_path, </span><span style="color:#E06C75;font-style:italic;">pages</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;all&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">multiple_tables</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># éå†æ¯ä¸ªè¡¨æ ¼ï¼Œå¹¶è½¬æ¢ä¸ºpandas DataFrame</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i, table </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(tables):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">(table)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ¸…æ´—æ•°æ®ï¼Œæ ¹æ®å…·ä½“è¡¨æ ¼ç»“æ„å¯èƒ½éœ€è¦è¿›è¡Œé¢å¤–çš„å¤„ç†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¾‹å¦‚ï¼Œåˆ é™¤ç©ºè¡Œã€å¤„ç†åˆ—åç­‰</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # df = df.dropna(how=&#39;all&#39;)  # åˆ é™¤å…¨ç©ºè¡Œ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # df.columns = [&#39;Column1&#39;, &#39;Column2&#39;, ...]  # è®¾ç½®åˆ—å</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å°†æ¸…æ´—åçš„DataFrameä¿å­˜ä¸ºExcelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    excel_path </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;extracted_table_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">i</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.xlsx&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    df.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(excel_path, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240511164549862.Bl82llzD.png" alt="image-20240511164549862"></p><p><img src="/ProgramLearnNotes/assets/image-20240511164610981._Vw6aGfK.png" alt="image-20240511164610981"></p><h4 id="æ€»ç»“-2" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-2" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h4><p>Python è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯çš„å¼•å…¥ä¸ºæˆ‘ä»¬çš„å·¥ä½œå¸¦æ¥äº†æå¤§çš„ä¾¿åˆ©å’Œæ•ˆç‡æå‡ã€‚é€šè¿‡ç¼–å†™ Python è„šæœ¬å®ç° PDF åˆ° Excel çš„è‡ªåŠ¨è½¬æ¢åŠŸèƒ½åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªå°å°åº”ç”¨ç¤ºä¾‹ã€‚ç›¸ä¿¡åœ¨æœªæ¥çš„å·¥ä½œä¸­æˆ‘ä»¬è¿˜ä¼šå‘ç°æ›´å¤š Python è‡ªåŠ¨åŒ–åŠå…¬çš„ç¥å¥‡ä¹‹å¤„ï¼</p><h2 id="ä¸€é”®æ‰¹é‡æå–wordè¡¨æ ¼åˆ°excel" tabindex="-1">ä¸€é”®æ‰¹é‡æå–Wordè¡¨æ ¼åˆ°Excel <a class="header-anchor" href="#ä¸€é”®æ‰¹é‡æå–wordè¡¨æ ¼åˆ°excel" aria-label="Permalink to &quot;ä¸€é”®æ‰¹é‡æå–Wordè¡¨æ ¼åˆ°Excel&quot;">â€‹</a></h2><h3 id="å¯¼è¯­" tabindex="-1">å¯¼è¯­ <a class="header-anchor" href="#å¯¼è¯­" aria-label="Permalink to &quot;å¯¼è¯­&quot;">â€‹</a></h3><p>åœ¨ç¹å¿™çš„åŠå…¬ç¯å¢ƒä¸­ï¼Œæ–‡æ¡£å¤„ç†å¾€å¾€å æ®äº†å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ç‰¹åˆ«æ˜¯å½“é¢å¯¹å¤§é‡Wordæ–‡æ¡£ä¸­çš„è¡¨æ ¼æ•°æ®æ—¶ï¼Œæ‰‹åŠ¨å¤åˆ¶ç²˜è´´åˆ°Excelä¸­è¿›è¡Œæ•´ç†åˆ†æï¼Œä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚ç°åœ¨ï¼Œå€ŸåŠ©Pythonè‡ªåŠ¨åŒ–åŠå…¬çš„ç¥å¥‡åŠ›é‡ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°ä¸€é”®æ‰¹é‡æå–Wordæ–‡æ¡£ä¸­çš„è¡¨æ ¼åˆ°Excelï¼Œè®©åŠå…¬æ•ˆç‡ç¿»å€ï¼Œå‡†ç¡®æ€§ä¹Ÿå¤§å¹…æå‡ï¼</p><h3 id="åœºæ™¯åˆ†æ-2" tabindex="-1">åœºæ™¯åˆ†æ <a class="header-anchor" href="#åœºæ™¯åˆ†æ-2" aria-label="Permalink to &quot;åœºæ™¯åˆ†æ&quot;">â€‹</a></h3><p>åœ¨ä¸å°‘ä¼ä¸šä¸­ï¼Œæ–‡æ¡£ç®¡ç†æ˜¯ä¸€é¡¹é‡è¦çš„å·¥ä½œã€‚ç„¶è€Œï¼Œå½“æ¶‰åŠåˆ°å¤§é‡Wordæ–‡æ¡£ä¸­çš„è¡¨æ ¼æ•°æ®æ—¶ï¼Œä¼ ç»Ÿçš„å¤„ç†æ–¹å¼å°±æ˜¾å¾—æ‰è¥Ÿè§è‚˜ã€‚å‘˜å·¥ä»¬éœ€è¦æ‰‹åŠ¨æ‰“å¼€æ¯ä¸ªWordæ–‡æ¡£ï¼Œå¤åˆ¶è¡¨æ ¼å†…å®¹ï¼Œå†ç²˜è´´åˆ°Excelä¸­è¿›è¡Œæ•´ç†å’Œåˆ†æã€‚è¿™æ ·çš„å¤„ç†æ–¹å¼ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å®¹æ˜“åœ¨å¤åˆ¶ç²˜è´´è¿‡ç¨‹ä¸­å‡ºç°æ•°æ®ä¸¢å¤±æˆ–æ ¼å¼é”™ä¹±çš„é—®é¢˜ã€‚</p><h3 id="æ•°æ®å¤„ç†æµç¨‹-1" tabindex="-1">æ•°æ®å¤„ç†æµç¨‹ <a class="header-anchor" href="#æ•°æ®å¤„ç†æµç¨‹-1" aria-label="Permalink to &quot;æ•°æ®å¤„ç†æµç¨‹&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šåŒ…å«å¤šä¸ªè¡¨æ ¼çš„WORDæ–‡æ¡£ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>ä½¿ç”¨docxåº“è¯»å–WORDæ–‡æ¡£ï¼Œå¹¶è·å–è¡¨æ ¼</li><li>éå†è¡¨æ ¼å¹¶ç”¨openpyxl å°†è¡¨æ ¼å­˜å‚¨åœ¨Excelä¸­</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šæ–‡æ¡£ä¸­æ‰€æœ‰è¡¨æ ¼çš„Excelæ–‡ä»¶ã€‚</p></li></ul><h3 id="å®æˆ˜æ¼”ç»ƒ-1" tabindex="-1">å®æˆ˜æ¼”ç»ƒ <a class="header-anchor" href="#å®æˆ˜æ¼”ç»ƒ-1" aria-label="Permalink to &quot;å®æˆ˜æ¼”ç»ƒ&quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Document</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Workbook</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#è·å–å¾…å¤„ç†çš„æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">path</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;wordæ–‡ä»¶&#39;</span><span style="color:#7F848E;font-style:italic;">  #æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;">files </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [path</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(path)] </span><span style="color:#7F848E;font-style:italic;">#è·å–æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å,å¹¶æ‹¼æ¥å®Œæ•´è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> files:</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Document</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Workbook</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb.</span><span style="color:#61AFEF;">remove</span><span style="color:#ABB2BF;">(wb.worksheets[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span><span style="color:#7F848E;font-style:italic;">#åˆ é™¤å·¥ä½œç°¿è‡ªå¸¦çš„å·¥ä½œè¡¨</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> index, table </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(doc.tables, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">): </span><span style="color:#7F848E;font-style:italic;">#ä»1å¼€å§‹ç»™è¡¨æ ¼ç¼–å·</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.</span><span style="color:#61AFEF;">create_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Sheet</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">index</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">#åˆ›å»ºæ–°å·¥ä½œè¡¨ï¼Œä»¥&quot;Sheet&quot; + wordä¸­è¡¨æ ¼çš„ç¼–å·å‘½å</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(table.rows)): </span><span style="color:#7F848E;font-style:italic;">#éå†wordä¸­è¡¨æ ¼çš„æ‰€æœ‰è¡Œ</span></span>
<span class="line"><span style="color:#ABB2BF;">            row_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [] </span><span style="color:#7F848E;font-style:italic;">#å‚¨å­˜è¡¨æ ¼ä¸­æ¯è¡Œçš„æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> j </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(table.columns)): </span><span style="color:#7F848E;font-style:italic;">#éå†wordä¸­è¡¨æ ¼çš„æ‰€æœ‰åˆ—</span></span>
<span class="line"><span style="color:#ABB2BF;">                row_data.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(table.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(i,j).text)</span></span>
<span class="line"><span style="color:#ABB2BF;">            ws.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(row_data) </span><span style="color:#7F848E;font-style:italic;">#æ¯å–ä¸€è¡Œå°±å†™å…¥æ•°æ®åˆ°Excelè¡¨çš„è¡Œä¸­</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;excelæ–‡ä»¶</span><span style="color:#56B6C2;">\\</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;">.xlsx&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])) </span><span style="color:#7F848E;font-style:italic;">#ä¿å­˜excelæ–‡ä»¶</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240517185959561.k07n0VLw.png" alt="image-20240517185959561"></p><p><img src="/ProgramLearnNotes/assets/image-20240517190011652.Ccn-qdo5.png" alt="image-20240517190011652"></p><h3 id="è‡ªåŠ¨åŒ–åŠå…¬å¸¦æ¥çš„å˜åŒ–" tabindex="-1">è‡ªåŠ¨åŒ–åŠå…¬å¸¦æ¥çš„å˜åŒ– <a class="header-anchor" href="#è‡ªåŠ¨åŒ–åŠå…¬å¸¦æ¥çš„å˜åŒ–" aria-label="Permalink to &quot;è‡ªåŠ¨åŒ–åŠå…¬å¸¦æ¥çš„å˜åŒ–&quot;">â€‹</a></h3><p>é€šè¿‡Pythonè‡ªåŠ¨åŒ–åŠå…¬è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€é”®æ‰¹é‡æå–Wordæ–‡æ¡£ä¸­çš„è¡¨æ ¼åˆ°Excelï¼Œä»è€Œå¸¦æ¥ä»¥ä¸‹å˜åŒ–ï¼š</p><ol><li>å·¥ä½œæ•ˆç‡å¤§å¹…æé«˜ï¼šç›¸æ¯”æ‰‹åŠ¨å¤åˆ¶ç²˜è´´çš„æ–¹å¼ï¼Œè‡ªåŠ¨åŒ–åŠå…¬å¯ä»¥å¤§å¤§ç¼©çŸ­å¤„ç†æ—¶é—´ã€‚å‘˜å·¥ä»¬å¯ä»¥å°†æ›´å¤šçš„ç²¾åŠ›æŠ•å…¥åˆ°å…¶ä»–æœ‰ä»·å€¼çš„å·¥ä½œä¸­ï¼Œæé«˜æ•´ä½“å·¥ä½œæ•ˆç‡ã€‚</li><li>æ–‡æ¡£æ ¼å¼æ›´åŠ è§„èŒƒï¼šè‡ªåŠ¨åŒ–åŠå…¬å¯ä»¥ç¡®ä¿æå–åˆ°çš„è¡¨æ ¼æ•°æ®åœ¨Excelä¸­ä¿æŒä¸€è‡´çš„æ ¼å¼å’Œæ ·å¼ã€‚è¿™æœ‰åŠ©äºå‡å°‘å› æ ¼å¼é”™ä¹±è€Œå¯¼è‡´çš„è¯¯è§£å’Œé”™è¯¯ã€‚</li><li>æ•°æ®å‡†ç¡®æ€§å¾—åˆ°ä¿éšœï¼šè‡ªåŠ¨åŒ–åŠå…¬å¯ä»¥å‡å°‘äººä¸ºå› ç´ å¯¹æ•°æ®çš„å½±å“ã€‚é€šè¿‡è‡ªåŠ¨åŒ–æå–å’Œè½¬æ¢è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚</li></ol><h3 id="ç»“è¯­" tabindex="-1">ç»“è¯­ï¼š <a class="header-anchor" href="#ç»“è¯­" aria-label="Permalink to &quot;ç»“è¯­ï¼š&quot;">â€‹</a></h3><p>Pythonè‡ªåŠ¨åŒ–åŠå…¬è§£å†³æ–¹æ¡ˆä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªé«˜æ•ˆã€å‡†ç¡®ã€è§„èŒƒçš„æ–‡æ¡£å¤„ç†æ–¹å¼ã€‚é€šè¿‡ä¸€é”®æ‰¹é‡æå–Wordæ–‡æ¡£ä¸­çš„è¡¨æ ¼åˆ°Excelï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åº”å¯¹å¤§é‡æ–‡æ¡£å¤„ç†ä»»åŠ¡ï¼Œæé«˜å·¥ä½œæ•ˆç‡å’Œè´¨é‡ã€‚è®©æˆ‘ä»¬ä¸€èµ·æ‹¥æŠ±Pythonè‡ªåŠ¨åŒ–åŠå…¬çš„ç¥å¥‡åŠ›é‡å§ï¼</p><h2 id="è‡ªåŠ¨å‘wordæ–‡æ¡£ä¸­æ·»åŠ æ•°æ®å’Œå›¾ç‰‡-æ™ºèƒ½è°ƒæ•´ç‰ˆé¢" tabindex="-1">è‡ªåŠ¨å‘Wordæ–‡æ¡£ä¸­æ·»åŠ æ•°æ®å’Œå›¾ç‰‡ï¼Œæ™ºèƒ½è°ƒæ•´ç‰ˆé¢ <a class="header-anchor" href="#è‡ªåŠ¨å‘wordæ–‡æ¡£ä¸­æ·»åŠ æ•°æ®å’Œå›¾ç‰‡-æ™ºèƒ½è°ƒæ•´ç‰ˆé¢" aria-label="Permalink to &quot;è‡ªåŠ¨å‘Wordæ–‡æ¡£ä¸­æ·»åŠ æ•°æ®å’Œå›¾ç‰‡ï¼Œæ™ºèƒ½è°ƒæ•´ç‰ˆé¢&quot;">â€‹</a></h2><h4 id="ç—›ç‚¹åˆ†æ" tabindex="-1">ç—›ç‚¹åˆ†æ <a class="header-anchor" href="#ç—›ç‚¹åˆ†æ" aria-label="Permalink to &quot;ç—›ç‚¹åˆ†æ&quot;">â€‹</a></h4><p>åœ¨æ—¥å¸¸çš„åŠå…¬ä¸­ï¼Œå›¾ç‰‡æ˜¯æ–‡æ¡£ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ‰‹åŠ¨æ·»åŠ å’Œè°ƒæ•´å›¾ç‰‡å¾€å¾€è€—è´¹å¤§é‡æ—¶é—´å’Œç²¾åŠ›ã€‚å°¤å…¶æ˜¯å½“éœ€è¦æ·»åŠ çš„å›¾ç‰‡æ•°é‡è¾ƒå¤šæ—¶ï¼Œé‡å¤æ€§çš„æ“ä½œæ›´æ˜¯è®©äººè‹¦ä¸å ªè¨€ã€‚æ¯”å¦‚ï¼šåœ¨æ—¥å¸¸çš„6Sç¨½æ ¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¸ä»…è¦è®°å½•é—®é¢˜ã€æè¿°æƒ…å†µï¼Œè¿˜è¦å°†ç°åœºæ‹æ‘„çš„ç…§ç‰‡æ·»åŠ åˆ°Wordæ–‡æ¡£ä¸­ã€‚ç„¶è€Œï¼Œç›´æ¥å°†å›¾ç‰‡ç²˜è´´åˆ°æ–‡æ¡£ä¸­ï¼Œå¾€å¾€ä¼šå¯¼è‡´æ–‡æ¡£æ’ç‰ˆæ··ä¹±ï¼Œå›¾ç‰‡å¤§å°ä¸åˆé€‚ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒæ•´ã€‚è¿™æ ·çš„é‡å¤æ€§å·¥ä½œï¼Œä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚æ­¤æ—¶ï¼Œå¦‚æœèƒ½æœ‰ä¸€ç§è‡ªåŠ¨åŒ–å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œå°†æå¤§åœ°æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚</p><h4 id="è§£å†³æ–¹æ¡ˆ" tabindex="-1">è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to &quot;è§£å†³æ–¹æ¡ˆ&quot;">â€‹</a></h4><p>æœ‰äº†Pythonçš„åŠ©åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°Wordæ–‡æ¡£çš„è‡ªåŠ¨åŒ–å¤„ç†ã€‚é¦–å…ˆï¼Œå°†åºå·ã€é—®é¢˜æè¿°å’Œè´£ä»»éƒ¨é—¨ç­‰ä¿¡æ¯å½•å…¥Excelè¡¨æ ¼ï¼Œç„¶ååˆ©ç”¨Pythonè¯»å–è¿™äº›ä¿¡æ¯ï¼Œå¹¶è‡ªåŠ¨åœ¨Wordæ–‡æ¡£çš„æŒ‡å®šä½ç½®æ·»åŠ å›¾ç‰‡ï¼ŒåŒæ—¶è°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œä½¿å…¶ç¬¦åˆæ’ç‰ˆè¦æ±‚ã€‚</p><h4 id="å®ç°æ­¥éª¤" tabindex="-1">å®ç°æ­¥éª¤ <a class="header-anchor" href="#å®ç°æ­¥éª¤" aria-label="Permalink to &quot;å®ç°æ­¥éª¤&quot;">â€‹</a></h4><ol><li><p><strong>å‡†å¤‡ææ–™</strong>ï¼šå°†ç¨½æ ¸è®°å½•æ•´ç†æˆExcelè¡¨æ ¼ï¼ŒåŒæ—¶æ”¶é›†å¥½å¯¹åº”çš„å›¾ç‰‡æ–‡ä»¶ã€‚ <img src="/ProgramLearnNotes/assets/image-20240605143351987.DB2FHn_t.png" alt="image-20240605143351987"></p><p><img src="/ProgramLearnNotes/assets/image-20240605143409737.B-jsyWQK.png" alt="image-20240605143409737"></p><p><img src="/ProgramLearnNotes/assets/image-20240605143420141.BKoZo70G.png" alt="image-20240605143420141"></p><ol><li><strong>ç¼–å†™ä»£ç </strong>ï¼šä½¿ç”¨Pythonçš„<code>python-docx</code>åº“æ¥æ“ä½œWordæ–‡æ¡£ï¼Œ<code>openpyxl</code>åº“æ¥è¯»å–Excelè¡¨æ ¼æ•°æ®</li><li><strong>è¯»å–æ•°æ®</strong>ï¼šéå†Excelè¡¨æ ¼ï¼Œè¯»å–æ¯æ¡è®°å½•çš„ä¿¡æ¯ï¼ˆåºå·ã€é—®é¢˜æè¿°ã€è´£ä»»éƒ¨é—¨ï¼‰å’Œå¯¹åº”çš„å›¾ç‰‡è·¯å¾„ã€‚</li><li><strong>æ·»åŠ å›¾ç‰‡</strong>ï¼šåœ¨Wordæ–‡æ¡£ä¸­æŒ‡å®šä½ç½®æ·»åŠ å›¾ç‰‡ï¼Œå¹¶è°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œä½¿å…¶é€‚åº”æ–‡æ¡£æ’ç‰ˆï¼Œå¹¶åœ¨æŒ‡å®šä½ç½®æ·»åŠ é—®é¢˜ã€æ—¶é—´ç­‰ä¿¡æ¯</li><li><strong>ä¿å­˜æ–‡æ¡£</strong>ï¼šå®Œæˆæ‰€æœ‰è®°å½•çš„å¤„ç†åï¼Œä¿å­˜Wordæ–‡æ¡£ã€‚</li></ol></li></ol><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#æå–Excelè¡¨ä¸­çš„æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook </span><span style="color:#7F848E;font-style:italic;">#ç”¨äºè¯»å–Excelä¸­çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ•°æ®.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active</span></span>
<span class="line"><span style="color:#ABB2BF;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[]</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,ws.max_row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    number </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#98C379;">&#39;A&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value</span></span>
<span class="line"><span style="color:#ABB2BF;">    problem </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#98C379;">&#39;B&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value</span></span>
<span class="line"><span style="color:#ABB2BF;">    owner </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#98C379;">&#39;C&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value</span></span>
<span class="line"><span style="color:#ABB2BF;">    info_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [number,problem,owner]</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(info_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Document</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx.shared </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Cm</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;">  os</span></span>
<span class="line"><span style="color:#ABB2BF;">doc </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Document</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;6Sç¨½æŸ¥é—®é¢˜æ¨¡æ¿.docx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#å°†å›¾ç‰‡æŒ‰ä¿®æ”¹æ—¶é—´æ’åº(è¿™æ ·æ‰èƒ½ä¸å›¾ç‰‡çš„æè¿°ä¸€è‡´)ï¼Œå°†è·¯å¾„å­˜å…¥åˆ—è¡¨ï¼Œä»¥ä¾¿åé¢é€ä¸ªæ’å…¥å›¾ç‰‡æ—¶è°ƒç”¨</span></span>
<span class="line"><span style="color:#ABB2BF;">path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;6s_pictures&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">list_p </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [path</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(path)] </span><span style="color:#7F848E;font-style:italic;">#è·å–å›¾ç‰‡çš„æ–‡ä»¶å,å¹¶æ‹¼æ¥å®Œæ•´è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">list_p.</span><span style="color:#61AFEF;">sort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">key</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">lambda</span><span style="color:#D19A66;font-style:italic;"> path</span><span style="color:#ABB2BF;">: os.path.</span><span style="color:#61AFEF;">getmtime</span><span style="color:#ABB2BF;">(path)) </span><span style="color:#7F848E;font-style:italic;">#å°†åˆ—è¡¨ä¸­çš„æ–‡ä»¶æŒ‰å…¶ä¿®æ”¹æ—¶é—´æ’åºï¼Œos.path.getmtime() å‡½æ•°æ˜¯è·å–æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">table </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> doc.tables[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#7F848E;font-style:italic;">#å·²ç¡®å®šæ˜¯ç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼Œå…¶ç´¢å¼•æ˜¯0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#å¢åŠ éœ€è¦çš„è¡Œï¼Œä»¥ä¾¿è¶³å¤Ÿå¡«å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(data)</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    table.</span><span style="color:#61AFEF;">add_row</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#å†™å…¥æ•°æ®åŠå›¾ç‰‡</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(data)</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    table.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(row,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">).text </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(data[row</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]) </span><span style="color:#7F848E;font-style:italic;">#å¾€ç¬¬1åˆ—å†™å…¥åºå·</span></span>
<span class="line"><span style="color:#ABB2BF;">    table.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(row,</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">).text </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[row</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#7F848E;font-style:italic;">#å¾€ç¬¬2åˆ—å†™å…¥é—®é¢˜æè¿°</span></span>
<span class="line"><span style="color:#ABB2BF;">    table.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(row,</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).text </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data[row</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">] </span><span style="color:#7F848E;font-style:italic;">#å¾€ç¬¬4åˆ—å†™å…¥è´£ä»»éƒ¨é—¨</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #æ’å…¥å›¾ç‰‡å¹¶è°ƒæ•´å›¾ç‰‡çš„é«˜åº¦å’Œå®½åº¦ï¼Œä»¥é€‚åˆæ¨¡æ¿ä¸­çš„å•å…ƒæ ¼å°ºå¯¸</span></span>
<span class="line"><span style="color:#ABB2BF;">    run </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> table.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(row,</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">).paragraphs[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">add_run</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">#æ–°å¢ä¸€ä¸ªæ–‡å­—å—</span></span>
<span class="line"><span style="color:#ABB2BF;">    picture </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> run.</span><span style="color:#61AFEF;">add_picture</span><span style="color:#ABB2BF;">(list_p[row</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]) </span><span style="color:#7F848E;font-style:italic;">#æ’å…¥å›¾ç‰‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    picture.height </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Cm</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4.4</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#è®¾ç½®å›¾ç‰‡é«˜åº¦</span></span>
<span class="line"><span style="color:#ABB2BF;">    picture.width </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Cm</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">6.2</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">#è®¾ç½®å›¾ç‰‡å®½åº¦</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">doc.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;6Sç¨½æŸ¥é—®é¢˜.docx&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h4 id="æ•ˆæœå±•ç¤º-1" tabindex="-1"><strong>æ•ˆæœå±•ç¤º</strong> <a class="header-anchor" href="#æ•ˆæœå±•ç¤º-1" aria-label="Permalink to &quot;**æ•ˆæœå±•ç¤º**&quot;">â€‹</a></h4><p>ç»è¿‡Pythonçš„è‡ªåŠ¨åŒ–å¤„ç†ï¼ŒåŸæœ¬æ··ä¹±çš„Wordæ–‡æ¡£å˜å¾—æ•´æ´æœ‰åºï¼Œå›¾ç‰‡å¤§å°é€‚ä¸­ï¼Œæ’ç‰ˆç¾è§‚ã€‚è€Œä¸”ï¼Œæ•´ä¸ªè¿‡ç¨‹åªéœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ï¼Œå¤§å¤§èŠ‚çœäº†äººåŠ›æˆæœ¬å’Œæ—¶é—´æˆæœ¬ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240605143518275.DjPsvzmS.png" alt="image-20240605143518275"></p><p><img src="/ProgramLearnNotes/assets/image-20240605143530012.T2Io6CzI.png" alt="image-20240605143530012"></p><h2 id="è‡ªåŠ¨åŒ–è¡¨æ ¼æ±‡æ€»ä¸é‚®ä»¶å‘é€-å‘Šåˆ«é‡å¤æ€§å·¥ä½œ" tabindex="-1">è‡ªåŠ¨åŒ–è¡¨æ ¼æ±‡æ€»ä¸é‚®ä»¶å‘é€ï¼Œå‘Šåˆ«é‡å¤æ€§å·¥ä½œ <a class="header-anchor" href="#è‡ªåŠ¨åŒ–è¡¨æ ¼æ±‡æ€»ä¸é‚®ä»¶å‘é€-å‘Šåˆ«é‡å¤æ€§å·¥ä½œ" aria-label="Permalink to &quot;è‡ªåŠ¨åŒ–è¡¨æ ¼æ±‡æ€»ä¸é‚®ä»¶å‘é€ï¼Œå‘Šåˆ«é‡å¤æ€§å·¥ä½œ&quot;">â€‹</a></h2><p>åœ¨æ—¥å¸¸çš„åŠå…¬ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é¢ä¸´ç€ä¸€ç§æ—¢é‡å¤åˆç¹ççš„å·¥ä½œæŒ‘æˆ˜ï¼šæ¯ä¸ªæœˆéƒ½éœ€è¦æ‰‹åŠ¨æ”¶é›†å’Œæ•´ç†æ¥è‡ªå„ä¸ªåŸå¸‚åˆ†å…¬å¸çš„ç»è¥æ•°æ®è¡¨æ ¼ã€‚è¿™äº›è¡¨æ ¼å¯èƒ½æ ¼å¼å„å¼‚ï¼Œå†…å®¹ç¹å¤šï¼ŒåŒ…å«é”€å”®é¢ã€æˆæœ¬ã€åˆ©æ¶¦ç­‰å…³é”®ä¿¡æ¯ï¼Œå¯¹äºå…¬å¸å†³ç­–å±‚æ¥è¯´è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œæ‰‹åŠ¨å¤„ç†è¿™äº›è¡¨æ ¼ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ï¼Œæå¤§åœ°å½±å“äº†å·¥ä½œæ•ˆç‡å’Œæ•°æ®çš„å‡†ç¡®æ€§ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæ¯ä¸ªæœˆçš„è¿™ä¸ªæ—¶å€™ï¼Œä½ éƒ½éœ€è¦æ‰“å¼€æ•°åä¸ªç”šè‡³ä¸Šç™¾ä¸ª Excel æ–‡ä»¶ï¼Œé€ä¸ªæŸ¥çœ‹ã€æ ¸å¯¹æ•°æ®ï¼Œç„¶åå°†å®ƒä»¬ä¸€ä¸€è¾“å…¥åˆ°ä¸€ä¸ªæ–°çš„æ±‡æ€»è¡¨æ ¼ä¸­ã€‚æ¥ä¸‹æ¥ï¼Œä½ è¿˜éœ€è¦ç¼–å†™é‚®ä»¶ï¼Œå°†è¿™ä¸ªæ±‡æ€»æŠ¥å‘Šå‘é€ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨ã€‚è¿™ç§æœºæ¢°å¼çš„é‡å¤å·¥ä½œä¸ä»…è®©äººæ„Ÿåˆ°æ¯ç‡¥æ— å‘³ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å› ä¸ºç–å¿½è€Œå¼•å…¥é”™è¯¯ã€‚</p><p>ä¸ºäº†æ‰“ç ´è¿™ç§åŠå…¬ç“¶é¢ˆï¼Œæé«˜å·¥ä½œæ•ˆç‡å’Œæ•°æ®çš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Python è¿›è¡Œè‡ªåŠ¨åŒ–åŠå…¬ã€‚é€šè¿‡ç¼–å†™ Python è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°ç»è¥æ•°æ®çš„è‡ªåŠ¨æ±‡æ€»å’Œé‚®ä»¶å‘é€ã€‚è¿™ä¸ä»…èƒ½å¤ŸèŠ‚çœæˆ‘ä»¬å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ï¼Œè€Œä¸”èƒ½å¤Ÿå‡å°‘äººä¸ºé”™è¯¯ï¼Œæé«˜æ•°æ®çš„å¯é æ€§ã€‚</p><p>åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åˆ©ç”¨ Python å®ç°ç»è¥æ•°æ®çš„è‡ªåŠ¨åŒ–æ±‡æ€»å’Œé‚®ä»¶å‘é€ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•è¯»å–å’Œå¤„ç†æ¥è‡ªä¸åŒåˆ†å…¬å¸çš„ç»è¥æ•°æ®è¡¨æ ¼ï¼›ç„¶åï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•å°†å¤„ç†åçš„æ•°æ®æ±‡æ€»åˆ°ä¸€ä¸ªæ–°çš„è¡¨æ ¼ä¸­ï¼›æœ€åï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•è‡ªåŠ¨å‘é€å¸¦æœ‰é™„ä»¶çš„é‚®ä»¶ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨ã€‚é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œä½ å°†çœ‹åˆ° Python åœ¨è‡ªåŠ¨åŒ–åŠå…¬ä¸­çš„å¼ºå¤§åŠŸèƒ½ï¼Œä»¥åŠå®ƒå¦‚ä½•å¸®åŠ©æˆ‘ä»¬æ‘†è„±ç¹ççš„é‡å¤å·¥ä½œï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚</p><h3 id="ä¸€ã€è‡ªåŠ¨åŒ–æ±‡æ€»ç»è¥æ•°æ®" tabindex="-1">ä¸€ã€è‡ªåŠ¨åŒ–æ±‡æ€»ç»è¥æ•°æ® <a class="header-anchor" href="#ä¸€ã€è‡ªåŠ¨åŒ–æ±‡æ€»ç»è¥æ•°æ®" aria-label="Permalink to &quot;ä¸€ã€è‡ªåŠ¨åŒ–æ±‡æ€»ç»è¥æ•°æ®&quot;">â€‹</a></h3><h4 id="å¤„ç†æµç¨‹" tabindex="-1">å¤„ç†æµç¨‹ <a class="header-anchor" href="#å¤„ç†æµç¨‹" aria-label="Permalink to &quot;å¤„ç†æµç¨‹&quot;">â€‹</a></h4><p><strong>è¾“å…¥</strong>ï¼šå¤šä¸ªå…·æœ‰ç›¸ä¼¼æ•°æ®ç»“æ„çš„ Excel å·¥ä½œç°¿ã€‚</p><p><strong>å¤„ç†</strong>ï¼š</p><ol><li><ul><li>ä½¿ç”¨ Python è„šæœ¬éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ Excel æ–‡ä»¶ã€‚</li><li>ä»æ¯ä¸ªæ–‡ä»¶ä¸­æå–ç‰¹å®šçš„æ•°æ®åˆ—ã€‚</li><li>å°†æå–çš„æ•°æ®æ•´åˆåˆ°ä¸€ä¸ªæ–°çš„ pandas DataFrame ä¸­ã€‚</li></ul></li><li></li><li><p><strong>è¾“å‡º</strong>ï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰æå–æ•°æ®çš„æ–°çš„ Excel å·¥ä½œç°¿ã€‚</p></li></ol><h4 id="ç¤ºä¾‹æ•°æ®" tabindex="-1">ç¤ºä¾‹æ•°æ® <a class="header-anchor" href="#ç¤ºä¾‹æ•°æ®" aria-label="Permalink to &quot;ç¤ºä¾‹æ•°æ®&quot;">â€‹</a></h4><p>å‡è®¾æˆ‘ä»¬éœ€è¦ä»å„ä¸ªåˆ†æ”¯æœºæ„çš„å¹´åº¦æŠ¥å‘Šä¸­æå–â€œè¥ä¸šæ”¶å…¥â€å’Œâ€œå‡€åˆ©æ¶¦â€æ•°æ®ã€‚æ–‡ä»¶åå¯èƒ½å¦‚ä¸‹ï¼š</p><ul><li>å±±ä¸œåˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>ä¸Šæµ·åˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>ä¸œåŒ—åˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>å¹¿ä¸œåˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>...</li></ul><p>æ¯ä¸ªæ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š</p><ul><li>æ—¥æœŸ</li><li>è¥ä¸šæ”¶å…¥</li><li>å‡€åˆ©æ¶¦</li><li>å…¶ä»–è´¹ç”¨</li><li>...</li></ul><h4 id="å®æˆ˜ä»£ç -1" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -1" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> batch_extract_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">columns</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_filename</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(directory):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xlsx&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">columns)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ·»åŠ æ–‡ä»¶æ¥æºä¿¡æ¯ï¼Œä»¥ä¾¿çŸ¥é“æ•°æ®æ¥è‡ªå“ªä¸ªåˆ†æ”¯æœºæ„</span></span>
<span class="line"><span style="color:#ABB2BF;">            df[</span><span style="color:#98C379;">&#39;Source&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å°†æ•°æ®æ·»åŠ åˆ°æ€»æ•°æ®åˆ—è¡¨ä¸­</span></span>
<span class="line"><span style="color:#ABB2BF;">            all_data.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(df)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å°†åˆ—è¡¨ä¸­çš„DataFrameåˆå¹¶æˆä¸€ä¸ª</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data_frame </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(all_data, </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å°†æ±‡æ€»çš„æ•°æ®è¾“å‡ºåˆ°æ–°çš„Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data_frame.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(output_filename, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#61AFEF;">batch_extract_data</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;æ—¥æœŸ&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;è¥ä¸šæ”¶å…¥&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;å‡€åˆ©æ¶¦&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;path_to_financial_reports&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Consolidated_Financials.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="äºŒã€è‡ªåŠ¨å‘é€é‚®ä»¶ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨" tabindex="-1">äºŒã€è‡ªåŠ¨å‘é€é‚®ä»¶ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨ <a class="header-anchor" href="#äºŒã€è‡ªåŠ¨å‘é€é‚®ä»¶ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨" aria-label="Permalink to &quot;äºŒã€è‡ªåŠ¨å‘é€é‚®ä»¶ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨&quot;">â€‹</a></h3><p>å½“æˆ‘ä»¬å®Œæˆäº†ç»è¥æ•°æ®çš„æ±‡æ€»åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å°†è¿™ä¸ªæ±‡æ€»æŠ¥å‘Šå‘é€ç»™é¢†å¯¼å’Œç›¸å…³éƒ¨é—¨ã€‚</p><p>Python ä¸­çš„ smtplib å’Œ email åº“å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‚®ä»¶çš„è‡ªåŠ¨å‘é€ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰é™„ä»¶çš„é‚®ä»¶ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.multipart </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEMultipart</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.text </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEText</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.base </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEBase</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> encoders</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è®¾ç½®é‚®ä»¶æœåŠ¡å™¨ã€å‘ä»¶äººã€æ”¶ä»¶äººã€é‚®ä»¶ä¸»é¢˜å’Œæ­£æ–‡</span></span>
<span class="line"><span style="color:#ABB2BF;">mailserver </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;smtp.163.com&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å‘ä»¶äºº-å¡«å†™è‡ªå·±çš„é‚®ç®±</span></span>
<span class="line"><span style="color:#ABB2BF;">userName_SendMail </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;zdy15921159716@163.com&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é‚®ç®±å‘ä»¶æˆæƒç -ä¸ºå‘ä»¶äººç”Ÿæˆçš„æˆæƒç ï¼Œè¯¦è§ä¸‹æ–‡</span></span>
<span class="line"><span style="color:#ABB2BF;">userName_AuthCode </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;BOEFGGZHRAHEXGRN&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">receivers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;boss_email@example.com&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;department_email@example.com&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">subject </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;ç»è¥æ•°æ®æ±‡æ€»æŠ¥å‘Š&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">body </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;è¯·æŸ¥é˜…é™„ä»¶ä¸­çš„ç»è¥æ•°æ®æ±‡æ€»æŠ¥å‘Šã€‚&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¯»å–è¦å‘é€çš„é™„ä»¶æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;summary_report.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> attachment:</span></span>
<span class="line"><span style="color:#ABB2BF;">    part </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MIMEBase</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;application&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;octet-stream&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    part.</span><span style="color:#61AFEF;">set_payload</span><span style="color:#ABB2BF;">(attachment.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    encoders.</span><span style="color:#61AFEF;">encode_base64</span><span style="color:#ABB2BF;">(part)</span></span>
<span class="line"><span style="color:#ABB2BF;">    part.</span><span style="color:#61AFEF;">add_header</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Content-Disposition&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;attachment; filename=&quot;summary_report.xlsx&quot;&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºé‚®ä»¶å¯¹è±¡å¹¶æ·»åŠ é™„ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">msg </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MIMEMultipart</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">msg[</span><span style="color:#98C379;">&#39;From&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sender</span></span>
<span class="line"><span style="color:#ABB2BF;">msg[</span><span style="color:#98C379;">&#39;To&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;, &#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(receivers)</span></span>
<span class="line"><span style="color:#ABB2BF;">msg[</span><span style="color:#98C379;">&#39;Subject&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> subject</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">attach</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">MIMEText</span><span style="color:#ABB2BF;">(body, </span><span style="color:#98C379;">&#39;plain&#39;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">attach</span><span style="color:#ABB2BF;">(part)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‘é€é‚®ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">smtp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> smtplib.</span><span style="color:#61AFEF;">SMTP_SSL</span><span style="color:#ABB2BF;">(mailserver, </span><span style="color:#E06C75;font-style:italic;">port</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">465</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">smtp.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(userName_SendMail, userName_AuthCode)</span></span>
<span class="line"><span style="color:#ABB2BF;">smtp.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(userName_SendMail, </span><span style="color:#98C379;">&#39;,&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(received_mail), msg.</span><span style="color:#61AFEF;">as_string</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">smtp.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>163 é‚®ç®±å®‰å…¨ç è®¾ç½®ã€python ä»£ç ä¸­çš„å¯†ç ä½¿ç”¨è¿™ä¸ªè€Œä¸æ˜¯é‚®ç®±å¯†ç ã€‘</p><p><img src="/ProgramLearnNotes/assets/image-20240511164848486.BfHz-IdD.png" alt="image-20240511164848486"></p><p><img src="/ProgramLearnNotes/assets/image-20240511164917121.CqX8puLu.png" alt="image-20240511164917121"></p><p><img src="/ProgramLearnNotes/assets/image-20240511164928150.C57N3I7J.png" alt="image-20240511164928150"></p><p>é€šè¿‡ç»“åˆä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ç»è¥æ•°æ®çš„è‡ªåŠ¨åŒ–æ±‡æ€»å’Œé‚®ä»¶å‘é€äº†ã€‚è¿™å°†å¤§å¤§æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ï¼Œè®©æˆ‘ä»¬æœ‰æ›´å¤šçš„æ—¶é—´ä¸“æ³¨äºå…¶ä»–é‡è¦çš„å·¥ä½œã€‚</p><h2 id="æ±‡æ€»20å¹´400ä¸ªäº§å“è¡¨æ•°æ®" tabindex="-1">æ±‡æ€»20å¹´400ä¸ªäº§å“è¡¨æ•°æ® <a class="header-anchor" href="#æ±‡æ€»20å¹´400ä¸ªäº§å“è¡¨æ•°æ®" aria-label="Permalink to &quot;æ±‡æ€»20å¹´400ä¸ªäº§å“è¡¨æ•°æ®&quot;">â€‹</a></h2><h3 id="å›°å¢ƒé‡é‡-ç™¾è¡¨éš¾å½’ä¸€-ä¼ ç»Ÿæ–¹æ³•è€—æ—¶è´¹åŠ›" tabindex="-1">å›°å¢ƒé‡é‡ï¼š<strong>ç™¾è¡¨éš¾å½’ä¸€ï¼Œä¼ ç»Ÿæ–¹æ³•è€—æ—¶è´¹åŠ›</strong> <a class="header-anchor" href="#å›°å¢ƒé‡é‡-ç™¾è¡¨éš¾å½’ä¸€-ä¼ ç»Ÿæ–¹æ³•è€—æ—¶è´¹åŠ›" aria-label="Permalink to &quot;å›°å¢ƒé‡é‡ï¼š**ç™¾è¡¨éš¾å½’ä¸€ï¼Œä¼ ç»Ÿæ–¹æ³•è€—æ—¶è´¹åŠ›**&quot;">â€‹</a></h3><p>é¦–å½“å…¶å†²çš„éš¾é¢˜ä¾¿æ˜¯å¦‚ä½•æ•´ç†é‚£æ•°ä»¥ä¸‡è®¡ã€åˆ†æ•£åœ¨å„ä¸ªä¸šåŠ¡å‘˜æ‰‹ä¸­çš„äº§å“æ•°æ®è¡¨ã€‚æ¯ä¸ªä¸šåŠ¡å‘˜éƒ½è´Ÿè´£ç€ä¸åŒçš„äº§å“å’Œå®¢æˆ·ï¼Œä»–ä»¬çš„å·¥ä½œæ–¹å¼ã€æ•°æ®è®°å½•ä¹ æƒ¯å„ä¸ç›¸åŒï¼Œè¿™å¯¼è‡´äº†æ•°æ®è¡¨æ ¼æ ¼å¼çš„äº”èŠ±å…«é—¨ã€‚æœ‰çš„ä¸šåŠ¡å‘˜å¯èƒ½åå¥½ä½¿ç”¨Excelçš„æŸäº›ç‰¹å®šåŠŸèƒ½ï¼Œè€Œæœ‰çš„åˆ™å¯èƒ½åªæ˜¯ç®€å•åœ°ç”¨æ–‡å­—è®°å½•äº†å…³é”®ä¿¡æ¯ã€‚æ›´è®©äººå¤´ç–¼çš„æ˜¯ï¼Œè¿™äº›è¡¨æ ¼çš„æ•°é‡é«˜è¾¾ä¸Šç™¾ä¸ªï¼Œä¸”æ¯ä¸ªè¡¨æ ¼éƒ½å¯èƒ½åŒ…å«ä¸åŒçš„å­—æ®µã€ä¸åŒçš„æ•°æ®æ ¼å¼ï¼Œç”šè‡³ä¸åŒçš„è¯­è¨€æè¿°ã€‚</p><p>é¢å¯¹è¿™æ ·çš„å›°å¢ƒï¼Œä¼ ç»Ÿçš„æ•°æ®æ•´ç†æ–¹å¼æ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚æ®åˆæ­¥ä¼°ç®—ï¼Œå¦‚æœæŒ‰ç…§ä¼ ç»Ÿæ–¹æ³•è¿›è¡Œæ•°æ®æ ¼å¼ç»Ÿä¸€å’Œè¡¨æ ¼æ±‡æ€»ï¼Œææ€•ä¸€ä¸ªæœˆçš„æ—¶é—´éƒ½éš¾ä»¥å®Œæˆã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå³ä½¿å®Œæˆäº†è¿™ä¸€å·¥ä½œï¼Œä¹Ÿæ— æ³•ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚è¿™å¯¹äºå³å°†ä¸Šçº¿ERPç³»ç»Ÿçš„ä¼ä¸šæ¥è¯´ï¼Œæ— ç–‘æ˜¯ä¸€ä¸ªå·¨å¤§çš„éšæ‚£ã€‚</p><h3 id="é€†è¢­ä¹‹è·¯-pythonè‡ªåŠ¨åŒ–ç¥å¥‡åŠ©åŠ›" tabindex="-1">é€†è¢­ä¹‹è·¯ï¼šPythonè‡ªåŠ¨åŒ–ç¥å¥‡åŠ©åŠ› <a class="header-anchor" href="#é€†è¢­ä¹‹è·¯-pythonè‡ªåŠ¨åŒ–ç¥å¥‡åŠ©åŠ›" aria-label="Permalink to &quot;é€†è¢­ä¹‹è·¯ï¼šPythonè‡ªåŠ¨åŒ–ç¥å¥‡åŠ©åŠ›&quot;">â€‹</a></h3><p>å¯»æ‰¾ä¸€ç§é«˜æ•ˆã€å‡†ç¡®çš„æ•°æ®æ•´ç†æ–¹æ³•è¿«åœ¨çœ‰ç«ã€‚å¹¸è¿çš„æ˜¯ï¼Œéšç€ç§‘æŠ€çš„å‘å±•ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†æ›´å¥½çš„é€‰æ‹©â€”â€”Pythonè‡ªåŠ¨åŒ–åŠå…¬å·¥å…·ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿã€å‡†ç¡®åœ°å®Œæˆæ•°æ®æ ¼å¼çš„ç»Ÿä¸€å’Œè¡¨æ ¼çš„æ±‡æ€»å·¥ä½œï¼Œä¸ºä¼ä¸šçš„æ•°å­—åŒ–è½¬å‹æä¾›æœ‰åŠ›çš„æ”¯æŒã€‚</p><h3 id="ä¸‰å¤§æ­¥éª¤-è½»æ¾å®ç°æ•°æ®æ±‡æ€»" tabindex="-1">ä¸‰å¤§æ­¥éª¤ï¼šè½»æ¾å®ç°æ•°æ®æ±‡æ€» <a class="header-anchor" href="#ä¸‰å¤§æ­¥éª¤-è½»æ¾å®ç°æ•°æ®æ±‡æ€»" aria-label="Permalink to &quot;ä¸‰å¤§æ­¥éª¤ï¼šè½»æ¾å®ç°æ•°æ®æ±‡æ€»&quot;">â€‹</a></h3><h4 id="ç¬¬ä¸€æ­¥-å»ºç«‹æ•°æ®åº“æ¨¡å¼è¡¨" tabindex="-1">ç¬¬ä¸€æ­¥ï¼šå»ºç«‹æ•°æ®åº“æ¨¡å¼è¡¨ <a class="header-anchor" href="#ç¬¬ä¸€æ­¥-å»ºç«‹æ•°æ®åº“æ¨¡å¼è¡¨" aria-label="Permalink to &quot;ç¬¬ä¸€æ­¥ï¼šå»ºç«‹æ•°æ®åº“æ¨¡å¼è¡¨&quot;">â€‹</a></h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªè§„å®šå¥½æ ¼å¼çš„æ•°æ®åº“æ¨¡å¼è¡¨ï¼Œä½œä¸ºäº§å“æ•°æ®åº“çš„é›å½¢ã€‚è¿™ä¸ªè¡¨æ ¼è§„å®šå¥½äº†éœ€è¦åŒ…å«çš„åˆ—å’Œäº§å“é¡¹ç›®ï¼Œä¸”éƒ¨åˆ†æ–°ä¸šåŠ¡å‘˜å·²ç»å°†è‡ªå·±çš„æ•°æ®è¿›è¡Œäº†å½•å…¥ï¼Œä½†å¯¹äºè€ä¸šåŠ¡å‘˜çš„è¡¨æ ¼ï¼Œç”±äºå¤šäº†ä¸€åˆ—è´§å·æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ•°æ®åº“æ¨¡å¼è¡¨çš„Cåˆ—æ·»åŠ ä¸€ä¸ªç©ºåˆ—ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240526153035637.VZBbn957.png" alt="image-20240526153035637"></p><h4 id="å‘è¡¨æ ¼ä¸­æ‰€æœ‰sheetå¢åŠ ä¸€ä¸ªç©ºåˆ—cåˆ—çš„python-ä»£ç " tabindex="-1">å‘è¡¨æ ¼ä¸­æ‰€æœ‰Sheetå¢åŠ ä¸€ä¸ªç©ºåˆ—Cåˆ—çš„Python ä»£ç  <a class="header-anchor" href="#å‘è¡¨æ ¼ä¸­æ‰€æœ‰sheetå¢åŠ ä¸€ä¸ªç©ºåˆ—cåˆ—çš„python-ä»£ç " aria-label="Permalink to &quot;å‘è¡¨æ ¼ä¸­æ‰€æœ‰Sheetå¢åŠ ä¸€ä¸ªç©ºåˆ—Cåˆ—çš„Python ä»£ç &quot;">â€‹</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> add_column_with_header</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">sheet_name</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">header_name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;Item No&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†å·¥ä½œç°¿ä¸­çš„æ‰€æœ‰sheetï¼Œæˆ–è€…åªå¤„ç†æŒ‡å®šçš„sheet</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> sheet_name:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheets_to_process </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [workbook[sheet_name]]</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheets_to_process </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook.sheetnames</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> sheet_name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sheets_to_process:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheet </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook[sheet_name]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ£€æŸ¥æ˜¯å¦éœ€è¦æ’å…¥æ–°åˆ—ï¼ˆç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªå•å…ƒæ ¼åœ¨Cåˆ—æœ‰æ•°æ®æˆ–sheetå·²ç»å­˜åœ¨Dåˆ—ï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> sheet[</span><span style="color:#98C379;">&#39;B2&#39;</span><span style="color:#ABB2BF;">].value </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#C678DD;"> or</span><span style="color:#ABB2BF;"> sheet.max_column </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åœ¨Dåˆ—çš„ä½ç½®æ’å…¥æ–°åˆ—ï¼ˆå¦‚æœDåˆ—å·²ç»å­˜åœ¨åˆ™ä¸ä¼šå†æ¬¡æ’å…¥ï¼‰</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ³¨æ„ï¼šopenpyxlçš„insert_colsä¼šè‡ªåŠ¨å¤„ç†åˆ—çš„ç§»åŠ¨</span></span>
<span class="line"><span style="color:#ABB2BF;">            sheet.</span><span style="color:#61AFEF;">insert_cols</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">idx</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># åœ¨ç¬¬3åˆ—ï¼ˆCåˆ—ï¼‰çš„ä½ç½®æ’å…¥æ–°åˆ—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åœ¨æ–°æ’å…¥çš„Cåˆ—çš„ç¬¬ä¸€è¡Œè®¾ç½®åˆ—åä¸ºâ€œè´§å·â€</span></span>
<span class="line"><span style="color:#ABB2BF;">            sheet.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">header_name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(file_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="ç¬¬äºŒæ­¥-æ ¼å¼åŒ–è€ä¸šåŠ¡å‘˜è¡¨æ ¼" tabindex="-1">ç¬¬äºŒæ­¥ï¼šæ ¼å¼åŒ–è€ä¸šåŠ¡å‘˜è¡¨æ ¼ <a class="header-anchor" href="#ç¬¬äºŒæ­¥-æ ¼å¼åŒ–è€ä¸šåŠ¡å‘˜è¡¨æ ¼" aria-label="Permalink to &quot;ç¬¬äºŒæ­¥ï¼šæ ¼å¼åŒ–è€ä¸šåŠ¡å‘˜è¡¨æ ¼&quot;">â€‹</a></h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹è€ä¸šåŠ¡å‘˜çš„è¡¨æ ¼è¿›è¡Œäº†æ ¼å¼åŒ–å¤„ç†ã€‚ä»ä¸‹å›¾å¯ä»¥çœ‹å‡ºï¼Œè€ä¸šåŠ¡å‘˜ä»¬æ˜¯éå¸¸ä¸æ„¿æ„æŒ‰å…¬å¸è§„å®šçš„æ ‡å‡†å¡«è¡¨çš„ï¼Œé¦–å…ˆAåˆ—æ˜¯å®Œå…¨æ— ç”¨çš„åˆ—éœ€è¦åˆ é™¤ï¼ŒBåˆ—åŒä¸€ä¿¡æ¯åˆ†è¡Œå†™åˆ°äº†ä¸¤è¡Œï¼Œé‡å¤ä¿¡æ¯å›¾çœäº‹å„¿ï¼Œæ²¡æœ‰è¿›è¡Œé‡å¤å½•å…¥ã€‚</p><p>é’ˆå¯¹Båˆ—æ•°æ®ï¼Œæˆ‘é‡‡ç”¨äº†ç‰¹æ®Šè§„åˆ™ï¼šå½“ä¸Šä¸‹ä¸¤è¡Œéƒ½ä¸ä¸ºç©ºæ—¶ï¼Œå°†ä¸¤è¡Œå†…å®¹æ±‡æ€»åˆ°ä¸€è¡Œï¼›åŒæ—¶ï¼Œç¡®ä¿ç›¸é‚»ä¸¤ä¸ªæœ‰æ•°æ®è¡Œä¹‹é—´çš„ç©ºè¡Œå¡«å……å‰ä¸€ä¸ªéç©ºè¡Œçš„æ•°æ®ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240526153111986.DUR9KPp7.png" alt="image-20240526153111986"></p><p><strong>æ ¼å¼åŒ–æ‰€æœ‰ä¸šåŠ¡å‘˜æ‰€æœ‰è¡¨æ ¼ä¸­çš„æ‰€æœ‰Sheetè¡¨çš„ä»£ç </strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> process_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(input_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sheet_names </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.</span><span style="color:#61AFEF;">get_sheet_names</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è·å¾—å·¥ä½œç°¿çš„æ‰€æœ‰å·¥ä½œè¡¨å  # å‡è®¾å¤„ç†çš„æ˜¯æ´»åŠ¨å·¥ä½œè¡¨</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> sheet_name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sheet_names:</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb[sheet_name]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ ‡è®°ä¸Šä¸€ä¸ªéç©ºå•å…ƒæ ¼çš„å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">        last_non_empty_value </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # éå†æ‰€æœ‰è¡Œï¼ˆä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå‡è®¾ç¬¬ä¸€è¡Œæ˜¯æ ‡é¢˜ï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, ws.max_row </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥å½“å‰è¡Œå’Œä¸‹ä¸€è¡Œæ˜¯å¦éƒ½ä¸ä¸ºç©º</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> row </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> ws.max_row </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åˆå¹¶ä¸¤è¡Œå†…å®¹åˆ°ä¸Šä¸€è¡Œ</span></span>
<span class="line"><span style="color:#ABB2BF;">                new_value </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> \</span></span>
<span class="line"><span style="color:#98C379;">                    &#39; &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value)</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> new_value</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span><span style="color:#7F848E;font-style:italic;">  # å¯ä»¥è®¾ç½®ä¸ºNoneæˆ–è€…åˆ é™¤æ•´è¡Œï¼Œå–å†³äºéœ€æ±‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # æ›´æ–°ä¸Šä¸€ä¸ªéç©ºå€¼ï¼Œç”¨äºå¡«å……</span></span>
<span class="line"><span style="color:#ABB2BF;">                last_non_empty_value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> new_value</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> last_non_empty_value </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å¡«å……ç©ºè¡Œä¸ºä¸Šä¸€ä¸ªéç©ºå€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws[</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;B</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">].value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> last_non_empty_value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜æ›´æ”¹åˆ°æ–°çš„å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(input_file)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># process_excel(&#39;SPINNING.xlsx&#39;, &#39;output.xlsx&#39;)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>åœ¨æ ¼å¼åŒ–å®Œæˆåï¼Œæˆ‘ä»¬åˆ é™¤äº†è€ä¸šåŠ¡å‘˜æ˜ç»†è¡¨ä¸­çš„Aåˆ—ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸æ•°æ®åº“æ¨¡å¼è¡¨æ— å…³çš„ä¿¡æ¯ã€‚</p><p><strong>åˆ é™¤æ‰€æœ‰è€ä¸šåŠ¡å‘˜æ‰€æœ‰è¡¨æ ¼ä¸­çš„æ‰€æœ‰sheetè¡¨Aåˆ—çš„ä»£ç </strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> delete_column_a_in_all_sheets</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†å·¥ä½œç°¿ä¸­çš„æ‰€æœ‰å·¥ä½œè¡¨</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> sheet </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> workbook.worksheets:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ£€æŸ¥Aåˆ—æ˜¯å¦æœ‰å†…å®¹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # if sheet[&#39;A1&#39;].value is not None or sheet.max_column &gt; 1:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¤åˆ¶Båˆ—åŠå…¶åæ‰€æœ‰åˆ—çš„å†…å®¹åˆ°Aåˆ—åŠå…¶åä¸€åˆ—çš„ä½ç½®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # for row in range(1, sheet.max_row + 1):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     for col in range(2, sheet.max_column + 1):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #         sheet.cell(row=row, column=col -</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #                    1).value = sheet.cell(row=row, column=col).value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # åˆ é™¤æœ€åä¸€åˆ—ï¼ˆç°åœ¨å®é™…ä¸Šæ˜¯åŸæ¥çš„Aåˆ—çš„å†…å®¹ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheet.</span><span style="color:#61AFEF;">delete_cols</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># åˆ é™¤ç¬¬ä¸€åˆ—ï¼ˆå³åŸæ¥çš„Aåˆ—ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(file_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="ç¬¬ä¸‰æ­¥-æ™ºèƒ½æ±‡æ€»æ‰€æœ‰æ•°æ®" tabindex="-1">ç¬¬ä¸‰æ­¥ï¼šæ™ºèƒ½æ±‡æ€»æ‰€æœ‰æ•°æ® <a class="header-anchor" href="#ç¬¬ä¸‰æ­¥-æ™ºèƒ½æ±‡æ€»æ‰€æœ‰æ•°æ®" aria-label="Permalink to &quot;ç¬¬ä¸‰æ­¥ï¼šæ™ºèƒ½æ±‡æ€»æ‰€æœ‰æ•°æ®&quot;">â€‹</a></h4><p>æœ€åï¼Œæˆ‘ä»¬åˆ©ç”¨Pythonçš„å¼ºå¤§æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œå°†æ‰€æœ‰è€ä¸šåŠ¡å‘˜çš„æ˜ç»†è¡¨æ±‡æ€»åˆ°æ•°æ®åº“æ¨¡å¼è¡¨ä¸­ã€‚å½“æ˜ç»†è¡¨çš„sheetåç§°ä¸æ¨¡å¼è¡¨ç›¸åŒæ—¶ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ï¼Œæˆ‘ä»¬å°†æ˜ç»†è¡¨çš„æ•°æ®æ·»åŠ åˆ°æ¨¡å¼è¡¨ç›¸åº”æ•°æ®çš„åé¢ï¼›å¦‚æœæ˜ç»†è¡¨çš„sheetåç§°åœ¨æ¨¡å¼è¡¨ä¸­ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬åˆ™åœ¨æ¨¡å¼è¡¨ä¸­æ–°å»ºsheetè¡¨ï¼Œå¹¶å°†æ•°æ®å¤åˆ¶åˆ°é‡Œé¢ã€‚</p><p><strong>æŒ‰ç…§è§„åˆ™æ±‡æ€»æ‰€æœ‰ä¸šåŠ¡å‘˜æ‰€æœ‰è¡¨æ ¼çš„æ‰€æœ‰sheetè¡¨çš„æ±‡æ€»ä»£ç </strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> copy_worksheet_contents</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">source_ws</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">target_ws</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">max_row</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">max_col</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;  </span></span>
<span class="line"><span style="color:#98C379;">    å¤åˆ¶æºå·¥ä½œè¡¨çš„å†…å®¹åˆ°ç›®æ ‡å·¥ä½œè¡¨ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">    :param source_ws: æºå·¥ä½œè¡¨å¯¹è±¡  </span></span>
<span class="line"><span style="color:#98C379;">    :param target_ws: ç›®æ ‡å·¥ä½œè¡¨å¯¹è±¡  </span></span>
<span class="line"><span style="color:#98C379;">    :param max_row: å¤åˆ¶çš„æœ€å¤§è¡Œæ•°ï¼ˆé»˜è®¤å¤åˆ¶æ‰€æœ‰è¡Œï¼‰  </span></span>
<span class="line"><span style="color:#98C379;">    :param max_col: å¤åˆ¶çš„æœ€å¤§åˆ—æ•°ï¼ˆé»˜è®¤å¤åˆ¶æ‰€æœ‰åˆ—ï¼‰  </span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> max_row </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        max_row </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> source_ws.max_row</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> max_col </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        max_col </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> source_ws.max_column</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> source_ws.</span><span style="color:#61AFEF;">iter_rows</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">min_row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">max_row</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">max_row, </span><span style="color:#E06C75;font-style:italic;">max_col</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">max_col, </span><span style="color:#E06C75;font-style:italic;">values_only</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> cell </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> row:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å¤åˆ¶å•å…ƒæ ¼å€¼ï¼ˆå¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥å¤åˆ¶æ ·å¼ã€å…¬å¼ç­‰ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">            target_cell </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> target_ws.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">cell.row, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">cell.column)</span></span>
<span class="line"><span style="color:#ABB2BF;">            target_cell.value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cell.value</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> merge_excel_workbooks</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_a_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">file_b_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½ä¸¤ä¸ªå·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook_a </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        file_a_path, </span><span style="color:#E06C75;font-style:italic;">keep_vba</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">keep_links</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook_b </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        file_b_path, </span><span style="color:#E06C75;font-style:italic;">keep_vba</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">keep_links</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†Bå·¥ä½œç°¿çš„æ‰€æœ‰sheet</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> sheet_b </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> workbook_b.sheetnames:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheet_b_obj </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook_b[sheet_b]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æŸ¥æ‰¾Aå·¥ä½œç°¿ä¸­æ˜¯å¦æœ‰åŒåï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰çš„sheet</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheet_a_name </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> sheet_a_name_candidate </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> workbook_a.sheetnames:</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> sheet_a_name_candidate.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> sheet_b.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                sheet_a_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sheet_a_name_candidate</span></span>
<span class="line"><span style="color:#C678DD;">                break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¦‚æœæ‰¾åˆ°åŒåsheetï¼Œåˆ™å°†Bè¡¨çš„å†…å®¹è¿½åŠ åˆ°Aè¡¨çš„åŒåsheetä¸­</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> sheet_a_name:</span></span>
<span class="line"><span style="color:#ABB2BF;">            sheet_a_obj </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook_a[sheet_a_name]</span></span>
<span class="line"><span style="color:#ABB2BF;">            max_row_a </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sheet_a_obj.max_row</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sheet_b_obj.</span><span style="color:#61AFEF;">iter_rows</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">min_row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">values_only</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                sheet_a_obj.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(row)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            sheet_a_obj </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook_a.</span><span style="color:#61AFEF;">create_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">title</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">sheet_b)</span></span>
<span class="line"><span style="color:#61AFEF;">            copy_worksheet_contents</span><span style="color:#ABB2BF;">(sheet_b_obj, sheet_a_obj)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒåsheetï¼Œåˆ™å°†Bè¡¨çš„sheetç§»åŠ¨åˆ°Aå·¥ä½œç°¿ä¸­</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # else:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     worksheet_to_add = workbook_b[sheet_b]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #     workbook_a._add_sheet(workbook_b[sheet_b], index=workbook_a.sheetnames.index(</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #         workbook_a.active.title) + 1)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜åˆå¹¶åçš„å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook_a.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(output_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h3 id="æˆæœå±•ç¤º-ç§’é€Ÿå®Œæˆå‡ ç™¾ä¸ªè¡¨æ ¼çš„æ•°æ®æ±‡æ€»" tabindex="-1">æˆæœå±•ç¤ºï¼šç§’é€Ÿå®Œæˆå‡ ç™¾ä¸ªè¡¨æ ¼çš„æ•°æ®æ±‡æ€» <a class="header-anchor" href="#æˆæœå±•ç¤º-ç§’é€Ÿå®Œæˆå‡ ç™¾ä¸ªè¡¨æ ¼çš„æ•°æ®æ±‡æ€»" aria-label="Permalink to &quot;æˆæœå±•ç¤ºï¼šç§’é€Ÿå®Œæˆå‡ ç™¾ä¸ªè¡¨æ ¼çš„æ•°æ®æ±‡æ€»&quot;">â€‹</a></h3><p>ç»è¿‡Pythonè‡ªåŠ¨åŒ–å·¥å…·çš„å¤„ç†ï¼ŒåŸæœ¬éœ€è¦ä¸€ä¸ªæœˆæ‰èƒ½å®Œæˆçš„æ•°æ®æ±‡æ€»å·¥ä½œï¼Œç°åœ¨åªéœ€å‡ ç§’é’Ÿå°±èƒ½è½»æ¾æå®šã€‚è¿™ä¸ä»…å¤§å¤§æé«˜äº†å·¥ä½œæ•ˆç‡ï¼Œè¿˜ç¡®ä¿äº†æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240526153218638.BbLZCkc2.png" alt="image-20240526153218638"></p><h2 id="è½»æ¾å®ç°è·¨-sheet-è¡¨æŸ¥è¯¢åŠŸèƒ½" tabindex="-1">è½»æ¾å®ç°è·¨ sheet è¡¨æŸ¥è¯¢åŠŸèƒ½ <a class="header-anchor" href="#è½»æ¾å®ç°è·¨-sheet-è¡¨æŸ¥è¯¢åŠŸèƒ½" aria-label="Permalink to &quot;è½»æ¾å®ç°è·¨ sheet è¡¨æŸ¥è¯¢åŠŸèƒ½&quot;">â€‹</a></h2><p>åœ¨æ—¥å¸¸çš„åŠå…¬åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†åŒ…å«å¤šä¸ªå·¥ä½œè¡¨ï¼ˆsheetï¼‰çš„ Excel æ–‡ä»¶ï¼Œå¹¶åœ¨è¿™äº›å·¥ä½œè¡¨ä¹‹ä¸­è¿›è¡Œæ•°æ®æŸ¥è¯¢å’ŒåŒ¹é…ã€‚ä¼ ç»Ÿçš„åšæ³•é€šå¸¸æ˜¯æ‰‹åŠ¨æ‰“å¼€ Excel æ–‡ä»¶ï¼Œç„¶åé€ä¸ªå·¥ä½œè¡¨è¿›è¡Œæœç´¢ï¼Œè¿™ç§æ–¹æ³•æ•ˆç‡ä½ä¸‹ï¼Œè´¹äº‹è´¹åŠ›ã€‚</p><p><strong>åœºæ™¯æè¿°</strong></p><p>æœ‹å‹æ˜¯ä¸€å®¶å“ç‰Œå…¬å¸çš„ç”µå•†è¿è¥ï¼Œåœ¨ç¹å¿™çš„ç”µå•†è¿è¥ä¸­ï¼Œå¤„ç†æ¥è‡ªå®¢æˆ·çš„å’¨è¯¢æ˜¯ä¸€é¡¹æ—¥å¸¸ä¸”é‡è¦çš„å·¥ä½œã€‚å½“å®¢æˆ·åœ¨æŠ–éŸ³å®˜æ–¹åº—é“ºä¸­è¯¢é—®ç‰¹å®šäº§å“æ—¶ï¼Œå¦‚æœèƒ½å¿«é€Ÿå®šä½åˆ°äº§å“ä¿¡æ¯ï¼Œæ— ç–‘ä¼šæå¤§æå‡å®¢æˆ·æ»¡æ„åº¦å’Œè¿è¥æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œæœ‹å‹æ‰‹é‡Œçš„äº§å“èµ„æ–™æ˜¯æŒ‰ç…§ç³»åˆ—è¿›è¡Œåˆ†è¡¨çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç³»åˆ—äº§å“æ˜¯ä¸€ä¸ª sheetï¼Œå½“å®¢æˆ·è¯¢é—®çš„ä¸æ˜¯å…·ä½“çš„äº§å“åç§°è€Œæ˜¯ä¸€äº›äº§å“å‚æ•°æ—¶ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†å¤šè¡¨æŸ¥è¯¢çš„é—®é¢˜äº†ï¼Œä¼ ç»Ÿçš„ WPS å’Œ Office æ˜¯ä¸æ”¯æŒå¤šè¡¨æŸ¥è¯¢çš„ï¼Œä¼ ç»Ÿçš„ Excel æ“ä½œæ–¹å¼â€”â€”é€ä¸ªå·¥ä½œè¡¨ä½¿ç”¨ Ctrl+F è¿›è¡Œæœç´¢ï¼Œä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Python çš„å¼ºå¤§åŠŸèƒ½æ¥è‡ªåŠ¨åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œå®ç°è½»æ¾å¿«æ·çš„è·¨è¡¨æŸ¥è¯¢åŠŸèƒ½ã€‚</p><p>ã€æ¯”å¦‚ç²‰ä¸çš„è¿™ä¸ªé—®é¢˜ï¼Œå°±éœ€è¦æ‰“å¼€æ‰€æœ‰çš„äº§å“è¡¨æ ¼å»æŒ¨ä¸ªæŸ¥æ‰¾æ•´ä¸ªè¡¨æ ¼é‡Œæ˜¯å¦æœ‰ MH è¿™ä¸ªä¿¡æ¯ï¼Œæˆ‘çš„äº§å“ç³»åˆ—æœ‰ä¸Šç™¾ä¸ªï¼Œå°±éœ€è¦é‡å¤ä¸Šç™¾æ¬¡åˆ‡æ¢ sheet è¡¨â€”&gt;Ctrl+F æ“ä½œã€‘</p><p><img src="/ProgramLearnNotes/assets/image-20240511165016030.5rR5eB87.png" alt="image-20240511165016030"></p><h3 id="æ•°æ®åˆ†æ-1" tabindex="-1">æ•°æ®åˆ†æ <a class="header-anchor" href="#æ•°æ®åˆ†æ-1" aria-label="Permalink to &quot;æ•°æ®åˆ†æ&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šä¸€ä¸ªåŒ…å«ä¸Šç™¾ä¸ª Sheet è¡¨çš„ Excel æ–‡ä»¶ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>æŸ¥æ‰¾æ¯ä¸ª Sheet è¡¨ä¸­æ˜¯å¦åŒ…å«éœ€è¦çš„ä¿¡æ¯</li><li>è¿”å› Sheet è¡¨åå’ŒæŸ¥æ‰¾ä¿¡æ¯æ‰€åœ¨çš„å•å…ƒæ ¼</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šæŸ¥è¯¢ä¿¡æ¯æ‰€åœ¨çš„ Sheet è¡¨åå’Œå•å…ƒæ ¼ä½ç½®ã€‚</p></li></ul><h3 id="ç¤ºä¾‹æ•°æ®-1" tabindex="-1">ç¤ºä¾‹æ•°æ® <a class="header-anchor" href="#ç¤ºä¾‹æ•°æ®-1" aria-label="Permalink to &quot;ç¤ºä¾‹æ•°æ®&quot;">â€‹</a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸Šç™¾ä¸ª Sheet è¡¨ï¼Œåä¸º<code>data.xlsx</code>çš„ Excel æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ª Sheet è¡¨éƒ½åŒ…å«ä»¥ä¸‹åˆ—ï¼š</p><ul><li>è´§å“ç¼–ç </li><li>è´§å“æè¿°</li><li>å…¶ä»–ä¸€äº›åˆ—</li></ul><h3 id="å®æˆ˜ä»£ç -2" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -2" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> openpyxl</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> search_product_in_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">search_value</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    results </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æ¯ä¸ªå·¥ä½œè¡¨</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> sheet_name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> workbook.sheetnames:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sheet </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook[sheet_name]</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;æ­£åœ¨æœç´¢è¡¨æ ¼</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">sheet</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # éå†æ¯ä¸ªå•å…ƒæ ¼</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sheet.</span><span style="color:#61AFEF;">iter_rows</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">min_row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">min_col</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">max_col</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">sheet.max_column, </span><span style="color:#E06C75;font-style:italic;">max_row</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">sheet.max_row):</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> cell </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> row:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> cell.value:</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(cell.value).</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">(search_value)</span><span style="color:#56B6C2;">!=-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                        # æ‰¾åˆ°å€¼ï¼Œæ·»åŠ ç»“æœåˆ°åˆ—è¡¨ä¸­</span></span>
<span class="line"><span style="color:#ABB2BF;">                        results.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">((sheet_name, cell.coordinate))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> results</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">file_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;your_excel_file.xlsx&#39;</span><span style="color:#7F848E;font-style:italic;">  # æ›¿æ¢ä¸ºä½ çš„Excelæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">search_value </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;MH&#39;</span><span style="color:#7F848E;font-style:italic;">  # æ›¿æ¢ä¸ºä½ è¦æœç´¢çš„å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">results </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> cross_sheet_search</span><span style="color:#ABB2BF;">(file_path, search_value)</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> result </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> results:</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;åœ¨å·¥ä½œè¡¨ </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">result[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> çš„å•å…ƒæ ¼ </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">result[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> æ‰¾åˆ°äº†å€¼ &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">result[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="è¿è¡Œç»“æœ" tabindex="-1">è¿è¡Œç»“æœ <a class="header-anchor" href="#è¿è¡Œç»“æœ" aria-label="Permalink to &quot;è¿è¡Œç»“æœ&quot;">â€‹</a></h3><p><img src="/ProgramLearnNotes/assets/image-20240511165107665.CgdJ-P9i.png" alt="image-20240511165107665"></p><h3 id="æ€»ç»“-3" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-3" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>é€šè¿‡ Python å’Œ openpyxl åº“ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°è·¨è¡¨æŸ¥è¯¢åŠŸèƒ½ï¼Œæå¤§åœ°æé«˜äº†åŠå…¬æ•ˆç‡ã€‚æ— è®ºæ˜¯å¤„ç†å•ä¸ª Excel æ–‡ä»¶è¿˜æ˜¯æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼ŒPython éƒ½èƒ½å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿã€å‡†ç¡®åœ°å®Œæˆä»»åŠ¡ã€‚å¸Œæœ›æœ¬æ–‡çš„ä»‹ç»å’Œç¤ºä¾‹ä»£ç èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°åº”å¯¹æ—¥å¸¸åŠå…¬ä¸­çš„æŒ‘æˆ˜ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚</p><h2 id="æ‰¹é‡-pdf-è½¬å›¾ç‰‡-é«˜æ•ˆå“åº”å®¢æˆ·éœ€æ±‚" tabindex="-1">æ‰¹é‡ PDF è½¬å›¾ç‰‡ï¼Œé«˜æ•ˆå“åº”å®¢æˆ·éœ€æ±‚ <a class="header-anchor" href="#æ‰¹é‡-pdf-è½¬å›¾ç‰‡-é«˜æ•ˆå“åº”å®¢æˆ·éœ€æ±‚" aria-label="Permalink to &quot;æ‰¹é‡ PDF è½¬å›¾ç‰‡ï¼Œé«˜æ•ˆå“åº”å®¢æˆ·éœ€æ±‚&quot;">â€‹</a></h2><p>åœ¨ç°ä»£å•†ä¸šç«äº‰ä¸­ï¼Œå¿«é€Ÿé«˜æ•ˆååº”å·²æˆä¸ºä¼ä¸šäº‰å¤ºå®¢æˆ·çš„ç§˜è¯€ã€‚éšç€å…¨çƒåŒ–å’Œäº’è”ç½‘çš„æ™®åŠï¼Œä¾›éœ€åŒæ–¹ä¿¡æ¯çš„é€æ˜åŒ–ç¨‹åº¦ä¸æ–­æé«˜ï¼Œä¼ä¸šèƒ½å¦é«˜æ•ˆå¿«é€Ÿåœ°åŒ¹é…å®¢æˆ·éœ€æ±‚å¹¶è§£å†³é—®é¢˜ï¼Œæˆä¸ºå†³å®šå…¶ç«äº‰åŠ›çš„å…³é”®å› ç´ ã€‚æœ€è¿‘ï¼Œæˆ‘é€šè¿‡è¿ç”¨ Python è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ï¼Œå¸®åŠ©æœ‹å‹çš„å…¬å¸è¿…é€Ÿå“åº”å®¢æˆ·éœ€æ±‚ï¼Œå–å¾—äº†å®¢æˆ·çš„ä¿¡ä»»å’Œå¤§è®¢å•ã€‚</p><p>äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œä¸€ä¸ªå¤§å®¢æˆ·ç”±äºå“ç‰Œæ›´æ”¹å’Œé¢†å¯¼å±‚çš„å˜åŠ¨ï¼Œéœ€è¦æ‰¹é‡ä¿®æ”¹ä¹‹å‰å·²ç»åˆ¶ä½œå¥½çš„äº§å“æ ·å†Œã€‚è¿™äº›æ ·å†Œä»¥ PDF æ ¼å¼æä¾›è€Œä¸”æ•°é‡å·¨å¤§ã€‚ä¸ºäº†å°½æ—©ä¸Šå¸‚ï¼Œè¿™ä¸ªå®¢æˆ·ç»™æ‰€æœ‰çš„åˆä½œä¾›åº”å•†éƒ½å‘é€äº† PDF äº§å“å†Œï¼Œä¹Ÿå°±æ„å‘³ç€è°èƒ½ç¬¬ä¸€æ—¶é—´å®Œæˆä¿®æ”¹ï¼Œè°å°±èƒ½æ‹¿åˆ°è¿™ä¸ªå¤§è®¢å•ã€‚</p><p>å½“å¯¹è¿™äº› PDF å›¾å†Œç›´æ¥è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé—®é¢˜å°±å‡ºç°äº†ã€‚ç”±äº PDF æ–‡ä»¶æœ¬èº«çš„ç‰¹æ€§ï¼Œç›´æ¥ç¼–è¾‘å®ƒä»¬ä¼šé‡åˆ°å„ç§è§£æé—®é¢˜ï¼Œä½¿å¾—ä¿®æ”¹è¿‡ç¨‹å˜å¾—å›°éš¾ä¸”è€—æ—¶ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¬å¸ç¾å·¥æå‡ºå°† PDF æ–‡ä»¶è½¬æ¢ä¸ºå›¾ç‰‡æ ¼å¼ï¼Œå†ä½¿ç”¨ä¸“ä¸šçš„å›¾åƒç¼–è¾‘è½¯ä»¶ PS è¿›è¡Œä¿®æ”¹ã€‚ä½†æ˜¯å®¢æˆ·ç»™çš„äº§å“å†Œæ•°é‡å·¨å¤§ï¼Œæ‰‹åŠ¨å°†æ¯ä¸ª PDF æ–‡ä»¶è½¬æ¢ä¸ºå›¾ç‰‡æ ¼å¼æ˜¯ä¸€é¡¹ç¹çä¸”è€—æ—¶çš„ä»»åŠ¡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ–‡ä»¶æ—¶ã€‚</p><p>é¢å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼Œæˆ‘æå‡ºäº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šåˆ©ç”¨ Python è„šæœ¬å°†å®¢æˆ·ç»™çš„æ‰€æœ‰ PDF æ–‡ä»¶æ‰¹é‡è½¬æ¢ä¸ºå›¾ç‰‡æ ¼å¼ï¼Œå†ç”±ç¾å·¥ä½¿ç”¨ä¸“ä¸šçš„å›¾åƒç¼–è¾‘è½¯ä»¶è¿›è¡Œä¿®æ”¹ã€‚</p><h3 id="python-ä»£ç " tabindex="-1">python ä»£ç  <a class="header-anchor" href="#python-ä»£ç " aria-label="Permalink to &quot;python ä»£ç &quot;">â€‹</a></h3><p>å®‰è£…åº“</p><div class="language-py line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">pip install PyMuPDF</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ä»£ç </p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> fitz  </span><span style="color:#7F848E;font-style:italic;"># PyMuPDFåº“ï¼Œç”¨äºå¤„ç†PDFæ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># from PIL import Image</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> pdf_to_images</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">pdf_folder</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_folder</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰PDFæ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> pdf_file </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(pdf_folder):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> pdf_file.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">((</span><span style="color:#98C379;">&#39;.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.PDF&#39;</span><span style="color:#ABB2BF;">)):</span></span>
<span class="line"><span style="color:#ABB2BF;">            pdf_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(pdf_folder, pdf_file)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ‰“å¼€PDFæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">            doc </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> fitz.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(pdf_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åˆ›å»ºè¾“å‡ºæ–‡ä»¶å¤¹ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">            output_subfolder </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(output_folder, os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(pdf_file)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(output_subfolder):</span></span>
<span class="line"><span style="color:#ABB2BF;">                os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(output_subfolder)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # éå†PDFçš„æ¯ä¸€é¡µ</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> page_num </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(doc)):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # è·å–å½“å‰é¡µçš„Pixmapå¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">                page </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> doc.</span><span style="color:#61AFEF;">load_page</span><span style="color:#ABB2BF;">(page_num)</span></span>
<span class="line"><span style="color:#ABB2BF;">                image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> page.</span><span style="color:#61AFEF;">get_pixmap</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # pix = doc.get_page_pixmap(page_num, alpha=False)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # å°†Pixmapå¯¹è±¡è½¬æ¢ä¸ºPIL Imageå¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # image = Image.frombytes(</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     &quot;RGB&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     [pix.width, pix.height],</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     pix.samples[&quot;RGB&quot;],</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     &quot;raw&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     &quot;RGB&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     pix.stride,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                #     -1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # ä¿å­˜å›¾ç‰‡åˆ°æŒ‡å®šæ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#ABB2BF;">                output_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(output_subfolder, </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pdf_file.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">_page_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">page_num</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1}</span><span style="color:#98C379;">.png&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                image.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(output_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å…³é—­PDFæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">            doc.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç¤ºä¾‹ä½¿ç”¨</span></span>
<span class="line"><span style="color:#ABB2BF;">pdf_folder </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;./&quot;</span><span style="color:#7F848E;font-style:italic;">  # PDFæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">output_folder </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;product_images&quot;</span><span style="color:#7F848E;font-style:italic;">  # è¾“å‡ºæ–‡ä»¶å¤¹è·¯å¾„</span></span>
<span class="line"><span style="color:#61AFEF;">pdf_to_images</span><span style="color:#ABB2BF;">(pdf_folder, output_folder)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>è¿™ä¸ªè„šæœ¬å°†éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ PDF æ–‡ä»¶ï¼Œå¹¶å°†æ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸€é¡µè½¬æ¢ä¸º PNG å›¾ç‰‡ã€‚è½¬æ¢åçš„å›¾ç‰‡å°†ä¿å­˜åœ¨ä¸åŸå§‹ PDF æ–‡ä»¶åŒåçš„å­æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä»¥ç‰¹å®šçš„å‘½åè§„åˆ™è¿›è¡Œå‘½åã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511165233544.BEEiGWbQ.png" alt="image-20240511165233544"></p><h3 id="ç»“è¯­-1" tabindex="-1">ç»“è¯­ <a class="header-anchor" href="#ç»“è¯­-1" aria-label="Permalink to &quot;ç»“è¯­&quot;">â€‹</a></h3><p>é€šè¿‡ Python è‡ªåŠ¨åŒ–æ‰¹é‡ PDF è½¬å›¾ç‰‡çš„æ“ä½œï¼Œæˆ‘æˆåŠŸå¸®åŠ©æœ‹å‹çš„å…¬å¸å¿«é€Ÿå“åº”äº†å®¢æˆ·éœ€æ±‚ï¼Œæå‡äº†å®¢æˆ·æ»¡æ„åº¦ï¼Œæˆä¸ºç¬¬ä¸€ä¸ªå®Œæˆä»»åŠ¡çš„å…¬å¸æˆåŠŸæ‹¿ä¸‹å®¢æˆ·å¤§è®¢å•ï¼Œå½“å…¶ä»–åˆä½œå•†è¿˜åœ¨æ‹¼å‘½åœ°å †äººåŠ›è§£å†³æ‰¹é‡ PDF è½¬å›¾ç‰‡çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å·²ç»å°†ä¿®æ”¹å¥½çš„äº§å“å†Œå‘ç»™å®¢æˆ·äº†ã€‚</p><p>è¿™å°±æ˜¯ Python è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯çš„å¼ºå¤§èƒ½åŠ›ï¼ŒæŒæ¡è¿™ä¸€æŠ€èƒ½å°†ä½¿æˆ‘ä»¬åœ¨æœªæ¥çš„å·¥ä½œä¸­æ›´åŠ é«˜æ•ˆã€ä¸“ä¸šã€‚</p><h2 id="pdfæ–‡ä»¶çš„æ‹†åˆ†å’Œåˆå¹¶" tabindex="-1">PDFæ–‡ä»¶çš„æ‹†åˆ†å’Œåˆå¹¶ <a class="header-anchor" href="#pdfæ–‡ä»¶çš„æ‹†åˆ†å’Œåˆå¹¶" aria-label="Permalink to &quot;PDFæ–‡ä»¶çš„æ‹†åˆ†å’Œåˆå¹¶&quot;">â€‹</a></h2><p>åœ¨å¿«èŠ‚å¥çš„å•†æµ·ä¸­ï¼Œäº§å“çº¿æ›´æ–°é€Ÿåº¦çŠ¹å¦‚ä¼ä¸šçš„â€œç”Ÿå‘½ä¹‹è„‰â€ã€‚å½“æ–°å“å¦‚é›¨åæ˜¥ç¬‹èˆ¬æ¶Œç°ï¼Œä½ æ˜¯å¦è¿˜åœ¨ä¸ºå¦‚ä½•å¿«é€Ÿæ›´æ–°ç”µå­æ ·å†Œè€Œçƒ¦æ¼ï¼Ÿäº§å“å†Œä¸€å¹´ä¸€æ›´æ–°ï¼Œå…¶å®å¾ˆå¤šæ—¶å€™åªéœ€è¦åœ¨å»å¹´æ ·å“å†Œçš„åŸºç¡€ä¸Šï¼Œå¢åŠ æ–°çš„ä¸€å¹´åŒç³»åˆ—è¿½åŠ çš„äº§å“å’Œå…¨æ–°ç³»åˆ—çš„äº§å“ï¼Œé€šè¿‡pdfçš„åˆå¹¶å’Œæ‹†åˆ†å³å¯å®ç°</p><hr><h3 id="èƒŒæ™¯" tabindex="-1">èƒŒæ™¯ <a class="header-anchor" href="#èƒŒæ™¯" aria-label="Permalink to &quot;èƒŒæ™¯&quot;">â€‹</a></h3><p>åœ¨æ—¥æ–°æœˆå¼‚çš„å•†ä¸šç¯å¢ƒä¸­ï¼Œäº§å“çº¿çš„å¿«é€Ÿæ›´æ–°æ˜¯ä¼ä¸šä¿æŒå¸‚åœºç«äº‰åŠ›çš„å…³é”®ã€‚ç„¶è€Œï¼Œé¢å¯¹ä¸æ–­æ›´æ–°çš„äº§å“ï¼Œäº§å“å†Œå¾€å¾€åªéœ€è¦åœ¨åŸæœ‰æ ·å“å†Œçš„åŸºç¡€ä¸Šï¼Œæ›´æ–°ä¸Šæ–°å“ã€‚å…¬å¸ä¹‹å‰æ ·å“å†Œæ›´æ–°ï¼Œæ€»æ˜¯éœ€è¦æ‰¾å¤–åŒ…ç¾å·¥è¿›è¡Œç”µå­æ ·å†Œæ›´æ–°ï¼Œä¸ä»…å¢åŠ äº†å…¬å¸è´¹ç”¨ï¼Œè¿˜éœ€è¦åè°ƒå¤–åŒ…äººå‘˜çš„æ—¶é—´ï¼Œæ— æ³•ä¿è¯äº¤æœŸï¼Œæ•ˆç‡ä½ä¸‹ä¸”æˆæœ¬é«˜æ˜‚ã€‚</p><p>éšç€2023å¹´å’Œ2024å¹´æ–°äº§å“çš„ä¸æ–­æ¶Œç°ï¼Œå…¬å¸åŸæœ‰çš„2022å¹´ç”µå­æ ·å†Œå·²ç»æ— æ³•æ»¡è¶³å±•ç¤ºæ–°äº§å“çš„éœ€æ±‚ã€‚è¿™äº›æ–°äº§å“æ—¢åŒ…æ‹¬åœ¨åŸæœ‰ç³»åˆ—ä¸­è¿½åŠ çš„ï¼Œä¹Ÿæœ‰å…¨æ–°å¼€å‘çš„æ–°ç³»åˆ—ã€‚ä¸ºäº†åŠæ—¶å±•ç¤ºå…¬å¸çš„æœ€æ–°äº§å“é˜µå®¹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç”µå­æ ·å†Œè¿›è¡Œæ›´æ–°ã€‚</p><p><img src="/ProgramLearnNotes/assets/640-48948.CCKLk5KD.webp" alt="å›¾ç‰‡"></p><p><strong><img src="/ProgramLearnNotes/assets/640-1716128146064-1.D3cTwrVd.webp" alt="å›¾ç‰‡"></strong></p><h3 id="ä¸€ã€ä¼ ç»Ÿæ›´æ–°æ–¹å¼çš„å¼Šç«¯" tabindex="-1">ä¸€ã€ä¼ ç»Ÿæ›´æ–°æ–¹å¼çš„å¼Šç«¯ <a class="header-anchor" href="#ä¸€ã€ä¼ ç»Ÿæ›´æ–°æ–¹å¼çš„å¼Šç«¯" aria-label="Permalink to &quot;ä¸€ã€ä¼ ç»Ÿæ›´æ–°æ–¹å¼çš„å¼Šç«¯&quot;">â€‹</a></h3><p>åœ¨è¿‡å»ï¼Œæ¯å½“æ–°å“ä¸Šå¸‚ï¼Œå…¬å¸éƒ½éœ€è¦è”ç³»å¤–åŒ…ç¾å·¥å›¢é˜Ÿï¼Œå°†æ–°å“çš„å›¾ç‰‡ã€æè¿°ç­‰ä¿¡æ¯äº¤ç»™ä»–ä»¬ï¼Œç„¶åç­‰å¾…ä»–ä»¬å®Œæˆç”µå­æ ·å†Œçš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼å­˜åœ¨è¯¸å¤šå¼Šç«¯ï¼š</p><ol><li><strong>æˆæœ¬é«˜æ˜‚</strong>ï¼šå¤–åŒ…ç¾å·¥å›¢é˜Ÿé€šå¸¸æ”¶è´¹ä¸è²ï¼Œè€Œä¸”éšç€æ›´æ–°æ¬¡æ•°çš„å¢åŠ ï¼Œæˆæœ¬ä¹Ÿä¼šä¸æ–­æ”€å‡ã€‚</li><li><strong>æ—¶é—´æˆæœ¬é«˜</strong>ï¼šéœ€è¦ä¸æ–­ä¸å¤–åŒ…å›¢é˜Ÿæ²Ÿé€šåè°ƒï¼Œç­‰å¾…ä»–ä»¬å®Œæˆæ›´æ–°ï¼Œè¿™å¾€å¾€éœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ã€‚</li><li><strong>è´¨é‡éš¾ä»¥ä¿è¯</strong>ï¼šå¤–åŒ…å›¢é˜Ÿå¯èƒ½å¯¹äº§å“çš„ç†è§£ä¸å¤Ÿæ·±å…¥ï¼Œå¯¼è‡´æ›´æ–°åçš„ç”µå­æ ·å†Œä¸é¢„æœŸä¸ç¬¦ï¼Œç”šè‡³å­˜åœ¨é”™è¯¯ã€‚</li></ol><h3 id="äºŒã€python-ä½ çš„è‡ªåŠ¨åŒ–åŠå…¬ç¥å™¨" tabindex="-1">äºŒã€Pythonï¼šä½ çš„è‡ªåŠ¨åŒ–åŠå…¬ç¥å™¨ <a class="header-anchor" href="#äºŒã€python-ä½ çš„è‡ªåŠ¨åŒ–åŠå…¬ç¥å™¨" aria-label="Permalink to &quot;äºŒã€Pythonï¼šä½ çš„è‡ªåŠ¨åŒ–åŠå…¬ç¥å™¨&quot;">â€‹</a></h3><p>ä¸ºäº†æ‘†è„±ä¼ ç»Ÿæ›´æ–°æ–¹å¼çš„å¼Šç«¯ï¼Œæˆ‘ä»¬å¼•å…¥äº†Pythonè‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ã€‚é€šè¿‡Pythonçš„PyPDF2åº“ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°PDFçš„æ‹†åˆ†å’Œåˆå¹¶ï¼Œè®©ç”µå­æ ·å†Œçš„æ›´æ–°å˜å¾—ç®€å•å¿«æ·ã€‚</p><h4 id="_1-pdfæ‹†åˆ†" tabindex="-1">1.PDFæ‹†åˆ† <a class="header-anchor" href="#_1-pdfæ‹†åˆ†" aria-label="Permalink to &quot;1.PDFæ‹†åˆ†&quot;">â€‹</a></h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†2022å¹´çš„ç”µå­æ ·å†ŒPDFæ–‡ä»¶è¿›è¡Œæ‹†åˆ†ã€‚è¿™å¯ä»¥é€šè¿‡Pythonçš„PyPDF2åº“å®ç°ã€‚é€šè¿‡è¯»å–PDFæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æ¯ä¸ªé¡µé¢çš„å†…å®¹ï¼Œå¹¶å°†å…¶å•ç‹¬ä¿å­˜ä¸ºä¸€ä¸ªæ–°çš„PDFæ–‡ä»¶ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†æ–°è¿½åŠ çš„äº§å“é¡µé¢ä»åŸå§‹PDFä¸­æ‹†åˆ†å‡ºæ¥ã€‚</p><h4 id="_2-pdfåˆå¹¶" tabindex="-1">2.PDFåˆå¹¶ <a class="header-anchor" href="#_2-pdfåˆå¹¶" aria-label="Permalink to &quot;2.PDFåˆå¹¶&quot;">â€‹</a></h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å°†æ–°è¿½åŠ çš„äº§å“é¡µé¢åˆå¹¶åˆ°åŸç³»åˆ—ä¸­ï¼Œå¹¶å°†æ–°å¼€å‘çš„ç³»åˆ—é¡µé¢åˆå¹¶åˆ°ä¸€èµ·ã€‚è¿™åŒæ ·å¯ä»¥é€šè¿‡PyPDF2åº“å®ç°ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„PDFå†™å…¥å¯¹è±¡ï¼Œç„¶åä¾æ¬¡å°†éœ€è¦åˆå¹¶çš„é¡µé¢æ·»åŠ åˆ°è¯¥å¯¹è±¡ä¸­ï¼Œå¹¶æœ€ç»ˆå°†åˆå¹¶åçš„å†…å®¹å†™å…¥ä¸€ä¸ªæ–°çš„PDFæ–‡ä»¶ã€‚</p><h3 id="ä¸‰ã€å®ç°è¿‡ç¨‹" tabindex="-1">ä¸‰ã€å®ç°è¿‡ç¨‹ <a class="header-anchor" href="#ä¸‰ã€å®ç°è¿‡ç¨‹" aria-label="Permalink to &quot;ä¸‰ã€å®ç°è¿‡ç¨‹&quot;">â€‹</a></h3><h4 id="å®‰è£…pypdf2åº“" tabindex="-1">å®‰è£…PyPDF2åº“ <a class="header-anchor" href="#å®‰è£…pypdf2åº“" aria-label="Permalink to &quot;å®‰è£…PyPDF2åº“&quot;">â€‹</a></h4><p>é¦–å…ˆï¼Œç¡®ä¿æ‚¨å·²ç»å®‰è£…äº†PyPDF2åº“ã€‚å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install PyPDF2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="ç¼–å†™pythonè„šæœ¬" tabindex="-1">ç¼–å†™Pythonè„šæœ¬ <a class="header-anchor" href="#ç¼–å†™pythonè„šæœ¬" aria-label="Permalink to &quot;ç¼–å†™Pythonè„šæœ¬&quot;">â€‹</a></h4><p>æ¥ä¸‹æ¥ï¼Œå¯ä»¥ç¼–å†™ä¸€ä¸ªPythonè„šæœ¬æ¥å®ç°PDFçš„æ‹†åˆ†å’Œåˆå¹¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹è„šæœ¬ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> PyPDF2  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> split_pdf</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_pdf_path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_folder</span><span style="color:#ABB2BF;">):  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # æ‹†åˆ†PDFæ–‡ä»¶  </span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(input_pdf_path, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> input_pdf_file:  </span></span>
<span class="line"><span style="color:#ABB2BF;">        pdf_reader </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> PyPDF2.</span><span style="color:#61AFEF;">PdfFileReader</span><span style="color:#ABB2BF;">(input_pdf_file)  </span></span>
<span class="line"><span style="color:#ABB2BF;">        num_pages </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pdf_reader.</span><span style="color:#61AFEF;">getNumPages</span><span style="color:#ABB2BF;">()  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> page_num </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(num_pages):  </span></span>
<span class="line"><span style="color:#ABB2BF;">            output_pdf_path </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">output_folder</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/page_</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">page_num</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1}</span><span style="color:#98C379;">.pdf&quot;</span><span style="color:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#ABB2BF;">            pdf_writer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> PyPDF2.</span><span style="color:#61AFEF;">PdfFileWriter</span><span style="color:#ABB2BF;">()  </span></span>
<span class="line"><span style="color:#ABB2BF;">            pdf_writer.</span><span style="color:#61AFEF;">addPage</span><span style="color:#ABB2BF;">(pdf_reader.</span><span style="color:#61AFEF;">getPage</span><span style="color:#ABB2BF;">(page_num))  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(output_pdf_path, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> output_pdf_file:  </span></span>
<span class="line"><span style="color:#ABB2BF;">                pdf_writer.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(output_pdf_file)  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> merge_pdfs</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">input_pdf_paths</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_pdf_path</span><span style="color:#ABB2BF;">):  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åˆå¹¶PDFæ–‡ä»¶  </span></span>
<span class="line"><span style="color:#ABB2BF;">    pdf_writer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> PyPDF2.</span><span style="color:#61AFEF;">PdfFileWriter</span><span style="color:#ABB2BF;">()  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> input_pdf_path </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> input_pdf_paths:  </span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(input_pdf_path, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> input_pdf_file:  </span></span>
<span class="line"><span style="color:#ABB2BF;">            pdf_reader </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> PyPDF2.</span><span style="color:#61AFEF;">PdfFileReader</span><span style="color:#ABB2BF;">(input_pdf_file)  </span></span>
<span class="line"><span style="color:#ABB2BF;">            num_pages </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pdf_reader.</span><span style="color:#61AFEF;">getNumPages</span><span style="color:#ABB2BF;">()  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> page_num </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(num_pages):  </span></span>
<span class="line"><span style="color:#ABB2BF;">                pdf_writer.</span><span style="color:#61AFEF;">addPage</span><span style="color:#ABB2BF;">(pdf_reader.</span><span style="color:#61AFEF;">getPage</span><span style="color:#ABB2BF;">(page_num))  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(output_pdf_path, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> output_pdf_file:  </span></span>
<span class="line"><span style="color:#ABB2BF;">        pdf_writer.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(output_pdf_file)  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹  </span></span>
<span class="line"><span style="color:#61AFEF;">split_pdf</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;2022_catalog.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;split_pages&#39;</span><span style="color:#ABB2BF;">)  </span></span>
<span class="line"><span style="color:#61AFEF;">merge_pdfs</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;split_pages/page_1.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;split_pages/page_2.pdf&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;updated_series.pdf&#39;</span><span style="color:#ABB2BF;">)  </span></span>
<span class="line"><span style="color:#61AFEF;">merge_pdfs</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;new_series_page_1.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;new_series_page_2.pdf&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;new_series.pdf&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œsplit_pdfå‡½æ•°ç”¨äºæ‹†åˆ†PDFæ–‡ä»¶ï¼Œmerge_pdfså‡½æ•°ç”¨äºåˆå¹¶å¤šä¸ªPDFæ–‡ä»¶ã€‚æ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹è¾“å…¥å’Œè¾“å‡ºè·¯å¾„ï¼Œä»¥åŠè¦æ‹†åˆ†å’Œåˆå¹¶çš„é¡µé¢ã€‚</p><h3 id="ç»“è¯­-2" tabindex="-1">ç»“è¯­ <a class="header-anchor" href="#ç»“è¯­-2" aria-label="Permalink to &quot;ç»“è¯­&quot;">â€‹</a></h3><p>Pythonè‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯å·²ç»æˆä¸ºä¼ä¸šæå‡æ•ˆç‡ã€é™ä½æˆæœ¬çš„é‡è¦å·¥å…·ã€‚é€šè¿‡å¼•å…¥Pythonè‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ï¼Œæˆ‘ä»¬æˆåŠŸæ‘†è„±äº†ä¼ ç»Ÿç”µå­æ ·å†Œæ›´æ–°æ–¹å¼çš„å¼Šç«¯ï¼Œå®ç°äº†å¿«é€Ÿã€å‡†ç¡®ã€ä½æˆæœ¬çš„æ›´æ–°è¿‡ç¨‹ã€‚</p><h2 id="ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶-å‘Šåˆ«æ‰‹åŠ¨ç¿»æ‰¾çš„çƒ¦æ¼-æ‹¯æ•‘ä½ çš„-æ–‡ä»¶å †" tabindex="-1">ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶ï¼Œå‘Šåˆ«æ‰‹åŠ¨ç¿»æ‰¾çš„çƒ¦æ¼ï¼æ‹¯æ•‘ä½ çš„â€œæ–‡ä»¶å †â€ï¼ <a class="header-anchor" href="#ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶-å‘Šåˆ«æ‰‹åŠ¨ç¿»æ‰¾çš„çƒ¦æ¼-æ‹¯æ•‘ä½ çš„-æ–‡ä»¶å †" aria-label="Permalink to &quot;ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶ï¼Œå‘Šåˆ«æ‰‹åŠ¨ç¿»æ‰¾çš„çƒ¦æ¼ï¼æ‹¯æ•‘ä½ çš„â€œæ–‡ä»¶å †â€ï¼&quot;">â€‹</a></h2><h3 id="å°æçš„-æ–‡ä»¶å †" tabindex="-1">å°æçš„&quot;æ–‡ä»¶å †&quot; <a class="header-anchor" href="#å°æçš„-æ–‡ä»¶å †" aria-label="Permalink to &quot;å°æçš„&quot;æ–‡ä»¶å †&quot;&quot;">â€‹</a></h3><p>æˆ‘çš„æœ‹å‹å°ææ˜¯ä»–ä»¬å…¬å¸çš„æ ¸å¿ƒè®¾è®¡å…ƒè€ã€‚è‡ªå…¬å¸æˆç«‹ä»¥æ¥ï¼Œæ‰€æœ‰çš„äº§å“è®¾è®¡éƒ½å‡ºè‡ªå°æä¹‹æ‰‹ï¼Œè€Œæ‰€æœ‰çš„äº§å“å‚æ•°ä¹Ÿéƒ½æ˜¯ä»–åœ¨ç²¾å¿ƒè®°å½•ã€‚ä½†æ˜¯ï¼Œå°ææœ‰ä¸€ä¸ªå°å°çš„â€œåä¹ æƒ¯â€â€”â€”ä»–å¹¶ä¸æ˜¯ä¸€ä¸ªæ“…é•¿æ–‡ä»¶æ•´ç†çš„äººã€‚</p><p>åœ¨å°æçš„ç”µè„‘é‡Œï¼Œæ— æ•°çš„æ–‡ä»¶ç›´æ¥å­˜æ”¾åœ¨ C ç›˜æˆ–è€…å¾®ä¿¡çš„ç¼“å­˜è·¯å¾„ä¸­ï¼ŒçŠ¹å¦‚ä¸€åº§åº§æœªå¼€å‘çš„â€œçŸ¿å±±â€ã€‚æ¯å½“å…¬å¸éœ€è¦å›é¡¾æŸä¸ªäº§å“çš„è®¾è®¡åŸç¨¿æˆ–è€…æŸ¥æ‰¾æŸä¸ªäº§å“çš„å‚æ•°æ—¶ï¼Œå°æå°±éœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´å»æ‰‹åŠ¨ç¿»æ‰¾è¿™äº›æ–‡ä»¶ã€‚è¿™ä¸ä»…æµªè´¹äº†ä»–å®è´µçš„æ—¶é—´ï¼Œä¹Ÿç»™ä»–çš„å·¥ä½œå¸¦æ¥äº†ä¸å°‘éº»çƒ¦ã€‚è¿™æ—¶å°±éœ€è¦èƒ½å¤ŸæŒ‰ç…§æ–‡ä»¶åå’Œæ–‡ä»¶å…³é”®è¯çš„å·¥å…·</p><p>æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾ï¼Œè½»æ¾å®šä½ç›®æ ‡æ–‡ä»¶</p><p>åœ¨æµ©å¦‚çƒŸæµ·çš„æ–‡ä»¶ä¸­ï¼Œæœ‰æ—¶æˆ‘ä»¬åªéœ€è¦æ ¹æ®æ–‡ä»¶åå°±èƒ½å¿«é€Ÿå®šä½åˆ°ç›®æ ‡æ–‡ä»¶ã€‚Windows è‡ªå¸¦çš„è¿™ä¸ªåŠŸèƒ½æœ‰ä¸¤å¤§é—®é¢˜ï¼šä¸€æ˜¯æ— æ³•å…¨å±€æœç´¢ï¼ŒäºŒæ˜¯æœç´¢é€Ÿåº¦ææ…¢ã€‚</p><p>å½“ä½ çŸ¥é“æ–‡ä»¶åæˆ–æ–‡ä»¶åæ¨¡å¼æ—¶ï¼ŒPython çš„ glob æ¨¡å—å°±èƒ½å¤§æ˜¾èº«æ‰‹ã€‚é€šè¿‡ç®€å•çš„å‡ è¡Œä»£ç ï¼Œä½ å°±èƒ½æŒ‰ç…§æ–‡ä»¶åæ¨¡å¼æŸ¥æ‰¾æ–‡ä»¶ï¼ŒPython çš„ glob æ¨¡å—å°±èƒ½æ´¾ä¸Šå¤§ç”¨åœºã€‚é€šè¿‡ç®€å•çš„å‡ è¡Œä»£ç ï¼Œä½ å°±èƒ½æŒ‰ç…§æ–‡ä»¶åæ¨¡å¼æŸ¥æ‰¾æ–‡ä»¶ï¼Œæ— è®ºæ˜¯å…¨å±€æ–‡ä»¶è¿˜æ˜¯å½“å‰ç›®å½•è¿˜æ˜¯å­ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œåªéœ€è¦ä½ è¾“å…¥ä½ æƒ³è¦æŸ¥æ‰¾çš„ç¡¬ç›˜èŒƒå›´å’Œæ–‡ä»¶åæ ¼å¼ï¼Œéƒ½èƒ½è½»æ¾æ‰¾åˆ°ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> glob</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> find_files_by_name</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">pattern</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">path</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;.&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">    :param pattern: æ–‡ä»¶åæ¨¡å¼ï¼Œä¾‹å¦‚ &quot;*vft*.pdf,æ–‡ä»¶ååŒ…å«vftçš„pdfæ–‡ä»¶&quot;</span></span>
<span class="line"><span style="color:#98C379;">    :param path: æŸ¥æ‰¾çš„ç›®å½•è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•</span></span>
<span class="line"><span style="color:#98C379;">    :return: åŒ¹é…åˆ°çš„æ–‡ä»¶åˆ—è¡¨</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> glob.</span><span style="color:#61AFEF;">glob</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/**/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pattern</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">recursive</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#ABB2BF;">file_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> find_files_by_name</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;*vft*.pdf&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;E:</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">code</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">pdf2word</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> file_path </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> file_list:</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(file_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240514153728881.Je-JAEeG.png" alt="image-20240514153728881"></p><h3 id="æŒ‰ç…§æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ–‡ä»¶" tabindex="-1">æŒ‰ç…§æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ–‡ä»¶ <a class="header-anchor" href="#æŒ‰ç…§æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ–‡ä»¶" aria-label="Permalink to &quot;æŒ‰ç…§æ–‡ä»¶å†…å®¹æŸ¥æ‰¾æ–‡ä»¶&quot;">â€‹</a></h3><p>ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬å¯èƒ½åªçŸ¥é“æ–‡ä»¶å†…å®¹ä¸­çš„æŸä¸ªå…³é”®è¯æˆ–ç‰¹å®šæ ¼å¼ï¼Œè¿™æ—¶å°±éœ€è¦æŒ‰ç…§æ–‡ä»¶å†…å®¹æ¥æŸ¥æ‰¾æ–‡ä»¶äº†ã€‚Python çš„ os å’Œ re æ¨¡å—å°†åŠ©ä½ ä¸€è‡‚ä¹‹åŠ›ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">st </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å‡è®¾å°æè¦æŸ¥æ‰¾åŒ…å«&quot;import&quot;å…³é”®è¯çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> search_content</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">key_word</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;font-style:italic;">root_dir</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    pattern </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">compile</span><span style="color:#ABB2BF;">(key_word)</span></span>
<span class="line"><span style="color:#ABB2BF;">    matching_files </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> root, dirs, files </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">walk</span><span style="color:#ABB2BF;">(root_dir):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> files:</span></span>
<span class="line"><span style="color:#ABB2BF;">            file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(root, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> file_path.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">((</span><span style="color:#98C379;">&#39;.psd&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.ai&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.csv&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;.xlsx&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;.docx&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;.py&quot;</span><span style="color:#ABB2BF;">)):  </span><span style="color:#7F848E;font-style:italic;"># å‡è®¾å°æçš„æ–‡ä»¶ä¸»è¦æ˜¯è¿™äº›ç±»å‹</span></span>
<span class="line"><span style="color:#C678DD;">                with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">errors</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;ignore&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> f.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> pattern.</span><span style="color:#61AFEF;">search</span><span style="color:#ABB2BF;">(content):</span></span>
<span class="line"><span style="color:#ABB2BF;">                        matching_files.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> matching_files</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¾“å‡ºåŒ¹é…åˆ°çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">file_paths </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> search_content</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;import&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;E:</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> file_path </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> file_paths:</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">et </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">u_t </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> et </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> st</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;ä¸€å…±æŸ¥æ‰¾åˆ°äº†</span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(file_paths)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">ä¸ªæ–‡ä»¶&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;ç”¨æ—¶</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">u_t</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">s&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>ä»…éœ€ 6s å°±èƒ½ä» 370G çš„ç¡¬ç›˜ä¸­ï¼ŒæŸ¥æ‰¾åˆ°äº† 29000 å¤šä¸ªåŒ¹é…çš„æ–‡ä»¶ï¼Œæ•ˆç‡æƒŠäºº</p><h3 id="ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶-è®©ä½ çš„ç”µè„‘äº•äº•æœ‰æ¡" tabindex="-1">ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶ï¼Œè®©ä½ çš„ç”µè„‘äº•äº•æœ‰æ¡ <a class="header-anchor" href="#ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶-è®©ä½ çš„ç”µè„‘äº•äº•æœ‰æ¡" aria-label="Permalink to &quot;ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶ï¼Œè®©ä½ çš„ç”µè„‘äº•äº•æœ‰æ¡&quot;">â€‹</a></h3><p>é€šè¿‡å°†ä»¥ä¸Šä»£ç æ‰“åŒ…æˆ exe æ–‡ä»¶ã€æ–¹æ³•å¯ä»¥å‚ç…§å¦ä¸€ç¯‡æ–‡ç« ã€Š<a href="http://mp.weixin.qq.com/s?__biz=Mzk0ODYxNzY5Nw==&amp;mid=2247484780&amp;idx=1&amp;sn=70c47650d878c801dc634e27400af975&amp;chksm=c365ade2f41224f4e49514b6f9edafa23478ed7367315861501b3a1821db5451174c78626373&amp;scene=21#wechat_redirect" target="_blank" rel="noreferrer">äººäººéƒ½èƒ½äº«å—åŠå…¬è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©â€”â€”ä¸‰æ­¥å°† Python ç¨‹åºè½¬ä¸ºè½¯ä»¶</a>ã€‹ã€‘ï¼Œå°æç»ˆäºèƒ½å¤Ÿè½»æ¾å®ç°ä¸€é”®æŸ¥æ‰¾æ–‡ä»¶çš„åŠŸèƒ½äº†ã€‚ä»–çš„å·¥ä½œæ•ˆç‡å¤§å¤§æé«˜ï¼Œå†ä¹Ÿä¸ç”¨ä¸ºäº†æ‰¾ä¸€ä¸ªæ–‡ä»¶è€Œçƒ¦æ¼äº†ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä»–çš„ç”µè„‘ä¹Ÿå˜å¾—æ›´åŠ äº•äº•æœ‰æ¡äº†ï¼</p><h2 id="pdf-è½¬-word" tabindex="-1">pdf è½¬ word <a class="header-anchor" href="#pdf-è½¬-word" aria-label="Permalink to &quot;pdf è½¬ word&quot;">â€‹</a></h2><p>æœ€è¿‘ï¼Œæˆ‘æ‰‹ä¸Šæœ‰ä¸ª PDF èµ„æ–™éœ€è¦è½¬æ¢ä¸º Word æ ¼å¼ï¼Œè¿™ç§è½¬æ¢åŠŸèƒ½åœ¨ä¼—å¤šæ–‡æ¡£å¤„ç†å·¥å…·ä¸­å·²ç»ç›¸å½“æ™®éã€‚</p><p>ç„¶è€Œï¼Œå‡ºäºå¥½å¥‡ï¼Œæˆ‘å†³å®šæ¢ç´¢ä¸€ä¸‹æŸå®å¹³å°ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰äººé’ˆå¯¹è¿™ä¸€å¸¸è§éœ€æ±‚æä¾›ä¸“é—¨çš„å•†å“æœåŠ¡ã€‚</p><p>æœç´¢äº†ä¸€ä¸‹å…³é”®è¯ <strong>â€œpdf è½¬ wordâ€</strong> ï¼Œç¬é—´æƒŠå‘†äº†ï¼Œè¿™ç§å°åŠŸèƒ½ç«Ÿç„¶éœ€æ±‚é‡è¿™ä¹ˆå¤§ï¼Œéƒ½æ˜¯å‡ ä¸‡äººä»˜æ¬¾ï¼š</p><p><img src="/ProgramLearnNotes/assets/640-1714914807650-762.BJPyGIAr.webp" alt="å›¾ç‰‡"></p><p>çœ‹å®Œåï¼Œæˆ‘æƒ³ç€è¿™ä¸ªç”¨ä»£ç æ¥å®ç°æ˜¯å¾ˆç®€å•çš„ã€‚</p><p>ç„¶åå°±æ‰¾äº†ä¸€ä¸ª python å¼€æºåº“ <strong>pdf2docx</strong> æ¥è¯•è¯•ã€‚</p><p>**å®˜æ–¹åœ°å€ï¼š**<a href="https://pdf2docx.readthedocs.io/en/latest/" target="_blank" rel="noreferrer">https://pdf2docx.readthedocs.io/en/latest/</a></p><p>**å¼€æºåœ°å€ï¼š**<a href="https://github.com/ArtifexSoftware/pdf2docx" target="_blank" rel="noreferrer">https://github.com/ArtifexSoftware/pdf2docx</a></p><p>**é¡¹ç›®ä»‹ç»ï¼š**Python å¼€æºåº“ pdf2docx æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œå®ƒä¸“é—¨ç”¨äºå°† PDF æ–‡ä»¶è½¬æ¢ä¸º DOCX æ ¼å¼çš„æ–‡æ¡£ï¼Œpdf2docx åˆ©ç”¨äº† PyMuPDF å’Œ python-docx ä¸¤ä¸ªåº“ï¼Œé€šè¿‡è§„åˆ™è§£æ PDF æ–‡ä»¶çš„å¸ƒå±€ï¼Œå¹¶ç”Ÿæˆ Microsoft Word å…¼å®¹çš„ DOCX æ–‡ä»¶ã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1714914807650-763.BMiL-iON.webp" alt="å›¾ç‰‡"></p><p><strong>å®‰è£…</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">pip</span><span style="color:#98C379;"> install</span><span style="color:#98C379;"> pdf2docx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å®‰è£…å®Œæˆåï¼Œæˆ‘å°±æ‹¿äº†ä¸€ä¸ªç®€å•çš„ PDF æ–‡ä»¶æ¥æµ‹è¯•ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pdf2docx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Converter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">pdf_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;./sample.pdf&#39;</span><span style="color:#7F848E;font-style:italic;">   # pdf æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">docx_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;./sample.docx&#39;</span><span style="color:#7F848E;font-style:italic;"> # docx æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">cv </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Converter</span><span style="color:#ABB2BF;">(pdf_file)   </span><span style="color:#7F848E;font-style:italic;">#  pdf è½¬ä¸º docx</span></span>
<span class="line"><span style="color:#ABB2BF;">cv.</span><span style="color:#61AFEF;">convert</span><span style="color:#ABB2BF;">(docx_file)      </span><span style="color:#7F848E;font-style:italic;"># é»˜è®¤è½¬æ¢æ‰€æœ‰é¡µé¢</span></span>
<span class="line"><span style="color:#ABB2BF;">cv.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ç„¶åï¼Œæˆ‘æ‰¾äº†ä¸ª PDF æ–‡ä»¶ <strong>sample.pdf</strong>ï¼Œæ‰§è¡Œä»¥ä¸Šä»£ç ï¼Œè½¬åŒ–æ•ˆæœéå¸¸å®Œç¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/ProgramLearnNotes/assets/640-1714914807650-764.DvMobFoS.webp" alt="å›¾ç‰‡"></p><p>æ„Ÿè§‰æˆ‘å¯ä»¥ç›´æ¥ç”¨è¿™ 6 è¡Œä»£ç å»å¼€åº—èµšé’±äº†ï¼Œå“ˆå“ˆå“ˆ ğŸ˜‚ ï½ï½ï½</p><p>è¿™ä¸ªéœ€æ±‚è¿˜å¯ä»¥å®ç°è‡ªåŠ¨åŒ–ï¼šç”¨æˆ·åœ¨èŠå¤©çª—å£æå‡ºè¦è½¬æ¢çš„éœ€æ±‚ï¼Œæˆ‘ç”¨èŠå¤©ç³»ç»Ÿè‡ªåŠ¨å›å¤ä¸€ä¸ªé“¾æ¥ç»™ä»–ï¼Œç”¨æˆ·æ‰“å¼€é“¾æ¥ï¼Œæäº¤ PDF æ–‡ä»¶ï¼Œå°±è‡ªåŠ¨è½¬æ¢æˆ docx è¿”å›ç»™ä»–ï¼ˆä¹Ÿå¯ä»¥åœ¨è½¬æ¢æˆåŠŸåï¼Œå¼¹å‡ºä»˜è´¹ä¸‹è½½æŒ‰é’®ï¼‰ï¼Œè¿™æ ·å°±å¾ˆå®Œç¾ï¼Œä¸ç”¨æ¯æ¬¡è½¬æ¢å®Œåè¿˜è¦å›å¤å®¢æˆ·ï¼Œèººç€ç¡è§‰ä¹Ÿå¯ä»¥åœ¨èµšé’±ã€‚</p><p>å…¶å®è¿™ç§å°éœ€æ±‚æŸå®ä¸Šè¿˜æœ‰å¾ˆå¤šï¼Œåªæ˜¯å¹³æ—¶æˆ‘ä»¬æ²¡æœ‰ç‰¹åˆ«å»å…³æ³¨ï¼Œè‡ªå·±ä»¥ä¸ºå¾ˆç®€å•çš„åŠŸèƒ½ï¼Œå¯¹ä¸æ‡‚çš„äººæ¥è¯´éƒ½æ˜¯ä¸€ä¸ªå·¨å¤§çš„å›°éš¾ï¼Œè€Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ç»™åˆ«äººè§£å†³é—®é¢˜ï¼Œæä¾›å¸®åŠ©ï¼Œé¡ºä¾¿è·å–ç‚¹æ”¶ç›Šã€‚</p><p>æƒ³æƒ³æœ‰æ—¶å€™æˆ‘ä»¬å¼€å‘äººå‘˜ä¹Ÿè¦æœ‰äº§å“æ€ç»´ï¼Œå› ä¸ºå³ä½¿æ˜¯çœ‹ä¼¼ç®€å•çš„æŠ€æœ¯ï¼Œåªè¦èƒ½å¤Ÿæ»¡è¶³ç‰¹å®šç”¨æˆ·ç¾¤ä½“çš„éœ€æ±‚ï¼Œéƒ½æœ‰å¯èƒ½è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰åˆ©å¯å›¾çš„å•†ä¸šæœºä¼šã€‚</p><p>è¿™ä¸ªæ¡ˆä¾‹ä¹Ÿä¸ºæˆ‘æä¾›äº†ä¸€ä¸ªæ–°çš„è§†è§’ï¼Œè¦å¤šå»å‘ç°å’ŒæŒ–æ˜æ—¥å¸¸ç”Ÿæ´»ä¸­å¯èƒ½è¢«å¿½è§†çš„å•†æœºã€‚</p><p>è¿˜æœ‰å¾ˆå¤šæœ‰æ„æ€çš„å°ä¿¡æ¯å·®é¡¹ç›®ï¼Œå…¶å®æŠ€æœ¯å®ç°éƒ½ä¸éš¾ï¼Œä¸»è¦è¿˜æ˜¯ä¿¡æ¯å·®çš„é—®é¢˜ã€‚</p><p>æ¯”å¦‚æœ€è¿‘æ¯”è¾ƒçƒ­é—¨çš„å…¬ä¼—å·è¿è¥èµšé’±ã€è§†é¢‘å·è§†é¢‘å†…å®¹ä¸‹è½½ç­‰ï¼Œå‡æ˜¯ä¸é”™çš„å°è€Œç¾çš„é¡¹ç›®å“¦ï¼</p><h2 id="è½»æ¾åˆå¹¶æ‰¹é‡-word-æ–‡æ¡£å¹¶ç»Ÿä¸€æ ¼å¼" tabindex="-1">è½»æ¾åˆå¹¶æ‰¹é‡ Word æ–‡æ¡£å¹¶ç»Ÿä¸€æ ¼å¼ <a class="header-anchor" href="#è½»æ¾åˆå¹¶æ‰¹é‡-word-æ–‡æ¡£å¹¶ç»Ÿä¸€æ ¼å¼" aria-label="Permalink to &quot;è½»æ¾åˆå¹¶æ‰¹é‡ Word æ–‡æ¡£å¹¶ç»Ÿä¸€æ ¼å¼&quot;">â€‹</a></h2><p>åœ¨ä¼ä¸šè¿è¥ä¸­ï¼Œå„ä¸ªéƒ¨é—¨å¸¸å¸¸éœ€è¦æäº¤å®šæœŸæŠ¥å‘Šï¼Œå¦‚å‘¨æŠ¥æˆ–æœˆæŠ¥ã€‚ä¸ºäº†å…¨é¢æŒæ¡å„éƒ¨é—¨çš„å·¥ä½œæƒ…å†µï¼Œç®¡ç†å±‚é€šå¸¸å¸Œæœ›å°†è¿™äº›æŠ¥å‘Šåˆå¹¶æˆä¸€ä¸ªå•ç‹¬çš„æ–‡æ¡£è¿›è¡Œæ±‡æ€»å’Œå®¡é˜…ï¼Œå¹¶ä¿æŒä¸€ä¸ªç»Ÿä¸€çš„æ ¼å¼ã€‚ç„¶è€Œï¼Œæ‰‹åŠ¨åˆå¹¶è¿™äº›æ–‡æ¡£æ—¢è€—æ—¶åˆå®¹æ˜“å‡ºé”™ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Python è‡ªåŠ¨åŒ–åˆå¹¶ Word æ–‡æ¡£ï¼Œå¤§å¹…æå‡æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚</p><h3 id="æ•°æ®åˆ†æ-2" tabindex="-1">æ•°æ®åˆ†æ <a class="header-anchor" href="#æ•°æ®åˆ†æ-2" aria-label="Permalink to &quot;æ•°æ®åˆ†æ&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šå¤šä¸ª Word æ–‡æ¡£ï¼ˆæ¯ä¸ªéƒ¨é—¨çš„å‘¨æŠ¥æˆ–æœˆæŠ¥ï¼‰ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>ä½¿ç”¨<code>python-docx</code>åº“è¯»å–æ¯ä¸ªæ–‡æ¡£çš„å†…å®¹ã€‚</li><li>å°†æ‰€æœ‰æ–‡æ¡£å†…å®¹æŒ‰é¡ºåºåˆå¹¶åˆ°ä¸€ä¸ªæ–°çš„ Word æ–‡æ¡£ä¸­ï¼Œå¹¶ç»Ÿä¸€æ–‡æ¡£æ ¼å¼ã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰æŠ¥å‘Šçš„åˆå¹¶æ–‡æ¡£ã€‚</p></li></ul><h3 id="å®ä¾‹æ•°æ®" tabindex="-1">å®ä¾‹æ•°æ® <a class="header-anchor" href="#å®ä¾‹æ•°æ®" aria-label="Permalink to &quot;å®ä¾‹æ•°æ®&quot;">â€‹</a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªéƒ¨é—¨çš„æœˆåº¦æŠ¥å‘Šï¼Œæ–‡ä»¶åå¦‚ä¸‹ï¼š</p><ul><li>Marketing_Report.docx</li><li>Sales_Report.docx</li><li>HR_Report.docx</li></ul><h3 id="å®æˆ˜ä»£ç -3" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -3" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Document</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx.shared </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Pt</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx.enum.text </span><span style="color:#C678DD;">import</span><span style="color:#D19A66;"> WD_ALIGN_PARAGRAPH</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> merge_documents_with_uniform_format</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">files</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_file</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">font_name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&#39;Calibri&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">font_size</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">line_spacing</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">1.15</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    merged_document </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Document</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è®¾ç½®ç»Ÿä¸€çš„æ ·å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    style </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> merged_document.styles[</span><span style="color:#98C379;">&#39;Normal&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    font </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> style.font</span></span>
<span class="line"><span style="color:#ABB2BF;">    font.name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> font_name</span></span>
<span class="line"><span style="color:#ABB2BF;">    font.size </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Pt</span><span style="color:#ABB2BF;">(font_size)</span></span>
<span class="line"><span style="color:#ABB2BF;">    paragraph_format </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> style.paragraph_format</span></span>
<span class="line"><span style="color:#ABB2BF;">    paragraph_format.line_spacing </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> line_spacing</span></span>
<span class="line"><span style="color:#ABB2BF;">    paragraph_format.alignment </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> WD_ALIGN_PARAGRAPH</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">JUSTIFY</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†å¹¶åˆå¹¶æ‰€æœ‰æ–‡æ¡£</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> files:</span></span>
<span class="line"><span style="color:#ABB2BF;">        sub_doc </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Document</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¤åˆ¶å­æ–‡æ¡£ä¸­çš„æ¯ä¸ªå…ƒç´ åˆ°åˆå¹¶æ–‡æ¡£ä¸­</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> element </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sub_doc.element.body:</span></span>
<span class="line"><span style="color:#ABB2BF;">            merged_document.element.body.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(element)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜åˆå¹¶åçš„æ–‡æ¡£</span></span>
<span class="line"><span style="color:#ABB2BF;">    merged_document.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(output_file)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ–‡æ¡£åˆ—è¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;">files </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;Marketing_Report.docx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Sales_Report.docx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;HR_Report.docx&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">output_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;Merged_Monthly_Report_With_Uniform_Format.docx&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°åˆå¹¶æ–‡æ¡£å¹¶è®¾ç½®ç»Ÿä¸€æ ¼å¼</span></span>
<span class="line"><span style="color:#61AFEF;">merge_documents_with_uniform_format</span><span style="color:#ABB2BF;">(files, output_file)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240511165332063.rESafK-g.png" alt="image-20240511165332063"></p><h3 id="æ€»ç»“-4" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-4" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>è¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ python-docx åº“è‡ªåŠ¨åŒ–åˆå¹¶å¤šä¸ª Word æ–‡æ¡£ã€‚é€šè¿‡é€ä¸ªè¯»å–å¹¶åˆå¹¶å„ä¸ªéƒ¨é—¨çš„æŠ¥å‘Šå†…å®¹ï¼Œæˆ‘ä»¬æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªç»Ÿä¸€çš„æœˆåº¦æ±‡æ€»æŠ¥å‘Šã€‚è¿™ç§è‡ªåŠ¨åŒ–åˆå¹¶ä¸ä»…ä¿è¯äº†æŠ¥å‘Šçš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ï¼Œè¿˜æ˜¾è‘—èŠ‚çœäº†æ‰‹åŠ¨å¤„ç†çš„æ—¶é—´å’Œç²¾åŠ›ã€‚è‡ªåŠ¨åŒ–åˆå¹¶æ–‡æ¡£çš„æ–¹æ³•éå¸¸é€‚åˆéœ€è¦å®šæœŸæ•´ç†å¤§é‡æ–‡æ¡£çš„ä¼ä¸šå’Œæœºæ„ï¼Œèƒ½å¤Ÿå¤§å¹…æå‡ä»–ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚</p><h2 id="è‡ªåŠ¨åŒ–æå–-word-æ–‡æ¡£ä¿¡æ¯-åŠ©åŠ›å•†ä¸šæ–‡æ¡£æ•°æ®è§£æ" tabindex="-1">è‡ªåŠ¨åŒ–æå– Word æ–‡æ¡£ä¿¡æ¯ï¼šåŠ©åŠ›å•†ä¸šæ–‡æ¡£æ•°æ®è§£æ <a class="header-anchor" href="#è‡ªåŠ¨åŒ–æå–-word-æ–‡æ¡£ä¿¡æ¯-åŠ©åŠ›å•†ä¸šæ–‡æ¡£æ•°æ®è§£æ" aria-label="Permalink to &quot;è‡ªåŠ¨åŒ–æå– Word æ–‡æ¡£ä¿¡æ¯ï¼šåŠ©åŠ›å•†ä¸šæ–‡æ¡£æ•°æ®è§£æ&quot;">â€‹</a></h2><p>åœ¨ç¹å¿™çš„å•†ä¸šç¯å¢ƒä¸­ï¼Œæ–‡æ¡£å¤„ç†æ˜¯ä¸€é¡¹ç¹é‡ä¸”è‡³å…³é‡è¦çš„ä»»åŠ¡ã€‚åˆåŒã€æŠ¥å‘Šå’Œå…¶ä»–ä¸šåŠ¡æ–‡æ¡£å¾€å¾€åŒ…å«å¤§é‡å…³é”®ä¿¡æ¯ï¼Œå¦‚æ—¥æœŸã€é‡‘é¢å’ŒåˆåŒæ–¹åç§°ç­‰ã€‚æ‰‹åŠ¨æå–è¿™äº›ä¿¡æ¯ä¸ä»…è€—æ—¶è´¹åŠ›ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚å¹¸è¿çš„æ˜¯ï¼Œå€ŸåŠ© Python çš„è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥é«˜æ•ˆåœ°æå–è¿™äº›å…³é”®æ•°æ®ï¼Œæ˜¾è‘—æå‡å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚</p><h3 id="åœºæ™¯æè¿°" tabindex="-1">åœºæ™¯æè¿° <a class="header-anchor" href="#åœºæ™¯æè¿°" aria-label="Permalink to &quot;åœºæ™¯æè¿°&quot;">â€‹</a></h3><p>åœ¨å•†ä¸šä¸–ç•Œä¸­ï¼Œå¿«é€Ÿå‡†ç¡®åœ°ä»åˆåŒã€æŠ¥å‘Šç­‰æ–‡æ¡£ä¸­æå–ç‰¹å®šä¿¡æ¯æ˜¯ä¸€é¡¹å¸¸è§éœ€æ±‚ã€‚è¿™äº›ä¿¡æ¯å¯¹äºå†³ç­–åˆ¶å®šã€æ•°æ®åˆ†æå’ŒæŠ¥å‘Šç¼–å†™è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œæ‰‹åŠ¨å¤„ç†è¿™äº›æ–‡æ¡£ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Python ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬æ¥æå–è¿™äº›ä¿¡æ¯ã€‚</p><h3 id="æ•°æ®åˆ†æ-3" tabindex="-1">æ•°æ®åˆ†æ <a class="header-anchor" href="#æ•°æ®åˆ†æ-3" aria-label="Permalink to &quot;æ•°æ®åˆ†æ&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šåŒ…å«å…³é”®ä¸šåŠ¡æ•°æ®çš„ Word æ–‡æ¡£ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>ä½¿ç”¨<code>python-docx</code>åº“è¯»å– Word æ–‡æ¡£ã€‚</li><li>åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢å¹¶æå–æ‰€éœ€ä¿¡æ¯ã€‚</li><li>å°†æå–çš„ä¿¡æ¯å­˜å‚¨æˆ–è¾“å‡ºã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šæå–çš„å…³é”®ä¿¡æ¯ï¼Œä¾‹å¦‚ä»¥åˆ—è¡¨æˆ–å­—å…¸å½¢å¼ã€‚</p></li></ul><h3 id="å®æˆ˜ä»£ç -4" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -4" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> docx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Document</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> extract_info</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">doc_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    doc </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Document</span><span style="color:#ABB2BF;">(doc_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">    extracted_info </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ä»¥åŒ¹é…æ—¥æœŸå’Œé‡‘é¢</span></span>
<span class="line"><span style="color:#ABB2BF;">    date_pattern </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">compile</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;\d</span><span style="color:#D19A66;">{4}</span><span style="color:#E06C75;">å¹´\d</span><span style="color:#D19A66;">{1,2}</span><span style="color:#E06C75;">æœˆ\d</span><span style="color:#D19A66;">{1,2}</span><span style="color:#E06C75;">æ—¥&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    amount_pattern </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">compile</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;</span><span style="color:#56B6C2;">\$</span><span style="color:#E06C75;">\d</span><span style="color:#D19A66;">+</span><span style="color:#E06C75;">,</span><span style="color:#D19A66;">*</span><span style="color:#E06C75;">\d</span><span style="color:#D19A66;">*</span><span style="color:#E06C75;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æ–‡æ¡£çš„æ¯ä¸ªæ®µè½ï¼Œæå–ä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> para </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> doc.paragraphs:</span></span>
<span class="line"><span style="color:#ABB2BF;">        date_matches </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> date_pattern.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(para.text)</span></span>
<span class="line"><span style="color:#ABB2BF;">        amount_matches </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> amount_pattern.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(para.text)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> date_matches </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> amount_matches:</span></span>
<span class="line"><span style="color:#ABB2BF;">            extracted_info.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#98C379;">                &#39;date&#39;</span><span style="color:#ABB2BF;">: date_matches[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> date_matches </span><span style="color:#C678DD;">else</span><span style="color:#98C379;"> &#39;N/A&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">                &#39;amount&#39;</span><span style="color:#ABB2BF;">: amount_matches[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> amount_matches </span><span style="color:#C678DD;">else</span><span style="color:#98C379;"> &#39;N/A&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">            })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> extracted_info</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">doc_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;Contract.docx&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°å¹¶æ‰“å°ç»“æœ</span></span>
<span class="line"><span style="color:#ABB2BF;">info </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> extract_info</span><span style="color:#ABB2BF;">(doc_path)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(info)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="æ€»ç»“-5" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-5" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>é€šè¿‡ä½¿ç”¨ python-docx åº“å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬æˆåŠŸåœ°ä» Word æ–‡æ¡£ä¸­è‡ªåŠ¨åŒ–æå–äº†æ—¥æœŸå’Œé‡‘é¢ä¿¡æ¯ã€‚è¿™ç§è‡ªåŠ¨åŒ–æ–¹æ³•ä¸ä»…èŠ‚çœäº†å¤§é‡çš„äººåŠ›å’Œæ—¶é—´ï¼Œè€Œä¸”å‡å°‘äº†äººä¸ºé”™è¯¯ï¼Œæé«˜äº†æ•°æ®å¤„ç†çš„å¯é æ€§ã€‚å¯¹äºéœ€è¦å¤„ç†å¤§é‡ç›¸ä¼¼æ–‡æ¡£çš„æ³•å¾‹ã€é‡‘èå’Œè¡Œæ”¿éƒ¨é—¨æ¥è¯´ï¼Œè¿™ç§æŠ€æœ¯ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h2 id="ç§’çº§æ±‡æ€»æ‰¹é‡excelæ•°æ®" tabindex="-1">ç§’çº§æ±‡æ€»æ‰¹é‡Excelæ•°æ® <a class="header-anchor" href="#ç§’çº§æ±‡æ€»æ‰¹é‡excelæ•°æ®" aria-label="Permalink to &quot;ç§’çº§æ±‡æ€»æ‰¹é‡Excelæ•°æ®&quot;">â€‹</a></h2><p>è¿™ä¸ªè„šæœ¬èƒ½å¤Ÿè‡ªåŠ¨è¯»å–æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰Excelæ–‡ä»¶ï¼Œæå–å…¶ä¸­çš„æ•°æ®ï¼Œå¹¶æŒ‰ç…§é¢„è®¾çš„è§„åˆ™è¿›è¡Œæ•´ç†ã€‚å½“æœ‹å‹ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªè„šæœ¬çš„è¿è¡Œç»“æœæ—¶ï¼Œä»–ç®€ç›´ä¸æ•¢ç›¸ä¿¡è‡ªå·±çš„çœ¼ç›ã€‚ä»¥å‰éœ€è¦ä¸€å‘¨æ—¶é—´æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œç°åœ¨åªéœ€è¦å‡ ç§’é’Ÿå°±å®Œæˆäº†ï¼è€Œä¸”ï¼Œç”±äºè„šæœ¬çš„è‡ªåŠ¨åŒ–å¤„ç†ï¼Œæ•°æ®çš„å‡†ç¡®æ€§ä¹Ÿå¾—åˆ°äº†æå¤§çš„æé«˜ã€‚</p><p>å„ä¸ªåˆ†å…¬å¸æ±‡æ€»ä¸Šæ¥çš„è¡¨æ ¼</p><p><img src="/ProgramLearnNotes/assets/image-20240526152206096.RjpCcB3V.png" alt="image-20240526152206096"></p><p>æ¯ä¸ªè¡¨æ ¼ä¸­çš„å¤§ä½“å†…å®¹</p><p><img src="/ProgramLearnNotes/assets/image-20240526152222785.Cs0mi5aS.png" alt="image-20240526152222785"></p><p><strong>å°†æ‰€æœ‰è¡¨æ ¼å†…å®¹æ±‡æ€»åˆ°ä¸€ä¸ªè¡¨æ ¼çš„ä»£ç </strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> traverse_excel_files</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">folder_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    df_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> root, dirs, files </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">walk</span><span style="color:#ABB2BF;">(folder_path):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> files:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ ¹æ®æ–‡ä»¶æ‰©å±•ååˆ¤æ–­æ˜¯å¦ä¸º Excel æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xls&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xlsx&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(root, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åœ¨è¿™é‡Œå¯ä»¥å¯¹ Excel æ–‡ä»¶è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œï¼Œä¾‹å¦‚æ‰“å°æ–‡ä»¶è·¯å¾„ç­‰</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">                df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">                df_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(df)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> df_list</span></span>
<span class="line"><span style="color:#ABB2BF;">folder_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;./Excel&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">df_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> traverse_excel_files</span><span style="color:#ABB2BF;">(folder_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">merged_df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(df_list, </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">merged_df.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;merged.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>æ‰€æœ‰çš„excelå†…å®¹éƒ½åˆ°ä¸€ä¸ªè¡¨é‡Œäº†ã€æ¡ˆä¾‹ä¸­æ¯ä¸ªè¡¨æ ¼çš„å†…å®¹éƒ½æ˜¯ä¸€æ ·çš„ã€‘</p><p><img src="/ProgramLearnNotes/assets/image-20240526152255927.BIFhUILe.png" alt="image-20240526152255927"></p><p><strong>å°†æ‰€æœ‰Excelè¡¨çš„å†…å®¹åˆå¹¶åˆ°ä¸€ä¸ªExcelæ–‡ä»¶é‡Œï¼Œæ¯ä¸ªè¡¨å•ç‹¬æˆä¸€ä¸ªSheet</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> traverse_excel_files</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">folder_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # # åˆ›å»ºä¸€ä¸ªç©ºçš„ Excel æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    writer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">ExcelWriter</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;mergeEx.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> root, dirs, files </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">walk</span><span style="color:#ABB2BF;">(folder_path):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> files:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ ¹æ®æ–‡ä»¶æ‰©å±•ååˆ¤æ–­æ˜¯å¦ä¸º Excel æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xls&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xlsx&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(root, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                sheetname </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                # åœ¨è¿™é‡Œå¯ä»¥å¯¹ Excel æ–‡ä»¶è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œï¼Œä¾‹å¦‚æ‰“å°æ–‡ä»¶è·¯å¾„ç­‰</span></span>
<span class="line"><span style="color:#56B6C2;">                print</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">                df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">                df.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(writer, </span><span style="color:#E06C75;font-style:italic;">sheet_name</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">sheetname,</span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    writer.</span><span style="color:#61AFEF;">_save</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">folder_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;./Excel&#39;</span></span>
<span class="line"><span style="color:#61AFEF;">traverse_excel_files</span><span style="color:#ABB2BF;">(folder_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240526152335719.-qRjK4BE.png" alt="image-20240526152335719"></p><h2 id="æ‰¹é‡å¤„ç†300å¤šä¸ªè¡¨æ ¼" tabindex="-1">æ‰¹é‡å¤„ç†300å¤šä¸ªè¡¨æ ¼ <a class="header-anchor" href="#æ‰¹é‡å¤„ç†300å¤šä¸ªè¡¨æ ¼" aria-label="Permalink to &quot;æ‰¹é‡å¤„ç†300å¤šä¸ªè¡¨æ ¼&quot;">â€‹</a></h2><h3 id="ä¸€ã€èƒŒæ™¯æ•…äº‹-erpä¸Šçº¿-æ•°æ®è§„èŒƒåŒ–æˆæ‹¦è·¯è™" tabindex="-1">ä¸€ã€èƒŒæ™¯æ•…äº‹ï¼šERPä¸Šçº¿ï¼Œæ•°æ®è§„èŒƒåŒ–æˆæ‹¦è·¯è™ <a class="header-anchor" href="#ä¸€ã€èƒŒæ™¯æ•…äº‹-erpä¸Šçº¿-æ•°æ®è§„èŒƒåŒ–æˆæ‹¦è·¯è™" aria-label="Permalink to &quot;ä¸€ã€èƒŒæ™¯æ•…äº‹ï¼šERPä¸Šçº¿ï¼Œæ•°æ®è§„èŒƒåŒ–æˆæ‹¦è·¯è™&quot;">â€‹</a></h3><p>éšç€ä¼ä¸šæ•°å­—åŒ–è½¬å‹çš„åŠ é€Ÿï¼ŒERPï¼ˆä¼ä¸šèµ„æºè§„åˆ’ï¼‰ç³»ç»Ÿæˆä¸ºäº†ä¼—å¤šä¼ä¸šæå‡ç®¡ç†æ•ˆç‡ã€é™ä½æˆæœ¬çš„åˆ©å™¨ã€‚ç„¶è€Œï¼Œåœ¨ERPç³»ç»Ÿä¸Šçº¿çš„è¿‡ç¨‹ä¸­ï¼Œå†å²æ•°æ®çš„è§„èŒƒåŒ–å´æˆä¸ºäº†ä¸€é“éš¾ä»¥é€¾è¶Šçš„åã€‚æŸä¼ ç»Ÿä¼ä¸šå°±é­é‡äº†è¿™æ ·çš„å›°å¢ƒï¼šä»–ä»¬éœ€è¦ä¸Šä¼ çš„300å¤šä¸ªè¡¨æ ¼ä¸­ï¼Œæ•°æ®è§„èŒƒæ€§æå·®ï¼Œæ— æ³•æ»¡è¶³ERPç³»ç»Ÿè§„èŒƒåŒ–çš„æ•°æ®æ¨¡æ¿ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240526152410443.DuIVPLpi.png" alt="image-20240526152410443"></p><p>10æ¡æ•°æ®æ¸…æ´—æ›¿æ¢è§„åˆ™</p><p><img src="/ProgramLearnNotes/assets/image-20240526152429428.GqgeEJw1.png" alt="image-20240526152429428"></p><p>å¾…æ¸…ç†çš„300å¤šä¸ªè¡¨æ ¼</p><p><img src="/ProgramLearnNotes/assets/image-20240526152446491.CbhgrUlf.png" alt="image-20240526152446491"></p><h3 id="äºŒã€ä¼ ç»Ÿæ–¹æ³•-è€—æ—¶è€—åŠ›-æ•ˆç‡ä½ä¸‹" tabindex="-1">äºŒã€ä¼ ç»Ÿæ–¹æ³•ï¼šè€—æ—¶è€—åŠ›ï¼Œæ•ˆç‡ä½ä¸‹ <a class="header-anchor" href="#äºŒã€ä¼ ç»Ÿæ–¹æ³•-è€—æ—¶è€—åŠ›-æ•ˆç‡ä½ä¸‹" aria-label="Permalink to &quot;äºŒã€ä¼ ç»Ÿæ–¹æ³•ï¼šè€—æ—¶è€—åŠ›ï¼Œæ•ˆç‡ä½ä¸‹&quot;">â€‹</a></h3><p>é¢å¯¹å¦‚æ­¤åºå¤§çš„æ•°æ®è§„èŒƒåŒ–éœ€æ±‚ï¼Œä¼ ç»Ÿæ–¹æ³•é€šå¸¸æ˜¯æ‰“å¼€è¡¨æ ¼ï¼Œç„¶åé€ä¸€æŸ¥æ‰¾å†…å®¹ï¼Œè¿›è¡Œæ›¿æ¢å¹¶ä¿å­˜ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚æ®ä¼°ç®—ï¼ŒæŒ‰ç…§ä¼ ç»Ÿæ–¹æ³•è¿›è¡Œæ“ä½œï¼Œä¸€ä¸ªè¡¨æ ¼çš„ä¸€é¡¹æ›¿æ¢è§„åˆ™å¹³å‡éœ€è¦3åˆ†é’Ÿå·¦å³ï¼Œé‚£ä¹ˆå¯¹äº300å¤šä¸ªè¡¨æ ¼å’Œ10ä¸ªæ›¿æ¢è§„åˆ™æ¥è¯´ï¼Œå°±éœ€è¦æƒŠäººçš„9600åˆ†é’Ÿï¼Œçº¦åˆ160ä¸ªå°æ—¶ï¼è¿™æ— ç–‘æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ—¶é—´æˆæœ¬ã€‚</p><h3 id="ä¸‰ã€pythonè‡ªåŠ¨åŒ–åŠå…¬-ä¸¤ç§’é’Ÿæå®šè§„èŒƒåŒ–" tabindex="-1">ä¸‰ã€Pythonè‡ªåŠ¨åŒ–åŠå…¬ï¼šä¸¤ç§’é’Ÿæå®šè§„èŒƒåŒ– <a class="header-anchor" href="#ä¸‰ã€pythonè‡ªåŠ¨åŒ–åŠå…¬-ä¸¤ç§’é’Ÿæå®šè§„èŒƒåŒ–" aria-label="Permalink to &quot;ä¸‰ã€Pythonè‡ªåŠ¨åŒ–åŠå…¬ï¼šä¸¤ç§’é’Ÿæå®šè§„èŒƒåŒ–&quot;">â€‹</a></h3><p>æ­£å½“é¡¹ç›®é™·å…¥å›°å¢ƒä¹‹é™…ï¼ŒPythonè‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯å¦‚åŒæ•‘æ˜Ÿèˆ¬é™ä¸´ã€‚é€šè¿‡ç¼–å†™Pythonè„šæœ¬ï¼Œä¼ä¸šå¯ä»¥è½»æ¾å®ç°å¯¹åŸå§‹æ•°æ®çš„è§„èŒƒåŒ–æ¸…ç†ã€‚å…·ä½“æ¥è¯´ï¼Œåªéœ€è¦æ ¹æ®æ•°æ®è§„èŒƒåŒ–çš„éœ€æ±‚ï¼Œç¼–å†™ç›¸åº”çš„Pythonä»£ç ï¼Œç„¶åè¿è¡Œè„šæœ¬å³å¯ã€‚æ•´ä¸ªè¿‡ç¨‹åªéœ€ä¸¤ç§’é’Ÿæ—¶é—´ï¼Œæå¤§åœ°æé«˜äº†å·¥ä½œæ•ˆç‡ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook  </span><span style="color:#7F848E;font-style:italic;"># ç”¨äºè¯»å–Excelä¸­çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è·å–Excelè¡¨æ ¼ä¸­çš„æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">s_t </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æŸ¥æ‰¾æ›¿æ¢.xlsx&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è¯»å–å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active  </span><span style="color:#7F848E;font-style:italic;"># è¯»å–æ´»åŠ¨å·¥ä½œè¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;">data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}  </span><span style="color:#7F848E;font-style:italic;"># æ–°å»ºå­—å…¸ï¼Œç”¨äºå‚¨å­˜æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, ws.max_row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    chazhao </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(ws[</span><span style="color:#98C379;">&#39;A&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value)  </span><span style="color:#7F848E;font-style:italic;"># è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œä»¥å…åç»­æ¯”å¯¹æ—¶å‡ºç°æ•°æ®ç±»å‹å†²çª</span></span>
<span class="line"><span style="color:#ABB2BF;">    tihuan </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(ws[</span><span style="color:#98C379;">&#39;B&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value)  </span><span style="color:#7F848E;font-style:italic;"># è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œä»¥å…åç»­æ¯”å¯¹æ—¶å‡ºç°æ•°æ®ç±»å‹å†²çª</span></span>
<span class="line"><span style="color:#ABB2BF;">    data[chazhao] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tihuan  </span><span style="color:#7F848E;font-style:italic;"># é”®å€¼å¯¹åº”å­˜å…¥å­—å…¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># print(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;åŸè¡¨.xlsx&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è¯»å–ç›®æ ‡å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">sheet_names </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.</span><span style="color:#61AFEF;">get_sheet_names</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># è·å¾—å·¥ä½œç°¿çš„æ‰€æœ‰å·¥ä½œè¡¨å</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> sheet_name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sheet_names[:</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]:  </span><span style="color:#7F848E;font-style:italic;"># éå†æ¯ä¸ªå·¥ä½œè¡¨ï¼Œæ›´æ”¹A4å•å…ƒæ ¼çš„æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb[sheet_name]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(sheet_name)</span></span>
<span class="line"><span style="color:#D19A66;">    ID_list</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> []  </span><span style="color:#7F848E;font-style:italic;"># æ–°å»ºä¸€ä¸ªåˆ—è¡¨ï¼Œç”¨äºå‚¨å­˜åŸè¡¨Dåˆ—çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, ws.max_row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#D19A66;">        ID</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#98C379;">&#39;D&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value  </span><span style="color:#7F848E;font-style:italic;"># éå†æ•´ä¸ªå·¥ä½œè¡¨ï¼Œå°†Dåˆ—çš„æ•°æ®é€ä¸ªå­˜å…¥IDå˜é‡</span></span>
<span class="line"><span style="color:#D19A66;">        ID_list</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">ID</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># å°†è¯»å–åˆ°çš„ç»“æœå­˜å…¥åˆ—è¡¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(ID_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">    code </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#D19A66;"> ID_list</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> i </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ˜¯Noneï¼Œåˆ™æ”¾å…¥Noneå ä½ï¼Œä»¥ä¿æŒåˆ—è¡¨çš„å€¼çš„é¡ºåºä¸åŸè¡¨ä¸€è‡´</span></span>
<span class="line"><span style="color:#ABB2BF;">            code.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # ä¸æ˜¯None,åˆ™æŒ‰&quot;ï¼š&quot;ç¬¦å·åˆ†å‰²ï¼Œå¹¶æ”¾åˆ†å‰²åçš„æœ€åä¸€ä¸ªå€¼è¿›å…¥æ–°åˆ—è¡¨code</span></span>
<span class="line"><span style="color:#ABB2BF;">            code.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(i.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ï¼š&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(code)</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(code)):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> code[i] </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data:</span></span>
<span class="line"><span style="color:#ABB2BF;">            ws.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                row</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">i</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> ID_list</span><span style="color:#ABB2BF;">[i].</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ï¼š&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;ï¼š&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> data[code[i]]</span></span>
<span class="line"><span style="color:#ABB2BF;">wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;åŸè¡¨-æ›¿æ¢.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">e_t </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&#39;ä¸€å…±ç”¨æ—¶</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e_t</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">s_t</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">s&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="excel-æ•°æ®è‡ªåŠ¨åŒ–éªŒè¯ä¸æ¸…ç†-å¼ºåŒ–æ•°æ®å¤„ç†ç­–ç•¥" tabindex="-1">Excel æ•°æ®è‡ªåŠ¨åŒ–éªŒè¯ä¸æ¸…ç†ï¼Œå¼ºåŒ–æ•°æ®å¤„ç†ç­–ç•¥ <a class="header-anchor" href="#excel-æ•°æ®è‡ªåŠ¨åŒ–éªŒè¯ä¸æ¸…ç†-å¼ºåŒ–æ•°æ®å¤„ç†ç­–ç•¥" aria-label="Permalink to &quot;Excel æ•°æ®è‡ªåŠ¨åŒ–éªŒè¯ä¸æ¸…ç†ï¼Œå¼ºåŒ–æ•°æ®å¤„ç†ç­–ç•¥&quot;">â€‹</a></h2><p>åœ¨æ•°æ®å¤„ç†æµç¨‹ä¸­ï¼ŒExcel æ•°æ®çš„è´¨é‡æ˜¯ç¡®ä¿åç»­åˆ†æå‡†ç¡®æ€§çš„åŸºçŸ³ã€‚ç„¶è€Œï¼Œæ ¼å¼é”™è¯¯ã€é‡å¤æ¡ç›®ä»¥åŠç©ºå­—æ®µç­‰å¸¸è§é—®é¢˜å¾€å¾€å¯¼è‡´æ•°æ®è´¨é‡ä¸‹é™ï¼Œè¿›è€Œå½±å“åˆ†æç»“æœçš„å‡†ç¡®æ€§ã€‚ä¸ºäº†æå‡æ•°æ®å¤„ç†æ•ˆç‡å’Œå‡†ç¡®æ€§ï¼Œæˆ‘ä»¬é‡‡ç”¨ Python çš„ openpyxl åº“è¿›è¡Œè‡ªåŠ¨åŒ–éªŒè¯ä¸æ¸…ç†ã€‚</p><h3 id="åœºæ™¯æè¿°-1" tabindex="-1">åœºæ™¯æè¿° <a class="header-anchor" href="#åœºæ™¯æè¿°-1" aria-label="Permalink to &quot;åœºæ™¯æè¿°&quot;">â€‹</a></h3><p>åœ¨å¤„ç† Excel æ•°æ®æ—¶ï¼Œæ•°æ®éªŒè¯å’Œæ¸…ç†æ˜¯ç¡®ä¿æ•°æ®è´¨é‡çš„å…³é”®æ­¥éª¤ã€‚å¸¸è§çš„æ•°æ®é—®é¢˜åŒ…æ‹¬æ ¼å¼é”™è¯¯ã€é‡å¤æ¡ç›®å’Œç©ºå­—æ®µï¼Œè¿™äº›é—®é¢˜å¦‚æœä¸åŠ ä»¥å¤„ç†ï¼Œå°†ä¼šå¯¹åç»­çš„æ•°æ®åˆ†æé€ æˆä¸¥é‡çš„åå·®ã€‚é€šè¿‡ä½¿ç”¨ openpyxl åº“ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªåŠ¨æ£€æµ‹å’Œä¿®æ­£è¿™äº›é—®é¢˜ï¼Œæˆ–è€…åœ¨æ— æ³•è‡ªåŠ¨ä¿®æ­£çš„æƒ…å†µä¸‹ç”Ÿæˆè¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šï¼Œä»è€Œå¸®åŠ©æ•°æ®åˆ†æå¸ˆæ›´å¥½åœ°ç»´æŠ¤æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p><h3 id="æ•°æ®åˆ†æ-4" tabindex="-1">æ•°æ®åˆ†æ <a class="header-anchor" href="#æ•°æ®åˆ†æ-4" aria-label="Permalink to &quot;æ•°æ®åˆ†æ&quot;">â€‹</a></h3><ul><li><p><strong>è¾“å…¥</strong>ï¼šä¸€ä¸ªåŒ…å«åŸå§‹æ•°æ®çš„ Excel æ–‡ä»¶ã€‚</p></li><li><p><strong>å¤„ç†</strong>ï¼š</p></li><li><ul><li>æ£€æŸ¥æ•°å€¼å­—æ®µçš„æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æ—¥æœŸå’Œæ•°å­—çš„æ ¼å¼ã€‚</li><li>æ£€æµ‹å¹¶åˆ é™¤é‡å¤çš„æ¡ç›®ã€‚</li><li>æ ‡è¯†å¹¶å¡«å……æˆ–æ ‡è®°ç©ºå­—æ®µã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šè¢«æ¸…ç†åçš„ Excel æ–‡ä»¶ä»¥åŠä¸€ä¸ªé”™è¯¯æŠ¥å‘Šï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚</p></li></ul><h3 id="ç¤ºä¾‹æ•°æ®-2" tabindex="-1">ç¤ºä¾‹æ•°æ® <a class="header-anchor" href="#ç¤ºä¾‹æ•°æ®-2" aria-label="Permalink to &quot;ç¤ºä¾‹æ•°æ®&quot;">â€‹</a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>data.xlsx</code>çš„ Excel æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹åˆ—ï¼š</p><ul><li>æ—¥æœŸï¼ˆå¯èƒ½åŒ…å«é”™è¯¯çš„æ ¼å¼ï¼‰</li><li>é”€å”®é¢ï¼ˆåº”ä¸ºæ•°å­—ï¼Œå¯èƒ½åŒ…å«æ–‡æœ¬æˆ–ç©ºå­—æ®µï¼‰</li><li>å®¢æˆ·åï¼ˆå¯èƒ½åŒ…å«é‡å¤é¡¹æˆ–ç©ºå­—æ®µï¼‰</li></ul><h3 id="å®æˆ˜ä»£ç -5" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -5" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> validate_and_clean</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">file_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åŠ è½½å·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(file_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    rows </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> list</span><span style="color:#ABB2BF;">(ws.rows)</span></span>
<span class="line"><span style="color:#ABB2BF;">    header </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [cell.value </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> cell </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rows[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"><span style="color:#ABB2BF;">    errors </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#ABB2BF;">    seen </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> set</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ç”¨äºæ£€æŸ¥é‡å¤</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä»ç¬¬äºŒè¡Œå¼€å§‹éå†ï¼ˆè·³è¿‡è¡¨å¤´ï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> idx, row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(rows[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">:], </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> col, cell </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(row, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cell.value</span></span>
<span class="line"><span style="color:#ABB2BF;">            column </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> header[col</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥ç©ºå­—æ®µ</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> value </span><span style="color:#C678DD;">is</span><span style="color:#D19A66;"> None</span><span style="color:#C678DD;"> or</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(value).</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                errors.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Row </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">idx</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">: &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">column</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39; is empty.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ•°æ®æ ¼å¼éªŒè¯å’Œæ¸…ç†</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> column </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;æ—¥æœŸ&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    datetime.</span><span style="color:#61AFEF;">strptime</span><span style="color:#ABB2BF;">(value, </span><span style="color:#98C379;">&#39;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># å°è¯•è§£ææ—¥æœŸæ ¼å¼</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;"> ValueError:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    errors.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Row </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">idx</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">: &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">value</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39; is not a valid date in column &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">column</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            elif</span><span style="color:#ABB2BF;"> column </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;é”€å”®é¢&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">                    float</span><span style="color:#ABB2BF;">(value)  </span><span style="color:#7F848E;font-style:italic;"># ç¡®ä¿é”€å”®é¢æ˜¯æ•°å­—</span></span>
<span class="line"><span style="color:#C678DD;">                except</span><span style="color:#ABB2BF;"> ValueError:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    errors.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Row </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">idx</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">: &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">value</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39; is not a number in column &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">column</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ£€æŸ¥é‡å¤</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> column </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;å®¢æˆ·å&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> value </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> seen:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    errors.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Row </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">idx</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">: Duplicate entry &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">value</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39; found in column &#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">column</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&#39;.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                seen.</span><span style="color:#61AFEF;">add</span><span style="color:#ABB2BF;">(value)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è¾“å‡ºé”™è¯¯æŠ¥å‘Š</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> errors:</span></span>
<span class="line"><span style="color:#C678DD;">        with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;error_report.txt&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;w&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> error </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> errors:</span></span>
<span class="line"><span style="color:#ABB2BF;">                f.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(error </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;No errors found. Data is clean.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä¿å­˜æ¸…ç†åçš„æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;cleaned_data.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#61AFEF;">validate_and_clean</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="æ€»ç»“-6" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-6" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>é€šè¿‡ä¸Šè¿° Python è„šæœ¬ï¼Œæˆ‘ä»¬åˆ©ç”¨ openpyxl åº“å®ç°äº† Excel æ•°æ®çš„è‡ªåŠ¨åŒ–éªŒè¯ä¸æ¸…ç†ã€‚è¯¥æ–¹æ³•èƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å¹¶ä¿®æ­£æ ¼å¼é”™è¯¯ã€åˆ é™¤é‡å¤æ¡ç›®ä»¥åŠå¤„ç†ç©ºå­—æ®µï¼Œæé«˜äº†æ•°æ®å¤„ç†çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚åŒæ—¶ï¼Œå¯¹äºæ— æ³•è‡ªåŠ¨ä¿®æ­£çš„é—®é¢˜ï¼Œè„šæœ¬è¿˜ä¼šç”Ÿæˆè¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šï¼Œå¸®åŠ©æ•°æ®åˆ†æå¸ˆå¿«é€Ÿå®šä½å¹¶å¤„ç†æ•°æ®ä¸­çš„é—®é¢˜ã€‚è¿™ç§è‡ªåŠ¨åŒ–å¤„ç†æ–¹å¼å¤§å¤§å‡å°‘äº†æ‰‹åŠ¨å®¡æŸ¥æ•°æ®çš„å·¥ä½œé‡ï¼Œä¸ºæ•°æ®åˆ†æå¸ˆæä¾›äº†æ›´åŠ é«˜æ•ˆå’Œå¯é çš„æ•°æ®å¤„ç†å·¥å…·ã€‚</p><h2 id="æ‰¹é‡æå–-excel-æ•°æ®-æ•°æ®ç§’çº§æ±‡æ€»" tabindex="-1">æ‰¹é‡æå– Excel æ•°æ®ï¼Œæ•°æ®ç§’çº§æ±‡æ€» <a class="header-anchor" href="#æ‰¹é‡æå–-excel-æ•°æ®-æ•°æ®ç§’çº§æ±‡æ€»" aria-label="Permalink to &quot;æ‰¹é‡æå– Excel æ•°æ®ï¼Œæ•°æ®ç§’çº§æ±‡æ€»&quot;">â€‹</a></h2><p>åœ¨æ•°å­—åŒ–æ—¶ä»£ï¼ŒExcel ä½œä¸ºæ•°æ®å¤„ç†çš„åˆ©å™¨ï¼Œå¹¿æ³›åº”ç”¨äºå„ä¸ªé¢†åŸŸã€‚ç„¶è€Œï¼Œå½“é¢å¯¹å¤§é‡éœ€è¦æå–å’Œæ•´åˆçš„ Excel æ•°æ®æ—¶ï¼Œä¼ ç»Ÿçš„æ‰‹åŠ¨æ“ä½œæ–¹å¼æ˜¾å¾—ç¹çä¸”æ•ˆç‡ä½ä¸‹ã€‚è¿™æ—¶ï¼ŒPython è‡ªåŠ¨åŒ–åŠå…¬çš„ç¥å¥‡é­…åŠ›ä¾¿å‡¸æ˜¾å‡ºæ¥ã€‚é€šè¿‡ Python çš„è‡ªåŠ¨åŒ–å¤„ç†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®ç°æ‰¹é‡æå– Excel æ•°æ®ï¼Œå¹¶åœ¨çŸ­æ—¶é—´å†…å®Œæˆæ•°æ®çš„æ±‡æ€»å’Œåˆ†æã€‚æœ¬æ–‡å°†å¸¦æ‚¨é¢†ç•¥ Python è‡ªåŠ¨åŒ–åŠå…¬çš„æ–°é«˜åº¦ï¼Œè®©æ‚¨æƒŠè‰³äºæ•°æ®ç§’çº§æ±‡æ€»çš„é«˜æ•ˆä¸ä¾¿æ·ã€‚</p><h3 id="åœºæ™¯æè¿°-2" tabindex="-1">åœºæ™¯æè¿° <a class="header-anchor" href="#åœºæ™¯æè¿°-2" aria-label="Permalink to &quot;åœºæ™¯æè¿°&quot;">â€‹</a></h3><p>åœ¨å•†ä¸šç ”ç©¶å’Œæ•°æ®åˆ†æçš„å®é™…åº”ç”¨ä¸­ï¼Œæ‰¹é‡æå– Excel æ•°æ®æ˜¯ä¸€ä¸ªå¸¸è§çš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€å®¶ä¼ä¸šéœ€è¦å¯¹å…¨å›½èŒƒå›´å†…çš„åˆ†æ”¯æœºæ„æäº¤çš„å¹´åº¦è´¢åŠ¡æŠ¥å‘Šè¿›è¡Œé›†ä¸­åˆ†ææ—¶ï¼Œé€šå¸¸éœ€è¦æ‰¹é‡æå–å…³é”®è´¢åŠ¡æŒ‡æ ‡ï¼Œå¦‚è¥ä¸šæ”¶å…¥å’Œå‡€åˆ©æ¶¦ï¼Œä»¥ä¾¿è¿›è¡Œç»¼åˆåˆ†æå’Œæ¯”è¾ƒã€‚</p><h3 id="è‡ªåŠ¨åŒ–å¤„ç†" tabindex="-1">è‡ªåŠ¨åŒ–å¤„ç† <a class="header-anchor" href="#è‡ªåŠ¨åŒ–å¤„ç†" aria-label="Permalink to &quot;è‡ªåŠ¨åŒ–å¤„ç†&quot;">â€‹</a></h3><p>åœ¨ Python çš„ååŠ©ä¸‹ï¼Œè¿™ç§æ‰¹é‡æå–å·¥ä½œå¯ä»¥å˜å¾—è‡ªåŠ¨åŒ–ä¸”é«˜æ•ˆã€‚Python çš„ pandas åº“èƒ½å¤Ÿè½»æ¾å¤„ç† Excel æ•°æ®ï¼Œä½¿å¾—æ‰¹é‡æå–ç‰¹å®šåˆ—çš„æ•°æ®å˜å¾—ç®€å•å¿«æ·ã€‚</p><h3 id="å¤„ç†æµç¨‹-1" tabindex="-1">å¤„ç†æµç¨‹ <a class="header-anchor" href="#å¤„ç†æµç¨‹-1" aria-label="Permalink to &quot;å¤„ç†æµç¨‹&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šå¤šä¸ªå…·æœ‰ç›¸ä¼¼æ•°æ®ç»“æ„çš„ Excel å·¥ä½œç°¿ã€‚</p><p><strong>å¤„ç†</strong>ï¼š</p><ol><li><ul><li>ä½¿ç”¨ Python è„šæœ¬éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ Excel æ–‡ä»¶ã€‚</li><li>ä»æ¯ä¸ªæ–‡ä»¶ä¸­æå–ç‰¹å®šçš„æ•°æ®åˆ—ã€‚</li><li>å°†æå–çš„æ•°æ®æ•´åˆåˆ°ä¸€ä¸ªæ–°çš„ pandas DataFrame ä¸­ã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong>ï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰æå–æ•°æ®çš„æ–°çš„ Excel å·¥ä½œç°¿ã€‚</p></li></ol><h3 id="ç¤ºä¾‹æ•°æ®-3" tabindex="-1">ç¤ºä¾‹æ•°æ® <a class="header-anchor" href="#ç¤ºä¾‹æ•°æ®-3" aria-label="Permalink to &quot;ç¤ºä¾‹æ•°æ®&quot;">â€‹</a></h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦ä»å„ä¸ªåˆ†æ”¯æœºæ„çš„å¹´åº¦æŠ¥å‘Šä¸­æå–â€œè¥ä¸šæ”¶å…¥â€å’Œâ€œå‡€åˆ©æ¶¦â€æ•°æ®ã€‚æ–‡ä»¶åå¯èƒ½å¦‚ä¸‹ï¼š</p><ul><li>å±±ä¸œåˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>ä¸Šæµ·åˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>ä¸œåŒ—åˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>å¹¿ä¸œåˆ†å…¬å¸è´¢åŠ¡æŠ¥å.xlsx</li><li>...</li></ul><p>æ¯ä¸ªæ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š</p><ul><li>æ—¥æœŸ</li><li>è¥ä¸šæ”¶å…¥</li><li>å‡€åˆ©æ¶¦</li><li>å…¶ä»–è´¹ç”¨</li><li>...</li></ul><h3 id="å®æˆ˜ä»£ç -6" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -6" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> batch_extract_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">columns</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_filename</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(directory):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xlsx&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">columns)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æ·»åŠ æ–‡ä»¶æ¥æºä¿¡æ¯ï¼Œä»¥ä¾¿çŸ¥é“æ•°æ®æ¥è‡ªå“ªä¸ªåˆ†æ”¯æœºæ„</span></span>
<span class="line"><span style="color:#ABB2BF;">            df[</span><span style="color:#98C379;">&#39;Source&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å°†æ•°æ®æ·»åŠ åˆ°æ€»æ•°æ®åˆ—è¡¨ä¸­</span></span>
<span class="line"><span style="color:#ABB2BF;">            all_data.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(df)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å°†åˆ—è¡¨ä¸­çš„DataFrameåˆå¹¶æˆä¸€ä¸ª</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data_frame </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(all_data, </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å°†æ±‡æ€»çš„æ•°æ®è¾“å‡ºåˆ°æ–°çš„Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data_frame.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(output_filename, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#61AFEF;">batch_extract_data</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;æ—¥æœŸ&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;è¥ä¸šæ”¶å…¥&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;å‡€åˆ©æ¶¦&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;path_to_financial_reports&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Consolidated_Financials.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="æ€»ç»“-7" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-7" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>æ­¤è„šæœ¬å……åˆ†åˆ©ç”¨äº† Python å’Œ pandas åº“çš„ä¼˜åŠ¿ï¼Œå®ç°äº†æ‰¹é‡æå– Excel æ•°æ®çš„åŠŸèƒ½ã€‚é€šè¿‡è‡ªåŠ¨åŒ–å¤„ç†ï¼Œä¸ä»…æé«˜äº†æ•°æ®å¤„ç†æ•ˆç‡ï¼Œè¿˜ä¿è¯äº†æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯è¿½æº¯æ€§ï¼Œä¸ºåç»­çš„æ•°æ®åˆ†æå’Œå†³ç­–æä¾›äº†å¯é çš„åŸºç¡€ã€‚åœ¨å¤§æ•°æ®å’Œè‡ªåŠ¨åŒ–çš„æ—¶ä»£ï¼Œåˆ©ç”¨ Python è¿›è¡Œæ­¤ç±»ä»»åŠ¡å¯ä»¥æå¤§åœ°ç®€åŒ–å·¥ä½œæµç¨‹ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚</p><h2 id="è‡ªåŠ¨åŒ–æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜excelè¡¨æ ¼" tabindex="-1">è‡ªåŠ¨åŒ–æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜Excelè¡¨æ ¼&#39; <a class="header-anchor" href="#è‡ªåŠ¨åŒ–æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜excelè¡¨æ ¼" aria-label="Permalink to &quot;è‡ªåŠ¨åŒ–æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜Excelè¡¨æ ¼&#39;&quot;">â€‹</a></h2><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨åŠå…¬æ¡Œå‰å¿™ç¢Œåœ°æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜ç€ä¸€ä¸ªä¸ªExcelè¡¨æ ¼ï¼Œè¿™äº›è¡¨æ ¼å †ç§¯å¦‚å±±ï¼Œä»¿ä½›æ°¸è¿œä¹Ÿåšä¸å®Œã€‚æ¯å½“ä½ ä»¥ä¸ºç»ˆäºå®Œæˆäº†ä¸€ä¸ªï¼Œå´å‘ç°è¿˜æœ‰æ›´å¤šçš„è¡¨æ ¼åœ¨ç­‰å¾…ç€ä½ ã€‚è¿™ç§åœºæ™¯æ˜¯å¦è®©ä½ æ„Ÿåˆ°çª’æ¯å’Œç»æœ›ï¼Ÿ</p><p>ä½†åˆ©ç”¨Pythonè‡ªåŠ¨åŒ–åŠå…¬ï¼Œä»…éœ€7è¡Œä»£ç ï¼Œåœ¨çŸ­çŸ­9ç§’é’Ÿå†…å°±å®Œæˆäº†åŸæœ¬éœ€è¦1390åˆ†é’Ÿçš„é‡å¤æ€§åŠ³åŠ¨ã€‚</p><h3 id="æ•…äº‹èƒŒæ™¯" tabindex="-1">æ•…äº‹èƒŒæ™¯ <a class="header-anchor" href="#æ•…äº‹èƒŒæ™¯" aria-label="Permalink to &quot;æ•…äº‹èƒŒæ™¯&quot;">â€‹</a></h3><p>åœ¨æŸå®¶å¤§å‹ä¼ä¸šä¸­ï¼Œä¸€ä½è´Ÿè´£ç®¡ç†çš„æœ‹å‹ï¼Œæ¯å¤©éƒ½éœ€è¦è®°å½•å…¥åº“å‡ºåº“æƒ…å†µã€‚å»å¹´ï¼Œä»–è¾›å‹¤åœ°åˆ¶ä½œäº†278ä¸ªExcelè¡¨æ ¼ï¼Œæ¯ä¸ªè¡¨æ ¼å¯¹åº”ä¸€å¤©çš„å‡ºå…¥åº“æƒ…å†µã€‚ç„¶è€Œï¼Œç”±äºç–å¿½ï¼Œè¿™äº›è¡¨æ ¼çš„æ ‡é¢˜ä¸€ç›´æœªèƒ½æŒ‰ç…§å…¬å¸æ–°ä¸Šçº¿çš„ERPç³»ç»Ÿçš„è¯†åˆ«è§„åˆ™è¿›è¡Œä¿®æ”¹ã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1716128303391-6.C8h5HBGc.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1716128303391-7.BhDZL-KF.webp" alt="å›¾ç‰‡"></p><h3 id="æŒ‘æˆ˜ä¸å›°å¢ƒ" tabindex="-1">æŒ‘æˆ˜ä¸å›°å¢ƒ <a class="header-anchor" href="#æŒ‘æˆ˜ä¸å›°å¢ƒ" aria-label="Permalink to &quot;æŒ‘æˆ˜ä¸å›°å¢ƒ&quot;">â€‹</a></h3><p>éšç€ERPç³»ç»Ÿçš„å…¨é¢ä¸Šçº¿ï¼Œè¿™ä½åŒäº‹é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼šå¦‚ä½•å°†è¿™278ä¸ªå†å²è¡¨æ ¼ä¸­çš„æ ‡é¢˜ä¿¡æ¯ã€è®¡åˆ’å¤–å‡º\å…¥åº“åŠä»“åº“è°ƒæ•´å•ã€‘æŒ‰ç…§ERPè¯†åˆ«ç³»ç»Ÿçš„è§„åˆ™ä¿®æ”¹æˆã€é›¶ä»¶æµ‹è¯•é¢†æ–™å•ã€‘ï¼Œè¦çŸ¥é“ï¼Œä¼ ç»Ÿçš„æ“ä½œæ–¹æ³•â€”â€”æ‰“å¼€è¡¨æ ¼ã€ä¿®æ”¹å†…å®¹ã€ä¿å­˜è¡¨æ ¼â€”â€”ä¸ä»…è´¹æ—¶è´¹åŠ›ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚</p><p>ä»–è¯•äº†ä¸€å¤©ï¼Œé‡‡ç”¨ä¼ ç»Ÿæ–¹æ³•å®Œæˆä¸€ä¸ªè¡¨æ ¼çš„å†…å®¹æ›´æ–°éœ€è¦å¤§çº¦5åˆ†é’Ÿã€‚é‚£ä¹ˆï¼Œå¯¹äº278ä¸ªè¡¨æ ¼æ¥è¯´ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªè€—æ—¶1390åˆ†é’Ÿçš„åºå¤§å·¥ç¨‹ï¼æ›´ç³Ÿç³•çš„æ˜¯ï¼Œé¢‘ç¹æ‰“å¼€å’Œå…³é—­è¡¨æ ¼è¿˜å¯èƒ½å¢åŠ å‡ºé”™çš„é£é™©ã€‚</p><h3 id="pythonè‡ªåŠ¨åŒ–ç™»åœº" tabindex="-1">Pythonè‡ªåŠ¨åŒ–ç™»åœº <a class="header-anchor" href="#pythonè‡ªåŠ¨åŒ–ç™»åœº" aria-label="Permalink to &quot;Pythonè‡ªåŠ¨åŒ–ç™»åœº&quot;">â€‹</a></h3><p>åœ¨è¿™ä½åŒäº‹å³å°†é™·å…¥ç»æœ›ä¹‹é™…ï¼Œæˆ‘ç”¨Pythonè‡ªåŠ¨åŒ–å¸®ä»–è§£å†³å›°å¢ƒï¼ä»…éœ€ç¼–å†™7è¡Œä»£ç ï¼Œå°±å¯ä»¥åœ¨çŸ­çŸ­9ç§’é’Ÿå†…å®ŒæˆåŸæœ¬éœ€è¦1390åˆ†é’Ÿçš„é‡å¤æ€§åŠ³åŠ¨ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook</span></span>
<span class="line"><span style="color:#ABB2BF;">wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data\é¢†æ–™å•ï¼ˆæ¯æ—¥ï¼‰.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">sheet_names</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">wb.</span><span style="color:#61AFEF;">get_sheet_names</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">#è·å¾—å·¥ä½œç°¿çš„æ‰€æœ‰å·¥ä½œè¡¨å</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> sheet_name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sheet_names: </span><span style="color:#7F848E;font-style:italic;">#éå†æ¯ä¸ªå·¥ä½œè¡¨ï¼Œæ›´æ”¹A4å•å…ƒæ ¼çš„æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">wb[sheet_name]</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws[</span><span style="color:#98C379;">&#39;A4&#39;</span><span style="color:#ABB2BF;">].value</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;é›¶ä»¶æµ‹è¯•é¢†æ–™å•&quot;</span><span style="color:#7F848E;font-style:italic;"> #ç›´æ¥å°†A4å•å…ƒæ ¼çš„å€¼æ”¹ä¸ºéœ€è¦çš„</span></span>
<span class="line"><span style="color:#ABB2BF;">wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data\é¢†æ–™å•ï¼ˆæ¯æ—¥ï¼‰-æ›´æ”¹å.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1716128303391-8.BrhR3eVt.webp" alt="å›¾ç‰‡"></p><p>å½“æœ‹å‹è¿è¡Œå®Œè„šæœ¬åï¼Œä»–æƒŠè®¶åœ°å‘ç°ï¼šåŸæœ¬éœ€è¦æ•°å°æ—¶æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œç°åœ¨ç«Ÿç„¶åœ¨å‡ ç§’é’Ÿå†…å°±å®Œæˆäº†ï¼è€Œä¸”ï¼Œç”±äºæ•´ä¸ªè¿‡ç¨‹å®Œå…¨ç”±è®¡ç®—æœºè‡ªåŠ¨å®Œæˆï¼Œå‡ºé”™çš„å¯èƒ½æ€§å¤§å¤§é™ä½ã€‚</p><h3 id="ç»“è¯­-3" tabindex="-1"><strong>ç»“è¯­</strong> <a class="header-anchor" href="#ç»“è¯­-3" aria-label="Permalink to &quot;**ç»“è¯­**&quot;">â€‹</a></h3><p>è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼šåœ¨æ•°å­—åŒ–æ—¶ä»£ï¼ŒæŒæ¡ä¸€é—¨ç¼–ç¨‹è¯­è¨€å¹¶æŒæ¡è‡ªåŠ¨åŒ–æŠ€èƒ½å¯¹äºæé«˜å·¥ä½œæ•ˆç‡å…·æœ‰é‡è¦æ„ä¹‰ã€‚Pythonä½œä¸ºä¸€ç§ç®€å•æ˜“å­¦ã€åŠŸèƒ½å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨è‡ªåŠ¨åŒ–åŠå…¬é¢†åŸŸå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚</p><h2 id="å®ç°æŠ–éŸ³è§†é¢‘æ‰¹é‡ä¸‹è½½" tabindex="-1">å®ç°æŠ–éŸ³è§†é¢‘æ‰¹é‡ä¸‹è½½ <a class="header-anchor" href="#å®ç°æŠ–éŸ³è§†é¢‘æ‰¹é‡ä¸‹è½½" aria-label="Permalink to &quot;å®ç°æŠ–éŸ³è§†é¢‘æ‰¹é‡ä¸‹è½½&quot;">â€‹</a></h2><p>åœ¨æ•°å­—åŒ–æ—¶ä»£ï¼ŒçŸ­è§†é¢‘å·²æˆä¸ºå“ç‰Œå®£ä¼ çš„é‡è¦æ¸ é“ä¹‹ä¸€ã€‚æŸå“ç‰Œå…¬å¸åœ¨æŠ–éŸ³å¹³å°ä¸Šæ‹¥æœ‰ä¸¤ä¸ªè´¦å·ï¼Œå¹¶å‘å¸ƒäº†å¤§é‡çŸ­è§†é¢‘å†…å®¹ï¼Œè¿™äº›è§†é¢‘åœ¨æ¨å¹¿å“ç‰Œå½¢è±¡å’Œäº§å“æ–¹é¢å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚éšç€å…¬å¸æˆ˜ç•¥è°ƒæ•´ï¼Œä»–ä»¬è®¡åˆ’åœ¨å…¶ä»–çŸ­è§†é¢‘å¹³å°ç»§ç»­æ‰©å¤§å“ç‰Œå½±å“åŠ›ï¼Œå†³å®šå°†ä¹‹å‰æŠ–éŸ³ä¸Šå‘å¸ƒè¿‡çš„è§†é¢‘è¿ç§»åˆ°æ–°çš„å¹³å°ä¸Šã€‚ä½†å› ç”µè„‘æ•…éšœï¼Œè¿™äº›è§†é¢‘æ–‡ä»¶å…¨éƒ¨ä¸¢å¤±ã€‚æ— æ³•ç›´æ¥åœ¨å…¶ä»–å¹³å°ä¸Šé‡æ–°å‘å¸ƒï¼Œé¢å¯¹è¿™ä¸€å›°å¢ƒï¼Œå…¬å¸å›¢é˜Ÿé™·å…¥äº†æ²‰æ€ã€‚æŠ–éŸ³å¹³å°æœ¬èº«å¹¶ä¸æä¾›è§†é¢‘ä¸‹è½½åŠŸèƒ½ï¼Œéš¾é“è¦æ‰‹åŠ¨ä¸€æ¡ä¸€æ¡åœ°å»å¤åˆ¶è§†é¢‘é“¾æ¥ï¼Œç„¶åå†é€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…·æˆ–ç½‘ç«™è¿›è¡Œä¸‹è½½å—ï¼Ÿè¿™æ ·ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚</p><p>æ­£å½“å›¢é˜Ÿä¸€ç­¹è«å±•ä¹‹é™…ï¼Œæˆ‘ç”¨çˆ¬è™«æŠ€æœ¯è½»æ¾ç ´å±€ï¼Œè€Œä¸”å­¦ä¼šä¸€ä¸ªå°æŠ€å·§ï¼Œåªéœ€è¦è‡ªå·±ç¼–å†™å‡ è¡Œä»£ç å°±èƒ½è½»æ¾å®ç°æŠ–éŸ³è§†é¢‘çš„æ‰¹é‡ä¸‹è½½ï¼Œå¯¹äºä»äº‹è§†é¢‘æ¬ç”¨ä¸äºŒæ¬¡åˆ›ä½œçš„æœ‹å‹ä»¬è€Œè¨€ï¼Œè¿™æ— ç–‘æ˜¯æœ€å¤§çš„ç¦éŸ³ï¼</p><p>é€šè¿‡å¤åˆ¶è®¿é—®ç½‘ç«™çš„ cURL å¹¶åœ¨çº¿è½¬æ¢ã€‚curl æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå‘é€ HTTP è¯·æ±‚ã€‚åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æŠ–éŸ³é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼€å‘è€…å·¥å…·ï¼ˆé€šå¸¸æŒ‰ F12 æ‰“å¼€ï¼‰æ‰¾åˆ°è¯·æ±‚è§†é¢‘ä¿¡æ¯çš„ cURL å‘½ä»¤ã€‚å¤åˆ¶è¿™ä¸ª CURL å‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç²˜è´´åˆ°ç½‘å€ï¼š<a href="https://curlconverter.com/%EF%BC%8C%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E4%BC%9A%E8%87%AA%E5%8A%A8%E5%B0%86curl%E5%91%BD%E4%BB%A4%E8%BD%AC%E6%8D%A2%E6%88%90%E5%90%84%E7%A7%8D%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%9A%84HTTP%E8%AF%B7%E6%B1%82%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%8C%85%E6%8B%ACPython%E7%9A%84requests%E5%BA%93%E4%BB%A3%E7%A0%81%E3%80%82" target="_blank" rel="noreferrer">https://curlconverter.com/ï¼Œè¿™ä¸ªç½‘ç«™ä¼šè‡ªåŠ¨å°†curlå‘½ä»¤è½¬æ¢æˆå„ç§ç¼–ç¨‹è¯­è¨€çš„HTTPè¯·æ±‚ä»£ç ï¼ŒåŒ…æ‹¬Pythonçš„requestsåº“ä»£ç ã€‚</a></p><p>åˆ©ç”¨è¿™ä¸ªæŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ç§’é—´å¾—åˆ°çˆ¬è™«æ‰€éœ€è¦çš„å„ç±»è®¿é—®å‚æ•°ï¼Œå¦‚è¯·æ±‚å¤´ï¼ˆheadersï¼‰ã€è¯·æ±‚æ–¹æ³•ï¼ˆGET æˆ– POSTï¼‰ã€æŸ¥è¯¢å‚æ•°ï¼ˆquery parametersï¼‰ç­‰ï¼Œä»è€Œå¿«é€Ÿæ„å»ºå‡ºèƒ½å¤Ÿæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºçš„ Python çˆ¬è™«è„šæœ¬ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511165849202.CPH3HFTj.png" alt="image-20240511165849202"></p><p><img src="/ProgramLearnNotes/assets/image-20240511165902883.CpASc4Rz.png" alt="image-20240511165902883"></p><p>è¿™ä¸ªæŠ€å·§å·²ç»å¸®æˆ‘ä»¬å®Œæˆäº†ç½‘ç«™è®¿é—®å’Œç½‘ç«™å“åº”çš„å…¨éƒ¨å·¥ä½œï¼Œåªéœ€è¦å†å¯¹ç»“æœè¿›è¡Œè§£æå°±å®Œæˆäº†çˆ¬è™«å·¥ä½œ</p><p>ç½‘ç«™ä»£ç </p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> threading</span></span>
<span class="line"><span style="color:#ABB2BF;">headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">&#39;accept&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;application/json, text/plain, */*&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;accept-language&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;zh-CN,zh;q=0.9,en;q=0.8&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;cookie&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;bd_ticket_guard_client_web_domain=2; _bd_ticket_crypt_doamin=2; __security_server_data_status=1; store-region=cn-sd; store-region-src=uid; d_ticket=110b1253f4bafca1e36ad981a84f1a3a15332; my_rd=2; passport_csrf_token=b2cf60354334595a7f39915640e9f4f4; passport_csrf_token_default=b2cf60354334595a7f39915640e9f4f4; xgplayer_device_id=69499535982; xgplayer_user_id=172535869193; MONITOR_WEB_ID=aa78c3e9-d188-496b-ad3e-a7f8907c99cf; ttwid=1%7CTWWWFMKfVOzVscCQVGKFtzLExlzpvIf7IG8JiEC1C9k%7C1711760081%7C04ac83727b6862d22b92023fdc2fa1b249ae419f2a12f359851429c1a9770820; SEARCH_RESULT_LIST_TYPE=</span><span style="color:#D19A66;">%22s</span><span style="color:#98C379;">ingle%22; volume_info=%7B</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">sUserMute</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3Afalse%2C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">sMute</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3Atrue%2C%22volume</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A0.265%7D; publish_badge_show_info=</span><span style="color:#D19A66;">%221%</span><span style="color:#98C379;">2C0%2C0%2C1714205266266%22; FORCE_LOGIN=%7B%22videoConsumedRemainSeconds</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A180%2C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">sForcePopClose</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A1%7D; n_mh=t31eWtoAuFgYdM06vjqH0Ui2OcSTTQuhwpGv8WzTXkU; passport_auth_status=f66b4e4a43c3cc0b5832c4bd4297cfd9%2C; passport_auth_status_ss=f66b4e4a43c3cc0b5832c4bd4297cfd9%2C; _bd_ticket_crypt_cookie=09b55f12ffe1a546cbdc829126c849d2; download_guide=</span><span style="color:#D19A66;">%223%</span><span style="color:#98C379;">2F20240427</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">0%22; pwa2=</span><span style="color:#D19A66;">%220%</span><span style="color:#98C379;">7C0%7C3%7C1%22; FOLLOW_LIVE_POINT_INFO=%22MS4wLjABAAAAwlWHPatdZHVmBwSfQZ2Rpx0CQBWo6gU4A-BCugurXoopcvyuhP9QQMThc4T4QPe3</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">1714233600000</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">0</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">0</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">1714227835012%22; FOLLOW_NUMBER_YELLOW_POINT_INFO=%22MS4wLjABAAAAwlWHPatdZHVmBwSfQZ2Rpx0CQBWo6gU4A-BCugurXoopcvyuhP9QQMThc4T4QPe3</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">1714233600000</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">0</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">1714227235013</span><span style="color:#D19A66;">%2F</span><span style="color:#98C379;">0%22; LOGIN_STATUS=0; dy_swidth=1920; dy_sheight=1080; odin_tt=524137479da105e2b529ad2a0cd38f489b9c8eb666d8ba48f6f0a294add99ef06652039b01a973bdcca617059b9de593ca6270de7aeaaadcfe01c64f78ca6c4608b630dc68a096e390c33bb4ee5557c9; douyin.com; device_web_cpu_core=20; device_web_memory_size=8; architecture=amd64; csrf_session_id=6b1694c9b1c243d95d40626d07ac688f; strategyABtestKey=</span><span style="color:#D19A66;">%221714268100.552%</span><span style="color:#98C379;">22; xg_device_score=7.588453342179008; stream_player_status_params=</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">7B%5C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">s_auto_play%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A0%2C%5C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">s_full_screen%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A0%2C%5C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">s_full_webscreen%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A0%2C%5C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">s_mute%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A1%2C%5C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">s_speed%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A1%2C%5C</span><span style="color:#D19A66;">%22i</span><span style="color:#98C379;">s_visible%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A0%7D%22; __ac_nonce=0662dc22100b53cfdebbe; __ac_signature=_02B4Z6wo00f01w5qLvQAAIDAM8M0a8oplE8OSipAAKXBpZHno8qZal065pT-0WD29v3aqTcjPfM92SpDzuXIxzTF-lLHxNtachWKr9IEptj73IUNDtWwastI72Tp2vGyMRny2MpCGguZNFpC17; stream_recommend_feed_params=</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">7B%5C</span><span style="color:#D19A66;">%22c</span><span style="color:#98C379;">ookie_enabled%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3Atrue%2C%5C</span><span style="color:#D19A66;">%22s</span><span style="color:#98C379;">creen_width%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A1920%2C%5C</span><span style="color:#D19A66;">%22s</span><span style="color:#98C379;">creen_height%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A1080%2C%5C</span><span style="color:#D19A66;">%22b</span><span style="color:#98C379;">rowser_online%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3Atrue%2C%5C</span><span style="color:#D19A66;">%22c</span><span style="color:#98C379;">pu_core_num%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A20%2C%5C</span><span style="color:#D19A66;">%22d</span><span style="color:#98C379;">evice_memory%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A8%2C%5C</span><span style="color:#D19A66;">%22d</span><span style="color:#98C379;">ownlink%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A10%2C%5C</span><span style="color:#D19A66;">%22e</span><span style="color:#98C379;">ffective_type%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A%5C</span><span style="color:#D19A66;">%224g</span><span style="color:#98C379;">%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">2C%5C</span><span style="color:#D19A66;">%22r</span><span style="color:#98C379;">ound_trip_time%5C</span><span style="color:#D19A66;">%22%</span><span style="color:#98C379;">3A50%7D%22; IsDouyinActive=true; home_can_add_dy_2_desktop=</span><span style="color:#D19A66;">%221%</span><span style="color:#98C379;">22; bd_ticket_guard_client_data=eyJiZC10aWNrZXQtZ3VhcmQtdmVyc2lvbiI6MiwiYmQtdGlja2V0LWd1YXJkLWl0ZXJhdGlvbi12ZXJzaW9uIjoxLCJiZC10aWNrZXQtZ3VhcmQtcmVlLXB1YmxpYy1rZXkiOiJCRkVYRStQcXdnLzdPZEZCMWdRUTQ1L3p1VnZFdTBTbWJ0eXN3UWttRGdhem1FNVo5ZlpEL2YyQUtUOWlzSDVEL2VrMVV1ZGVQMmZxZzNzN3JXM1k3bGM9IiwiYmQtdGlja2V0LWd1YXJkLXdlYi12ZXJzaW9uIjoxfQ%3D%3D; msToken=YAnzmZUwDm55Z4rof_W_iqXkD-HQud-3bf1SPNX0YpYFRwSiMPbuMc99Rj8T-RHB8POFBPeSTrDlLljDZM4v77VRuqlsWs0_cQwumItQ55lKra9mnwg=&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;referer&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://www.douyin.com/user/MS4wLjABAAAAIVYCOtxmRjv3iXP-Z2h1B8m7wK1UbxsnSKbgk-d5wpc&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec-ch-ua&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&quot;Google Chrome&quot;;v=&quot;123&quot;, &quot;Not:A-Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;123&quot;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec-ch-ua-mobile&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;?0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec-ch-ua-platform&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&quot;Windows&quot;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec-fetch-dest&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;empty&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec-fetch-mode&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;cors&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec-fetch-site&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;same-origin&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;user-agent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">&#39;device_platform&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;webapp&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;aid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;6383&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;channel&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;channel_pc_web&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;sec_user_id&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;MS4wLjABAAAAIVYCOtxmRjv3iXP-Z2h1B8m7wK1UbxsnSKbgk-d5wpc&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;max_cursor&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1692695420000&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;locate_query&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;false&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;show_live_replay_strategy&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;need_time_list&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;time_list_query&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;whale_cut_token&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;cut_version&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;count&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;18&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;publish_video_strategy_type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;pc_client_type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;version_code&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;290100&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;version_name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;29.1.0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;cookie_enabled&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;true&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;screen_width&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1920&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;screen_height&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;1080&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;browser_language&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;zh-CN&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;browser_platform&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Win32&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;browser_name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Chrome&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;browser_version&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;123.0.0.0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;browser_online&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;true&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;engine_name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Blink&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;engine_version&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;123.0.0.0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;os_name&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Windows&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;os_version&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;10&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;cpu_core_num&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;20&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;device_memory&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;8&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;platform&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;PC&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;downlink&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;10&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;effective_type&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;4g&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;round_trip_time&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;50&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;webid&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;7313179785457747493&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;msToken&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;cXXtUg2jdRwMT7ADUW_nzzvVFLs6WMLNi12-9NHGmFwoAMT5CS68kiuusXfRuyao8vNdUdNXjfuxLlRp_NbETy3-89ZQDrWnAc9zV_ZGwq9BScVokuo=&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;a_bogus&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;dX8MBmLXDkIBvDWD555LfY3q6vP3YBa00trEMD2fzdvbEL39HMTV9exEzAXvVz8jLG/lIeDjy4hCTNFMx5AJA3vRHWfKUIchsESDSFl2sokj5Z7rejusJUkNmktISlc25k3WE/i8wwIaSYukW9Fe-XolO6Z7aryk96EtO939lNE6HBv0&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;https://www.douyin.com/aweme/v1/web/aweme/post/&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers)</span></span>
<span class="line"><span style="color:#ABB2BF;">aweme_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;aweme_list&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># print(aweme_list)</span></span>
<span class="line"><span style="color:#ABB2BF;">url_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [aweme.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;video&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;play_addr&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;url_list&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> aweme </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> aweme_list]</span></span>
<span class="line"><span style="color:#ABB2BF;">desc_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#61AFEF;">extract_chinese</span><span style="color:#ABB2BF;">(aweme.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;desc&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> aweme </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> aweme_list]</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> extract_chinese</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">s</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    chinese_pattern </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">compile</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;</span><span style="color:#D19A66;">[\u4e00-\u9fa5]</span><span style="color:#E06C75;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">return</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(chinese_pattern.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(s))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç¤ºä¾‹ä½¿ç”¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># original_string = &quot;Hello, ä½ å¥½ï¼Œä¸–ç•Œï¼ŒHello&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># chinese_string = extract_chinese(original_string)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># print(chinese_string)</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_one_video</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">url</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">c</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    res </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># æ–‡ä»¶å†™æ“ä½œ</span></span>
<span class="line"><span style="color:#C678DD;">with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;F:</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">æŠ–éŸ³å·²å‘å¸ƒè§†é¢‘</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">VFT</span><span style="color:#56B6C2;">\\</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">c</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.mp4&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;wb&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:  </span><span style="color:#7F848E;font-style:italic;"># wï¼šå†™æ–‡æœ¬ wbå†™å­—èŠ‚</span></span>
<span class="line"><span style="color:#ABB2BF;">        f.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(res.content)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">c</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">.mp4ä¸‹è½½æˆåŠŸï¼&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">t_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i,url </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(url_list):</span></span>
<span class="line"><span style="color:#ABB2BF;">    t </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> threading.</span><span style="color:#61AFEF;">Thread</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">target</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">get_one_video, </span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(url, desc_list[i]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    t.</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    t_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(t)</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> t </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> t_list:</span></span>
<span class="line"><span style="color:#ABB2BF;">    t.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><p>å‰ 58 è¡Œä»£ç å…¨æ˜¯ï¼š<a href="https://curlconverter.com/%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E7%9A%84%EF%BC%8C%E5%85%B6%E4%BB%96%E4%BB%A3%E7%A0%81%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E6%98%AF%E8%A7%A3%E6%9E%90%E5%BE%97%E5%88%B0%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%EF%BC%8C%E4%B8%8B%E8%BD%BD%E8%A7%86%E9%A2%91%EF%BC%8C%E6%8F%90%E5%8F%96%E8%A7%86%E9%A2%91%E6%8F%8F%E8%BF%B0%E4%B8%AD%E7%9A%84%E4%B8%AD%E6%96%87%E5%B9%B6%E4%BD%9C%E4%B8%BA%E8%A7%86%E9%A2%91%E4%BF%9D%E5%AD%98%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E3%80%82" target="_blank" rel="noreferrer">https://curlconverter.com/è¿™ä¸ªç½‘ç«™è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå…¶ä»–ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯è§£æå¾—åˆ°è§†é¢‘ä¸‹è½½åœ°å€ï¼Œä¸‹è½½è§†é¢‘ï¼Œæå–è§†é¢‘æè¿°ä¸­çš„ä¸­æ–‡å¹¶ä½œä¸ºè§†é¢‘ä¿å­˜çš„æ–‡ä»¶åã€‚</a></p><p>ä»£ç è¿è¡Œç»“æœ</p><p><img src="/ProgramLearnNotes/assets/image-20240511165944023.CyUNibuX.png" alt="image-20240511165944023"></p><p><img src="/ProgramLearnNotes/assets/image-20240511165955042.CZAOf1Ox.png" alt="image-20240511165955042"></p><p><img src="/ProgramLearnNotes/assets/image-20240511170011096.B83jtFLf.png" alt="image-20240511170011096"></p><p>å‡ åˆ†é’Ÿæå®šå‡ ç™¾ä¸ªæŠ–éŸ³è§†é¢‘çš„ä¸‹è½½</p><p>ç°åœ¨ï¼Œä½ å¯ä»¥è½»æ¾åœ°å°†æŠ–éŸ³è§†é¢‘æ‰¹é‡ä¸‹è½½åˆ°æœ¬åœ°ï¼Œé‡æ–°åŠ å·¥åï¼Œå†åœ¨å…¶ä»–çŸ­è§†é¢‘å¹³å°ä¸Šé‡æ–°å‘å¸ƒï¼ŒPython è‡ªåŠ¨åŒ–åŠå…¬ç¥å™¨ï¼Œè®©ä½ çš„å·¥ä½œæ›´é«˜æ•ˆã€æ›´ä¾¿æ·</p><h2 id="é«˜æ•ˆæ‰¹é‡æŸ¥æ‰¾-excel-æ•°æ®-è½»æ¾åº”å¯¹æµ·é‡æ•°æ®å¤„ç†" tabindex="-1">é«˜æ•ˆæ‰¹é‡æŸ¥æ‰¾ Excel æ•°æ®ï¼Œè½»æ¾åº”å¯¹æµ·é‡æ•°æ®å¤„ç† <a class="header-anchor" href="#é«˜æ•ˆæ‰¹é‡æŸ¥æ‰¾-excel-æ•°æ®-è½»æ¾åº”å¯¹æµ·é‡æ•°æ®å¤„ç†" aria-label="Permalink to &quot;é«˜æ•ˆæ‰¹é‡æŸ¥æ‰¾ Excel æ•°æ®ï¼Œè½»æ¾åº”å¯¹æµ·é‡æ•°æ®å¤„ç†&quot;">â€‹</a></h2><h3 id="åœºæ™¯æè¿°-3" tabindex="-1">åœºæ™¯æè¿° <a class="header-anchor" href="#åœºæ™¯æè¿°-3" aria-label="Permalink to &quot;åœºæ™¯æè¿°&quot;">â€‹</a></h3><p>åœ¨å¤„ç†æµ·é‡çš„ Excel æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éœ€è¦è·¨å¤šä¸ªå·¥ä½œç°¿æŸ¥æ‰¾ç‰¹å®šä¿¡æ¯çš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œä¸€å®¶å¤§å‹ä¼ä¸šå¯èƒ½éœ€ä»å¤šä¸ªéƒ¨é—¨ä¸ŠæŠ¥çš„æŠ¥è¡¨ä¸­ï¼Œæ£€ç´¢ç‰¹å®šé¡¹ç›®çš„è¿›åº¦æ›´æ–°æˆ–æŸå‘˜å·¥çš„ä¸šç»©è®°å½•ã€‚ä¼ ç»Ÿåšæ³•é€šå¸¸æ˜¯æŒ¨ä¸ªæ‰“å¼€ Excel è¡¨æ ¼æŸ¥æ‰¾åˆ°éœ€è¦çš„æ•°æ®åå¤åˆ¶ç²˜è´´åˆ°ç»“æœè¡¨é‡Œï¼Œæœ‰ 100 ä¸ªè¡¨æ ¼å°±éœ€è¦å¦‚æ­¤é‡å¤æ“ä½œ 100 æ¬¡ï¼Œè€Œä¸”è¿‡ç¨‹ä¸­è¿˜å®¹æ˜“å‡ºé”™ã€‚åˆ©ç”¨ Python è¿›è¡Œæ‰¹é‡æŸ¥æ‰¾ Excel æ•°æ®ï¼Œå¯ä»¥è¿…é€Ÿå®šä½å¹¶æ•´åˆè¿™äº›ä¿¡æ¯ï¼Œä»è€ŒèŠ‚çº¦æ—¶é—´å¹¶æå‡å·¥ä½œæ•ˆç‡ã€‚</p><h3 id="æ•°æ®åˆ†æ-5" tabindex="-1">æ•°æ®åˆ†æ <a class="header-anchor" href="#æ•°æ®åˆ†æ-5" aria-label="Permalink to &quot;æ•°æ®åˆ†æ&quot;">â€‹</a></h3><ul><li><p>è¾“å…¥ï¼šåŒ…å«ç›¸ä¼¼æ•°æ®ç»“æ„çš„å¤šä¸ª Excel å·¥ä½œç°¿ã€‚</p></li><li><p>å¤„ç†æµç¨‹ï¼š</p></li><li><ul><li>éå†æ‰€æœ‰å·¥ä½œç°¿åŠå…¶å·¥ä½œè¡¨ã€‚</li><li>æŸ¥æ‰¾åŒ…å«ç‰¹å®šå…³é”®è¯æˆ–æ•°æ®çš„æ¡ç›®ã€‚</li><li>æå–å¹¶æ•´åˆè¿™äº›æ•°æ®ã€‚</li></ul></li><li><p>è¾“å‡ºï¼šä¸€ä¸ªæ•´åˆäº†æ‰€æœ‰ç›¸å…³æ•°æ®çš„å…¨æ–° Excel å·¥ä½œç°¿ã€‚</p></li></ul><h3 id="ç¤ºä¾‹æ•°æ®-4" tabindex="-1">ç¤ºä¾‹æ•°æ® <a class="header-anchor" href="#ç¤ºä¾‹æ•°æ®-4" aria-label="Permalink to &quot;ç¤ºä¾‹æ•°æ®&quot;">â€‹</a></h3><p>å‡è®¾ä¼ä¸šæœ‰å¤šä¸ªéƒ¨é—¨ï¼Œæ¯ä¸ªéƒ¨é—¨æ¯æœˆéƒ½ä¼šä¸ŠæŠ¥é”€å”®æ•°æ®ã€‚ç°éœ€æ£€ç´¢æ‰€æœ‰åŒ…å«ç‰¹å®šäº§å“â€œYâ€çš„é”€å”®è®°å½•ã€‚</p><p>éƒ¨é—¨æ–‡ä»¶å¦‚ä¸‹ï¼š</p><ul><li>SalesReport_Dept1.xlsx</li><li>SalesReport_Dept2.xlsx</li><li>SalesReport_Dept3.xlsx</li><li>...</li><li>SalesReport_DeptN.xlsx</li><li></li></ul><p>æ¯ä¸ªæ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š</p><ul><li>ReportDateï¼ˆæŠ¥å‘Šæ—¥æœŸï¼‰</li><li>ProductNameï¼ˆäº§å“åç§°ï¼‰</li><li>SalesVolumeï¼ˆé”€å”®æ•°é‡ï¼‰</li><li>SalesPersonï¼ˆé”€å”®å‘˜ï¼‰</li></ul><h3 id="å®æˆ˜ä»£ç -7" tabindex="-1">å®æˆ˜ä»£ç  <a class="header-anchor" href="#å®æˆ˜ä»£ç -7" aria-label="Permalink to &quot;å®æˆ˜ä»£ç &quot;">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> batch_search_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">keyword</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_filename</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> filename </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(directory):</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> filename.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.xlsx&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            filepath </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(directory, filename)</span></span>
<span class="line"><span style="color:#ABB2BF;">            df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(filepath)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æœç´¢åŒ…å«ç‰¹å®šå…³é”®è¯çš„æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">            matched_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&#39;ProductName&#39;</span><span style="color:#ABB2BF;">].str.</span><span style="color:#61AFEF;">contains</span><span style="color:#ABB2BF;">(keyword, </span><span style="color:#E06C75;font-style:italic;">na</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">case</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # å¦‚æœæ‰¾åˆ°åŒ¹é…çš„æ•°æ®ï¼Œå°†å…¶æ·»åŠ åˆ°æ€»æ•°æ®ä¸­</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> matched_data.empty:</span></span>
<span class="line"><span style="color:#ABB2BF;">                all_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">([all_data, matched_data], </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å°†æ±‡æ€»çš„æ•°æ®è¾“å‡ºåˆ°æ–°çš„Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(output_filename, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#61AFEF;">batch_search_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;äº§å“Y&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;path_to_sales_reports&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Matched_Product_Sales.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="æ€»ç»“-8" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-8" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>æœ¬æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ Python å’Œ pandas åº“ï¼Œæ‰¹é‡æŸ¥æ‰¾åŒ…å«ç‰¹å®šå…³é”®è¯çš„ Excel æ•°æ®ã€‚é€šè¿‡è‡ªåŠ¨éå†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ Excel æ–‡ä»¶ï¼Œæœç´¢å«æœ‰ç‰¹å®šäº§å“åç§°çš„è®°å½•ï¼Œå¹¶å°†è¿™äº›è®°å½•æ•´åˆåˆ°ä¸€ä¸ªæ–°çš„ Excel æ–‡ä»¶ä¸­ã€‚è¿™ç§æ–¹æ³•åœ¨å¤„ç†éœ€è¦ä»å¤§é‡åˆ†æ•£çš„æ•°æ®æºä¸­æå–ä¿¡æ¯çš„æƒ…å†µæ—¶ç‰¹åˆ«æœ‰æ•ˆï¼Œèƒ½æ˜¾è‘—æé«˜æ•°æ®å¤„ç†çš„æ•ˆç‡ã€‚</p><h2 id="excel-ä¸­å›¾ç‰‡çš„æ‰¹é‡å¯¼å…¥ä¸å¯¼å‡º" tabindex="-1">Excel ä¸­å›¾ç‰‡çš„æ‰¹é‡å¯¼å…¥ä¸å¯¼å‡º <a class="header-anchor" href="#excel-ä¸­å›¾ç‰‡çš„æ‰¹é‡å¯¼å…¥ä¸å¯¼å‡º" aria-label="Permalink to &quot;Excel ä¸­å›¾ç‰‡çš„æ‰¹é‡å¯¼å…¥ä¸å¯¼å‡º&quot;">â€‹</a></h2><p>åœ¨æ—¥å¸¸åŠå…¬ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨ Excel è¡¨æ ¼ä¸­æ’å…¥æˆ–å¯¼å‡ºå›¾ç‰‡ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ¶ä½œäº§å“ç›®å½•ã€æŠ¥å‘Šæˆ–å±•ç¤ºæ•°æ®æ—¶ã€‚ç°åœ¨æœ‰è¿™æ ·ä¸€ä»½ä»»åŠ¡ï¼Œäº§å“åå½•è¡¨é‡Œéœ€è¦å°†æ¯ä¸ªäº§å“çš„å®æ‹å›¾ç‰‡æ’å…¥åˆ° D åˆ—ä¸Šï¼Œäº§å“æœ‰ä¸Šç™¾ä¸ªï¼Œä¼ ç»Ÿæ–¹æ³•éœ€è¦å°†å›¾ç‰‡ä¸€ä¸ªä¸ªè´´åˆ° excel é‡Œï¼Œç„¶åå°†å›¾ç‰‡è°ƒæ•´å¥½å¤§å°ï¼Œè¿™ä¸ªè¿‡ç¨‹è´¹æ—¶è´¹åŠ›ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPython æä¾›äº†å¼ºå¤§çš„åº“æ¥å¸®åŠ©æˆ‘ä»¬å®ç°è¿™äº›ä»»åŠ¡çš„è‡ªåŠ¨åŒ–ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511170146116.BukgeEF-.png" alt="image-20240511170146116"></p><h3 id="ä¸€ã€python-å¯¼å…¥å›¾ç‰‡åˆ°-excel" tabindex="-1">ä¸€ã€Python å¯¼å…¥å›¾ç‰‡åˆ° Excel <a class="header-anchor" href="#ä¸€ã€python-å¯¼å…¥å›¾ç‰‡åˆ°-excel" aria-label="Permalink to &quot;ä¸€ã€Python å¯¼å…¥å›¾ç‰‡åˆ° Excel&quot;">â€‹</a></h3><p>ä½¿ç”¨ Python å°†å›¾ç‰‡æ‰¹é‡å¯¼å…¥ Excel è¡¨æ ¼ä¸­ï¼Œå¯ä»¥æå¤§åœ°æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>openpyxl</code>åº“å°†å›¾ç‰‡æ·»åŠ åˆ° Excel å·¥ä½œè¡¨ä¸­ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> glob</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl.drawing.image </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> write_images_to_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">image_paths</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">excel_file</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(excel_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> path </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> image_paths:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åˆ›å»ºImageå¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">        img </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Image</span><span style="color:#ABB2BF;">(path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # è°ƒæ•´å›¾â½šâ¼¤â¼©ï¼Œå‡è®¾æ”¾åœ¨Aåˆ—ï¼Œ1:1â½ä¾‹</span></span>
<span class="line"><span style="color:#ABB2BF;">        img.width, img.height </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 150</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">50</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # æ·»åŠ å›¾â½šåˆ°â¼¯ä½œè¡¨ï¼Œæ”¾åœ¨å›¾â½šåå¯¹åº”çš„â¾</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws.</span><span style="color:#61AFEF;">add_image</span><span style="color:#ABB2BF;">(img, </span><span style="color:#98C379;">&#39;D&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(image_paths.</span><span style="color:#61AFEF;">index</span><span style="color:#ABB2BF;">(path) </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 3</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(excel_file)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># â½°ä¾‹å›¾â½šè·¯å¾„å’ŒExcelâ½‚ä»¶å</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> get_image_paths</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">folder_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    image_paths </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ä½¿ç”¨globæ¨¡å—åŒ¹é…æ‰€æœ‰jpgå’Œpngå›¾ç‰‡</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> extension </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;*.jpg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;*.png&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#ABB2BF;">        image_paths.</span><span style="color:#61AFEF;">extend</span><span style="color:#ABB2BF;">(glob.</span><span style="color:#61AFEF;">glob</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(folder_path, extension)))</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> image_paths</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨ä½ çš„æ–‡ä»¶å¤¹è·¯å¾„æ›¿æ¢ä¸‹é¢çš„&#39;your_folder_path&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">folder_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;extracted_images&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">image_paths </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_image_paths</span><span style="color:#ABB2BF;">(folder_path)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(image_paths)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">excel_file </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;test.xlsx&#39;</span></span>
<span class="line"><span style="color:#61AFEF;">write_images_to_excel</span><span style="color:#ABB2BF;">(image_paths, excel_file)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>è¿™æ®µä»£ç é¦–å…ˆæ‰“å¼€éœ€è¦æ’å…¥å›¾ç‰‡çš„ Excelï¼Œå¹¶è·å–æ´»åŠ¨å·¥ä½œè¡¨ã€‚ç„¶åï¼Œå®ƒéå†äº†ä¸€ä¸ªåŒ…å«å›¾ç‰‡è·¯å¾„çš„åˆ—è¡¨ï¼Œå¹¶ä¸ºæ¯ä¸ªè·¯å¾„åˆ›å»ºäº†ä¸€ä¸ª<code>Image</code>å¯¹è±¡ã€‚æ¥ç€ï¼Œå®ƒè®¾ç½®äº†å›¾ç‰‡çš„å¤§å°ï¼Œå¹¶å°†å›¾ç‰‡æ·»åŠ åˆ°äº†å·¥ä½œè¡¨çš„æŒ‡å®šä½ç½®ã€‚æœ€åï¼Œä¿å­˜å·¥ä½œç°¿ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511170220150.DR5LXmve.png" alt="image-20240511170220150"></p><p><img src="/ProgramLearnNotes/assets/image-20240511170230697.BriyZ9xJ.png" alt="image-20240511170230697"></p><h3 id="äºŒã€python-ä»-excel-å¯¼å‡ºå›¾ç‰‡" tabindex="-1">äºŒã€Python ä» Excel å¯¼å‡ºå›¾ç‰‡ <a class="header-anchor" href="#äºŒã€python-ä»-excel-å¯¼å‡ºå›¾ç‰‡" aria-label="Permalink to &quot;äºŒã€Python ä» Excel å¯¼å‡ºå›¾ç‰‡&quot;">â€‹</a></h3><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä» Excel æ–‡ä»¶ä¸­æå–å›¾ç‰‡ï¼Œæ¯”å¦‚ä¸ºäº†å¤‡ä»½ã€è¿›ä¸€æ­¥å¤„ç†æˆ–åœ¨å…¶ä»–åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚è™½ç„¶<code>openpyxl</code>åº“æœ¬èº«ä¸æä¾›ç›´æ¥ä» Excel æå–å›¾ç‰‡çš„åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç»“åˆå…¶ä»–æ–¹æ³•æ¥å®ç°è¿™ä¸€éœ€æ±‚ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> zipfile</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åŠ è½½åŒ…å«å›¾ç‰‡çš„Excelå·¥ä½œç°¿</span></span>
<span class="line"><span style="color:#ABB2BF;">wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;VFTLURE.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºè¾“å‡ºç›®å½•æ¥ä¿å­˜æå–çš„å›¾ç‰‡</span></span>
<span class="line"><span style="color:#ABB2BF;">output_dir </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;extracted_images&#39;</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(output_dir):</span></span>
<span class="line"><span style="color:#ABB2BF;">    os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(output_dir)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Excelæ–‡ä»¶ä½œä¸ºZIPå½’æ¡£å¤„ç†</span></span>
<span class="line"><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> zipfile.</span><span style="color:#61AFEF;">ZipFile</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;VFTLURE.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> zip_ref:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†ZIPå½’æ¡£ä¸­çš„æ–‡ä»¶ï¼ŒæŸ¥æ‰¾å›¾ç‰‡æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> zip_info </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> zip_ref.</span><span style="color:#61AFEF;">infolist</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> zip_info.filename.</span><span style="color:#61AFEF;">endswith</span><span style="color:#ABB2BF;">((</span><span style="color:#98C379;">&#39;.png&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.jpg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.jpeg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.gif&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;.bmp&#39;</span><span style="color:#ABB2BF;">)):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # æå–å›¾ç‰‡åˆ°è¾“å‡ºç›®å½•</span></span>
<span class="line"><span style="color:#ABB2BF;">            img_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(output_dir, os.path.</span><span style="color:#61AFEF;">basename</span><span style="color:#ABB2BF;">(zip_info.filename))</span></span>
<span class="line"><span style="color:#C678DD;">            with</span><span style="color:#ABB2BF;"> zip_ref.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(zip_info) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> img_file, </span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(img_path, </span><span style="color:#98C379;">&#39;wb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> out_file:</span></span>
<span class="line"><span style="color:#ABB2BF;">                out_file.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(img_file.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Images extracted to </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">output_dir</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>è¿™æ®µä»£ç é¦–å…ˆåŠ è½½äº†åŒ…å«å›¾ç‰‡çš„ Excel å·¥ä½œç°¿ã€‚ç„¶åï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªè¾“å‡ºç›®å½•æ¥ä¿å­˜æå–çš„å›¾ç‰‡ã€‚æ¥ä¸‹æ¥ï¼Œå®ƒå°† Excel æ–‡ä»¶è§†ä¸ºä¸€ä¸ª ZIP å½’æ¡£æ–‡ä»¶ï¼Œå¹¶éå†å…¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚å¯¹äºæ¯ä¸ªä»¥å›¾ç‰‡æ ¼å¼ç»“å°¾çš„æ–‡ä»¶ï¼Œå®ƒå°†å…¶æå–åˆ°è¾“å‡ºç›®å½•ä¸­ã€‚æœ€åï¼Œå®ƒæ‰“å°äº†ä¸€æ¡æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºå›¾ç‰‡å·²æˆåŠŸæå–åˆ°æŒ‡å®šç›®å½•ã€‚ä¸Šé¢ Excel ä¸­çš„æ‰€æœ‰å›¾ç‰‡å°±è¢«æå–åˆ°åˆ¶å®šæ–‡ä»¶å¤¹é‡Œäº†</p><p><img src="/ProgramLearnNotes/assets/image-20240511170302941.Cuu02gpO.png" alt="image-20240511170302941"></p><h3 id="æ€»ç»“-9" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“-9" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h3><p>é€šè¿‡ Python è‡ªåŠ¨åŒ–åŠå…¬ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç° Excel ä¸­å›¾ç‰‡çš„æ‰¹é‡å¯¼å…¥ä¸å¯¼å‡ºï¼Œå¤§å¤§æé«˜äº†å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚æ— è®ºæ˜¯åˆ¶ä½œäº§å“ç›®å½•ã€æŠ¥å‘Šè¿˜æ˜¯å…¶ä»–éœ€è¦å¤„ç†å¤§é‡å›¾ç‰‡çš„åœºæ™¯ï¼Œè¿™äº›è‡ªåŠ¨åŒ–è„šæœ¬éƒ½èƒ½ä¸ºæˆ‘ä»¬èŠ‚çœå¤§é‡æ—¶é—´å’Œç²¾åŠ›ã€‚</p><h2 id="å…«è¡Œä»£ç è½»æ¾è§£å†³278å¼ excelè¡¨çš„æ±‡æ€»ä¸æ’åº" tabindex="-1">å…«è¡Œä»£ç è½»æ¾è§£å†³278å¼ Excelè¡¨çš„æ±‡æ€»ä¸æ’åº <a class="header-anchor" href="#å…«è¡Œä»£ç è½»æ¾è§£å†³278å¼ excelè¡¨çš„æ±‡æ€»ä¸æ’åº" aria-label="Permalink to &quot;å…«è¡Œä»£ç è½»æ¾è§£å†³278å¼ Excelè¡¨çš„æ±‡æ€»ä¸æ’åº&quot;">â€‹</a></h2><p>åœ¨å¿™ç¢Œçš„èŒåœºä¸­ï¼Œæˆ‘ä»¬æ—¶å¸¸è¢«ç¹ççš„æ•°æ®å¤„ç†ä»»åŠ¡æ‰€å›°æ‰°ï¼Œç‰¹åˆ«æ˜¯å½“é¢å¯¹æˆç™¾ä¸Šåƒå¼ Excelè¡¨æ ¼æ—¶ï¼Œé‚£ç§æ— åŠ›æ„Ÿå’Œç„¦è™‘æ„Ÿå‡ ä¹è®©äººå´©æºƒã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå»å¹´å…¬å¸å…±æœ‰278å¤©é¢†ç”¨ç‰©æ–™ï¼Œè¿™äº›é¢†ç”¨è®°å½•åˆ†æ•£åœ¨278å¼ ä¸åŒçš„Excelè¡¨ä¸­ã€‚å¦‚æœè®©ä½ æ‰‹åŠ¨åˆå¹¶è¿™äº›è¡¨æ ¼ï¼Œå†ç»Ÿè®¡ç‰©æ–™çš„é¢†ç”¨é‡ï¼Œå¹¶æŒ‰é¢†ç”¨é‡ä»é«˜åˆ°ä½æ’åºï¼Œææ€•ä½ ä¼šè§‰å¾—è¿™æ˜¯ä¸€é¡¹å‡ ä¹ä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚ä½†æ˜¯ï¼Œåˆ«æ‹…å¿ƒï¼ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ç§ç¥å¥‡çš„æ–¹æ³•ï¼Œåˆ©ç”¨Pythonç¼–ç¨‹è¯­è¨€ä¸­çš„<code>pandas</code>åº“ï¼Œè®©ä½ ä¸€é”®è§£å†³è¿™ä¸ªçœ‹ä¼¼ä¸å¯èƒ½çš„ä»»åŠ¡ï¼Œè®©ä½ çš„å·¥ä½œæ•ˆç‡ç¬é—´é£™å‡ï¼</p><h3 id="æ•…äº‹èƒŒæ™¯-1" tabindex="-1">æ•…äº‹èƒŒæ™¯ <a class="header-anchor" href="#æ•…äº‹èƒŒæ™¯-1" aria-label="Permalink to &quot;æ•…äº‹èƒŒæ™¯&quot;">â€‹</a></h3><p>å»å¹´å…±æœ‰278å¤©é¢†ç”¨äº†ç‰©æ–™ï¼Œè¿™äº›é¢†ç”¨è®°å½•åˆ†æ•£åœ¨278å¼ Excelè¡¨ä¸­ã€‚ç°åœ¨ï¼Œè€æ¿æƒ³è¦äº†è§£å“ªäº›ç‰©æ–™é¢†ç”¨å¾—æœ€å¤šï¼Œä»¥ä¾¿åšå‡ºç›¸åº”çš„å†³ç­–ã€‚é¢å¯¹å¦‚æ­¤åºå¤§çš„æ•°æ®é‡ï¼Œå¦‚æœé‡‡ç”¨æ‰‹å·¥æ“ä½œï¼Œæ— ç–‘å°†è€—è´¹å¤§é‡æ—¶é—´å’Œç²¾åŠ›ã€‚ç„¶è€Œï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰Pythonè¿™ä¸ªå¼ºå¤§çš„åŠ©æ‰‹ï¼</p><p><img src="/ProgramLearnNotes/assets/489496489.BzzoyD5p.webp" alt="å›¾ç‰‡"></p><h3 id="ç—›ç‚¹åˆ†æ-1" tabindex="-1">ç—›ç‚¹åˆ†æ <a class="header-anchor" href="#ç—›ç‚¹åˆ†æ-1" aria-label="Permalink to &quot;ç—›ç‚¹åˆ†æ&quot;">â€‹</a></h3><p><strong>æ•ˆç‡ä½ä¸‹</strong>ï¼šæ‰‹åŠ¨æ±‡æ€»å’Œå¤åˆ¶è¿™äº›è¡¨æ ¼è´¹æ—¶è´¹åŠ›ï¼Œæ•ˆç‡ä½ä¸‹ã€‚</p><p><strong>å®¹æ˜“å‡ºé”™</strong>ï¼šç”±äºæ‰‹åŠ¨æ“ä½œï¼Œéš¾å…ä¼šå‡ºç°è¾“å…¥é”™è¯¯æˆ–é—æ¼çš„æƒ…å†µã€‚</p><p><strong>å·¥ä½œé‡å¤§</strong>ï¼šéšç€å…¬å¸äººå‘˜çš„å¢åŠ ï¼Œæ±‡æ€»æ—¶é—´å‘¨æœŸçš„å¢åŠ ï¼Œè¡¨æ ¼çš„æ•°é‡ä¹Ÿåœ¨ä¸æ–­å¢åŠ ï¼Œå·¥ä½œè´Ÿæ‹…è¶Šæ¥è¶Šé‡ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-1" tabindex="-1">è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-1" aria-label="Permalink to &quot;è§£å†³æ–¹æ¡ˆ&quot;">â€‹</a></h3><p>é’ˆå¯¹ä»¥ä¸Šç—›ç‚¹ï¼Œåˆ©ç”¨Pythonè‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ï¼Œé‡èº«å®šåˆ¶ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#æ–°å»ºä¸€ä¸ªDataFrameç”¨äºå­˜å‚¨æ±‡æ€»æ‰€æœ‰å·¥ä½œè¡¨çš„ç»“æœ</span></span>
<span class="line"><span style="color:#ABB2BF;">result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#è¯»å–æ•´ä¸ªExcelæ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;">df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ—¥é¢†æ–™å•.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">sheet_name</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#æŒ‰è¡¨åéå†ï¼Œå¤„ç†æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> sheet_name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">():    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #æŒ‰ç‰©æ–™ç¼–å·åŠ æ€»é¢†æ–™æ•°é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    df_sum </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[sheet_name].</span><span style="color:#61AFEF;">groupby</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;ç‰©æ–™ç¼–å·&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;ç‰©æ–™æè¿°&#39;</span><span style="color:#ABB2BF;">])[</span><span style="color:#98C379;">&#39;æ‰¹å·æ‰¹æ•°é‡&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">sum</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">()    </span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">([result,df_sum])</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#ABB2BF;">final </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> result.</span><span style="color:#61AFEF;">groupby</span><span style="color:#ABB2BF;">([</span><span style="color:#98C379;">&#39;ç‰©æ–™ç¼–å·&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;ç‰©æ–™æè¿°&#39;</span><span style="color:#ABB2BF;">])[</span><span style="color:#98C379;">&#39;æ‰¹å·æ‰¹æ•°é‡&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">sum</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">sort_values</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ‰¹å·æ‰¹æ•°é‡&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">ascending</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">final.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ±‡æ€».xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><img src="/ProgramLearnNotes/assets/640-1715865487406-78.CW2QtJoL.webp" alt="å›¾ç‰‡"></p><h2 id="å›¾ç‰‡é‡å‘½å" tabindex="-1">å›¾ç‰‡é‡å‘½å <a class="header-anchor" href="#å›¾ç‰‡é‡å‘½å" aria-label="Permalink to &quot;å›¾ç‰‡é‡å‘½å&quot;">â€‹</a></h2><p>ä½ æ˜¯å¦ä¹Ÿæ›¾é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šåŒäº‹Aå–ç€å’–å•¡ï¼Œæ‚ ç„¶è‡ªå¾—åœ°å®Œæˆå·¥ä½œä»»åŠ¡ï¼Œå¾—åˆ°é¢†å¯¼çš„èµè¯†ï¼›è€ŒåŒäº‹Bå´åŠ ç­åŠ ç‚¹ï¼Œå¿™ç¢Œä¸å ªï¼Œå´æ€»æ˜¯éš¾ä»¥å®Œæˆä»»åŠ¡ï¼Œé™·å…¥å›°å¢ƒã€‚è¿™å…¶ä¸­çš„å…³é”®ï¼Œå¾€å¾€ä¸åœ¨äºè°æ›´åŠªåŠ›ï¼Œè€Œåœ¨äºè°æŒæ¡äº†æ›´é«˜æ•ˆçš„å·¥ä½œæ–¹æ³•ã€‚ä»Šå¤©ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·æ¢è®¨å¦‚ä½•é€šè¿‡Pythonè‡ªåŠ¨åŒ–åŠå…¬ï¼Œæå‡èŒåœºæ•ˆç‡ï¼Œè§£æ”¾åŒæ‰‹ï¼å‘Šåˆ«åŠ ç­è‹¦æµ·ï¼è½»æ¾é€†è¢­èŒåœºå·…å³°ï¼</p><p>æœ€è¿‘ï¼Œæˆ‘çš„ä¸€ä½åšæ‘„å½±çš„æœ‹å‹é‡åˆ°äº†ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚ä»–ä»¬æ­£åœ¨ä¸ºä¸€å®¶æœè£…ç”µå•†ä¸Šçº¿å¤ç§‹å­£æ–°å“ï¼Œä½†ç”±äºç»è´¹å‹åŠ›ï¼Œåªèƒ½æ‹›äº†å‡ ä¸ªå¤§å­¦ç”Ÿå…¼èŒæ¨¡ç‰¹ã€‚ä¸ºäº†è®©å­¦ç”Ÿæ¨¡ç‰¹èƒ½å¤Ÿå‡†ç¡®åœ°æ‘†å‡ºä¸“ä¸šæ¨¡ç‰¹çš„å§¿åŠ¿ï¼Œä»–ä»¬éœ€è¦æå‰å‡†å¤‡å¥½å¤§é‡ä¸“ä¸šæ¨¡ç‰¹çš„åŠ¨ä½œå›¾ç‰‡ï¼Œå¹¶<strong>æŒ‰****ä¸€å®šè§„åˆ™è¿›è¡Œé‡å‘½åå’Œæ’åºï¼Œç«™å§¿æ’åœ¨å‰é¢å¹¶æ”¹æˆ&quot;1_&quot;ï¼Œæ‰‹éƒ¨ç±»çš„å§¿åŠ¿æ’åœ¨å…¶æ¬¡å‘½åä¸º&quot;2_&quot;ç±»ä¼¼æ­¤ç±»å°±ä¸èµ˜è¿°äº†</strong>ã€‚é‡å‘½ååçš„æ–‡ä»¶åå¦‚ä¸‹ã€‚é¢å¯¹è¿™ä¸ªç¹ççš„ä»»åŠ¡ï¼Œæˆ‘çš„æœ‹å‹å’Œä»–çš„åŒäº‹ä»¬é€‰æ‹©äº†ä¼ ç»Ÿçš„æ‰‹åŠ¨é‡å‘½åæ–¹å¼ï¼Œä½†æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€é¡¹æ—¢è€—æ—¶åˆè€—åŠ›çš„å·¥ä½œã€‚</p><p><img src="/ProgramLearnNotes/assets/640-9992222.DE3Q4ndC.webp" alt="å›¾ç‰‡"></p><p>å½“æˆ‘å¾—çŸ¥è¿™ä¸ªæƒ…å†µåï¼Œæˆ‘ç«‹å³æƒ³åˆ°äº†Pythonè‡ªåŠ¨åŒ–åŠå…¬ã€‚é€šè¿‡ç¼–å†™ç®€å•çš„Pythonè„šæœ¬ï¼Œ<strong>æˆ‘ä»…ç”¨10è¡Œä»£ç å°±è½»æ¾è§£å†³äº†ä¸Šä¸‡å¼ ç…§ç‰‡çš„é‡å‘½åé—®é¢˜ï¼Œä¸åˆ°5åˆ†é’Ÿå°±å®Œæˆäº†åŸæœ¬éœ€è¦åå‡ ä¸ªå°æ—¶çš„ä»»åŠ¡</strong>ã€‚è¿™ä¸ä»…è®©æˆ‘çš„æœ‹å‹å¤§æ„ŸæƒŠè®¶ï¼Œä¹Ÿè®©ä»–æ·±åˆ»ä½“ä¼šåˆ°äº†è‡ªåŠ¨åŒ–åŠå…¬çš„é«˜æ•ˆå’Œä¾¿æ·ã€‚</p><p>ä»£ç </p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#ABB2BF;">data_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/home/young/data/myself/men/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">dir_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/home/young/data/myself/man/&quot;</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(data_path):</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(i)</span></span>
<span class="line"><span style="color:#ABB2BF;">    j </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> i.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ç«™å§¿&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;1_&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ‰‹éƒ¨&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;2_&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;è¡£æœ&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;3_&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;åŠ¨æ€&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;4_&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;åå§¿&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;5_&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(j)</span></span>
<span class="line"><span style="color:#ABB2BF;">    img </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(data_path,i))</span></span>
<span class="line"><span style="color:#ABB2BF;">    img.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(dir_path,j))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ç„¶è€Œï¼Œäº‹æƒ…å¹¶æ²¡æœ‰å°±æ­¤ç»“æŸã€‚åœ¨æ‹æ‘„å½“å¤©ï¼Œç°åœºåˆå‡ºç°äº†ä¸€ä¸ªç´§æ€¥é—®é¢˜ï¼šåŸæœ¬è®¡åˆ’åœ¨ä¸¤ä¸ªå¤§å±ä¸Šåˆ†åˆ«æ”¾æ˜ ç”·å¥³æ¨¡ç‰¹çš„åŠ¨ä½œå›¾ç‰‡ï¼Œä¸¤ä¸ªæ¨¡ç‰¹åˆ†åˆ«æ ¹æ®å›¾ç‰‡å»æ¨¡ä»¿åŠ¨ä½œï¼Œä½†ç”±äºè®¾å¤‡æ•…éšœï¼Œä¸€ä¸ªå¤§å±åäº†ã€‚è¿™æ„å‘³ç€ç”·å¥³æ¨¡ç‰¹éœ€è¦é—´éš”æ‹æ‘„ï¼ŒåŸæ¥å¹¶è¡Œçš„æµç¨‹å˜æˆäº†ä¸²è¡Œï¼Œè¿™å°†ä¸¥é‡å½±å“æ‹æ‘„è¿›åº¦ã€‚é¢å¯¹è¿™ä¸ªçªå‘æƒ…å†µï¼Œæˆ‘å†æ¬¡åˆ©ç”¨Pythonç¼–ç¨‹æŠ€èƒ½ï¼Œå®ç°äº†ç”·å¥³æ¨¡ç‰¹å›¾ç‰‡çš„åˆå¹¶åŠŸèƒ½ï¼Œä¸€ä¸ªå¤§å±åŒæ—¶æ’­å‡ºç”·å¥³æ¨¡ç‰¹åˆå¹¶çš„å›¾ç‰‡ã€‚é€šè¿‡ç¼–å†™ä»£ç ï¼Œæˆ‘æˆåŠŸåœ°å°†ç”·å¥³æ¨¡ç‰¹çš„å›¾ç‰‡åˆå¹¶åˆ°ä¸€å¼ å›¾ä¸Šï¼Œå¹¶ç¡®ä¿äº†ä¸¤å¼ å›¾ç‰‡çš„å®½åº¦å’Œé«˜åº¦ç›¸åŒã€‚è¿™ä¸ä»…è§£å†³äº†ç°åœºçš„é—®é¢˜ï¼Œè¿˜èŠ‚çœäº†å®è´µçš„æ—¶é—´ã€‚</p><p>åŸæ¥çš„å›¾ç‰‡ç”·å¥³ç”Ÿæ¨¡ç‰¹å§¿åŠ¿åˆ†åˆ«åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1716211454870-156.CelLN94D.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1716211454870-157.BR3axaSv.webp" alt="å›¾ç‰‡"></p><p>æˆ‘å®ç°å›¾ç‰‡åˆå¹¶çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">man_pic </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/home/young/data/model/man_final/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">woman_pic </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/home/young/data/model/woman/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">man_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(man_pic)</span></span>
<span class="line"><span style="color:#ABB2BF;">woman_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(woman_pic)</span></span>
<span class="line"><span style="color:#ABB2BF;">men_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [man_pic</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> man_list]</span></span>
<span class="line"><span style="color:#ABB2BF;">women_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [woman_pic</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> woman_list]</span></span>
<span class="line"><span style="color:#ABB2BF;">save_dir </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;/home/young/data/model/joint/&quot;</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(save_dir):</span></span>
<span class="line"><span style="color:#ABB2BF;">    os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(save_dir)</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> torchvision </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> transforms</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> image_Splicing</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">img_1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">img_2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">flag</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;font-style:italic;">save_dir</span><span style="color:#ABB2BF;"> ,</span><span style="color:#D19A66;font-style:italic;">pic_name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;joint&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    img1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(img_1)</span></span>
<span class="line"><span style="color:#ABB2BF;">    img2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(img_2)</span></span>
<span class="line"><span style="color:#ABB2BF;">    size1, size2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> img1.size, img2.size</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#     radio = size1[0]/size1[1]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#     img_org = cv2.imread(str(img_1))</span></span>
<span class="line"><span style="color:#ABB2BF;">    img2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> transforms.</span><span style="color:#61AFEF;">Resize</span><span style="color:#ABB2BF;">([size1[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">],size1[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]])(img2)</span></span>
<span class="line"><span style="color:#ABB2BF;">    size2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> img2.size</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#     max_height = max(size1[1])</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> flag </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;x&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        joint </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">new</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;RGB&quot;</span><span style="color:#ABB2BF;">, (size1[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> size2[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">], size1[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">        loc1, loc2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">), (size1[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">], </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        joint </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">new</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;RGB&quot;</span><span style="color:#ABB2BF;">, (size1[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">], size2[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">size1[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">        loc1, loc2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">), (</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, size1[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">    joint.</span><span style="color:#61AFEF;">paste</span><span style="color:#ABB2BF;">(img1, loc1)</span></span>
<span class="line"><span style="color:#ABB2BF;">    joint.</span><span style="color:#61AFEF;">paste</span><span style="color:#ABB2BF;">(img2, loc2)</span></span>
<span class="line"><span style="color:#ABB2BF;">    joint.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(save_dir</span><span style="color:#56B6C2;">+str</span><span style="color:#ABB2BF;">(pic_name)</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;.png&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i,(men,women)</span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">zip</span><span style="color:#ABB2BF;">(women_list,men_list)):</span></span>
<span class="line"><span style="color:#61AFEF;">    image_Splicing</span><span style="color:#ABB2BF;">(men,women,</span><span style="color:#98C379;">&quot;x&quot;</span><span style="color:#ABB2BF;">,save_dir,i</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>å®ç°äº†å›¾ç‰‡åˆå¹¶ï¼Œè¿˜ä¿è¯äº†åˆå¹¶åçš„ä¸¤ä¸ªå›¾ç‰‡çš„å®½åº¦é«˜åº¦æ˜¯ç›¸åŒçš„ã€‚ä¸ä»…å®ç°äº†æ¨ªå‘åˆå¹¶ï¼Œè¿˜èµ é€äº†çºµå‘åˆå¹¶ã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1716211454870-158.DU9VZ8jw.webp" alt="å›¾ç‰‡"></p><p><img src="/ProgramLearnNotes/assets/640-1716211454870-159.CbKkajdx.webp" alt="å›¾ç‰‡"></p><p>é€šè¿‡è¿™ä¸¤ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ·±åˆ»ä½“ä¼šåˆ°Pythonè‡ªåŠ¨åŒ–åŠå…¬çš„å¼ºå¤§é­…åŠ›ã€‚å®ƒä¸ä»…å¯ä»¥è®©æˆ‘ä»¬ä»ç¹ççš„å·¥ä½œä¸­è§£è„±å‡ºæ¥ï¼Œè¿˜èƒ½å¤§å¤§æé«˜å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚åœ¨å½“ä»Šè¿™ä¸ªä¿¡æ¯åŒ–ã€æ•°å­—åŒ–çš„æ—¶ä»£ï¼ŒæŒæ¡ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œå°¤å…¶æ˜¯åƒPythonè¿™æ ·çš„é€šç”¨æ€§å¼ºçš„è¯­è¨€ï¼Œå¯¹äºèŒåœºäººæ¥è¯´å·²ç»å˜å¾—è‡³å…³é‡è¦ã€‚</p><h2 id="å¼¥è¡¥-vlookup-ä¸è¶³-å®ç°è‡ªå®šä¹‰è§„åˆ™çš„æ¨¡ç³ŠåŒ¹é…" tabindex="-1">å¼¥è¡¥ VLOOKUP ä¸è¶³ï¼Œå®ç°è‡ªå®šä¹‰è§„åˆ™çš„æ¨¡ç³ŠåŒ¹é… <a class="header-anchor" href="#å¼¥è¡¥-vlookup-ä¸è¶³-å®ç°è‡ªå®šä¹‰è§„åˆ™çš„æ¨¡ç³ŠåŒ¹é…" aria-label="Permalink to &quot;å¼¥è¡¥ VLOOKUP ä¸è¶³ï¼Œå®ç°è‡ªå®šä¹‰è§„åˆ™çš„æ¨¡ç³ŠåŒ¹é…&quot;">â€‹</a></h2><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†å¤§é‡çš„ Excel æ•°æ®ã€‚å½“å¤šä¸ªè¡¨æ ¼ç»è¿‡å¤šäººä¹‹æ‰‹æ—¶ï¼Œæ•°æ®è¾“å…¥è§„èŒƒçš„ä¸ä¸€è‡´æ€§å¾€å¾€æˆä¸ºæ•°æ®å¤„ç†çš„éš¾é¢˜ã€‚å°¤å…¶æ˜¯å½“éœ€è¦ä½¿ç”¨ Vlookup è¿›è¡Œå¤šè¡¨åŒ¹é…æ—¶ï¼Œå› æ•°æ®æ ¼å¼çš„å·®å¼‚å¯¼è‡´åŒ¹é…å¤±è´¥çš„æƒ…å†µå±¡è§ä¸é²œã€‚è€Œ Python è‡ªåŠ¨åŒ–åŠå…¬å·¥å…·çš„å‡ºç°ï¼Œåˆ™ä¸ºè§£å†³è¿™ç±»é—®é¢˜æä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚</p><p>è¿‘æœŸï¼Œæˆ‘å°±é‡åˆ°äº†è¿™æ ·ä¸€ä¸ªæŒ‘æˆ˜ï¼šéœ€è¦åŒ¹é…ä¸¤ä¸ª Excel è¡¨ä¸­çš„æ•°æ®ï¼Œä½†åŒ¹é…åˆ—çš„æ•°æ®æ˜¯å¤šä¸ªäººç»æ‰‹çš„ï¼Œæ ¼å¼å­˜åœ¨è¾ƒå¤§çš„å·®å¼‚ã€‚å…·ä½“æ¥è¯´ï¼ŒåŒ¹é…åˆ—çš„æ•°æ®éå¸¸ç›¸è¿‘å´åˆä¸åŒï¼Œæ¯”å¦‚åŒä¸€æ•°æ®åœ¨ä¸€ä¸ªè¡¨é‡Œæ˜¯ Solid carbon tipUltra light Spinn 195 Up to 35g Light FASTï¼Œåœ¨å¦ä¸€ä¸ªè¡¨é‡Œå°±å˜æˆäº† Ultra light Spinn Solid carbon tip 195 Up to 35g FASTLight ä¹Ÿå°±æ˜¯æ•°æ®çš„åŸºæœ¬å…ƒç´ æ˜¯ç›¸åŒçš„ï¼Œåªä¸è¿‡æ˜¯å­—ç¬¦é¡ºåºã€å¤§å°å†™ã€ç©ºæ ¼ä¸å°½ç›¸åŒï¼Œé¢å¯¹è¿™æ ·çš„é—®é¢˜ï¼Œä¼ ç»Ÿçš„ Vlookup æ–¹æ³•æ˜¾ç„¶æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚è™½ç„¶ Vlookup æä¾›äº†æ¨¡ç³ŠåŒ¹é…çš„åŠŸèƒ½ï¼Œä½†å…¶åœ¨å¤„ç†å¤§å°å†™ã€ç©ºæ ¼ä»¥åŠå­—ç¬¦é¡ºåºç­‰æ–¹é¢æ— æ³•è¿›è¡Œè§„åˆ™è‡ªå®šä¹‰ï¼Œå¾€å¾€éš¾ä»¥å¾—åˆ°å‡†ç¡®çš„ç»“æœã€‚</p><p>Python è‡ªåŠ¨åŒ–åŠå…¬å·¥å…·ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†æ›´åŠ çµæ´»å’Œå¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚é€šè¿‡ç¼–å†™è‡ªå®šä¹‰çš„æ¨¡ç³ŠåŒ¹é…è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°å¯¹å¤§å°å†™ã€ç©ºæ ¼ä»¥åŠå­—ç¬¦é¡ºåºçš„å¿½ç•¥ï¼Œä»è€Œå®ç°ç²¾ç¡®çš„æ•°æ®åŒ¹é…ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è¯»å–ä¸¤ä¸ªExcelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">df1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;file1.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">df2 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;file2.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥é¢„å¤„ç†å­—ç¬¦ä¸²ï¼Œä»¥å¿½ç•¥å¤§å°å†™ã€ç©ºæ ¼å’Œå­—ç¬¦é¡ºåº</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> preprocess_string</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">s</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è½¬æ¢ä¸ºå°å†™</span></span>
<span class="line"><span style="color:#ABB2BF;">    s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> s.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # ç§»é™¤å¤šä½™çš„ç©ºæ ¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">sub</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;\s</span><span style="color:#D19A66;">+</span><span style="color:#E06C75;">&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39; &#39;</span><span style="color:#ABB2BF;">, s).</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åˆ†å‰²å­—ç¬¦ä¸²ä¸ºå­—ç¬¦åˆ—è¡¨ï¼Œç„¶åæ’åº</span></span>
<span class="line"><span style="color:#ABB2BF;">    s </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">sorted</span><span style="color:#ABB2BF;">(s))</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¹df1å’Œdf2ä¸­éœ€è¦åŒ¹é…çš„åˆ—è¿›è¡Œé¢„å¤„ç†</span></span>
<span class="line"><span style="color:#ABB2BF;">df1[</span><span style="color:#98C379;">&#39;column_to_match_processed&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df1[</span><span style="color:#98C379;">&#39;column_to_match&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(preprocess_string)</span></span>
<span class="line"><span style="color:#ABB2BF;">df2[</span><span style="color:#98C379;">&#39;column_to_match_against_processed&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df2[</span><span style="color:#98C379;">&#39;column_to_match_against&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(preprocess_string)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºä¸€ä¸ªç©ºåˆ—æ¥å­˜å‚¨åŒ¹é…ç»“æœ</span></span>
<span class="line"><span style="color:#ABB2BF;">df1[</span><span style="color:#98C379;">&#39;matched_data&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># éå†df1ï¼Œå°è¯•åœ¨df2ä¸­æ‰¾åˆ°åŒ¹é…é¡¹</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> index, row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df1.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    processed_string </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&#39;column_to_match_processed&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    matches </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df2[df2[</span><span style="color:#98C379;">&#39;column_to_match_against_processed&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> processed_string]</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> matches.empty:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å‡è®¾æ¯ä¸ªå¤„ç†åçš„å­—ç¬¦ä¸²åœ¨df2ä¸­åªåŒ¹é…ä¸€æ¬¡ï¼Œå–ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</span></span>
<span class="line"><span style="color:#ABB2BF;">        df1.at[index, </span><span style="color:#98C379;">&#39;matched_data&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> matches[</span><span style="color:#98C379;">&#39;data_column&#39;</span><span style="color:#ABB2BF;">].iloc[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]  </span><span style="color:#7F848E;font-style:italic;"># å‡è®¾&#39;data_column&#39;æ˜¯df2ä¸­ä½ æƒ³è¦åŒ¹é…çš„æ•°æ®åˆ—å</span></span>
<span class="line"><span style="color:#C678DD;">    else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œå¯ä»¥ä¿æŒä¸ºNoneæˆ–è€…è®¾ç½®ä¸ºå…¶ä»–é»˜è®¤å€¼</span></span>
<span class="line"><span style="color:#C678DD;">        pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ç§»é™¤é¢„å¤„ç†åˆ—ï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">df1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df1.</span><span style="color:#61AFEF;">drop</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">columns</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;column_to_match_processed&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä¿å­˜ç»“æœåˆ°æ–°çš„Excelæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">df1.</span><span style="color:#61AFEF;">to_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;matched_data.xlsx&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>è¯·æ³¨æ„ï¼Œä¸Šé¢çš„è„šæœ¬å‡è®¾<code>df1</code>ä¸­çš„<code>column_to_match</code>æ˜¯ä½ è¦åŒ¹é…çš„åˆ—ï¼Œè€Œ<code>df2</code>ä¸­çš„<code>column_to_match_against</code>æ˜¯ä½ è¦ä¸ä¹‹åŒ¹é…çš„åˆ—ã€‚åŒæ—¶ï¼Œå‡è®¾<code>df2</code>ä¸­æœ‰ä¸€ä¸ªåä¸º<code>data_column</code>çš„åˆ—ï¼Œå…¶ä¸­åŒ…å«ä½ æƒ³è¦ä»<code>df2</code>ä¸­è·å–çš„æ•°æ®ã€‚ä½ éœ€è¦å°†è¿™äº›åˆ—åæ›¿æ¢ä¸ºä½ å®é™… Excel æ–‡ä»¶ä¸­çš„åˆ—åï¼Œpreprocess_string å‡½æ•°å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªå®šä¹‰ä»»æ„çš„è§„åˆ™ã€‚</p><p>æ­¤å¤–ï¼Œè¿™ä¸ªè„šæœ¬å‡è®¾æ¯ä¸ªå¤„ç†åçš„å­—ç¬¦ä¸²åœ¨<code>df2</code>ä¸­åªåŒ¹é…ä¸€æ¬¡ã€‚å¦‚æœå¯èƒ½å­˜åœ¨å¤šä¸ªåŒ¹é…é¡¹ï¼Œä½ éœ€è¦å†³å®šå¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œå–ç¬¬ä¸€ä¸ªã€æœ€åä¸€ä¸ªã€éšæœºä¸€ä¸ªï¼Œæˆ–è€…æ‰€æœ‰åŒ¹é…é¡¹ï¼‰ã€‚</p><h2 id="ä¸€åˆ†é’Ÿæå®šåŸæ¥ä¸€ä¸ªéƒ¨é—¨å‡ ä¸ªå‘¨çš„å·¥ä½œ" tabindex="-1">ä¸€åˆ†é’Ÿæå®šåŸæ¥ä¸€ä¸ªéƒ¨é—¨å‡ ä¸ªå‘¨çš„å·¥ä½œ <a class="header-anchor" href="#ä¸€åˆ†é’Ÿæå®šåŸæ¥ä¸€ä¸ªéƒ¨é—¨å‡ ä¸ªå‘¨çš„å·¥ä½œ" aria-label="Permalink to &quot;ä¸€åˆ†é’Ÿæå®šåŸæ¥ä¸€ä¸ªéƒ¨é—¨å‡ ä¸ªå‘¨çš„å·¥ä½œ&quot;">â€‹</a></h2><p>Python åŠå…¬â¾ƒåŠ¨åŒ–æ˜¯åˆ©â½¤ Python ç¼–ç¨‹è¯­â¾”æ¥åˆ›å»ºè„šæœ¬å’Œç¨‹åºï¼Œä»¥ç®€åŒ–ã€åŠ é€Ÿå’Œâ¾ƒåŠ¨åŒ–â½‡å¸¸åŠå…¬ä»»åŠ¡å’Œâ¼¯ä½œæµç¨‹çš„è¿‡ç¨‹ã€‚å®ƒåŸºäº Python çš„å¼ºâ¼¤åŠŸèƒ½å’Œä¸°å¯Œçš„ç¬¬ä¸‰â½…åº“ï¼Œä½¿å¾—èƒ½å¤Ÿå¤„ç†å„ç§åŠå…¬ä»»åŠ¡ï¼Œå¦‚â½‚æ¡£å¤„ç†ã€æ•°æ®åˆ†æã€ç”µâ¼¦é‚®ä»¶ç®¡ç†ã€â½¹ç»œé€šä¿¡ç­‰ç­‰ã€‚</p><p>ä¸‹é¢å°±ç”¨ä¸€ä¸ªçœŸå®çš„æ¡ˆä¾‹æ„Ÿå— python è‡ªåŠ¨åŒ–çš„é«˜æ•ˆï¼Œä¸€åˆ†é’Ÿæå®šåŸæ¥ä¸€ä¸ªéƒ¨é—¨äº”å…­ä¸ªäººä¸€å‘¨çš„è¡¨æ ¼æ±‡æ€»å·¥ä½œã€‚</p><hr><p>åœ¨å›½ä¼çš„å­£åº¦ç»©æ•ˆè€ƒæ ¸ä¸­ï¼Œé¢†å¯¼å¯¹å‘˜å·¥è¿›è¡Œè¯„åˆ†æ˜¯ä¸€é¡¹é‡è¦è€Œç¹ççš„ä»»åŠ¡ã€‚ç”±äºå…¬å¸è§„æ¨¡è¾ƒå¤§ï¼Œå‘˜å·¥ä¼—å¤šï¼Œæ¯ä¸ªé¢†å¯¼éƒ½éœ€è¦å¯¹è‡ªå·±æ‰€ç®¡è¾–çš„å‘˜å·¥è¿›è¡Œè¯„åˆ†ï¼ŒåŒæ—¶å‘˜å·¥ä¹‹é—´è¿˜éœ€è¦è¿›è¡Œäº’è¯„ï¼Œä»¥ä½“ç°å…¬å¹³æ°‘ä¸»ï¼Œè€Œè¿™äº›è¯„åˆ†æ•°æ®é€šå¸¸ä»¥ Excel è¡¨æ ¼çš„å½¢å¼æäº¤ã€‚äººäº‹å°±è‚©è´Ÿç€å°†è¿™äº›è¯„åˆ†æ•°æ®è¿›è¡Œæ±‡æ€»å¹¶è®¡ç®—å¹³å‡å€¼çš„é‡ä»»ã€‚</p><h3 id="å‘˜å·¥äº’è¯„è¡¨" tabindex="-1">å‘˜å·¥äº’è¯„è¡¨ <a class="header-anchor" href="#å‘˜å·¥äº’è¯„è¡¨" aria-label="Permalink to &quot;å‘˜å·¥äº’è¯„è¡¨&quot;">â€‹</a></h3><p><img src="/ProgramLearnNotes/assets/image-20240511170638118.BkIshhON.png" alt="image-20240511170638118"></p><h3 id="é¢†å¯¼è¯„åˆ†è¡¨" tabindex="-1">é¢†å¯¼è¯„åˆ†è¡¨ <a class="header-anchor" href="#é¢†å¯¼è¯„åˆ†è¡¨" aria-label="Permalink to &quot;é¢†å¯¼è¯„åˆ†è¡¨&quot;">â€‹</a></h3><p><img src="/ProgramLearnNotes/assets/image-20240511170653295.CQ66ZhKO.png" alt="image-20240511170653295"></p><p>ä¼ ç»Ÿçš„æ±‡æ€»æ–¹å¼éœ€è¦äººå·¥æ‰‹åŠ¨æ‰“å¼€æ¯ä¸ª Excel æ–‡ä»¶ï¼Œæå–å‡ºæ¯ä½é¢†å¯¼å’Œå‘˜å·¥å¯¹æ¯ä¸ªå‘˜å·¥çš„è¯„åˆ†æ•°æ®ï¼Œç„¶åå†æŒ‰ç…§å‘˜å·¥å§“åè¿›è¡Œæ±‡æ€»ï¼Œå¹¶è®¡ç®—å¹³å‡å€¼ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚ä¸€æ—¦æ•°æ®å‡ºç°åå·®ï¼Œå°±éœ€è¦é‡æ–°æ ¸å¯¹ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†å·¥ä½œé‡ã€‚</p><p>æ±‡æ€»ç»“æœæ˜¯è¿™æ ·çš„ï¼Œæ¯ä¸ªäººæ¯ä¸ªæœˆçš„è€ƒæ ¸åˆ†æ•°åŠç»“æœè¡¨</p><p><img src="/ProgramLearnNotes/assets/image-20240511170709321.CIH1PaEL.png" alt="image-20240511170709321"></p><p><img src="/ProgramLearnNotes/assets/image-20240511170723940.COcmkNF1.png" alt="image-20240511170723940"></p><p><img src="/ProgramLearnNotes/assets/image-20240511170735156.BPhM6raW.png" alt="image-20240511170735156"></p><p>è¡Œæ”¿äººäº‹æ”¶ä¸Šæ¥çš„æ–‡ä»¶æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="/ProgramLearnNotes/assets/image-20240511170747321.D6gNOaGK.png" alt="image-20240511170747321"></p><p>æ¯ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯æ¯ä¸ªéƒ¨é—¨é¢†å¯¼æˆ–è€…å‘˜å·¥ç»™æ‰€æœ‰äººæ‰“åˆ†</p><p><img src="/ProgramLearnNotes/assets/image-20240511170801963.Bo1RSQDW.png" alt="image-20240511170801963"></p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å°è¯•åˆ©ç”¨ Python çš„è‡ªåŠ¨åŒ–å¤„ç†èƒ½åŠ›æ¥ä¼˜åŒ–æ•´ä¸ªä¸ªå·¥ä½œæµç¨‹ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„åŠªåŠ›ï¼Œæˆ‘æˆåŠŸå¼€å‘å‡ºäº†ä¸€ä¸ªè‡ªåŠ¨åŒ–æ±‡æ€»è½¯ä»¶ã€‚</p><p>æ ¸å¿ƒä»£ç </p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> json</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logging</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> openpyxl</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">LOG_FORMAT</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;</span><span style="color:#D19A66;">%(asctime)s</span><span style="color:#98C379;"> - </span><span style="color:#D19A66;">%(levelname)s</span><span style="color:#98C379;"> - </span><span style="color:#D19A66;">%(message)s</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">logging.</span><span style="color:#61AFEF;">basicConfig</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">filename</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;./datacount.log&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">                    level</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">logging.</span><span style="color:#D19A66;">WARN</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">format</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">LOG_FORMAT</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">dx_dir </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;å®šæ€§æ‰“åˆ†è¡¨&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">dl_dir </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;å®šé‡æ‰“åˆ†è¡¨&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> all_files</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">path</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">file_type</span><span style="color:#ABB2BF;">):    </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆpathè·¯å¾„ä¸‹å…¨éƒ¨file_typeç±»å‹æ–‡ä»¶ç»å¯¹è·¯å¾„åˆ—è¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;">    f_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    def</span><span style="color:#61AFEF;"> files_list</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">father_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        sub_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">listdir</span><span style="color:#ABB2BF;">(father_path)    </span><span style="color:#7F848E;font-style:italic;"># è¯»å–çˆ¶è·¯å¾„ä¸‹å…¨éƒ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åç§°</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> sp </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> sub_path:</span></span>
<span class="line"><span style="color:#ABB2BF;">            full_sub_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(father_path, sp)    </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆå®Œæ•´å­è·¯å¾„</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">isfile</span><span style="color:#ABB2BF;">(full_sub_path):    </span><span style="color:#7F848E;font-style:italic;"># åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">                file_name, post_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    full_sub_path)    </span><span style="color:#7F848E;font-style:italic;"># è·å–æ–‡ä»¶åç¼€å</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> file_type </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> post_name:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    f_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(file_name </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> post_name)</span></span>
<span class="line"><span style="color:#C678DD;">            else</span><span style="color:#ABB2BF;">:    </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ˜¯æ–‡ä»¶å¤¹ï¼Œé€’å½’è°ƒç”¨</span></span>
<span class="line"><span style="color:#61AFEF;">                files_list</span><span style="color:#ABB2BF;">(full_sub_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">    files_list</span><span style="color:#ABB2BF;">(path)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> f_list</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> read_all_dl_exl</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">fs_list</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;font-style:italic;">mons</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> excel_file </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> fs_list:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(excel_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">        excel_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(excel_file)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(excel_name)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # rated_name = excel_file.split(&quot;\\&quot;)[-1].split(&quot;.&quot;)[0]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #     rated_name_mon = re.split(r&quot;[- _  --]&quot;,excel_name)[-2]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rater_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> excel_file.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rater_name)</span></span>
<span class="line"><span style="color:#ABB2BF;">        rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;</span><span style="color:#D19A66;">[- _  --]</span><span style="color:#E06C75;">&quot;</span><span style="color:#ABB2BF;">,excel_name)[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rated_name)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(mons[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;æœˆ&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> excel_name:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(mons[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">])</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;æœˆ&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> excel_name:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(mons[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">])</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;æœˆ&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> excel_name:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">99</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;rated_name&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [rated_name]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [rater_name]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [mon]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#98C379;"> &quot;.xlsx&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> excel_file:</span></span>
<span class="line"><span style="color:#ABB2BF;">            data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file,</span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;I&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">engine</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;openpyxl&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(data_s)</span><span style="color:#56B6C2;">&lt;=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file,</span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;I&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">engine</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;openpyxl&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">sheet_name</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(data_s)</span><span style="color:#56B6C2;">&lt;=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file,</span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;I&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">engine</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;openpyxl&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">sheet_name</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file,</span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;I&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(data_s)</span><span style="color:#56B6C2;">&lt;=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file,</span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;I&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">sheet_name</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(data_s)</span><span style="color:#56B6C2;">&lt;=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file,</span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;I&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">sheet_name</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [data_s[data_s.iloc[:,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">notna</span><span style="color:#ABB2BF;">()].iloc[:,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].iloc[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        all_data_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(rate_df)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> all_data_list</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> read_all_dx_exl</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">fs_list</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">mons</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_data_list </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> excel_file </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> fs_list:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(excel_file)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # rated_name = excel_file.split(&quot;\\&quot;)[-1].split(&quot;.&quot;)[0]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rated_name_mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> excel_file.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rater_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> excel_file.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rater_name)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#98C379;"> &quot;-&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> rated_name_mon:</span></span>
<span class="line"><span style="color:#ABB2BF;">            rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> rated_name_mon.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;-&quot;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;\d&quot;</span><span style="color:#ABB2BF;">, rated_name_mon)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rated_name)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(mons[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]) </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rated_name_mon:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(mons[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]) </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rated_name_mon:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        elif</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(mons[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]) </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rated_name_mon:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            mon </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">99</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;rated_name&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [rated_name]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [rater_name]</span></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [mon]</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#98C379;"> &quot;.xlsx&quot;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> excel_file:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                excel_file, </span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;G&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">engine</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;openpyxl&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(data_s) </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    excel_file, </span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">engine</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;openpyxl&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_s[data_s.columns[[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]]]</span></span>
<span class="line"><span style="color:#C678DD;">        else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file, </span><span style="color:#E06C75;font-style:italic;">usecols</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;G&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(data_s) </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(excel_file, </span><span style="color:#E06C75;font-style:italic;">header</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                data_s </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_s[data_s.columns[[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]]]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        rate_df[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">            data_s[data_s.iloc[:, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">notna</span><span style="color:#ABB2BF;">()].iloc[:, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].iloc[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]]</span></span>
<span class="line"><span style="color:#ABB2BF;">        all_data_list.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(rate_df)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> all_data_list</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> save_dx_result</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">rated_group</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">mons</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> rated_per, df </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rated_group:</span></span>
<span class="line"><span style="color:#ABB2BF;">        wb1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;./æ¨¡æ¿è¡¨.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb1[</span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rated_per)</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(df)</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> rated_per</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">11</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> rated_per</span></span>
<span class="line"><span style="color:#ABB2BF;">        ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> rated_per</span></span>
<span class="line"><span style="color:#ABB2BF;">        df_7 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]].</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">drop</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(df_7) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i, row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df_7.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df_7.score.</span><span style="color:#61AFEF;">mean</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        df_8 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]].</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">drop</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(df_8) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i, row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df_8.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df_8.score.</span><span style="color:#61AFEF;">mean</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        df_9 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> mons[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]].</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">drop</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(df_9) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i, row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df_9.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">21</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">i).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">23</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df_9.score.</span><span style="color:#61AFEF;">mean</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        wb1.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;./result/&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">rated_per</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> save_dl_result</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">rated_group</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">mons</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> rated_per,df </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rated_group:</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            wb1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> openpyxl.</span><span style="color:#61AFEF;">load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;./result/&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">rated_per</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            ws1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb1[</span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#C678DD;">        except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rated_per)</span></span>
<span class="line"><span style="color:#ABB2BF;">            logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#C678DD;">            continue</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(rated_per)</span></span>
<span class="line"><span style="color:#ABB2BF;">        logging.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(df)</span></span>
<span class="line"><span style="color:#ABB2BF;">        df_7 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">]</span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">mons[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]].</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">drop</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(df_7)</span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i,row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df_7.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        df_8 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">]</span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">mons[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]].</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">drop</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(df_8)</span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i,row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df_8.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        df_9 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> df[df[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">]</span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;">mons[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]].</span><span style="color:#61AFEF;">reset_index</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">drop</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#56B6C2;"> len</span><span style="color:#ABB2BF;">(df_9)</span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> i,row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df_9.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">24</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;rater_name&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                ws1.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">).value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> row[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        wb1.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;./result/&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;">rated_per</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&quot;.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> clean_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;ã€Š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;</span><span style="color:#56B6C2;">\ï¼ˆ</span><span style="color:#E06C75;">.</span><span style="color:#D19A66;">*?</span><span style="color:#56B6C2;">\ï¼‰</span><span style="color:#E06C75;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot; &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;  &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;\s*&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;   &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;    &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;ã€Šå®šæ€§æŒ‡æ ‡è€ƒæ ¸è¡¨ï¼ˆå‘˜å·¥å±‚ï¼‰ã€‹&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;1æœˆ&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;2æœˆ&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;3æœˆ&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;ã€Šå®šæ€§æŒ‡æ ‡è€ƒæ ¸è¡¨ã€‹&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.rated_name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.rated_name.str.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&quot;ã€Š&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> data</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    save_dir </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;./result/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(save_dir):</span></span>
<span class="line"><span style="color:#ABB2BF;">        os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(save_dir)</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;config.json&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> json_file:</span></span>
<span class="line"><span style="color:#ABB2BF;">        config </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json.</span><span style="color:#61AFEF;">load</span><span style="color:#ABB2BF;">(json_file)</span></span>
<span class="line"><span style="color:#ABB2BF;">    mons </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&quot;mons&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    fs_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> all_files</span><span style="color:#ABB2BF;">(dx_dir, </span><span style="color:#98C379;">&quot;xls&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_dx_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> read_all_dx_exl</span><span style="color:#ABB2BF;">(fs_list, mons)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(all_dx_list, </span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_score_dx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dx[data_dx.score </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_mon_dx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dx[data_dx[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">99</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_score_dx.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;wrong_data_dx.csv&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">mode</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;a&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_mon_dx.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;wrong_data_dx.csv&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">mode</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;a&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dx[data_dx.score </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dx[data_dx[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">99</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dx[</span><span style="color:#98C379;">&quot;score&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">to_numeric</span><span style="color:#ABB2BF;">(data_dx.score, </span><span style="color:#E06C75;font-style:italic;">errors</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;coerce&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dx[data_dx.score.</span><span style="color:#61AFEF;">notnull</span><span style="color:#ABB2BF;">()]</span></span>
<span class="line"><span style="color:#ABB2BF;">    data </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> clean_data</span><span style="color:#ABB2BF;">(data_dx)</span></span>
<span class="line"><span style="color:#ABB2BF;">    rated_group </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">groupby</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;rated_name&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">    save_dx_result</span><span style="color:#ABB2BF;">(rated_group, mons)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    dl_fs_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> all_files</span><span style="color:#ABB2BF;">(dl_dir,</span><span style="color:#98C379;">&quot;xls&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    all_dl_list </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> read_all_dl_exl</span><span style="color:#ABB2BF;">(dl_fs_list, mons)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(all_dl_list,</span><span style="color:#E06C75;font-style:italic;">ignore_index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_score_dl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dl[data_dl.score </span><span style="color:#56B6C2;">&lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_mon_dl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dl[data_dl[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">==</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">99</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_score_dl.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;wrong_data_dl.csv&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">mode</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;a&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    wrong_mon_dl.</span><span style="color:#61AFEF;">to_csv</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;wrong_data_dl.csv&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">mode</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;a&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    data_dl </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data_dl[data_dl[</span><span style="color:#98C379;">&quot;month&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">!=</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">99</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    data2 </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> clean_data</span><span style="color:#ABB2BF;">(data_dl)</span></span>
<span class="line"><span style="color:#ABB2BF;">    dl_rated_group </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> data2.</span><span style="color:#61AFEF;">groupby</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;rated_name&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">    save_dl_result</span><span style="color:#ABB2BF;">(dl_rated_group, mons)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br></div></div><p>ä¸ºäº†è¿›ä¸€æ­¥è®©å›½ä¼çš„æœ‹å‹éƒ½èƒ½ä½¿ç”¨è¿™æ®µç¨‹åºï¼Œæˆ‘ç”¨ pyinstaller å¯¹ç¨‹åºæ‰“åŒ…æˆäº† EXE è½¯ä»¶ï¼Œæœ‹å‹å°±åƒä½¿ç”¨å¾®ä¿¡ QQ ä¸€æ ·ä½¿ç”¨è¿™æ®µä»£ç ï¼Œä¸åœ¨éœ€è¦æ­å»º python ç¯å¢ƒ</p><p><img src="/ProgramLearnNotes/assets/image-20240511170851523.DM6Vs2dZ.png" alt="image-20240511170851523"></p><p>è¿™ä¸ªè½¯ä»¶çš„æ“ä½œéå¸¸ç®€å•ã€‚åªéœ€è¦å°†æœ¬å­£åº¦çš„æ‰€æœ‰è¯„åˆ†è¡¨æ ¼å¯¼å…¥åˆ°è½¯ä»¶ä¸­ï¼Œå®ƒå°±èƒ½è‡ªåŠ¨è¯†åˆ«è¡¨æ ¼ä¸­çš„æ•°æ®ï¼Œå¹¶æŒ‰ç…§å‘˜å·¥å§“åè¿›è¡Œæ±‡æ€»å½¢æˆæ±‡æ€»è¡¨ã€‚è½¯ä»¶ä¼šè‡ªåŠ¨è®¡ç®—æ¯ä¸ªå‘˜å·¥çš„æ€»åˆ†ï¼Œå¹¶è®¡ç®—å‡ºå¹³å‡å€¼ã€‚ä¸€åˆ†é’Ÿçš„æ—¶é—´ï¼Œè½¯ä»¶å°±èƒ½ç”Ÿæˆä¸€ä¸ªåŒ…å«æ¯ä¸ªå‘˜å·¥å¹³å‡åˆ†çš„æ±‡æ€»è¡¨ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511170909563.BcgY1Vfb.png" alt="image-20240511170909563"></p><p>è‡ªä»ä½¿ç”¨äº†è¿™ä¸ªè‡ªåŠ¨åŒ–æ±‡æ€»è½¯ä»¶åï¼Œæœ‹å‹çš„å·¥ä½œæ•ˆç‡å¾—åˆ°äº†æå¤§çš„æå‡ã€‚åŸæœ¬éœ€è¦æ•´ä¸ªéƒ¨é—¨ä¸€å‘¨æ—¶é—´æ‰èƒ½å®Œæˆçš„å·¥ä½œï¼Œç°åœ¨åªéœ€è¦å‡ åˆ†é’Ÿå°±èƒ½è½»æ¾æå®šã€‚è¿™ä¸ä»…å¤§å¤§å‡è½»äº†æˆ‘ä»¬çš„å·¥ä½œè´Ÿæ‹…ï¼Œè¿˜æé«˜äº†æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p><h2 id="å‡ è¡Œä»£ç å®ç°æ–‡ä»¶è‡ªåŠ¨åˆ†ç±»-å‘Šåˆ«æ··ä¹±æ–‡ä»¶å¤¹" tabindex="-1">å‡ è¡Œä»£ç å®ç°æ–‡ä»¶è‡ªåŠ¨åˆ†ç±»ï¼Œå‘Šåˆ«æ··ä¹±æ–‡ä»¶å¤¹ <a class="header-anchor" href="#å‡ è¡Œä»£ç å®ç°æ–‡ä»¶è‡ªåŠ¨åˆ†ç±»-å‘Šåˆ«æ··ä¹±æ–‡ä»¶å¤¹" aria-label="Permalink to &quot;å‡ è¡Œä»£ç å®ç°æ–‡ä»¶è‡ªåŠ¨åˆ†ç±»ï¼Œå‘Šåˆ«æ··ä¹±æ–‡ä»¶å¤¹&quot;">â€‹</a></h2><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šå¤§é‡çš„æ–‡ä»¶è¢«éšæ„å­˜æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œå¯¼è‡´æ–‡ä»¶æŸ¥æ‰¾å˜å¾—å¼‚å¸¸å›°éš¾ï¼Œç”šè‡³éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´å»æ‰‹åŠ¨æ•´ç†ã€‚è¿™ç§æ··ä¹±çš„æ–‡ä»¶å¤¹ç®¡ç†æ–¹å¼ä¸ä»…å½±å“äº†å·¥ä½œæ•ˆç‡ï¼Œä¹Ÿå¢åŠ äº†å‡ºé”™çš„å¯èƒ½æ€§ã€‚</p><p>ä¸è¿‡ï¼Œç°åœ¨æœ‰äº† Python è¿™ä¸ªå¼ºå¤§çš„è‡ªåŠ¨åŒ–åŠå…¬å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é€šè¿‡ç¼–å†™ç®€å•çš„ Python è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ–‡ä»¶ç±»å‹è‡ªåŠ¨å°†æ–‡ä»¶åˆ†ç±»ï¼Œè®©æ–‡ä»¶å¤¹å˜å¾—äº•äº•æœ‰æ¡ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> shutil</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> classify_files</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">directory</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">destination_directory</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">config</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    å°†ç›®å½•ä¸‹çš„æ–‡ä»¶æŒ‰ç…§é…ç½®ä¸­çš„åç¼€åˆ†ç±»åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">    Args:</span></span>
<span class="line"><span style="color:#98C379;">    - directory: è¦åˆ†ç±»çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#98C379;">    - destination_directory: åˆ†ç±»åæ–‡ä»¶å¤¹çš„ç›®æ ‡è·¯å¾„</span></span>
<span class="line"><span style="color:#98C379;">    - config: åŒ…å«åç¼€ã€ç›®æ ‡æ–‡ä»¶å¤¹å’Œæ“ä½œæ ‡è¯†çš„å…ƒç»„çš„é…ç½®åˆ—è¡¨</span></span>
<span class="line"><span style="color:#98C379;">              æ ¼å¼ä¸º [(&#39;åç¼€1&#39;, &#39;ç›®æ ‡æ–‡ä»¶å¤¹1&#39;, &#39;ç§»åŠ¨/å¤åˆ¶&#39;), (&#39;åç¼€2&#39;, &#39;ç›®æ ‡æ–‡ä»¶å¤¹2&#39;, &#39;ç§»åŠ¨/å¤åˆ¶&#39;), ...]</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> root, dirs, files </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> os.</span><span style="color:#61AFEF;">walk</span><span style="color:#ABB2BF;">(directory):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#E06C75;"> file</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> files:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">            file_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(root, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # è·å–æ–‡ä»¶åç¼€</span></span>
<span class="line"><span style="color:#ABB2BF;">            _, extension </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">splitext</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            extension </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> extension.</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># ç»Ÿä¸€è½¬æ¢ä¸ºå°å†™</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # åœ¨é…ç½®åˆ—è¡¨ä¸­æŸ¥æ‰¾åç¼€å¯¹åº”çš„é…ç½®é¡¹</span></span>
<span class="line"><span style="color:#C678DD;">            for</span><span style="color:#ABB2BF;"> ext, dest, action </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> config:</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> extension </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> ext:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    destination_folder </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(destination_directory, dest)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # å¦‚æœç›®æ ‡æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒ</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(destination_folder):</span></span>
<span class="line"><span style="color:#ABB2BF;">                        os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(destination_folder)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                    # æ‰§è¡Œç§»åŠ¨æˆ–å¤åˆ¶æ“ä½œ</span></span>
<span class="line"><span style="color:#C678DD;">                    if</span><span style="color:#ABB2BF;"> action </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;ç§»åŠ¨&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        shutil.</span><span style="color:#61AFEF;">move</span><span style="color:#ABB2BF;">(file_path, destination_folder)</span></span>
<span class="line"><span style="color:#C678DD;">                    elif</span><span style="color:#ABB2BF;"> action </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39;å¤åˆ¶&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        shutil.</span><span style="color:#61AFEF;">copy</span><span style="color:#ABB2BF;">(file_path, destination_folder)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> __name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é…ç½®æ–‡ä»¶åç¼€ã€ç›®æ ‡æ–‡ä»¶å¤¹å’Œæ“ä½œæ ‡è¯†çš„å…ƒç»„åˆ—è¡¨</span></span>
<span class="line"><span style="color:#ABB2BF;">    file_extension_config </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#98C379;">&#39;.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;TextFiles&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ç§»åŠ¨&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#98C379;">&#39;.jpg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ImageFiles&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;å¤åˆ¶&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#98C379;">&#39;.png&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ImageFiles&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;å¤åˆ¶&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#98C379;">&#39;.jpeg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ImageFiles&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ç§»åŠ¨&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#98C379;">&#39;.mp3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;AudioFiles&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;ç§»åŠ¨&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#98C379;">&#39;.mp4&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;AudioFiles&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;å¤åˆ¶&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        # å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•æ›´å¤šçš„åç¼€ã€ç›®æ ‡æ–‡ä»¶å¤¹å’Œæ“ä½œæ ‡è¯†çš„å…ƒç»„</span></span>
<span class="line"><span style="color:#ABB2BF;">    ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è¦åˆ†ç±»çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">    source_directory </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;D:</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">AI</span><span style="color:#56B6C2;">\\</span><span style="color:#98C379;">massdir&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # åˆ†ç±»åæ–‡ä»¶å¤¹çš„ç›®æ ‡è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">    destination_directory </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;./path/classify&quot;</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#C678DD;"> not</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(destination_directory):</span></span>
<span class="line"><span style="color:#ABB2BF;">        os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(destination_directory)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # è°ƒç”¨åˆ†ç±»å‡½æ•°</span></span>
<span class="line"><span style="color:#61AFEF;">    classify_files</span><span style="color:#ABB2BF;">(source_directory, destination_directory, file_extension_config)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p>ä»£ç è¿è¡Œæ•ˆæœ</p><p>æ•´ç†å‰</p><p><img src="/ProgramLearnNotes/assets/image-20240511171006983.CPDJudln.png" alt="image-20240511171006983"></p><p>æ•´ç†å</p><p><img src="/ProgramLearnNotes/assets/image-20240511171027590.BsnOGuge.png" alt="image-20240511171027590"></p><p><img src="/ProgramLearnNotes/assets/image-20240511171058971.6__fQTWD.png" alt="image-20240511171058971"></p><p>å½“ç„¶ï¼Œè¿™ä¸ªè„šæœ¬åªæ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œçµæ´»é…ç½®ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šçš„æ–‡ä»¶ç±»å‹ï¼Œæˆ–è€…å°†æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡æ–‡ä»¶å¤¹è€Œä¸æ˜¯å¤åˆ¶ã€‚æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥è€ƒè™‘æ·»åŠ ä¸€äº›é”™è¯¯å¤„ç†çš„é€»è¾‘ï¼Œä»¥å¤„ç†å¯èƒ½å‡ºç°çš„å¼‚å¸¸æƒ…å†µã€‚</p><p>æ€»ä¹‹ï¼Œé€šè¿‡ Python è‡ªåŠ¨åŒ–åŠå…¬ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°æ–‡ä»¶è‡ªåŠ¨åˆ†ç±»ï¼Œè®©å·¥ä½œå˜å¾—æ›´åŠ é«˜æ•ˆå’Œæœ‰åºã€‚åªéœ€è¦å‡ è¡Œç®€å•çš„ä»£ç ï¼Œå°±èƒ½å‘Šåˆ«æ··ä¹±çš„æ–‡ä»¶å¤¹ï¼Œäº«å—æ›´åŠ æ„‰å¿«çš„åŠå…¬ä½“éªŒï¼</p><h2 id="ä¸€é”®è§£å†³å·¥èµ„æ¡å‘æ”¾å¤§éš¾é¢˜" tabindex="-1">ä¸€é”®è§£å†³å·¥èµ„æ¡å‘æ”¾å¤§éš¾é¢˜ <a class="header-anchor" href="#ä¸€é”®è§£å†³å·¥èµ„æ¡å‘æ”¾å¤§éš¾é¢˜" aria-label="Permalink to &quot;ä¸€é”®è§£å†³å·¥èµ„æ¡å‘æ”¾å¤§éš¾é¢˜&quot;">â€‹</a></h2><h3 id="åŠå…¬éœ€æ±‚" tabindex="-1">åŠå…¬éœ€æ±‚ <a class="header-anchor" href="#åŠå…¬éœ€æ±‚" aria-label="Permalink to &quot;åŠå…¬éœ€æ±‚&quot;">â€‹</a></h3><p>æˆ‘æœ‰ä¸€ä¸ªå¥½æœ‹å‹ï¼Œåœ¨ä¸€å®¶å›½ä¼çš„åˆ†å…¬å¸æ‹…ä»»äººäº‹ä¸€èŒã€‚æ¯ä¸ªæœˆï¼Œæ€»å…¬å¸çš„äººäº‹éƒ½ä¼šå°†åˆ†å…¬å¸äººå‘˜çš„å·¥èµ„è¡¨æ ¼é€šè¿‡å¾®ä¿¡æˆªå›¾çš„å½¢å¼å‘ç»™å¥¹ã€‚å¥¹éœ€è¦ä¸€å¼ å¼ æ‰“å¼€å›¾ç‰‡ï¼Œå¯¹ç…§ç€å†…å®¹æ‰‹åŠ¨è¾“å…¥åˆ° Excel è¡¨æ ¼ä¸­ï¼Œç„¶åå†å°†è¿™äº›æ•°æ®åˆ¶ä½œæˆå·¥èµ„æ¡ï¼Œé€šè¿‡é‚®ä»¶å‘é€ç»™ç›¸å…³äººå‘˜ã€‚æ•´ä¸ªè¿‡ç¨‹ç¹çè‡³æï¼Œæ¯ä¸ªæœˆéƒ½éœ€è¦è€—è´¹ä¸¤å¤©çš„æ—¶é—´æ‰èƒ½å®Œæˆã€‚å¯¹äºé¢†å¯¼ä»¥æˆªå›¾å½¢å¼å‘é€çš„æ–¹å¼ä¹Ÿæ˜¯æ•¢æ€’ä¸æ•¢è¨€ã€‚</p><h3 id="ç—›ç‚¹åˆ†æ-2" tabindex="-1"><strong>ç—›ç‚¹åˆ†æï¼š</strong> <a class="header-anchor" href="#ç—›ç‚¹åˆ†æ-2" aria-label="Permalink to &quot;**ç—›ç‚¹åˆ†æï¼š**&quot;">â€‹</a></h3><p><strong>æ•ˆç‡ä½ä¸‹</strong>ï¼šæ‰‹åŠ¨è¾“å…¥å’Œåˆ¶ä½œå·¥èµ„æ¡çš„è¿‡ç¨‹è€—æ—¶è€—åŠ›ï¼Œæ•ˆç‡ä½ä¸‹ã€‚</p><p><strong>å®¹æ˜“å‡ºé”™</strong>ï¼šç”±äºæ‰‹åŠ¨æ“ä½œï¼Œéš¾å…ä¼šå‡ºç°è¾“å…¥é”™è¯¯æˆ–é—æ¼çš„æƒ…å†µã€‚</p><p><strong>å·¥ä½œé‡å¤§</strong>ï¼šéšç€å…¬å¸äººå‘˜çš„å¢åŠ ï¼Œå·¥èµ„æ¡çš„æ•°é‡ä¹Ÿåœ¨ä¸æ–­å¢åŠ ï¼Œå·¥ä½œè´Ÿæ‹…è¶Šæ¥è¶Šé‡ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-2" tabindex="-1">è§£å†³æ–¹æ¡ˆï¼š <a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-2" aria-label="Permalink to &quot;è§£å†³æ–¹æ¡ˆï¼š&quot;">â€‹</a></h3><p>é’ˆå¯¹ä»¥ä¸Šç—›ç‚¹ï¼Œæˆ‘åˆ©ç”¨ Python è‡ªåŠ¨åŒ–åŠå…¬æŠ€æœ¯ï¼Œä¸ºæœ‹å‹é‡èº«å®šåˆ¶äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚</p><h4 id="ç¬¬ä¸€æ­¥-ocr-ç®—æ³•è‡ªåŠ¨æå–å·¥èµ„è¡¨æ ¼" tabindex="-1">ç¬¬ä¸€æ­¥ï¼šOCR ç®—æ³•è‡ªåŠ¨æå–å·¥èµ„è¡¨æ ¼ <a class="header-anchor" href="#ç¬¬ä¸€æ­¥-ocr-ç®—æ³•è‡ªåŠ¨æå–å·¥èµ„è¡¨æ ¼" aria-label="Permalink to &quot;ç¬¬ä¸€æ­¥ï¼šOCR ç®—æ³•è‡ªåŠ¨æå–å·¥èµ„è¡¨æ ¼&quot;">â€‹</a></h4><p>åˆ©ç”¨ OCRï¼ˆå…‰å­¦å­—ç¬¦è¯†åˆ«ï¼‰ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†å¾®ä¿¡æˆªå›¾ä¸­çš„å·¥èµ„è¡¨æ ¼è‡ªåŠ¨æå–åˆ° Excel ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹åªéœ€è¦å°†å›¾ç‰‡å¤åˆ¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œç¨‹åºä¼šè‡ªåŠ¨è¯†åˆ«å¹¶è½¬æ¢ã€‚</p><p>python ä»£ç </p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#D19A66;"> PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pytesseract</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Workbook</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> load_image</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">image_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(image_path)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> image</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> convert_to_grayscale</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">image</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> image.</span><span style="color:#61AFEF;">convert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;L&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> extract_text</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">image</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> pytesseract.</span><span style="color:#61AFEF;">image_to_string</span><span style="color:#ABB2BF;">(image)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> extract_table_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">text</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    rows </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> text.</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    table_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [row.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\t</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> rows]</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> table_data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> save_as_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">table_data</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">output_path</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    workbook </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Workbook</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    sheet </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> workbook.active</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> row_index, row_data </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(table_data, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#C678DD;">        for</span><span style="color:#ABB2BF;"> column_index, cell_data </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> enumerate</span><span style="color:#ABB2BF;">(row_data, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            sheet.</span><span style="color:#61AFEF;">cell</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">row</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">row_index, </span><span style="color:#E06C75;font-style:italic;">column</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">column_index, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">cell_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    workbook.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(output_path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#ABB2BF;">image_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;table_image.jpg&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">output_path </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;table_data.xlsx&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">image </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_image</span><span style="color:#ABB2BF;">(image_path)</span></span>
<span class="line"><span style="color:#ABB2BF;">grayscale_image </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> convert_to_grayscale</span><span style="color:#ABB2BF;">(image)</span></span>
<span class="line"><span style="color:#ABB2BF;">text </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> extract_text</span><span style="color:#ABB2BF;">(grayscale_image)</span></span>
<span class="line"><span style="color:#ABB2BF;">table_data </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> extract_table_data</span><span style="color:#ABB2BF;">(text)</span></span>
<span class="line"><span style="color:#61AFEF;">save_as_excel</span><span style="color:#ABB2BF;">(table_data, output_path)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240513165835111.C91oHjlE.png" alt="image-20240513165835111"></p><p>å¯ä»¥çœ‹åˆ°ç”¨è¿™ç§æ–¹å¼æå–åˆ°çš„ä¿¡æ¯ä¸ä»…æ²¡æœ‰é”™è¯¯ï¼Œè€Œä¸”è¿˜å®Œç¾çš„ä¿æŒäº†è¡¨æ ¼çš„ç»“æ„</p><p>æ€»ä¹‹ï¼ŒPython è‡ªåŠ¨åŒ–å·¥å…·ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§é«˜æ•ˆã€ç²¾å‡†çš„æ–¹æ³•ï¼Œå¯ä»¥ä¸€é”®æå–å›¾ç‰‡ä¸­çš„è¡¨æ ¼æ•°æ®ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå¯ç¼–è¾‘çš„ Excel æ ¼å¼ã€‚å®ƒä¸ä»…å¯ä»¥è§£å†³æˆ‘ä»¬æ‰‹åŠ¨è¾“å…¥è¡¨æ ¼æ•°æ®çš„ç¹çé—®é¢˜ï¼Œè¿˜å¯ä»¥ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚</p><h4 id="ç¬¬äºŒæ­¥-è‡ªåŠ¨åˆ¶ä½œå·¥èµ„æ¡" tabindex="-1">ç¬¬äºŒæ­¥ï¼šè‡ªåŠ¨åˆ¶ä½œå·¥èµ„æ¡ <a class="header-anchor" href="#ç¬¬äºŒæ­¥-è‡ªåŠ¨åˆ¶ä½œå·¥èµ„æ¡" aria-label="Permalink to &quot;ç¬¬äºŒæ­¥ï¼šè‡ªåŠ¨åˆ¶ä½œå·¥èµ„æ¡&quot;">â€‹</a></h4><p>åœ¨æˆåŠŸå°†å·¥èµ„è¡¨æ ¼å¯¼å…¥ Excel åï¼Œç¨‹åºä¼šè‡ªåŠ¨æ ¹æ®é¢„è®¾çš„æ ¼å¼å°†è¡¨æ ¼è½¬æ¢æˆå·¥èµ„æ¡å½¢å¼ã€‚è¿™æ ·ï¼ŒåŸæœ¬éœ€è¦æ‰‹åŠ¨ä¸€æ¡ä¸€æ¡å¤åˆ¶ç²˜è´´çš„å·¥ä½œï¼Œç°åœ¨åªéœ€ä¸€ç§’é’Ÿå°±èƒ½å®Œæˆã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240513165911570.CwiHwpBD.png" alt="image-20240513165911570"></p><p><strong>python ä»£ç </strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥Excelå†™å…¥åº“</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Workbook</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">df </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">read_excel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;employee_data.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(df)</span></span>
<span class="line"><span style="color:#ABB2BF;">os.</span><span style="color:#61AFEF;">makedirs</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·¥èµ„æ¡&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">exist_ok</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> i,row </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> df.</span><span style="color:#61AFEF;">iterrows</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Workbook</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">list</span><span style="color:#ABB2BF;">(df.columns))</span></span>
<span class="line"><span style="color:#ABB2BF;">    ws.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">list</span><span style="color:#ABB2BF;">(row))</span></span>
<span class="line"><span style="color:#ABB2BF;">    file_name </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&quot;./å·¥èµ„æ¡/</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">row[</span><span style="color:#98C379;">&#39;å§“å&#39;</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">_å·¥èµ„æ¡.xlsx&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    wb.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">filename</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">file_name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å·¥èµ„æ¡ç”Ÿæˆå®Œæ¯•&quot;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240513165937452.u00aKSSR.png" alt="image-20240513165937452"></p><p><img src="/ProgramLearnNotes/assets/image-20240513165947756.CFnovzVl.png" alt="image-20240513165947756"></p><h4 id="ç¬¬ä¸‰æ­¥-æ ¹æ®äººåè‡ªåŠ¨å‘é€é‚®ä»¶" tabindex="-1">ç¬¬ä¸‰æ­¥ï¼šæ ¹æ®äººåè‡ªåŠ¨å‘é€é‚®ä»¶ <a class="header-anchor" href="#ç¬¬ä¸‰æ­¥-æ ¹æ®äººåè‡ªåŠ¨å‘é€é‚®ä»¶" aria-label="Permalink to &quot;ç¬¬ä¸‰æ­¥ï¼šæ ¹æ®äººåè‡ªåŠ¨å‘é€é‚®ä»¶&quot;">â€‹</a></h4><p>æœ€åï¼Œç¨‹åºä¼šæ ¹æ®å·¥èµ„è¡¨ä¸­çš„å‘˜å·¥å§“åå’Œé‚®ç®±ä¿¡æ¯ï¼Œè‡ªåŠ¨å°†å·¥èµ„æ¡ä»¥é‚®ä»¶çš„å½¢å¼å‘é€ç»™å¯¹åº”çš„äººå‘˜ã€‚è¿™æ ·ï¼Œä¸ä»…çœå»äº†æ‰‹åŠ¨å‘é€é‚®ä»¶çš„ç¹çè¿‡ç¨‹ï¼Œè¿˜èƒ½ç¡®ä¿å·¥èµ„æ¡å‡†ç¡®æ— è¯¯åœ°å‘é€åˆ°æ¯ä¸ªå‘˜å·¥çš„é‚®ç®±ä¸­ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> smtplib</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># å¤„ç†é‚®ä»¶å†…å®¹çš„åº“ï¼Œemail.mine</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.text </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEText</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> email.mime.application </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> MIMEApplication</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logging</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">logging.</span><span style="color:#61AFEF;">basicConfig</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">filename</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;E:\code\Plan_m\log.log&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">level</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">logging.</span><span style="color:#D19A66;">INFO</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;font-style:italic;">filemode</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;a&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">format</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;ã€</span><span style="color:#D19A66;">%(asctime)s</span><span style="color:#98C379;">ã€‘ ã€</span><span style="color:#D19A66;">%(levelname)s</span><span style="color:#98C379;">ã€‘ &gt;&gt;&gt;  </span><span style="color:#D19A66;">%(message)s</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">datefmt</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># é‚®ç®±å±æ€§é…ç½®</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#61AFEF;"> send_email</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">text_msg</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é‚®ç®±æœåŠ¡ç«¯</span></span>
<span class="line"><span style="color:#ABB2BF;">    mailserver </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;smtp.163.com&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å‘ä»¶äºº-å¡«å†™è‡ªå·±çš„é‚®ç®±</span></span>
<span class="line"><span style="color:#ABB2BF;">    userName_SendMail </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;zdy15921159716@163.com&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # é‚®ç®±å‘ä»¶æˆæƒç -ä¸ºå‘ä»¶äººç”Ÿæˆçš„æˆæƒç ï¼Œè¯¦è§ä¸‹æ–‡</span></span>
<span class="line"><span style="color:#ABB2BF;">    userName_AuthCode </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;BOEFGGZHRAHEXGRN&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å®šä¹‰é‚®ä»¶çš„æ¥æ”¶è€…-æˆ‘éšä¾¿å†™çš„ï¼Œè‹¥æ”¶ä»¶äººè¾ƒå¤šï¼Œå¯ç”¨åˆ—è¡¨è¡¨ç¤º</span></span>
<span class="line"><span style="color:#ABB2BF;">    per_email </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> email_dict.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(text_msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å§“å&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;None&quot;</span><span style="color:#ABB2BF;">),</span><span style="color:#98C379;">&quot;None&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> text_msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å§“å&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;None&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(per_email)</span></span>
<span class="line"><span style="color:#ABB2BF;">    received_mail </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&#39;young@example.com&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#7F848E;font-style:italic;"># åŠ å…¥ç¥–æ€» åˆ˜æ€» å¼ æ€»é‚®ç®±</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # final_received_mail = received_mail+per_email</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # print(final_received_mail)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å‘é€ä¸€å°ç®€å•çš„é‚®ä»¶ï¼Œå¤„ç†é‚®ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">    content </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;æœ¬æœˆå·¥èµ„æ¡è¯·æŸ¥æ”¶&#39;</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(content)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # çº¯æ–‡æœ¬å½¢å¼çš„é‚®ä»¶å†…å®¹çš„å®šä¹‰ï¼Œé€šè¿‡MIMETextè¿›è¡Œæ“ä½œï¼Œplainä¸ºé»˜è®¤çš„æ–‡æœ¬çš„å±•ç¤ºå½¢å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">    email </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MIMEMultipart</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    email[</span><span style="color:#98C379;">&#39;Subject&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;å·¥èµ„æ¡&#39;</span><span style="color:#7F848E;font-style:italic;">  # å®šä¹‰é‚®ä»¶ä¸»é¢˜</span></span>
<span class="line"><span style="color:#ABB2BF;">    email[</span><span style="color:#98C379;">&#39;From&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;äººäº‹éƒ¨&quot;</span><span style="color:#7F848E;font-style:italic;">  # å‘ä»¶äºº</span></span>
<span class="line"><span style="color:#ABB2BF;">    email[</span><span style="color:#98C379;">&#39;To&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;,&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(received_mail)  </span><span style="color:#7F848E;font-style:italic;"># æ”¶ä»¶äººï¼ˆå¯ä»¥æ·»åŠ å¤šä¸ªï¼Œè‹¥åªæœ‰ä¸€ä¸ªæ”¶ä»¶äººï¼Œå¯ç›´æ¥å†™é‚®ç®±å·ï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;">    filename </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">name</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">_å·¥èµ„æ¡.xlsx&#39;</span></span>
<span class="line"><span style="color:#C678DD;">    with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(filename, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> attachment:</span></span>
<span class="line"><span style="color:#ABB2BF;">        part </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> MIMEApplication</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        attachment.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(),</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">        Name</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">filename</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"><span style="color:#ABB2BF;">      part[</span><span style="color:#98C379;">&#39;Content-Disposition&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> f</span><span style="color:#98C379;">&#39;attachment; filename=&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">filename</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">      email.</span><span style="color:#61AFEF;">attach</span><span style="color:#ABB2BF;">(part)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # å‘é€é‚®ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # QQé‚®ç®±çš„ç«¯å£å·æ˜¯465ï¼Œå…¶ä»–é‚®ç®±çš„ç«¯å£å·å¯è‡ªè¡Œç™¾åº¦ï¼ŒéQQé‚®ç®±ï¼Œä¸€èˆ¬ä½¿ç”¨SMTPå³å¯ï¼Œä¸éœ€è¦æœ‰SSL</span></span>
<span class="line"><span style="color:#ABB2BF;">    smtp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> smtplib.</span><span style="color:#61AFEF;">SMTP_SSL</span><span style="color:#ABB2BF;">(mailserver, </span><span style="color:#E06C75;font-style:italic;">port</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">465</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    smtp.</span><span style="color:#61AFEF;">login</span><span style="color:#ABB2BF;">(userName_SendMail, userName_AuthCode)</span></span>
<span class="line"><span style="color:#ABB2BF;">    smtp.</span><span style="color:#61AFEF;">sendmail</span><span style="color:#ABB2BF;">(userName_SendMail, </span><span style="color:#98C379;">&#39;,&#39;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(received_mail), email.</span><span style="color:#61AFEF;">as_string</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    smtp.</span><span style="color:#61AFEF;">quit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    logging.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;æ­å–œï¼Œé‚®ä»¶å‘é€æˆåŠŸäº†&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># data = pd.read_excel(&quot;E:\Plan_m\æ‰¹é‡æ ·å“è·Ÿè¿›è®¡åˆ’è¡¨.xlsx&quot;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># # data[&#39;ä¸‹å•æ—¶é—´&#39;] = pd.to_datetime(data[&#39;ä¸‹å•æ—¶é—´&#39;])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>163 é‚®ç®±å®‰å…¨ç è®¾ç½®ã€python ä»£ç ä¸­çš„å¯†ç ä½¿ç”¨è¿™ä¸ªè€Œä¸æ˜¯é‚®ç®±å¯†ç ã€‘</p><p><img src="/ProgramLearnNotes/assets/image-20240513170027955.BkvG2vy7.png" alt="image-20240513170027955"></p><p><img src="/ProgramLearnNotes/assets/image-20240513170050286.B8E36ha9.png" alt="image-20240513170050286"></p><p><img src="/ProgramLearnNotes/assets/image-20240513170059555.Tvp16Dvk.png" alt="image-20240513170059555"></p><h3 id="æ•ˆæœå±•ç¤º-2" tabindex="-1">æ•ˆæœå±•ç¤ºï¼š <a class="header-anchor" href="#æ•ˆæœå±•ç¤º-2" aria-label="Permalink to &quot;æ•ˆæœå±•ç¤ºï¼š&quot;">â€‹</a></h3><p>ç»è¿‡å®æ–½è¿™ä¸ªè§£å†³æ–¹æ¡ˆåï¼Œæœ‹å‹çš„å·¥ä½œè´Ÿæ‹…å¾—åˆ°äº†æå¤§çš„å‡è½»ã€‚ç°åœ¨ï¼Œå¥¹æ¯ä¸ªæœˆåªéœ€èŠ±è´¹ä¸€ç§’é’Ÿçš„æ—¶é—´å°†å›¾ç‰‡å¤åˆ¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸­ï¼Œå‰©ä¸‹çš„å·¥ä½œå°±å…¨éƒ¨äº¤ç»™äº† Python è‡ªåŠ¨åŒ–åŠå…¬ç¥å™¨ã€‚è€Œä¸”ï¼Œç”±äºç¨‹åºçš„é«˜åº¦è‡ªåŠ¨åŒ–å’Œå‡†ç¡®æ€§ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒå‡ºç°é”™è¯¯æˆ–é—æ¼çš„æƒ…å†µäº†ã€‚</p><h2 id="åŸºäº-excel-æ„å»ºå…¨æ–¹ä½é”€å”®ç®¡ç†ç³»ç»Ÿ" tabindex="-1">åŸºäº Excel æ„å»ºå…¨æ–¹ä½é”€å”®ç®¡ç†ç³»ç»Ÿ <a class="header-anchor" href="#åŸºäº-excel-æ„å»ºå…¨æ–¹ä½é”€å”®ç®¡ç†ç³»ç»Ÿ" aria-label="Permalink to &quot;åŸºäº Excel æ„å»ºå…¨æ–¹ä½é”€å”®ç®¡ç†ç³»ç»Ÿ&quot;">â€‹</a></h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://pan.baidu.com/s/1_gahdoDJjFQEyKc65O0_rA?pwd=1dlk" target="_blank" rel="noreferrer">é”€å”®ç®¡ç†ç³»ç»Ÿ.xlsx_å…è´¹é«˜é€Ÿä¸‹è½½|ç™¾åº¦ç½‘ç›˜-åˆ†äº«æ— é™åˆ¶ (baidu.com)</a></p><p>åœ¨å½“ä»Šæ•°å­—åŒ–æ—¶ä»£ï¼Œæœ‰æ•ˆçš„é”€å”®ç®¡ç†å¯¹äºä¼ä¸šçš„å‘å±•è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œå¯¹äºè®¸å¤šä¸­å°å‹ä¼ä¸šæ¥è¯´ï¼Œèµ„é‡‘å’ŒæŠ€æœ¯ä¸Šçš„é™åˆ¶ä½¿å¾—ä»–ä»¬æ— æ³•æ‰¿æ‹…æ˜‚è´µçš„ä¼ä¸šèµ„æºè§„åˆ’ï¼ˆERPï¼‰ç³»ç»Ÿã€‚åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼Œåˆ©ç”¨ Excel æ„å»ºä¸€å¥—å…¨é¢è€Œå®ç”¨çš„é”€å”®ç®¡ç†ç³»ç»Ÿï¼Œæˆä¸ºäº†ä¸­å°å‹ä¼ä¸šå®ç°æ•°å­—åŒ–é”€å”®ç®¡ç†çš„é«˜æ•ˆé€”å¾„ã€‚</p><p>è¿‘æœŸï¼Œæˆ‘èŠ±è´¹ä¸€å‘¨çš„æ—¶é—´ï¼ŒåŸºäº Excel ä¸ºä¸€å®¶ä¸­å°å‹ä¼ä¸šæ‰“é€ äº†ä¸€ä¸ªé”€å”®ç®¡ç†ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿæ¶µç›–äº†å®¢æˆ·ã€äº§å“ã€å‘˜å·¥ã€é”€å”®ä»·ç›®è¡¨ã€è¥é”€ã€é”€å”®æŠ¥ä»·ã€å¼€ç¥¨ç”³è¯·ã€åˆåŒã€è®¢å•æ˜ç»†ã€å‡ºåº“æ˜ç»†ã€æ”¶æ¬¾æ˜ç»†ã€å‘ç¥¨æ˜ç»†ä»¥åŠå„ç±»æŠ¥è¡¨ç­‰å¤šä¸ªæ¨¡å—ï¼Œå®ç°äº†é”€å”®ç®¡ç†æµç¨‹çš„æ•°å­—åŒ–å’Œè‡ªåŠ¨åŒ–ã€‚</p><h3 id="ä¸€ã€ç³»ç»Ÿæ¶æ„è®¾è®¡" tabindex="-1">ä¸€ã€ç³»ç»Ÿæ¶æ„è®¾è®¡ <a class="header-anchor" href="#ä¸€ã€ç³»ç»Ÿæ¶æ„è®¾è®¡" aria-label="Permalink to &quot;ä¸€ã€ç³»ç»Ÿæ¶æ„è®¾è®¡&quot;">â€‹</a></h3><p>è¯¥ç³»ç»Ÿåˆ©ç”¨ Excel çš„è¡¨æ ¼ã€å‡½æ•°ã€å›¾è¡¨ç­‰åŠŸèƒ½ï¼Œæ„å»ºäº†ä¸€ä¸ªé›†æ•°æ®ç®¡ç†ã€æŸ¥è¯¢ã€åˆ†æå’ŒæŠ¥å‘Šäºä¸€ä½“çš„é”€å”®ç®¡ç†å¹³å°ã€‚é€šè¿‡ç®€å•çš„æ“ä½œï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å½•å…¥ã€æŸ¥è¯¢å’Œä¿®æ”¹é”€å”®æ•°æ®ï¼Œå®ç°é”€å”®æµç¨‹çš„å…¨ç¨‹è·Ÿè¸ªå’Œç®¡ç†ã€‚</p><p>é€šè¿‡å¯¹é”€å”®ç®¡ç†çš„å„ä¸ªæ¨¡å—è¿›è¡Œæ¢³ç†ï¼Œç¡®å®šç³»ç»Ÿçš„åŸºæœ¬æ¶æ„ã€‚åœ¨æœ¬ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼šå®¢æˆ·ç®¡ç†ã€äº§å“ç®¡ç†ã€å‘˜å·¥ç®¡ç†ã€è¥é”€ç®¡ç†ã€åˆåŒç®¡ç†ã€è®¢å•ç®¡ç†ä»¥åŠæŠ¥è¡¨ç®¡ç†ã€‚æ¯ä¸ªæ¨¡å—éƒ½å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ª Excel å·¥ä½œè¡¨ï¼Œé€šè¿‡æ•°æ®é“¾æ¥å’Œå…¬å¼å®ç°æ•°æ®çš„äº’é€šå’Œè®¡ç®—ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171206902.DOFfwJIy.png" alt="image-20240511171206902"></p><p><img src="/ProgramLearnNotes/assets/image-20240511171216652.72U5w0iG.png" alt="image-20240511171216652"></p><h3 id="äºŒã€æ¨¡å—åŠŸèƒ½å®ç°" tabindex="-1">äºŒã€æ¨¡å—åŠŸèƒ½å®ç° <a class="header-anchor" href="#äºŒã€æ¨¡å—åŠŸèƒ½å®ç°" aria-label="Permalink to &quot;äºŒã€æ¨¡å—åŠŸèƒ½å®ç°&quot;">â€‹</a></h3><p><strong>æ¶µç›–åŸºæœ¬ä¿¡æ¯æ¨¡å—ã€è¥é”€æ¨¡å—ã€è®¢å•ç®¡ç†ã€æŠ¥è¡¨ç®¡ç†å’Œç³»ç»Ÿä¿¡æ¯</strong></p><p><img src="/ProgramLearnNotes/assets/image-20240511171352762.BCEmnitg.png" alt="image-20240511171352762"></p><p><strong>å®¢æˆ·ç®¡ç†</strong>ï¼šåœ¨å®¢æˆ·ç®¡ç†æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®°å½•å®¢æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€äº¤æ˜“å†å²ã€ä¿¡ç”¨è¯„çº§ç­‰å†…å®¹ã€‚é€šè¿‡è®¾ç½®ç­›é€‰å’Œæ’åºåŠŸèƒ½ï¼Œé”€å”®äººå‘˜å¯ä»¥è¿…é€Ÿå®šä½ç›®æ ‡å®¢æˆ·ï¼Œæé«˜é”€å”®æ•ˆç‡ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171410934.BMd8dS0_.png" alt="image-20240511171410934"></p><p><strong>äº§å“ç®¡ç†</strong>ï¼šäº§å“ç®¡ç†æ¨¡å—ç”¨äºè®°å½•äº§å“çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº§å“åç§°ã€è§„æ ¼ã€ä»·æ ¼ã€åº“å­˜ç­‰ã€‚é€šè¿‡ Excel çš„æ•°æ®éªŒè¯åŠŸèƒ½ï¼Œå¯ä»¥ç¡®ä¿è¾“å…¥çš„æ•°æ®æ ¼å¼æ­£ç¡®ï¼Œå‡å°‘é”™è¯¯ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171425260.BRPP2Ijl.png" alt="image-20240511171425260"></p><p><strong>å‘˜å·¥ç®¡ç†</strong>ï¼šå‘˜å·¥ç®¡ç†æ¨¡å—å¯ä»¥è®°å½•å‘˜å·¥çš„ä¸ªäººä¿¡æ¯ã€é”€å”®ä¸šç»©ã€ææˆè®¡ç®—ç­‰å†…å®¹ã€‚é€šè¿‡è®¾ç½®æƒé™ï¼Œå¯ä»¥é™åˆ¶ä¸åŒçº§åˆ«å‘˜å·¥å¯¹æ•°æ®çš„è®¿é—®å’Œä¿®æ”¹æƒé™ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171609709.DctRVu-T.png" alt="image-20240511171609709"></p><p><img src="/ProgramLearnNotes/assets/image-20240511171620516.CiDdX2PB.png" alt="image-20240511171620516"></p><p><strong>è¥é”€ç®¡ç†</strong>ï¼šè¥é”€ç®¡ç†æ¨¡å—ç”¨äºç­–åˆ’å’Œæ‰§è¡Œè¥é”€æ´»åŠ¨ï¼ŒåŒ…æ‹¬æ´»åŠ¨è®¡åˆ’ã€é¢„ç®—ã€æ‰§è¡Œæ•ˆæœç­‰ã€‚é€šè¿‡å›¾è¡¨å±•ç¤ºè¥é”€æ•°æ®ï¼Œå¯ä»¥å¸®åŠ©ä¼ä¸šæ›´å¥½åœ°äº†è§£å¸‚åœºåŠ¨æ€å’Œæ•ˆæœè¯„ä¼°ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171634401.snzY1-Yj.png" alt="image-20240511171634401"></p><p><strong>åˆåŒç®¡ç†</strong>ï¼šåˆåŒç®¡ç†æ¨¡å—å¯ä»¥è®°å½•åˆåŒçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆåŒç¼–å·ã€ç­¾è®¢æ—¥æœŸã€åˆåŒé‡‘é¢ã€å±¥è¡Œæƒ…å†µç­‰ã€‚é€šè¿‡è®¾ç½®æé†’åŠŸèƒ½ï¼Œå¯ä»¥ç¡®ä¿åˆåŒå±¥è¡Œçš„åŠæ—¶æ€§å’Œå‡†ç¡®æ€§ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171659774.DG4ctwGc.png" alt="image-20240511171659774"></p><p><strong>è®¢å•ç®¡ç†</strong>ï¼šè®¢å•ç®¡ç†æ¨¡å—ç”¨äºè®°å½•è®¢å•çš„ç”Ÿæˆã€æ‰§è¡Œå’Œç»“ç®—è¿‡ç¨‹ã€‚é€šè¿‡ Excel çš„å…¬å¼å’Œå‡½æ•°ï¼Œå¯ä»¥è‡ªåŠ¨è®¡ç®—è®¢å•é‡‘é¢ã€æŠ˜æ‰£ã€ç¨é‡‘ç­‰ï¼Œæé«˜è®¢å•å¤„ç†çš„å‡†ç¡®æ€§ã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171712733.JgJVMaJw.png" alt="image-20240511171712733"></p><p>**åº“å­˜ç®¡ç†ï¼š**åº“å­˜ç®¡ç†æ¨¡å—è´Ÿè´£è®°å½•æ‰€æœ‰äº§å“çš„è¿›ã€é”€å­˜ã€æ•°æ®</p><p><img src="/ProgramLearnNotes/assets/image-20240511171730682.cn_ho2Sh.png" alt="image-20240511171730682"></p><p><strong>æŠ¥è¡¨ç®¡ç†</strong>ï¼šæŠ¥è¡¨ç®¡ç†æ¨¡å—å¯ä»¥æ ¹æ®éœ€è¦ç”Ÿæˆå„ç±»é”€å”®æŠ¥è¡¨ï¼Œå¦‚é”€å”®æ±‡æ€»è¡¨ã€å®¢æˆ·åˆ†æè¡¨ã€äº§å“é”€é‡è¡¨ã€æ”¶æ¬¾æŠ¥è¡¨ç­‰ã€‚è¿™äº›æŠ¥è¡¨å¯ä»¥å¸®åŠ©ä¼ä¸šå…¨é¢äº†è§£é”€å”®æƒ…å†µï¼Œä¸ºå†³ç­–æä¾›æ”¯æŒã€‚</p><p><img src="/ProgramLearnNotes/assets/image-20240511171746907.CFl-Js5t.png" alt="image-20240511171746907"></p><p>åŸºäº Excel æ„å»ºçš„é”€å”®ç®¡ç†ç³»ç»Ÿï¼Œä»¥å…¶çµæ´»ã€æ˜“ç”¨çš„ç‰¹ç‚¹ï¼Œä¸ºä¸­å°å‹ä¼ä¸šæä¾›äº†ä¸€ç§ç»æµé«˜æ•ˆçš„é”€å”®ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡åˆç†åˆ©ç”¨ Excel çš„å„é¡¹åŠŸèƒ½ï¼Œä¼ä¸šå¯ä»¥å®ç°é”€å”®ç®¡ç†çš„æ•°å­—åŒ–å’Œæ™ºèƒ½åŒ–ï¼Œæå‡é”€å”®æ•ˆç‡å’Œç®¡ç†æ°´å¹³ã€‚æœªæ¥ï¼Œéšç€ Excel åŠŸèƒ½çš„ä¸æ–­å®Œå–„å’Œæ›´æ–°ï¼ŒåŸºäº Excel çš„é”€å”®ç®¡ç†ç³»ç»Ÿå°†æœ‰æ›´å¤§çš„å‘å±•ç©ºé—´å’Œåº”ç”¨å‰æ™¯ã€‚</p><h2 id="_4-ç§’é’Ÿç”Ÿæˆ-399-ä»½è£èª‰è¯ä¹¦" tabindex="-1">4 ç§’é’Ÿç”Ÿæˆ 399 ä»½è£èª‰è¯ä¹¦ <a class="header-anchor" href="#_4-ç§’é’Ÿç”Ÿæˆ-399-ä»½è£èª‰è¯ä¹¦" aria-label="Permalink to &quot;4 ç§’é’Ÿç”Ÿæˆ 399 ä»½è£èª‰è¯ä¹¦&quot;">â€‹</a></h2><p>å¦‚æœæœ‰ä¸€ä¸ªå·¥å…·å¯ä»¥åœ¨çŸ­çŸ­ 4 ç§’é’Ÿå†…å®Œæˆä¸€å‘¨çš„å·¥ä½œé‡ï¼Œä½ ä¼šæ€ä¹ˆæƒ³ï¼Ÿè¿™ä¸æ˜¯å¤©æ–¹å¤œè°­ï¼Œè¿™æ˜¯ Python ç¼–ç¨‹è¯­è¨€å¸¦ç»™æˆ‘ä»¬çš„ç°å®å¥‡è¿¹ï¼</p><h3 id="_1-æ•…äº‹èƒŒæ™¯" tabindex="-1"><strong>1. æ•…äº‹èƒŒæ™¯</strong> <a class="header-anchor" href="#_1-æ•…äº‹èƒŒæ™¯" aria-label="Permalink to &quot;**1. æ•…äº‹èƒŒæ™¯**&quot;">â€‹</a></h3><p>åœ¨æ¯ä¸ªå­¦æœŸçš„å°¾å£°ï¼Œå¹¼å„¿å›­çš„å°æœ‹å‹ä»¬éƒ½ä¼šæ”¶åˆ°ä¸€ä»½ç‰¹åˆ«çš„â€œå¥½å­©å­â€è£èª‰è¯ä¹¦ã€‚è¿™ä»½è£èª‰è¯ä¹¦æ˜¯æ¯ä¸ªå­©å­éƒ½èƒ½å¾—åˆ°çš„ä¸€ä»½é¼“åŠ±å’Œè®¤å¯ã€‚å¦‚æœå“ªä¸ªå°æœ‹å‹æ²¡æœ‰æ”¶åˆ°è¿™ä»½è¯ä¹¦ï¼Œé‚£ä¹ˆå®¶é•¿å’Œå­©å­éƒ½ä¼šæ„Ÿåˆ°éå¸¸å¤±æœ›ï¼Œç”šè‡³ä¼šæ‰¾åˆ°è€å¸ˆè¿›è¡Œä¸€ç•ªç†è®ºã€‚</p><p>åœ¨æˆ‘æœ‹å‹çš„å¹¼å„¿å›­ï¼Œæ¯å­¦æœŸç»“æŸæ—¶ï¼Œå‘æ”¾è£èª‰è¯ä¹¦æˆäº†ä¸€é¡¹é‡è¦çš„æ´»åŠ¨ã€‚æ•´ä¸ªå¹¼å„¿å›­æœ‰å°†è¿‘ 400 ä»½è£èª‰è¯ä¹¦éœ€è¦å¡«å†™ï¼Œè¿™é€šå¸¸éœ€è¦ä¸“äººèŠ±è´¹å‡ å¤©çš„æ—¶é—´æ¥å®Œæˆã€‚å¯è¿™ä¸€æ¬¡æˆ‘ç”¨ Python å‡ ç§’é’Ÿå°±è§£å†³äº†è¿™ä¸ªéš¾é¢˜ã€‚</p><h3 id="_2-ä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§" tabindex="-1"><strong>2. ä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§</strong> <a class="header-anchor" href="#_2-ä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§" aria-label="Permalink to &quot;**2. ä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§**&quot;">â€‹</a></h3><ul><li><strong>è€—æ—¶</strong>ï¼šæ¯ä»½å¥–çŠ¶çš„åˆ¶ä½œè‡³å°‘éœ€è¦ 5 åˆ†é’Ÿï¼Œæ€»è®¡å°†è¿‘ 25 ä¸ªå°æ—¶ã€‚</li><li><strong>é‡å¤åŠ³åŠ¨</strong>ï¼šå·¥ä½œå†…å®¹æœºæ¢°é‡å¤ï¼Œæ•ˆç‡ä½ä¸‹ã€‚</li><li><strong>æ˜“å‡ºé”™</strong>ï¼šæ‰‹å·¥å¡«å†™ä¿¡æ¯å®¹æ˜“å‡ºç°é”™è¯¯ã€‚</li></ul><h3 id="_3-python-è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆ" tabindex="-1"><strong>3. Python è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆ</strong> <a class="header-anchor" href="#_3-python-è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to &quot;**3. Python è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆ**&quot;">â€‹</a></h3><p>ä½¿ç”¨ Python è‡ªåŠ¨åŒ–åŠå…¬å·¥å…·æ¥æ‰¹é‡è‡ªåŠ¨åŒ–ç”Ÿæˆ PPT ç‰ˆè£èª‰è¯ä¹¦ã€‚</p><h3 id="_4-å¦‚ä½•å®ç°è‡ªåŠ¨åŒ–" tabindex="-1"><strong>4. å¦‚ä½•å®ç°è‡ªåŠ¨åŒ–ï¼Ÿ</strong> <a class="header-anchor" href="#_4-å¦‚ä½•å®ç°è‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;**4. å¦‚ä½•å®ç°è‡ªåŠ¨åŒ–ï¼Ÿ**&quot;">â€‹</a></h3><h4 id="_4-1-å‡†å¤‡å·¥ä½œ" tabindex="-1">4.1 å‡†å¤‡å·¥ä½œ <a class="header-anchor" href="#_4-1-å‡†å¤‡å·¥ä½œ" aria-label="Permalink to &quot;4.1 å‡†å¤‡å·¥ä½œ&quot;">â€‹</a></h4><ul><li><p><strong>æ”¶é›†ä¿¡æ¯</strong>ï¼šæ•´ç†å¥½æ‰€æœ‰è·å¥–å­©å­çš„åå•å’Œç›¸å…³ä¿¡æ¯ï¼Œå­˜å‚¨åˆ° Excel é‡Œã€‚</p></li><li><p><strong>è®¾è®¡æ¨¡æ¿</strong>ï¼šåœ¨ PowerPoint ä¸­è®¾è®¡ä¸€ä¸ªå¥–çŠ¶æ¨¡æ¿ï¼ŒåŒ…æ‹¬å§“åã€å­¦å¹´ã€æ—¶é—´ç­‰å¯å˜å­—æ®µã€‚</p><p><img src="/ProgramLearnNotes/assets/640-1715765080431-74.hExGIKnx.webp" alt="å›¾ç‰‡"></p></li></ul><p><img src="/ProgramLearnNotes/assets/640-1715765080432-75.DrEEUt-9.webp" alt="å›¾ç‰‡"></p><h4 id="_4-2-python-è„šæœ¬å¼€å‘" tabindex="-1">4.2 Python è„šæœ¬å¼€å‘ <a class="header-anchor" href="#_4-2-python-è„šæœ¬å¼€å‘" aria-label="Permalink to &quot;4.2 Python è„šæœ¬å¼€å‘&quot;">â€‹</a></h4><ul><li><p><strong>ç¼–å†™è„šæœ¬</strong>ï¼šåˆ©ç”¨ Python çš„<code>python-pptx</code>åº“æ¥æ“ä½œ PPT æ–‡ä»¶ã€‚</p></li><li><p><strong>æ‰¹é‡å¡«å……</strong>ï¼šç¼–å†™å¾ªç¯ï¼Œè‡ªåŠ¨å¡«å……æ¯ä¸ªå­©å­çš„ä¿¡æ¯åˆ°æ¨¡æ¿ä¸­ã€‚</p><p>Python ä»£ç </p></li></ul><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pptx </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Presentation</span></span>
<span class="line"><span style="color:#ABB2BF;">prs </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Presentation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data\è£èª‰è¯ä¹¦æ¨¡æ¿.pptx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">slide </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> prs.slides.</span><span style="color:#61AFEF;">add_slide</span><span style="color:#ABB2BF;">(prs.slide_layouts[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]) </span><span style="color:#7F848E;font-style:italic;"># ç¬¬ä¸€ä¸ªæ¨¡æ¿çš„ç¬¬0ä¸ªæ¿å¼</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> ph </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> slide.placeholders: </span><span style="color:#7F848E;font-style:italic;">#éå†è¿™é¡µPPTçš„æ‰€æœ‰å ä½ç¬¦</span></span>
<span class="line"><span style="color:#ABB2BF;">    phf </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ph.placeholder_format </span><span style="color:#7F848E;font-style:italic;">#è·å–å ä½ç¬¦çš„æ ¼å¼</span></span>
<span class="line"><span style="color:#56B6C2;">    print</span><span style="color:#ABB2BF;">(phf.idx) </span><span style="color:#7F848E;font-style:italic;">#æ‰“å°å…¶IDç¼–å·</span></span>
<span class="line"><span style="color:#ABB2BF;">    ph.text </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(phf.idx)</span><span style="color:#7F848E;font-style:italic;"># å°†ç¼–å·å†™å…¥PPTå¯¹åº”çš„ä½ç½®ä¸­ï¼Œä»¥ä¾¿åé¢ä¸€ä¸€å¯¹åº”</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ä»¥ä¸Šè¯»å–åˆ°å ä½ç¬¦çš„IDæ–¹ä¾¿åé¢è°ƒç”¨</span></span>
<span class="line"><span style="color:#ABB2BF;">prs.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data\è£èª‰è¯ä¹¦æ¨¡æ¿-å ä½ç¬¦ç¼–å·.pptx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> openpyxl </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_workbook</span></span>
<span class="line"><span style="color:#ABB2BF;">wb </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> load_workbook</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data\åå•.xlsx&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">ws </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> wb.active</span></span>
<span class="line"><span style="color:#ABB2BF;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{}</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> row </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,ws.max_row</span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    class_id </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#98C379;">&#39;A&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value</span></span>
<span class="line"><span style="color:#ABB2BF;">    name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> ws[</span><span style="color:#98C379;">&#39;B&#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#56B6C2;"> str</span><span style="color:#ABB2BF;">(row)].value</span></span>
<span class="line"><span style="color:#ABB2BF;">    data.</span><span style="color:#61AFEF;">setdefault</span><span style="color:#ABB2BF;">(class_id,[])</span></span>
<span class="line"><span style="color:#ABB2BF;">    data[class_id].</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(name)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#ABB2BF;">t0</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">()</span><span style="color:#7F848E;font-style:italic;"># ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">prs </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Presentation</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data\è£èª‰è¯ä¹¦æ¨¡æ¿.pptx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">slide_layout </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> prs.slide_layouts[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span><span style="color:#7F848E;font-style:italic;">#è°ƒç”¨è®¾ç½®å¥½çš„æ¯ç‰ˆï¼Œå› ä¸ºæ˜¯æ¯ç‰ˆçš„ç¬¬ä¸€ç‰ˆå¼ï¼Œæ‰€ä»¥å–[0]</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> class_id </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data:</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> data[class_id]:</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> prs.slides.</span><span style="color:#61AFEF;">add_slide</span><span style="color:#ABB2BF;">(slide_layout) </span><span style="color:#7F848E;font-style:italic;">#ä»¥æ¯ç‰ˆçš„ç‰ˆå¼ä¸ºåŸºç¡€æ–°å¢ä¸€é¡µå¹»ç¯ç‰‡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        #å¾€å¹»ç¯ç‰‡ä¸­å†™å…¥å†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide.placeholders[</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">].text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;</span><span style="color:#D19A66;">{}</span><span style="color:#98C379;"> ç­ </span><span style="color:#D19A66;">{}</span><span style="color:#98C379;"> åŒå­¦ï¼š&quot;</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(class_id,name) </span><span style="color:#7F848E;font-style:italic;">#æ­¤å¤„æ˜¯ç­çº§å’Œå§“å</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide.placeholders[</span><span style="color:#D19A66;">11</span><span style="color:#ABB2BF;">].text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;åœ¨2023-2024å­¦å¹´åº¦ç¬¬ä¸€å­¦æœŸè·å¾—&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide.placeholders[</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">].text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;â€œå¥½å­©å­â€ç§°å·ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide.placeholders[</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">].text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;ç‰¹å‘æ­¤è¯ï¼Œä»¥èµ„é¼“åŠ±ã€‚&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide.placeholders[</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">].text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;å¸‚å¹¼å„¿å›­&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        slide.placeholders[</span><span style="color:#D19A66;">15</span><span style="color:#ABB2BF;">].text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;2024å¹´4æœˆ&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">prs.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data\è£èª‰è¯ä¹¦(æ€»).pptx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">t1 </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;ç¨‹åºç”¨æ—¶ï¼š&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">round</span><span style="color:#ABB2BF;">(t1</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">t0))</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;ç§’ã€‚&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h4 id="_4-3-è‡ªåŠ¨åŒ–æµç¨‹" tabindex="-1">4.3 è‡ªåŠ¨åŒ–æµç¨‹ <a class="header-anchor" href="#_4-3-è‡ªåŠ¨åŒ–æµç¨‹" aria-label="Permalink to &quot;4.3 è‡ªåŠ¨åŒ–æµç¨‹&quot;">â€‹</a></h4><ul><li><strong>ä¸€é”®è¿è¡Œ</strong>ï¼šé€šè¿‡ pyinstaller å°†æ•´ä¸ªé¡¹ç›®ä»£ç æ‰“åŒ…æˆ EXE è½¯ä»¶ï¼Œå…·ä½“æ–¹æ³•å¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡æ–‡ç« ã€Š<a href="http://mp.weixin.qq.com/s?__biz=Mzk0ODYxNzY5Nw==&amp;mid=2247484780&amp;idx=1&amp;sn=70c47650d878c801dc634e27400af975&amp;chksm=c365ade2f41224f4e49514b6f9edafa23478ed7367315861501b3a1821db5451174c78626373&amp;scene=21#wechat_redirect" target="_blank" rel="noreferrer">äººäººéƒ½èƒ½äº«å—åŠå…¬è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©â€”â€”ä¸‰æ­¥å°† Python ç¨‹åºè½¬ä¸ºè½¯ä»¶</a>ã€‹ï¼Œè€å¸ˆåªéœ€ç‚¹å‡»è¿è¡ŒæŒ‰é’®ï¼Œç¨‹åºä¾¿å¼€å§‹å·¥ä½œã€‚</li><li><strong>å¿«é€Ÿç”Ÿæˆ</strong>ï¼šç¨‹åºä¼šè¿…é€Ÿç”Ÿæˆ 399 ä»½å¥–çŠ¶ï¼Œæ¯ä»½å¥–çŠ¶çš„ä¿¡æ¯éƒ½æ˜¯å‡†ç¡®æ— è¯¯çš„ã€‚</li></ul><h3 id="_5-å®é™…æ•ˆæœ" tabindex="-1"><strong>5. å®é™…æ•ˆæœ</strong> <a class="header-anchor" href="#_5-å®é™…æ•ˆæœ" aria-label="Permalink to &quot;**5. å®é™…æ•ˆæœ**&quot;">â€‹</a></h3><ul><li><strong>æ—¶é—´èŠ‚çœ</strong>ï¼šä» 25 å°æ—¶ç¼©çŸ­åˆ° 4 ç§’é’Ÿï¼Œæ•ˆç‡æå‡äº† 22500 å€ï¼</li><li><strong>é›¶é”™è¯¯</strong>ï¼šè‡ªåŠ¨åŒ–é¿å…äº†æ‰‹å·¥å¡«å†™å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</li><li><strong>æ˜“äºè°ƒæ•´</strong>ï¼šæœªæ¥è‹¥è¦å¢åŠ æˆ–ä¿®æ”¹å¥–çŠ¶å†…å®¹ï¼Œåªéœ€è°ƒæ•´æ¨¡æ¿å’Œè„šæœ¬å³å¯ã€‚</li></ul><h3 id="_6-ç»“è¯­" tabindex="-1"><strong>6. ç»“è¯­</strong> <a class="header-anchor" href="#_6-ç»“è¯­" aria-label="Permalink to &quot;**6. ç»“è¯­**&quot;">â€‹</a></h3><p>é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Python åœ¨è‡ªåŠ¨åŒ–åŠå…¬é¢†åŸŸçš„å¼ºå¤§æ½œåŠ›ã€‚å®ƒä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬èŠ‚çœæ—¶é—´ï¼Œæé«˜æ•ˆç‡ï¼Œè¿˜èƒ½å‡å°‘äººä¸ºé”™è¯¯ï¼Œæå‡å·¥ä½œè´¨é‡ã€‚å¦‚æœä½ ä¹Ÿæ˜¯ä¸€ä½æ•™è‚²å·¥ä½œè€…æˆ–å¯¹è‡ªåŠ¨åŒ–åŠå…¬æ„Ÿå…´è¶£ï¼Œä¸å¦¨å­¦ä¹  Pythonï¼Œå¼€å¯é«˜æ•ˆåŠå…¬çš„æ–°ç¯‡ç« ï¼</p><p><strong>æ³¨ï¼š</strong> æ–‡ç« ä¸­æä¾›çš„ Python ä»£ç å’Œæ“ä½œæ­¥éª¤éœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´å’Œå®Œå–„ã€‚æ­¤å¤–ï¼Œä¸ºäº†ä¿æŠ¤ä¸ªäººéšç§ï¼Œå»ºè®®åœ¨å¤„ç†ä»»ä½•ä¸ªäººä¿¡æ¯æ—¶éƒ½è¦æ³¨æ„æ•°æ®å®‰å…¨å’Œéšç§ä¿æŠ¤ã€‚</p><h2 id="è‡ªåŠ¨æ ¡å¯¹" tabindex="-1">è‡ªåŠ¨æ ¡å¯¹ <a class="header-anchor" href="#è‡ªåŠ¨æ ¡å¯¹" aria-label="Permalink to &quot;è‡ªåŠ¨æ ¡å¯¹&quot;">â€‹</a></h2><p>æ— è®ºä½ çš„è¯­è¨€èƒ½åŠ›æœ‰å¤šå¥½ï¼Œå½“æˆ‘ä»¬æ’°å†™é•¿æŠ¥å‘Šã€æ–‡ç« æˆ–ç ”ç©¶è®ºæ–‡æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šçŠ¯æ‹¼å†™é”™è¯¯ã€‚åœ¨è¿™ä¸ªAIæ—¶ä»£ï¼Œæœ‰è®¸å¤šä¼Ÿå¤§çš„PythonåŒ…å¯ä»¥å¸®åŠ©è§£å†³è¿™äº›æ„šè ¢çš„æ‹¼å†™é”™è¯¯ï¼Œå¹¶ä¸ºä½ çš„ä½œå“æä¾›ç²¾ç¾çš„æ ¡å¯¹ã€‚</p><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬åˆ©ç”¨lmproofåº“æ¥è¿›è¡Œè¯­æ³•é”™è¯¯ã€æ‹¼å†™é”™è¯¯ã€è¯è¯­æ··æ·†é”™è¯¯å’Œå…¶ä»–é”™è¯¯çš„æ ¡å¯¹æ›´æ­£ã€‚</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>##å®‰è£…åº“</span></span>
<span class="line"><span>#ä½¿ç”¨pipå‘½ä»¤å®‰è£…åä¸ºlmproofçš„åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ–‡æœ¬æ ¡å¯¹çš„å·¥å…·åº“ã€‚</span></span>
<span class="line"><span>!pip</span></span>
<span class="line"><span>install lmproof</span></span>
<span class="line"><span>##å¯¼å…¥åº“</span></span>
<span class="line"><span>#å¯¼å…¥å®‰è£…çš„lmproofåº“ï¼Œå¹¶é‡å‘½åä¸ºlmï¼Œæ–¹ä¾¿åç»­è°ƒç”¨ã€‚</span></span>
<span class="line"><span>import</span></span>
<span class="line"><span>lmproof as lm</span></span>
<span class="line"><span>##å®šä¹‰æ ¡å¯¹å‡½æ•°</span></span>
<span class="line"><span>#å®šä¹‰ä¸€ä¸ªåä¸ºProofreadçš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°textï¼Œç”¨äºæ ¡å¯¹æ–‡æœ¬ä¸­çš„è¯­æ³•é”™è¯¯ã€‚</span></span>
<span class="line"><span>def</span></span>
<span class="line"><span>Proofread(text):</span></span>
<span class="line"><span> # åŠ è½½è‹±æ–‡çš„è¯­æ³•æ ¡å¯¹æ¨¡å‹ã€‚</span></span>
<span class="line"><span> proof = lm.load(&quot;en&quot;)</span></span>
<span class="line"><span> # ä½¿ç”¨åŠ è½½çš„æ¨¡å‹å¯¹è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œæ ¡å¯¹ï¼Œå¹¶è¿”å›æ ¡å¯¹åæ— é”™è¯¯çš„æ–‡æœ¬ã€‚</span></span>
<span class="line"><span> error_free_text = proof.proofread(text)</span></span>
<span class="line"><span> return error_free_text</span></span>
<span class="line"><span>##ç¤ºä¾‹æ–‡æœ¬</span></span>
<span class="line"><span>#å®šä¹‰ä¸€ä¸ªåŒ…å«è¯­æ³•é”™è¯¯çš„è‹±æ–‡å­—ç¬¦ä¸²TEXTã€‚</span></span>
<span class="line"><span>TEXT</span></span>
<span class="line"><span>= &#39;The varialbe was initilized with an invald value, causing the progam to</span></span>
<span class="line"><span>throw a runtime erro.&#39;</span></span>
<span class="line"><span>##è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span>#ä½¿ç”¨Pythonçš„æ‰“å°åŠŸèƒ½Printï¼ˆåº”ä¸ºå°å†™çš„printï¼‰æ¥è¾“å‡ºè°ƒç”¨Proofreadå‡½æ•°å¤„ç†åçš„æ–‡æœ¬ã€‚</span></span>
<span class="line"><span>print(Proofread(TEXT))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>è„šæœ¬åº”ç”¨â€”â€” â€¢ æ”¹å–„èŠå¤©æœºå™¨äººã€è™šæ‹ŸåŠ©æ‰‹å’Œå®¢æˆ·æ”¯æŒç³»ç»Ÿçš„äº’åŠ¨å’Œå›åº”ã€‚</p><h2 id="ä¼ªæ•°æ®" tabindex="-1">ä¼ªæ•°æ® <a class="header-anchor" href="#ä¼ªæ•°æ®" aria-label="Permalink to &quot;ä¼ªæ•°æ®&quot;">â€‹</a></h2><p>æˆ‘ä¸çŸ¥é“è°éœ€è¦å®ƒæˆ–ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Œä½†æˆ‘å‘ç°è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬åœ¨è®¸å¤šåœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚æ— è®ºä½ æ˜¯ä¸€åæ•°æ®ç§‘å­¦å®¶å¯»æ‰¾ä¸€äº›æ ·æœ¬æ•°æ®æ¥æµ‹è¯•ä½ çš„æ¨¡å‹ï¼Œè¿˜æ˜¯æŸäººæƒ³è¦éšæœºä¿¡æ¯æ¥å¡«å†™ä¸å¿…è¦çš„è¡¨æ ¼ã€‚</p><p>è¿™ä¸ªPythonè‡ªåŠ¨åŒ–è„šæœ¬å°†ç”Ÿæˆé€¼çœŸä½†å®Œå…¨äººå·¥çš„æ•°æ®é›†ï¼Œéå¸¸é€‚åˆæµ‹è¯•ã€å¼€å‘å’Œæ¨¡æ‹Ÿç›®çš„ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥æ‰€éœ€çš„åº“</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">pandas </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> pd          </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥pandasåº“ï¼Œç”¨äºæ•°æ®å¤„ç†å’Œæ•°æ®åˆ†æï¼Œé€šå¸¸ç®€ç§°ä¸ºpdã€‚</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">faker </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Faker      </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥Fakeråº“ï¼Œç”¨äºç”Ÿæˆè™šå‡æ•°æ®ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">random                </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥randomåº“ï¼Œç”¨äºç”Ÿæˆéšæœºæ•°ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">åˆ›å»ºä¸€ä¸ªFakerå¯¹è±¡ï¼Œç”¨äºç”Ÿæˆå„ç§è™šå‡æ•°æ®ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;">fake</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> Faker</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰å‡½æ•°ä»¥ç”Ÿæˆè™šå‡æ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">generate_fake_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">num_entries</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆå§‹åŒ–ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨æ¥å­˜å‚¨æ¯æ¡ç”Ÿæˆçš„æ•°æ®ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¾ªç¯æŒ‡å®šçš„æ¬¡æ•°ï¼Œæ¯æ¬¡ç”Ÿæˆä¸€æ¡è®°å½•ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> _ </span><span style="color:#C678DD;">in</span><span style="color:#56B6C2;"> range</span><span style="color:#ABB2BF;">(num_entries):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼Œå­˜å‚¨ä¸€æ¡è™šå‡æ•°æ®è®°å½•ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> entry </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Name&quot;</span><span style="color:#ABB2BF;">: fake.</span><span style="color:#61AFEF;">name</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„å…¨åã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Address&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">address</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„åœ°å€ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Email&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">email</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„ç”µå­é‚®ç®±åœ°å€ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Phone Number&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">phone_number</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„ç”µè¯å·ç ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Date of Birth&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">date_of_birth</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">minimum_age</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">maximum_age</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">65</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">), </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„å‡ºç”Ÿæ—¥æœŸï¼Œå¹´é¾„èŒƒå›´18è‡³65å²ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Random Number&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">random.</span><span style="color:#61AFEF;">randint</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">),  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ç”Ÿæˆä¸€ä¸ª1è‡³100ä¹‹é—´çš„éšæœºæ•°ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Job Title&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">job</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„èŒä½åç§°ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Company&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">company</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆè™šå‡çš„å…¬å¸åç§°ã€‚</span></span>
<span class="line"><span style="color:#98C379;"> &quot;Lorem Ipsum Text&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">fake.</span><span style="color:#61AFEF;">text</span><span style="color:#ABB2BF;">(),  </span><span style="color:#7F848E;font-style:italic;"># ç”Ÿæˆä¸€æ®µè™šå‡çš„æ–‡æœ¬ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†ç”Ÿæˆçš„æ•°æ®è®°å½•æ·»åŠ åˆ°åˆ—è¡¨ä¸­ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> data.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(entry)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†åˆ—è¡¨è½¬æ¢æˆDataFrameå¯¹è±¡ï¼Œå¹¶è¿”å›ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> pd.</span><span style="color:#61AFEF;">DataFrame</span><span style="color:#ABB2BF;">(data)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä¸»ç¨‹åºå…¥å£</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> num_entries </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 10</span><span style="color:#7F848E;font-style:italic;">  # è®¾ç½®æƒ³è¦ç”Ÿæˆçš„è™šå‡æ•°æ®è®°å½•çš„æ•°é‡ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> fake_data_df </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">generate_fake_data</span><span style="color:#ABB2BF;">(num_entries)  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">è°ƒç”¨å‡½æ•°ç”Ÿæˆè™šå‡æ•°æ®ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">##</span></span>
<span class="line"><span style="color:#ABB2BF;">æ‰“å°ç”Ÿæˆçš„DataFrame</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(fake_data_df)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><p>ä½¿ç”¨ä¸Šè¿°è„šæœ¬ç”Ÿæˆçš„è™šå‡æ•°æ® è„šæœ¬åº”ç”¨â€”â€”</p><p>â€¢ æ•°æ®åº“æ¶æ„æµ‹è¯•ã€‚</p><p>â€¢ æœºå™¨å­¦ä¹ æ¨¡å‹å¼€å‘</p><p>â€¢ APIæµ‹è¯•</p><h2 id="notifo" tabindex="-1">Notifo <a class="header-anchor" href="#notifo" aria-label="Permalink to &quot;Notifo&quot;">â€‹</a></h2><p>æˆ‘æ€»æ˜¯åœ¨å·¥ä½œæ—¶å¿˜è®°äº‹æƒ…ã€‚ä¸ºäº†å…‹æœå¥å¿˜å¹¶æé«˜æˆ‘çš„ç”Ÿäº§åŠ›ï¼Œæˆ‘ç¼–å†™äº†è¿™ä¸ªPythonè‡ªåŠ¨åŒ–è„šæœ¬Notifoã€‚å®ƒå……å½“æˆ‘çš„æ•°å­—è®°å¿†åŠ©æ‰‹ï¼Œåœ¨è‡ªå®šä¹‰æ—¶é—´æ¡†æ¶åæé†’æˆ‘åšäº‹æƒ…ï¼Œå¼ºè¿«æˆ‘å®Œæˆå·¥ä½œã€‚è¿™ä¸ªè„šæœ¬æé«˜äº†æˆ‘çš„ç”Ÿäº§åŠ›ï¼Œå¸®åŠ©æˆ‘åœ¨æˆªæ­¢æ—¥æœŸä¹‹å‰å®Œæˆä»»åŠ¡ã€‚æœ€å¥½çš„æ˜¯ï¼Œå®ƒç®€å•ã€æ˜“äºå¤åˆ¶ä¸”éå¸¸æœ‰ç”¨ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥æ‰€éœ€çš„åº“</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">win10toast </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> ToastNotifier  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä»win10toaståº“å¯¼å…¥ToastNotifierï¼Œç”¨äºæ˜¾ç¤ºWindows </span><span style="color:#FFFFFF;">10æ¡Œé¢é€šçŸ¥</span><span style="color:#ABB2BF;">ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">time  </span><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥timeåº“ï¼Œç”¨äºå¤„ç†æ—¶é—´ç›¸å…³åŠŸèƒ½ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">åˆ›å»ºToastNotifierå¯¹è±¡ï¼Œç”¨äºåç»­å‘é€é€šçŸ¥ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;">toaster</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> ToastNotifier</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰ä¸€ä¸ªè®¾ç½®æé†’çš„å‡½æ•°ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">set_reminder</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # é€šè¿‡inputå‡½æ•°è·å–ç”¨æˆ·æƒ³è¦è®°ä½çš„äº‹é¡¹çš„æ ‡é¢˜ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> reminder_header </span><span style="color:#56B6C2;">=</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;What would</span></span>
<span class="line"><span style="color:#ABB2BF;">you like me to remember</span><span style="color:#FFFFFF;">?</span><span style="color:#ABB2BF;">\</span><span style="color:#FFFFFF;">n&quot;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–ä¸æé†’ç›¸å…³çš„è¯¦ç»†ä¿¡æ¯ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> related_message</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Related</span></span>
<span class="line"><span style="color:#ABB2BF;">Message:\</span><span style="color:#FFFFFF;">n&quot;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–ç”¨æˆ·å¸Œæœ›å¤šå°‘åˆ†é’Ÿåæ”¶åˆ°æé†’ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> time_minutes</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> float</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;In how</span></span>
<span class="line"><span style="color:#ABB2BF;">many minutes</span><span style="color:#FFFFFF;">?</span><span style="color:#ABB2BF;">\</span><span style="color:#FFFFFF;">n&quot;))</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†åˆ†é’Ÿè½¬æ¢ä¸ºç§’ï¼Œå› ä¸ºtime.sleepå‡½æ•°éœ€è¦ç§’ä¸ºå•ä½ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> time_seconds</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> time_minutes </span><span style="color:#56B6C2;">*</span><span style="color:#D19A66;"> 60</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ˜¾ç¤ºè®¾ç½®æé†’çš„è¿‡ç¨‹æ¶ˆæ¯ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Setting up reminder...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># å»¶è¿Ÿ2ç§’æ¨¡æ‹Ÿè®¾ç½®æé†’è¿‡ç¨‹ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;All set!&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å»¶è¿Ÿç”¨æˆ·æŒ‡å®šçš„æ—¶é—´ï¼Œæ­¤å¤„ä½¿ç”¨time.sleepé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°æé†’æ—¶é—´åˆ°è¾¾ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(time_seconds)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å‘é€æ¡Œé¢é€šçŸ¥ï¼Œæ˜¾ç¤ºæé†’ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> toaster.</span><span style="color:#61AFEF;">show_toast</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">title</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">reminder_header</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;"># æé†’çš„æ ‡é¢˜ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">related_message</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;"># æé†’çš„è¯¦ç»†ä¿¡æ¯ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> duration</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># é€šçŸ¥æ˜¾ç¤ºçš„æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> threaded</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#7F848E;font-style:italic;">  # ä½¿ç”¨çº¿ç¨‹æ¥æ˜¾ç¤ºé€šçŸ¥ï¼Œè¿™æ ·ä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> )</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¾ªç¯æ£€æŸ¥é€šçŸ¥æ˜¯å¦è¿˜åœ¨æ´»åŠ¨çŠ¶æ€ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™çŸ­æš‚ä¼‘çœ 0.005ç§’ï¼Œé¿å…å ç”¨å¤ªå¤šCPUã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> while</span><span style="color:#ABB2BF;"> toaster.</span><span style="color:#61AFEF;">notification_active</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;"> time.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.005</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœè¿™ä¸ªè„šæœ¬æ˜¯ä½œä¸ºä¸»ç¨‹åºè¿è¡Œï¼Œè€Œä¸æ˜¯è¢«å¯¼å…¥åˆ°å…¶ä»–è„šæœ¬ä¸­ï¼Œé‚£ä¹ˆæ‰§è¡Œset_reminderå‡½æ•°ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;"> set_reminder</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>Notifoæ­£åœ¨æ‰§è¡Œå…¶èŒè´£â€¦â€¦</p><p><img src="/ProgramLearnNotes/assets/image-20240516212224824.CCdwcKIy.png" alt="image-20240516212224824"></p><p>è¿™æ˜¯é€šçŸ¥ï¼Œåœ¨35åˆ†é’Ÿåå‡†æ—¶</p><p>ä½ å¯ä»¥ä½¿ç”¨playsoundåŒ…åœ¨Notifoæé†’ä½ æŸäº‹æ—¶æ’­æ”¾ç‰¹å®šçš„å£°éŸ³ã€‚</p><h2 id="nato-åŠ å¯†" tabindex="-1">NATO åŠ å¯† <a class="header-anchor" href="#nato-åŠ å¯†" aria-label="Permalink to &quot;NATO åŠ å¯†&quot;">â€‹</a></h2><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä¹‹ä¸€ï¼Œæˆ‘æ€»æ˜¯åœ¨å‘é€ä¸€äº›ç§äººä¿¡æ¯æˆ–æœ‰æ—¶åªæ˜¯ä¸ºäº†å¥½ç©è€Œåœ¨æˆ‘çš„ç”µå­é‚®ä»¶å’Œæ¶ˆæ¯ä¸­ä½¿ç”¨å®ƒã€‚å®ƒåˆ©ç”¨åŠ å¯†å’Œè§£å¯†æŠ€æœ¯ç”Ÿæˆå¯ä»¥ä½¿ç”¨æ­£ç¡®çš„å¯†é’¥é›†è§£ç çš„ç¼–ç å¥å­ã€‚å®ƒä»¥æ¶ˆæ¯ä¸ºè¾“å…¥å¹¶è¿”å›ç¼–ç åçš„æ¶ˆæ¯ä½œä¸ºè¾“å‡ºã€‚ æˆ‘å·²å°†æ­¤è„šæœ¬ä¸streamlité›†æˆåœ¨ä¸€ä¸ªç½‘ç»œåº”ç”¨ä¸­ï¼Œä»¥è·å¾—æ›´å¥½çš„ç”¨æˆ·äº’åŠ¨ã€‚ä½ å¯ä»¥é€šè¿‡å¤åˆ¶ä¸‹é¢çš„ä»£ç æ¥å°è¯•ä¸€ä¸‹ï¼ æˆ‘ç›¸ä¿¡ä½ ä¼šå–œæ¬¢å®ƒï¼</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥Streamlitåº“ï¼Œç”¨äºå¿«é€Ÿæ„å»ºWebåº”ç”¨ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">streamlit </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> st</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä½¿ç”¨ä¸€ä¸ªå­—å…¸å®šä¹‰NATOéŸ³æ ‡å­—æ¯è¡¨çš„åŠ å¯†è§„åˆ™ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;">nato_encoder</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;"> &#39;A&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Beta&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Gamma&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Cypher&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Epsilon&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;E&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Zeta&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;F&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Eta&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;G&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Theta&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;H&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">&#39;Iota&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;I&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Kappa&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;J&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Lambda&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;K&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Mu&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;L&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Nu&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;M&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Xi&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;N&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Omicron&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;O&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Pi&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;P&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">&#39;Rho&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;Q&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Sigma&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;R&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Tau&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;S&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Upsilon&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&#39;T&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Phi&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;U&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Chi&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;V&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Psi&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;W&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Omega&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;X&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">&#39;Alpha&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;Y&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Delta&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Z&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Zen&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39; &#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Space&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰åŠ å¯†å‡½æ•°ï¼Œè¾“å…¥æ˜¯æ™®é€šæ¶ˆæ¯å’ŒNATOç¼–ç å™¨ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">encrypt_message</span><span style="color:#ABB2BF;">(message, nato_encoder):</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_message </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> char </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> message:</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> char.</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> nato_encoder:  </span><span style="color:#7F848E;font-style:italic;"># å°†å­—ç¬¦è½¬å¤§å†™å¹¶æ£€æŸ¥æ˜¯å¦åœ¨å­—å…¸ä¸­ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_message </span><span style="color:#56B6C2;">+=</span></span>
<span class="line"><span style="color:#ABB2BF;">nato_encoder[char.</span><span style="color:#61AFEF;">upper</span><span style="color:#ABB2BF;">()] </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39; &#39;</span><span style="color:#7F848E;font-style:italic;">  #</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœåœ¨ï¼Œæ·»åŠ å¯¹åº”çš„åŠ å¯†è¯ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> elif</span><span style="color:#ABB2BF;"> char </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &#39; &#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_message </span><span style="color:#56B6C2;">+=</span></span>
<span class="line"><span style="color:#ABB2BF;">nato_encoder[char] </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39; &#39;</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> encrypted_message </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> char </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39;</span></span>
<span class="line"><span style="color:#98C379;">&#39;  # å¦‚æœä¸åœ¨å­—å…¸ä¸­ï¼Œä¿æŒåŸæ ·ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> encrypted_message</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰è§£å¯†å‡½æ•°ï¼Œè¾“å…¥æ˜¯åŠ å¯†æ¶ˆæ¯å’ŒNATOç¼–ç å™¨ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">decode_message</span><span style="color:#ABB2BF;">(encoded_message, nato_encoder):</span></span>
<span class="line"><span style="color:#ABB2BF;"> decoded_message </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;"> words </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> encoded_message.</span><span style="color:#61AFEF;">split</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># åˆ†å‰²åŠ å¯†æ¶ˆæ¯çš„æ¯ä¸€ä¸ªå•è¯ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> word </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> words:</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> key, value </span><span style="color:#C678DD;">in</span></span>
<span class="line"><span style="color:#ABB2BF;">nato_encoder.</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">():  </span><span style="color:#7F848E;font-style:italic;"># éå†å­—å…¸ï¼Œå¯»æ‰¾åŒ¹é…çš„åŠ å¯†è¯ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> value </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> word:</span></span>
<span class="line"><span style="color:#ABB2BF;"> decoded_message </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> key  </span><span style="color:#7F848E;font-style:italic;"># æ‰¾åˆ°åï¼Œæ·»åŠ å¯¹åº”çš„å­—æ¯ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> break</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> decoded_message </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> word  </span><span style="color:#7F848E;font-style:italic;"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œä¿æŒåŸæ ·ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> decoded_message</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰ä¸»å‡½æ•°ï¼Œç”¨äºå¯åŠ¨Streamlitåº”ç”¨ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">title</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;NATO Phonetic Alphabet</span></span>
<span class="line"><span style="color:#ABB2BF;">Encoder</span><span style="color:#56B6C2;">/</span><span style="color:#ABB2BF;">Decoder</span><span style="color:#98C379;">&quot;)  # è®¾ç½®Webé¡µé¢æ ‡é¢˜ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # åˆ›å»ºä¸¤ä¸ªæ ‡ç­¾é¡µï¼šç¼–ç å’Œè§£ç ã€‚</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> tab_choice</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> st.sidebar.</span><span style="color:#61AFEF;">radio</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Select</span></span>
<span class="line"><span style="color:#ABB2BF;">Tab:</span><span style="color:#98C379;">&quot;, [&quot;</span><span style="color:#ABB2BF;">Encode</span><span style="color:#98C379;">&quot;, &quot;</span><span style="color:#ABB2BF;">Decode</span><span style="color:#98C379;">&quot;])</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> tab_choice </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;Encode&quot;</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># ç¼–ç æ ‡ç­¾é¡µã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">header</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Encode Message&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> message_to_encode</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">text_input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Enter the message to encode:&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">button</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Encode&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> encoded_message</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#61AFEF;">encrypt_message</span><span style="color:#ABB2BF;">(message_to_encode, nato_encoder)</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">encoded_message</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºåŠ å¯†åçš„æ¶ˆæ¯ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> elif</span><span style="color:#ABB2BF;"> tab_choice </span><span style="color:#56B6C2;">==</span><span style="color:#98C379;"> &quot;Decode&quot;</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># è§£ç æ ‡ç­¾é¡µã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">header</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Decode Message&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> message_to_decode</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">text_input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Enter the message to decode:&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">button</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Decode&quot;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> decoded_message</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#61AFEF;">decode_message</span><span style="color:#ABB2BF;">(message_to_decode, nato_encoder)</span></span>
<span class="line"><span style="color:#ABB2BF;">st.</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">decoded_message</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºè§£å¯†åçš„åŸå§‹æ¶ˆæ¯ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;"> st.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Creator:: Abhay Parashar</span></span>
<span class="line"><span style="color:#56B6C2;">@</span><span style="color:#ABB2BF;">abhayparashar31 </span><span style="color:#98C379;">&#39;)  # æ˜¾ç¤ºåˆ›å»ºè€…ä¿¡æ¯ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœè¿™ä¸ªæ–‡ä»¶ä½œä¸ºä¸»ç¨‹åºè¿è¡Œï¼Œæ‰§è¡Œmainå‡½æ•°ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br></div></div><p>è§£ç æ¶ˆæ¯ è„šæœ¬åº”ç”¨â€”â€”</p><p>â€¢ æ„å»ºè‡ªå®šä¹‰åŠ å¯†/è§£å¯†ç®—æ³•</p><h2 id="briefit" tabindex="-1">Briefit <a class="header-anchor" href="#briefit" aria-label="Permalink to &quot;Briefit&quot;">â€‹</a></h2><p>æˆ‘å–œæ¬¢æ¯å¤©é˜…è¯»æ–‡ç« ã€ç ”ç©¶è®ºæ–‡å’Œä¸åŒçš„æ–°é—»å‡ºç‰ˆç‰©ã€‚æˆ‘ç›¸ä¿¡è®¸å¤šæ‰¾åˆ°è¿™ä¸ªè„šæœ¬çš„äººæœ‰ç±»ä¼¼çš„ä¹ æƒ¯ã€‚æœ‰æ—¶ç”±äºæ—¶é—´ä¸è¶³ï¼Œé˜…è¯»æ•´ç¯‡æ–‡ç« å˜å¾—å›°éš¾ã€‚ è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ä½¿ç”¨ç¥ç»ç½‘ç»œç”Ÿæˆæ–‡ç« æ‘˜è¦ã€‚å®ƒåˆ©ç”¨ç½‘ç»œæŠ“å–æ¥æŠ“å–æ–‡ç« å†…å®¹ï¼Œç„¶åå°†å®ƒä»¬è¾“å…¥é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹è¾“å‡ºä¸€ä¸ªæ‘˜è¦ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥æ‰€éœ€åº“</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">transformers </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> BartForConditionalGeneration, BartTokenizer  </span><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥BARTæ¨¡å‹å’Œå…¶å¯¹åº”çš„åˆ†è¯å™¨ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">requests  </span><span style="color:#7F848E;font-style:italic;"># å¯¼å…¥requestsåº“ï¼Œç”¨äºå¤„ç†HTTPè¯·æ±‚ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">bs4 </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> BeautifulSoup  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥BeautifulSoupåº“ï¼Œç”¨äºç½‘é¡µè§£æã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¯¹æ–‡ç« æ–‡æœ¬è¿›è¡Œæ‘˜è¦</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">summarize_article</span><span style="color:#ABB2BF;">(article_text, </span><span style="color:#E06C75;font-style:italic;">max_length</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;"> model_name </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#98C379;">&quot;facebook/bart-large-cnn&quot;</span><span style="color:#7F848E;font-style:italic;">  #</span></span>
<span class="line"><span style="color:#ABB2BF;">æŒ‡å®šæ¨¡å‹åï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯é¢„è®­ç»ƒçš„BARTæ¨¡å‹ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> tokenizer </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">BartTokenizer.</span><span style="color:#61AFEF;">from_pretrained</span><span style="color:#ABB2BF;">(model_name) </span><span style="color:#7F848E;font-style:italic;"># ä»é¢„è®­ç»ƒæ¨¡å‹åŠ è½½åˆ†è¯å™¨ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> model </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">BartForConditionalGeneration.</span><span style="color:#61AFEF;">from_pretrained</span><span style="color:#ABB2BF;">(model_name)  </span><span style="color:#7F848E;font-style:italic;"># ä»é¢„è®­ç»ƒæ¨¡å‹åŠ è½½BARTæ¨¡å‹ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨åˆ†è¯å™¨å¤„ç†è¾“å…¥çš„æ–‡ç« æ–‡æœ¬ï¼Œå‡†å¤‡æ¨¡å‹è¾“å…¥æ•°æ®ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> inputs </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tokenizer.</span><span style="color:#61AFEF;">encode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;summarize:</span></span>
<span class="line"><span style="color:#98C379;">&quot; + article_text, return_tensors=&quot;</span><span style="color:#ABB2BF;">pt</span><span style="color:#98C379;">&quot;, max_length=1024,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">truncation</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨æ¨¡å‹ç”Ÿæˆæ‘˜è¦ï¼Œè®¾ç½®æ‘˜è¦çš„æœ€å¤§é•¿åº¦å’Œæœ€å°é•¿åº¦ç­‰å‚æ•°ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> summary_ids </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> model.</span><span style="color:#61AFEF;">generate</span><span style="color:#ABB2BF;">(inputs,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">max_length</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">max_length, </span><span style="color:#E06C75;font-style:italic;">min_length</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">50</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">length_penalty</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">2.0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">num_beams</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">early_stopping</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†ç”Ÿæˆçš„æ‘˜è¦IDè½¬æ¢ä¸ºæ–‡æœ¬ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> summary </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> tokenizer.</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(summary_ids[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">skip_special_tokens</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> summary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºä»ç»™å®šçš„URLæŠ“å–ç½‘é¡µå†…å®¹ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">scrape_webpage</span><span style="color:#ABB2BF;">(url):</span></span>
<span class="line"><span style="color:#C678DD;"> try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url)  </span><span style="color:#7F848E;font-style:italic;"># å‘æŒ‡å®šçš„URLå‘é€GETè¯·æ±‚ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># æ£€æŸ¥å“åº”çŠ¶æ€ï¼Œå¦‚æœä¸æ˜¯200ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> soup </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> BeautifulSoup</span><span style="color:#ABB2BF;">(response.text,</span></span>
<span class="line"><span style="color:#98C379;">&#39;html.parser&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä½¿ç”¨BeautifulSoupè§£æå“åº”çš„HTMLå†…å®¹ã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> all_text </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">soup.</span><span style="color:#61AFEF;">get_text</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">separator</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">strip</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;"># è·å–ç½‘é¡µçš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ï¼Œå¹¶ä»¥æ¢è¡Œç¬¦åˆ†éš”ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> all_text</span></span>
<span class="line"><span style="color:#C678DD;"> except</span><span style="color:#ABB2BF;"> requests.exceptions.RequestException</span></span>
<span class="line"><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:  </span><span style="color:#7F848E;font-style:italic;"># æ•è·å¹¶å¤„ç†å¯èƒ½çš„è¯·æ±‚å¼‚å¸¸ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Error: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœè¿™æ®µä»£ç ä½œä¸ºä¸»è„šæœ¬è¿è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;"> webpage_url </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;https://www.scmagazine.com/brief/info-crypto-stealing-python-packages-proliferate&quot;</span><span style="color:#7F848E;font-style:italic;">  # å®šä¹‰ä¸€ä¸ªç”¨äºæµ‹è¯•çš„ç½‘é¡µURLã€‚</span></span>
<span class="line"><span style="color:#ABB2BF;"> webpage_text </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">scrape_webpage</span><span style="color:#ABB2BF;">(webpage_url)  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°æŠ“å–ç½‘é¡µå†…å®¹ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> webpage_text:</span></span>
<span class="line"><span style="color:#ABB2BF;"> summary </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">summarize_article</span><span style="color:#ABB2BF;">(webpage_text)  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœæˆåŠŸè·å–åˆ°ç½‘é¡µæ–‡æœ¬ï¼Œåˆ™å¯¹å…¶è¿›è¡Œæ‘˜è¦ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">Summarized</span></span>
<span class="line"><span style="color:#ABB2BF;">Article:</span><span style="color:#98C379;">&quot;)  # æ‰“å°æ‘˜è¦çš„æ ‡é¢˜ã€‚</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(summary)  </span><span style="color:#7F848E;font-style:italic;"># æ‰“å°æ‘˜è¦å†…å®¹ã€‚</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Webpage scraping</span></span>
<span class="line"><span style="color:#ABB2BF;">failed.</span><span style="color:#98C379;">&quot;)  # å¦‚æœæŠ“å–ç½‘é¡µå¤±è´¥ï¼Œåˆ™è¾“å‡ºé”™è¯¯æ¶ˆæ¯ã€‚</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h2 id="_6-image-exif" tabindex="-1">6. Image Exif <a class="header-anchor" href="#_6-image-exif" aria-label="Permalink to &quot;6. Image Exif&quot;">â€‹</a></h2><p>Exifï¼ˆå¯äº¤æ¢å›¾åƒæ–‡ä»¶æ ¼å¼ï¼‰æ˜¯ä¸€ç§æ ‡å‡†ï¼Œè§„å®šäº†æ•°å­—ç›¸æœºï¼ˆåŒ…æ‹¬æ™ºèƒ½æ‰‹æœºï¼‰ã€æ‰«æä»ªå’Œå…¶ä»–å¤„ç†ç”±æ•°å­—ç›¸æœºè®°å½•çš„å›¾åƒå’Œå£°éŸ³æ–‡ä»¶çš„ç³»ç»Ÿä½¿ç”¨çš„å›¾åƒã€å£°éŸ³å’Œé™„å±æ ‡ç­¾çš„æ ¼å¼ã€‚ Exifæ•°æ®åµŒå…¥åœ¨å›¾åƒæ–‡ä»¶æœ¬èº«ä¸­ï¼ŒåŒ…å«å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚ç›¸æœºè®¾ç½®ã€æ—¥æœŸå’Œæ—¶é—´ã€åœ°ç†ä½ç½®ã€æ–¹å‘ã€è½¯ä»¶ä¿¡æ¯ã€æ¨¡å‹ç­‰ã€‚ å¦‚æœä½ æ˜¯ä¸€ä¸ªå–œæ¬¢åœ¨ä¸åŒç¤¾äº¤åª’ä½“å¹³å°ä¸Šé€šè¿‡å›¾åƒåˆ†äº«ä½ çš„å›å¿†çš„äººï¼Œè¿™ä¸ªè„šæœ¬é€‚åˆä½ ã€‚ è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬è·å–å›¾åƒè·¯å¾„ï¼Œæå–å›¾åƒä¸­çš„æ‰€æœ‰Exifè¯¦ç»†ä¿¡æ¯ï¼Œç„¶åå®Œå…¨åˆ é™¤å®ƒä»¬ä»¥ä¿æŠ¤ä½ çš„éšç§ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥Pillowåº“ä¸­çš„Imageæ¨¡å—å’ŒJpegImagePluginï¼ˆè™½ç„¶æœªç›´æ¥ä½¿ç”¨JpegImagePluginï¼‰</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#D19A66;">PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥ExifTagsæ¨¡å—ï¼Œç”¨äºè§£é‡Šå›¾åƒæ–‡ä»¶ä¸­çš„EXIFæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#D19A66;">PIL</span><span style="color:#ABB2BF;">.ExifTags </span><span style="color:#C678DD;">import</span><span style="color:#D19A66;"> TAGS</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰å‡½æ•°ï¼Œç”¨äºæå–å›¾åƒçš„EXIFæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">fetch_exif</span><span style="color:#ABB2BF;">(image_path):</span></span>
<span class="line"><span style="color:#C678DD;"> try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ‰“å¼€å›¾åƒæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;"> image </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(image_path)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–å›¾åƒçš„EXIFä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;"> exif_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> image.</span><span style="color:#61AFEF;">_getexif</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> exif_data </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> not</span><span style="color:#D19A66;"> None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¦‚æœEXIFä¿¡æ¯å­˜åœ¨ï¼Œå°†å…¶è½¬æ¢ä¸ºæ˜“è¯»çš„å­—å…¸æ ¼å¼</span></span>
<span class="line"><span style="color:#ABB2BF;"> exif_dict </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#D19A66;">TAGS</span><span style="color:#ABB2BF;">[key]:</span></span>
<span class="line"><span style="color:#ABB2BF;">exif_data[key] </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> key </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> exif_data.</span><span style="color:#61AFEF;">keys</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> key </span><span style="color:#C678DD;">in</span><span style="color:#D19A66;"> TAGS</span><span style="color:#C678DD;"> and</span></span>
<span class="line"><span style="color:#56B6C2;">isinstance</span><span style="color:#ABB2BF;">(exif_data[key], (</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">))}</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> exif_dict</span></span>
<span class="line"><span style="color:#C678DD;"> else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;No EXIF data found in</span></span>
<span class="line"><span style="color:#ABB2BF;">the image.</span><span style="color:#98C379;">&quot;)</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#C678DD;"> except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Error fetching EXIF data:</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#D19A66;"> None</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰å‡½æ•°ï¼Œç”¨äºåˆ é™¤å›¾åƒçš„EXIFæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">remove_exif</span><span style="color:#ABB2BF;">(image_path, output_path):</span></span>
<span class="line"><span style="color:#C678DD;"> try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ‰“å¼€å›¾åƒæ–‡ä»¶</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> image</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(image_path)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä¿å­˜å›¾åƒåˆ°æŒ‡å®šè·¯å¾„ï¼Œåˆ é™¤æ‰€æœ‰EXIFä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;"> image.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(output_path,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">exif</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;EXIF data removed and</span></span>
<span class="line"><span style="color:#98C379;">saved to </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">output_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;"> except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Error removing EXIF data:</span></span>
<span class="line"><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœè¿™ä¸ªè„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–ç”¨æˆ·è¾“å…¥çš„å›¾åƒè·¯å¾„</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> image_path</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> input</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Paste your Image path :</span></span>
<span class="line"><span style="color:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è°ƒç”¨å‡½æ•°æå–EXIFæ•°æ®</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> exif_data</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> fetch_exif</span><span style="color:#ABB2BF;">(image_path)</span></span>
<span class="line"><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> exif_data:</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;EXIF Data:&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ‰“å°å‡ºEXIFæ•°æ®ä¸­çš„æ¯ä¸ªé”®å€¼å¯¹</span></span>
<span class="line"><span style="color:#C678DD;"> for</span><span style="color:#ABB2BF;"> key, value </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> exif_data.</span><span style="color:#61AFEF;">items</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">key</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">value</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è°ƒç”¨å‡½æ•°åˆ é™¤EXIFæ•°æ®ï¼Œå¹¶ä¿å­˜æ–°å›¾åƒ</span></span>
<span class="line"><span style="color:#61AFEF;"> remove_exif</span><span style="color:#ABB2BF;">(image_path,</span></span>
<span class="line"><span style="color:#ABB2BF;">image_path</span><span style="color:#56B6C2;">+</span><span style="color:#98C379;">&#39;_noexif.png&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><h2 id="removebg" tabindex="-1">RemoveBG <a class="header-anchor" href="#removebg" aria-label="Permalink to &quot;RemoveBG&quot;">â€‹</a></h2><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬æ˜¯æˆ‘æ—¥å¸¸å·¥å…·åŒ…çš„ä¸€éƒ¨åˆ†ã€‚ä½œä¸ºä¸€åä½œå®¶ï¼Œæˆ‘ä¸€ç›´åœ¨å¤„ç†å›¾åƒï¼Œè€Œä¸”å¤§å¤šæ•°æ—¶é—´æˆ‘éœ€è¦æ²¡æœ‰èƒŒæ™¯çš„å›¾åƒã€‚ æœ‰è®¸å¤šåœ¨çº¿å·¥å…·å’Œè½¯ä»¶å¯ç”¨äºå»é™¤å›¾ç‰‡çš„èƒŒæ™¯ï¼Œä½†æˆ‘å¯¹å®ƒä»¬æ„Ÿåˆ°ä¸ä¿¡ä»»ï¼Œå› ä¸ºæˆ‘ä¸ç¡®å®šæˆ‘çš„å›¾ç‰‡åœ¨æä¾›ç»“æœä¹‹å‰åœ¨äº’è”ç½‘ä¸Šæ—…è¡Œåˆ°äº†å“ªé‡Œã€‚</p><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ä½¿ç”¨rembg pythonåŒ…åœ¨æœ¬åœ°åˆ é™¤å›¾åƒçš„èƒŒæ™¯ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥rembgåº“çš„removeå‡½æ•°ï¼Œç”¨äºèƒŒæ™¯å»é™¤</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">rembg </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> remove</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥Pillowåº“çš„Imageæ¨¡å—ï¼Œç”¨äºå›¾åƒæ“ä½œ</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#D19A66;">PIL</span><span style="color:#C678DD;"> import</span><span style="color:#ABB2BF;"> Image</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">##</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰è¾“å…¥å’Œè¾“å‡ºå›¾åƒçš„è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">input_img</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;monkey.jpg&#39;</span><span style="color:#7F848E;font-style:italic;">  # è¾“å…¥å›¾åƒæ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">output_img</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &#39;monkey_rmbg.png&#39;</span><span style="color:#7F848E;font-style:italic;">  # è¾“å‡ºï¼ˆå¤„ç†åï¼‰å›¾åƒæ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">##</span></span>
<span class="line"><span style="color:#ABB2BF;">åŠ è½½å’Œç§»é™¤èƒŒæ™¯</span></span>
<span class="line"><span style="color:#ABB2BF;">inp</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> Image.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(input_img)  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä½¿ç”¨Pillowçš„Image.openæ–¹æ³•æ‰“å¼€å›¾åƒæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">output</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> remove</span><span style="color:#ABB2BF;">(inp)  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨rembgçš„removeå‡½æ•°ç§»é™¤å›¾åƒçš„èƒŒæ™¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">##</span></span>
<span class="line"><span style="color:#ABB2BF;">ä¿å­˜å»èƒŒæ™¯åçš„å›¾åƒåˆ°è¾“å…¥å›¾åƒç›¸åŒçš„ä½ç½®</span></span>
<span class="line"><span style="color:#ABB2BF;">output.</span><span style="color:#61AFEF;">save</span><span style="color:#ABB2BF;">(output_img)  </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨Pillowçš„saveæ–¹æ³•ä¿å­˜å¤„ç†åçš„å›¾åƒ</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="filtertext" tabindex="-1">FilterText <a class="header-anchor" href="#filtertext" aria-label="Permalink to &quot;FilterText&quot;">â€‹</a></h2><p>Pythonæä¾›äº†è¿‡æ»¤å¤§é‡æ–‡æœ¬æ•°æ®å¹¶ä»ä¸­æå–æœ‰ç”¨ä¿¡æ¯çš„æœ€ç®€å•æ–¹æ³•ä¹‹ä¸€ã€‚Pythonå†…ç½®çš„reæ¨¡å—å¯ä»¥å¸®åŠ©ä½ ä½¿ç”¨Pythonç¼–å†™æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½ å¯ä»¥åˆ›å»ºä¸åŒçš„æ¨¡å¼ï¼Œå¹¶æ ¹æ®è¿™äº›æ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œè¿™ä½¿å¾—æ–‡æœ¬è¿‡æ»¤å˜å¾—æ›´åŠ å®¹æ˜“ã€‚è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬æ˜¯ä¸åŒæ–‡æœ¬è¿‡æ»¤å™¨çš„é›†åˆï¼ŒåŒ…æ‹¬ç”µå­é‚®ä»¶åœ°å€ã€HTMLæ ‡ç­¾å’Œç½‘é¡µé“¾æ¥ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥æ­£åˆ™è¡¨è¾¾å¼æ¨¡å—</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">re</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è¿‡æ»¤æ–‡æœ¬</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">filter_text</span><span style="color:#ABB2BF;">(text):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡æœ¬ä¸­çš„ç”µå­é‚®ä»¶åœ°å€</span></span>
<span class="line"><span style="color:#ABB2BF;"> emails </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">re.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;\b</span><span style="color:#D19A66;">[A-Za-z0-9._%+-]+</span><span style="color:#E06C75;">@</span><span style="color:#D19A66;">[A-Za-z0-9.-]+</span><span style="color:#56B6C2;">\.</span><span style="color:#D19A66;">[A-Z|a-z]{2,}</span><span style="color:#E06C75;">\b&#39;</span><span style="color:#ABB2BF;">, text)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡æœ¬ä¸­çš„TwitteræåŠï¼ˆå¦‚ï¼š@usernameï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;"> mentions </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;@\w</span><span style="color:#D19A66;">+</span><span style="color:#E06C75;">&#39;</span><span style="color:#ABB2BF;">, text)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡æœ¬ä¸­çš„è¯é¢˜æ ‡ç­¾ï¼ˆå¦‚ï¼š#hashtagï¼‰</span></span>
<span class="line"><span style="color:#ABB2BF;"> hashtags </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;#\w</span><span style="color:#D19A66;">+</span><span style="color:#E06C75;">&#39;</span><span style="color:#ABB2BF;">, text)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡æœ¬ä¸­çš„HTTPæˆ–HTTPSé“¾æ¥</span></span>
<span class="line"><span style="color:#ABB2BF;"> links </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">re.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;http</span><span style="color:#D19A66;">[s]?</span><span style="color:#E06C75;">://</span><span style="color:#D19A66;">(?:[a-zA-Z]</span><span style="color:#ABB2BF;">|</span><span style="color:#D19A66;">[0-9]</span><span style="color:#ABB2BF;">|</span><span style="color:#D19A66;">[$-_@.&amp;+]</span><span style="color:#ABB2BF;">|</span><span style="color:#D19A66;">[!*</span><span style="color:#56B6C2;">\\</span><span style="color:#D19A66;">(</span><span style="color:#56B6C2;">\\</span><span style="color:#D19A66;">),]</span><span style="color:#ABB2BF;">|</span><span style="color:#D19A66;">(?:</span><span style="color:#E06C75;">%</span><span style="color:#D19A66;">[0-9a-fA-F][0-9a-fA-F]))+</span><span style="color:#E06C75;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">text)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡æœ¬ä¸­çš„HTMLæ ‡ç­¾</span></span>
<span class="line"><span style="color:#ABB2BF;"> html_tags </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> re.</span><span style="color:#61AFEF;">findall</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">r</span><span style="color:#E06C75;">&#39;&lt;</span><span style="color:#D19A66;">[</span><span style="color:#ABB2BF;">^</span><span style="color:#D19A66;">&gt;]+</span><span style="color:#E06C75;">&gt;&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">text)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å°†æ‰¾åˆ°çš„æ‰€æœ‰ä¿¡æ¯æ‰“åŒ…æˆä¸€ä¸ªå­—å…¸è¿”å›</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;"> &#39;emails&#39;</span><span style="color:#ABB2BF;">: emails,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;mentions&#39;</span><span style="color:#ABB2BF;">: mentions,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;hashtags&#39;</span><span style="color:#ABB2BF;">: hashtags,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;links&#39;</span><span style="color:#ABB2BF;">: links,</span></span>
<span class="line"><span style="color:#98C379;"> &#39;html_tags&#39;</span><span style="color:#ABB2BF;">: html_tags,</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœè¿™ä¸ªè„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # ç¤ºä¾‹æ–‡æœ¬ï¼ŒåŒ…å«HTMLæ ‡ç­¾</span></span>
<span class="line"><span style="color:#ABB2BF;"> example_text </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;"> For more information, contact &lt;a</span></span>
<span class="line"><span style="color:#98C379;">href=&quot;support@example.com&quot;&gt;support@example.com&lt;/a&gt;.</span></span>
<span class="line"><span style="color:#98C379;"> Follow us on Twitter: @example_user. Visit</span></span>
<span class="line"><span style="color:#98C379;">our website: https://www.example.com</span></span>
<span class="line"><span style="color:#98C379;"> Join the conversation with</span></span>
<span class="line"><span style="color:#98C379;">#PythonProgramming.</span></span>
<span class="line"><span style="color:#98C379;"> Connect with John Doe at</span></span>
<span class="line"><span style="color:#98C379;">john.doe@example.com.</span></span>
<span class="line"><span style="color:#98C379;"> I love using Python for &lt;b&gt;natural</span></span>
<span class="line"><span style="color:#98C379;">language processing&lt;/b&gt; and sentiment analysis!</span></span>
<span class="line"><span style="color:#98C379;"> &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è°ƒç”¨filter_textå‡½æ•°ï¼Œè¿‡æ»¤ç¤ºä¾‹æ–‡æœ¬</span></span>
<span class="line"><span style="color:#ABB2BF;"> filtered_info </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> filter_text</span><span style="color:#ABB2BF;">(example_text)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ‰“å°è¿‡æ»¤å‡ºçš„å„ç±»ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Emails:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">filtered_info[</span><span style="color:#98C379;">&#39;emails&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Mentions:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">filtered_info[</span><span style="color:#98C379;">&#39;mentions&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Hashtags:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">filtered_info[</span><span style="color:#98C379;">&#39;hashtags&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Links:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">filtered_info[</span><span style="color:#98C379;">&#39;links&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;HTML Tags:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">filtered_info[</span><span style="color:#98C379;">&#39;html_tags&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240516212431669.Dh9YJ1Uk.png" alt="image-20240516212431669"></p><h2 id="emailheaders" tabindex="-1">EmailHeaders <a class="header-anchor" href="#emailheaders" aria-label="Permalink to &quot;EmailHeaders&quot;">â€‹</a></h2><p>ç”µå­é‚®ä»¶å¤´æ˜¯ç”µå­é‚®ä»¶æ¶ˆæ¯çš„å…ƒæ•°æ®ç»„æˆéƒ¨åˆ†ï¼Œæä¾›æœ‰å…³æ¶ˆæ¯èµ·æºã€ä¼ è¾“å’Œå†…å®¹çš„å…³é”®ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç”µå­é‚®ä»¶æ”¶ä»¶äººçœ‹ä¸åˆ°å®ƒä»¬ï¼Œä½†å¯ä»¥ä½¿ç”¨ç”µå­é‚®ä»¶å®¢æˆ·ç«¯åŠŸèƒ½æˆ–å·¥å…·æŸ¥çœ‹ã€‚ç”µå­é‚®ä»¶å¤´ç”±å„ç§å­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰ç‰¹å®šçš„ç”¨é€”ã€‚ ç”µå­é‚®ä»¶å¤´åœ¨ç¡®ä¿ç”µå­é‚®ä»¶ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€éªŒè¯æ¶ˆæ¯å¹¶æä¾›æœ‰å…³ç”µå­é‚®ä»¶èµ·æºçš„é€æ˜åº¦æ–¹é¢å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚å®ƒä»¬æœ‰åŠ©äºé˜²æ­¢åƒåœ¾é‚®ä»¶ï¼ŒéªŒè¯å‘ä»¶äººçš„èº«ä»½ï¼Œå¹¶ååŠ©è§£å†³ç”µå­é‚®ä»¶ä¼ é€’é—®é¢˜ã€‚ å¦‚æœä½ è¿˜æ²¡æœ‰çœ‹è¿‡ç”µå­é‚®ä»¶å¤´æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œç›¸ä¿¡æˆ‘ï¼Œå®ƒä»¬ä¸€ç‚¹ä¹Ÿä¸å¯è¯»ä¸”ä¸å‹å¥½ã€‚</p><p>è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬æ£€æµ‹å¹¶æå–ç”µå­é‚®ä»¶å¤´çš„é‡è¦éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è¯†åˆ«ç”µå­é‚®ä»¶æ˜¯å¦è¢«ç¯¡æ”¹ã€é€€å›æˆ–åŒ…å«æ¶æ„å†…å®¹ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥ç›¸å…³åº“</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">email</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">quopri</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">email </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> policy</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">email.parser </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> BytesParser  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä½¿ç”¨BytesParseræ¥è§£æäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰å‡½æ•°è§£æç”µå­é‚®ä»¶</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">parse_email</span><span style="color:#ABB2BF;">(file_path):</span></span>
<span class="line"><span style="color:#C678DD;"> with</span><span style="color:#56B6C2;"> open</span><span style="color:#ABB2BF;">(file_path, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#E06C75;"> file</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># ä»¥äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;"> msg </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#61AFEF;">BytesParser</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">policy</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">policy.default).</span><span style="color:#61AFEF;">parse</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;"># è§£æé‚®ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ‰“å°åŸºæœ¬çš„é‚®ä»¶å¤´éƒ¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;From:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;From&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># å‘é€è€…ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;To:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;To&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># æ¥æ”¶è€…ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Subject:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Subject&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># é‚®ä»¶ä¸»é¢˜</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Date:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Date&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># é‚®ä»¶å‘é€æ—¥æœŸ</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Message ID:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Message-ID&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># é‚®ä»¶å”¯ä¸€æ ‡è¯†</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;X-Mailer:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;X-Mailer&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># ä½¿ç”¨çš„é‚®ä»¶å®¢æˆ·ç«¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ‰“å°æ›´å¤šçš„é‚®ä»¶å¤´éƒ¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">--- Additional Information</span></span>
<span class="line"><span style="color:#FFFFFF;">--</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">\</span><span style="color:#FFFFFF;">n&quot;)</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;SPF:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Received-SPF&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># SPFéªŒè¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;DKIM:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;DKIM-Signature&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># DKIMç­¾å</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;DMARC:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;DMARC-Filter&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># DMARCç­–ç•¥</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;SENDERIP:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;X-Sender-IP&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># å‘é€è€…IP</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;RETURN PATH:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Return-Path&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># å›å¤è·¯å¾„</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Reply-To:&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Reply-To&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;N/A&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># å›å¤åˆ°å“ªä¸ªåœ°å€</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Authentication Results:</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Authentication-Results&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;N/A&#39;</span><span style="color:#ABB2BF;">)) </span><span style="color:#7F848E;font-style:italic;"># éªŒè¯ç»“æœ</span></span>
<span class="line"><span style="color:#56B6C2;"> print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Message ID&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">msg.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Message-Id&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;N/A&#39;</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># é‚®ä»¶IDï¼ˆé‡å¤ï¼‰</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # å¦‚æœéœ€è¦ï¼Œå¯ä»¥å–æ¶ˆæ³¨é‡Šä¸‹é¢çš„ä»£ç æ¥æ‰“å°å®Œæ•´çš„é‚®ä»¶å¤´éƒ¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> #print(&#39;\n\n\n\n&#39;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> #print(&quot;\n--- Email Headers</span></span>
<span class="line"><span style="color:#FFFFFF;">--</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">\</span><span style="color:#FFFFFF;">n&quot;)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> #print(msg.as_string())  # æ‰“å°å®Œæ•´çš„é‚®ä»¶å¤´éƒ¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ä¸»å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;"> email_file_path</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#98C379;">&quot;/content/Congrat!!.eml&quot;</span><span style="color:#7F848E;font-style:italic;">  #</span></span>
<span class="line"><span style="color:#ABB2BF;">æŒ‡å®šç”µå­é‚®ä»¶æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#61AFEF;"> parse_email</span><span style="color:#ABB2BF;">(email_file_path)  </span><span style="color:#7F848E;font-style:italic;"># è°ƒç”¨è§£æå‡½æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¦‚æœè¿™æ®µè„šæœ¬ä½œä¸ºä¸»ç¨‹åºæ‰§è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">if</span></span>
<span class="line"><span style="color:#E06C75;">__name__</span><span style="color:#56B6C2;"> ==</span><span style="color:#98C379;"> &quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h2 id="trendystocks" tabindex="-1">TrendyStocks <a class="header-anchor" href="#trendystocks" aria-label="Permalink to &quot;TrendyStocks&quot;">â€‹</a></h2><p>æœ‰å¥è¯è¯´â€”â€”â€œçœ‹å¾—è§çš„ä¸œè¥¿æ‰èƒ½å–å‡ºå»â€ åœ¨è‚¡å¸‚ä¸­ï¼Œæ„ŸçŸ¥æ˜¯ä¸€ç§å¼ºå¤§çš„å½±å“åŠ›ã€‚æ˜æ™ºçš„æŠ•èµ„è€…ä¸ä»…å…³æ³¨æ•°å­—ï¼Œè¿˜å…³æ³¨å¡‘é€ å¸‚åœºæ ¼å±€çš„å™è¿°ã€æ–°é—»å’Œæ–‡ç« ã€‚ äººä»¬è¶Šå¤šåœ°è°ˆè®ºä¸€åªè‚¡ç¥¨ï¼Œé€šå¸¸ä¼šæœ‰æ›´å¤šå…³äºå®ƒçš„æ–‡ç« å‘å¸ƒï¼Œè¿™æ„å‘³ç€å®ƒå‡ºäºå¥½çš„ç†ç”±æˆ–åçš„ç†ç”±è€Œæˆä¸ºçƒ­é—¨è¯é¢˜ã€‚äº†è§£å“ªäº›è‚¡ç¥¨æ­£åœ¨æµè¡Œå¯ä»¥å¸®åŠ©åšå‡ºæ›´å¥½çš„ä¹°å–å†³ç­–ã€‚è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ä½¿ç”¨Google Trendsä¸ºæŒ‡å®šçš„è‚¡ç¥¨ç”Ÿæˆå›¾è¡¨ã€‚</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å¯¼å…¥å¿…è¦çš„åº“</span></span>
<span class="line"><span style="color:#C678DD;">from</span></span>
<span class="line"><span style="color:#ABB2BF;">pytrends.request </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> TrendReq  </span><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ç”¨äºè¯·æ±‚Google Trendsæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">import</span></span>
<span class="line"><span style="color:#ABB2BF;">matplotlib.pyplot </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> plt  </span><span style="color:#7F848E;font-style:italic;"># ç”¨äºç»˜å›¾</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è·å–Google Trendsæ•°æ®</span></span>
<span class="line"><span style="color:#C678DD;">def</span></span>
<span class="line"><span style="color:#61AFEF;">get_google_trends_data</span><span style="color:#ABB2BF;">(keywords, </span><span style="color:#E06C75;font-style:italic;">timeframe</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;today 3-m&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">geo</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;US&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;"> pytrends </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> TrendReq</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">hl</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;en-US&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">tz</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">360</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># åˆ›å»ºTrendReqå¯¹è±¡ï¼Œè®¾ç½®è¯­è¨€å’Œæ—¶åŒº</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # æ„å»ºæŸ¥è¯¢çš„è½½è·ï¼Œè®¾ç½®å…³é”®è¯ã€æ—¶é—´èŒƒå›´å’Œåœ°åŒºç­‰å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;"> pytrends.</span><span style="color:#61AFEF;">build_payload</span><span style="color:#ABB2BF;">(keywords, </span><span style="color:#E06C75;font-style:italic;">cat</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">timeframe</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">timeframe, </span><span style="color:#E06C75;font-style:italic;">geo</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">geo, </span><span style="color:#E06C75;font-style:italic;">gprop</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # è·å–å…´è¶£éšæ—¶é—´çš„å˜åŒ–æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;"> interest_over_time_df </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">pytrends.</span><span style="color:#61AFEF;">interest_over_time</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;"> return</span><span style="color:#ABB2BF;"> interest_over_time_df  </span><span style="color:#7F848E;font-style:italic;"># è¿”å›å¾—åˆ°çš„æ•°æ®æ¡†(DataFrame)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ç¤ºä¾‹å…³é”®è¯ï¼Œè¿™é‡Œç”¨äº†å‡ ä¸ªå¤§å…¬å¸çš„è‚¡ç¥¨ä»£ç </span></span>
<span class="line"><span style="color:#D19A66;">STOCKS</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;AMZN&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;MSFT&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;NVDA&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;AAPL&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">&quot;GOOG&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">è·å–Google Trendsæ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">trends_data</span></span>
<span class="line"><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> get_google_trends_data</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">STOCKS</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#</span></span>
<span class="line"><span style="color:#ABB2BF;">ç»˜åˆ¶æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">plt.</span><span style="color:#61AFEF;">figure</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">figsize</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">))  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®å›¾å½¢çš„å¤§å°</span></span>
<span class="line"><span style="color:#ABB2BF;">trends_data.</span><span style="color:#61AFEF;">plot</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">title</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;Google</span></span>
<span class="line"><span style="color:#ABB2BF;">Trends </span><span style="color:#C678DD;">for</span><span style="color:#D19A66;"> STOCKS</span><span style="color:#98C379;">&#39;)  # ç»˜åˆ¶è¶‹åŠ¿æ•°æ®</span></span>
<span class="line"><span style="color:#ABB2BF;">plt.</span><span style="color:#61AFEF;">xlabel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Date&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># è®¾ç½®xè½´æ ‡ç­¾</span></span>
<span class="line"><span style="color:#ABB2BF;">plt.</span><span style="color:#61AFEF;">ylabel</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Interest</span></span>
<span class="line"><span style="color:#ABB2BF;">Over Time</span><span style="color:#98C379;">&#39;)  # è®¾ç½®yè½´æ ‡ç­¾</span></span>
<span class="line"><span style="color:#ABB2BF;">plt.</span><span style="color:#61AFEF;">show</span><span style="color:#ABB2BF;">()  </span><span style="color:#7F848E;font-style:italic;"># æ˜¾ç¤ºå›¾å½¢</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p><img src="/ProgramLearnNotes/assets/image-20240516212538600.CSM0yR6k.png" alt="image-20240516212538600"></p><h1 id="python-å®šæ—¶ä»»åŠ¡-8-ç§å®ç°æ–¹å¼" tabindex="-1">Python å®šæ—¶ä»»åŠ¡ 8 ç§å®ç°æ–¹å¼ <a class="header-anchor" href="#python-å®šæ—¶ä»»åŠ¡-8-ç§å®ç°æ–¹å¼" aria-label="Permalink to &quot;Python å®šæ—¶ä»»åŠ¡ 8 ç§å®ç°æ–¹å¼&quot;">â€‹</a></h1><h2 id="_1ã€thread-å®šæ—¶æ‰§è¡Œ-ğŸ”„" tabindex="-1">1ã€Thread å®šæ—¶æ‰§è¡Œ ğŸ”„ <a class="header-anchor" href="#_1ã€thread-å®šæ—¶æ‰§è¡Œ-ğŸ”„" aria-label="Permalink to &quot;1ã€Thread å®šæ—¶æ‰§è¡Œ ğŸ”„&quot;">â€‹</a></h2><p>åœ¨ Python ä¸­ï¼Œåˆ©ç”¨æ ‡å‡†åº“<code>threading</code>ä¸­çš„<code>Timer</code>ç±»å¯ä»¥è½»æ¾åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œè¿™å¯¹äºéœ€è¦åœ¨åå°ç‹¬ç«‹äºä¸»çº¿ç¨‹è¿è¡Œçš„ä»»åŠ¡ç‰¹åˆ«æœ‰ç”¨ã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨<code>threading.Timer</code>æ¥å®ç°å®šæ—¶ä»»åŠ¡ ï¼Œå¹¶æ¢è®¨å®šæ—¶ä»»åŠ¡çš„ç®¡ç†ä¸å–æ¶ˆç­–ç•¥ã€‚</p><h3 id="_1-1-ä½¿ç”¨-threading-timer-å®ç°" tabindex="-1">1.1 ä½¿ç”¨ <code>threading.Timer</code> å®ç° <a class="header-anchor" href="#_1-1-ä½¿ç”¨-threading-timer-å®ç°" aria-label="Permalink to &quot;1.1 ä½¿ç”¨ `threading.Timer` å®ç°&quot;">â€‹</a></h3><p><code>threading.Timer</code>ç±»å…è®¸ä½ å®‰æ’ä¸€ä¸ªå‡½æ•°åœ¨æŒ‡å®šæ—¶é—´åæ‰§è¡Œã€‚å®ƒé€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å®ç° ï¼Œä½¿å¾—å®šæ—¶ä»»åŠ¡ä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨<code>Timer</code>æ¯éš” 5 ç§’æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>import threading</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def hello():</span></span>
<span class="line"><span>    print(&quot;Hello, this is a timed message!&quot;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># åˆ›å»ºå®šæ—¶å™¨ ï¼Œ5ç§’åæ‰§è¡Œhelloå‡½æ•°</span></span>
<span class="line"><span>t = threading.Timer(5.0, hello)</span></span>
<span class="line"><span>t.start()  # å¼€å§‹è®¡æ—¶</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>Hello, this is a timed message!</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_1-2-å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸å–æ¶ˆç­–ç•¥" tabindex="-1">1.2 å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸å–æ¶ˆç­–ç•¥ <a class="header-anchor" href="#_1-2-å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸å–æ¶ˆç­–ç•¥" aria-label="Permalink to &quot;1.2 å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸å–æ¶ˆç­–ç•¥&quot;">â€‹</a></h3><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯èƒ½éœ€è¦æ ¹æ®æ¡ä»¶åŠ¨æ€ç®¡ç†å®šæ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚å–æ¶ˆå°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚<code>threading.Timer</code>å¯¹è±¡æä¾›äº†<code>cancel()</code>æ–¹æ³•æ¥å–æ¶ˆå°šæœªå¯åŠ¨çš„ä»»åŠ¡ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span># ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„helloå‡½æ•°ä¸ºä¾‹</span></span>
<span class="line"><span>t = threading.Timer(10.0, hello)  # æ”¹ä¸º10ç§’åæ‰§è¡Œ</span></span>
<span class="line"><span>t.start()</span></span>
<span class="line"><span></span></span>
<span class="line"><span># å‡è®¾åœ¨5ç§’åå†³å®šå–æ¶ˆè¿™ä¸ªå®šæ—¶ä»»åŠ¡</span></span>
<span class="line"><span>import time</span></span>
<span class="line"><span>time.sleep(5)</span></span>
<span class="line"><span>if t.is_alive():  # æ£€æŸ¥å®šæ—¶å™¨æ˜¯å¦è¿˜åœ¨è¿è¡Œ</span></span>
<span class="line"><span>    t.cancel()</span></span>
<span class="line"><span>    print(&quot;The timer has been cancelled.&quot;)</span></span>
<span class="line"><span>else:</span></span>
<span class="line"><span>    print(&quot;The timer has already executed.&quot;)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>è¾“å‡ºç»“æœï¼ˆå¦‚æœåœ¨ 5 ç§’å†…å–æ¶ˆäº†å®šæ—¶å™¨ï¼‰ï¼š</strong></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>The timer has been cancelled.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥çµæ´»åœ°æ§åˆ¶å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œï¼Œç¡®ä¿ç¨‹åºèƒ½å¤Ÿå“åº”å¤–éƒ¨æ¡ä»¶çš„å˜åŒ–ï¼Œæé«˜ç¨‹åºçš„çµæ´»æ€§å’Œæ•ˆç‡ã€‚åœ¨è®¾è®¡å¤æ‚çš„å®šæ—¶ä»»åŠ¡ç³»ç»Ÿæ—¶ ï¼Œè€ƒè™‘ä½¿ç”¨æ›´é«˜çº§çš„è°ƒåº¦åº“æˆ–æ¡†æ¶å¯èƒ½ä¼šæ›´åŠ åˆé€‚ï¼Œä½†<code>threading.Timer</code>å¯¹äºç®€å•éœ€æ±‚è€Œè¨€å·²ç»è¶³å¤Ÿé«˜æ•ˆä¸”æ˜“äºä½¿ç”¨ã€‚</p><h2 id="_2ã€schedule-åº“è‡ªåŠ¨åŒ–-ğŸ—“ï¸" tabindex="-1">2ã€Schedule åº“è‡ªåŠ¨åŒ– ğŸ—“ï¸ <a class="header-anchor" href="#_2ã€schedule-åº“è‡ªåŠ¨åŒ–-ğŸ—“ï¸" aria-label="Permalink to &quot;2ã€Schedule åº“è‡ªåŠ¨åŒ– ğŸ—“ï¸&quot;">â€‹</a></h2><h3 id="_2-1-å®‰è£…ä¸åŸºæœ¬ç”¨æ³•" tabindex="-1">2.1 å®‰è£…ä¸åŸºæœ¬ç”¨æ³• <a class="header-anchor" href="#_2-1-å®‰è£…ä¸åŸºæœ¬ç”¨æ³•" aria-label="Permalink to &quot;2.1 å®‰è£…ä¸åŸºæœ¬ç”¨æ³•&quot;">â€‹</a></h3><p><code>schedule</code>åº“æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Python å®šæ—¶ä»»åŠ¡åº“ï¼Œå®ƒå…è®¸ä½ ä»¥ç®€æ´çš„æ–¹å¼å®‰æ’å‡½æ•°å®šæœŸæ‰§è¡Œã€‚é¦–å…ˆï¼Œä½ éœ€è¦é€šè¿‡ pip å®‰è£…è¯¥åº“ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install schedule</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å®‰è£…å®Œæˆå ï¼Œä½ å¯ä»¥å¼€å§‹ç¼–å†™å®šæ—¶ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•æ¯ 10 ç§’é’Ÿæ‰“å°ä¸€æ¬¡â€œHello, Schedule!â€ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>import schedule</span></span>
<span class="line"><span>import time</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def job():</span></span>
<span class="line"><span>    print(&quot;Hello, Schedule!&quot;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># æ¯éš”10ç§’æ‰§è¡Œä¸€æ¬¡jobå‡½æ•°</span></span>
<span class="line"><span>schedule.every(10).seconds.do(job)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while True:</span></span>
<span class="line"><span>    schedule.run_pending()</span></span>
<span class="line"><span>    time.sleep(1)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿™æ®µä»£ç ä¼šæŒç»­è¿è¡Œï¼Œæ¯ 10 ç§’è¾“å‡ºä¸€æ¬¡æŒ‡å®šçš„ä¿¡æ¯ ï¼Œç›´åˆ°æ‰‹åŠ¨ä¸­æ–­ã€‚</p><h3 id="_2-2-é«˜çº§åŠŸèƒ½-é‡å¤ä»»åŠ¡ä¸å¼‚å¸¸å¤„ç†" tabindex="-1">2.2 é«˜çº§åŠŸèƒ½ï¼šé‡å¤ä»»åŠ¡ä¸å¼‚å¸¸å¤„ç† <a class="header-anchor" href="#_2-2-é«˜çº§åŠŸèƒ½-é‡å¤ä»»åŠ¡ä¸å¼‚å¸¸å¤„ç†" aria-label="Permalink to &quot;2.2 é«˜çº§åŠŸèƒ½ï¼šé‡å¤ä»»åŠ¡ä¸å¼‚å¸¸å¤„ç†&quot;">â€‹</a></h3><p><strong>é‡å¤ä»»åŠ¡</strong></p><p><code>schedule</code>åº“æ”¯æŒçµæ´»çš„æ—¶é—´é—´éš”è®¾ç½®ï¼Œé™¤äº†åŸºæœ¬çš„ç§’ã€åˆ†é’Ÿã€å°æ—¶ç­‰å•ä½å¤– ï¼Œè¿˜å¯ä»¥è®¾å®šç‰¹å®šæ—¥æœŸå’Œæ—¶é—´æ‰§è¡Œä»»åŠ¡ï¼Œæˆ–è€…æŒ‰å‘¨ã€æœˆé‡å¤æ‰§è¡Œã€‚</p><ul><li><strong>æ¯æ—¥ç‰¹å®šæ—¶é—´æ‰§è¡Œï¼š</strong></li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>schedule.every().day.at(&quot;10:30&quot;).do(job)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><strong>æ¯å‘¨ä¸€æ—©ä¸Š 9 ç‚¹æ‰§è¡Œï¼š</strong></li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>schedule.every().monday.at(&quot;09:00&quot;).do(job)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>å¼‚å¸¸å¤„ç†</strong></p><p>åœ¨é•¿æ—¶é—´è¿è¡Œçš„å®šæ—¶ä»»åŠ¡ä¸­ ï¼Œå¼‚å¸¸å¤„ç†è‡³å…³é‡è¦ã€‚å¯ä»¥é€šè¿‡ try-except ç»“æ„æ¥æ•è·å¹¶é€‚å½“å¤„ç†ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ ï¼Œç¡®ä¿å®šæ—¶ä»»åŠ¡æ¡†æ¶çš„ç¨³å®šè¿è¡Œã€‚ä¾‹å¦‚ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>import schedule</span></span>
<span class="line"><span>import time</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def safe_job():</span></span>
<span class="line"><span>    try:</span></span>
<span class="line"><span>        # å‡è®¾è¿™æ˜¯å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»£ç </span></span>
<span class="line"><span>        ...</span></span>
<span class="line"><span>    except Exception as e:</span></span>
<span class="line"><span>        print(f&quot;An error occurred: {e}&quot;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>schedule.every(5).seconds.do(safe_job)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while True:</span></span>
<span class="line"><span>    schedule.run_pending()</span></span>
<span class="line"><span>    time.sleep(1)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå³ä½¿<code>safe_job</code>å†…éƒ¨çš„ä»£ç å‘ç”Ÿå¼‚å¸¸ ï¼Œç¨‹åºä¹Ÿä¸ä¼šç›´æ¥å´©æºƒ ï¼Œè€Œæ˜¯ä¼šæ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ ï¼Œç„¶åç»§ç»­ç­‰å¾…ä¸‹ä¸€ä¸ªæ‰§è¡Œå‘¨æœŸã€‚</p><p>é€šè¿‡ä¸Šè¿°ä»‹ç»ï¼Œå¯ä»¥çœ‹åˆ°<code>schedule</code>åº“å‡­å€Ÿå…¶ç®€æ´çš„ API è®¾è®¡ï¼Œæˆä¸ºäº†å¤„ç†å®šæ—¶ä»»åŠ¡çš„ä¸€ä¸ªå¼ºå¤§å·¥å…· ï¼Œæ— è®ºæ˜¯ç®€å•çš„é‡å¤ä»»åŠ¡è¿˜æ˜¯éœ€è¦å¤æ‚æ—¶é—´å®‰æ’çš„ä»»åŠ¡ï¼Œéƒ½èƒ½è½»æ¾åº”å¯¹ã€‚</p><h2 id="_3ã€apscheduler-æ¡†æ¶-ğŸ””" tabindex="-1">3ã€APScheduler æ¡†æ¶ ğŸ”” <a class="header-anchor" href="#_3ã€apscheduler-æ¡†æ¶-ğŸ””" aria-label="Permalink to &quot;3ã€APScheduler æ¡†æ¶ ğŸ””&quot;">â€‹</a></h2><h3 id="_3-1-åŠŸèƒ½å¼ºå¤§çš„å®šæ—¶ä»»åŠ¡åº“" tabindex="-1">3.1 åŠŸèƒ½å¼ºå¤§çš„å®šæ—¶ä»»åŠ¡åº“ <a class="header-anchor" href="#_3-1-åŠŸèƒ½å¼ºå¤§çš„å®šæ—¶ä»»åŠ¡åº“" aria-label="Permalink to &quot;3.1 åŠŸèƒ½å¼ºå¤§çš„å®šæ—¶ä»»åŠ¡åº“&quot;">â€‹</a></h3><p><code>APScheduler</code>ï¼ˆAdvanced Python Schedulerï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å…¨é¢ä¸”é«˜åº¦å¯å®šåˆ¶çš„å®šæ—¶ä»»åŠ¡åº“ï¼Œé€‚ç”¨äº Python 3.5 åŠæ›´é«˜ç‰ˆæœ¬ã€‚å®ƒæ”¯æŒ cron é£æ ¼çš„æ—¶é—´è¡¨è¾¾å¼ã€æ—¥æœŸæ—¶é—´ä»¥åŠå›ºå®šé—´éš”ç­‰å¤šç§è§¦å‘æ–¹å¼ï¼ŒåŒæ—¶å…·å¤‡æŒä¹…åŒ–ä»»åŠ¡ã€é”™è¯¯å¤„ç†ã€ä»»åŠ¡å­˜å‚¨æ’ä»¶ç­‰é«˜çº§ç‰¹æ€§ï¼Œéå¸¸é€‚åˆæ„å»ºå¤æ‚ä¸”å¥å£®çš„å®šæ—¶ä»»åŠ¡ç³»ç»Ÿã€‚</p><p>è¦å¼€å§‹ä½¿ç”¨<code>APScheduler</code>ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡ pip å®‰è£…ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install apscheduler</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>æ¥ç€ï¼Œå¯ä»¥å¿«é€Ÿä¸Šæ‰‹ä¸€ä¸ªç®€å•çš„å®šæ—¶ä»»åŠ¡ç¤ºä¾‹ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from apscheduler.schedulers.blocking import BlockingScheduler</span></span>
<span class="line"><span>import datetime</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def my_job():</span></span>
<span class="line"><span>    print(&quot;Job executed at &quot; + str(datetime.datetime.now()))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>scheduler = BlockingScheduler()</span></span>
<span class="line"><span>scheduler.add_job(my_job, &#39;interval&#39;, seconds=5)</span></span>
<span class="line"><span>scheduler.start()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>è¿™æ®µä»£ç ä¼šæ¯éš” 5 ç§’æ‰§è¡Œä¸€æ¬¡<code>my_job</code>å‡½æ•°ï¼Œæ‰“å°å½“å‰æ—¶é—´ã€‚</p><h3 id="_3-2-ä¸åŒç±»å‹çš„è§¦å‘å™¨ä»‹ç»" tabindex="-1">3.2 ä¸åŒç±»å‹çš„è§¦å‘å™¨ä»‹ç» <a class="header-anchor" href="#_3-2-ä¸åŒç±»å‹çš„è§¦å‘å™¨ä»‹ç»" aria-label="Permalink to &quot;3.2 ä¸åŒç±»å‹çš„è§¦å‘å™¨ä»‹ç»&quot;">â€‹</a></h3><p><code>APScheduler</code>æä¾›äº†å¤šç§è§¦å‘å™¨æ¥é€‚åº”ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼š</p><ul><li><strong>IntervalTrigger</strong>ï¼šç”¨äºåœ¨å›ºå®šæ—¶é—´é—´éš”åé‡å¤æ‰§è¡Œä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œæ¯éš” 5 ç§’æ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from apscheduler.schedulers.blocking import BlockingScheduler</span></span>
<span class="line"><span></span></span>
<span class="line"><span>scheduler = BlockingScheduler()</span></span>
<span class="line"><span>scheduler.add_job(my_job, &#39;interval&#39;, seconds=5)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>CronTrigger</strong>ï¼šç±»ä¼¼äº Linux çš„ cronï¼Œæ”¯æŒå¤æ‚çš„å‘¨æœŸæ€§è®¡åˆ’ï¼Œå¦‚æ¯å¤©å‡Œæ™¨ 1 ç‚¹æ‰§è¡Œã€‚</li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from apscheduler.triggers.cron import CronTrigger</span></span>
<span class="line"><span>from apscheduler.schedulers.blocking import BlockingScheduler</span></span>
<span class="line"><span></span></span>
<span class="line"><span>trigger = CronTrigger(hour=1, minute=0)  # æ¯å¤©å‡Œæ™¨1ç‚¹æ‰§è¡Œ</span></span>
<span class="line"><span>scheduler = BlockingScheduler()</span></span>
<span class="line"><span>scheduler.add_job(my_job, trigger)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><strong>DateTrigger</strong>ï¼šåœ¨ç‰¹å®šçš„æ—¥æœŸå’Œæ—¶é—´åªæ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from apscheduler.triggers.date import DateTrigger</span></span>
<span class="line"><span>from apscheduler.schedulers.blocking import BlockingScheduler</span></span>
<span class="line"><span></span></span>
<span class="line"><span>trigger = DateTrigger(run_date=datetime.datetime(2023, 4, 1))  # åœ¨2023å¹´4æœˆ1æ—¥æ‰§è¡Œ</span></span>
<span class="line"><span>scheduler = BlockingScheduler()</span></span>
<span class="line"><span>scheduler.add_job(my_job, trigger)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™äº›è§¦å‘å™¨ä½¿å¾—<code>APScheduler</code>èƒ½å¤Ÿçµæ´»é€‚åº”å„ç§å®šæ—¶ä»»åŠ¡éœ€æ±‚ï¼Œä»ç®€å•çš„å®šæ—¶æé†’åˆ°å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å®šæ—¶å¤„ç†ï¼Œéƒ½èƒ½è½»æ¾åº”å¯¹ã€‚é€šè¿‡åˆç†é€‰æ‹©è§¦å‘å™¨ç±»å‹å’Œé…ç½® ï¼Œå¯ä»¥æ„å»ºå‡ºæ—¢é«˜æ•ˆåˆå¯é çš„å®šæ—¶ä»»åŠ¡è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="_4ã€åŸºäº-unix-cron-çš„-python-å®ç°-ğŸ•’" tabindex="-1">4ã€åŸºäº Unix Cron çš„ Python å®ç° ğŸ•’ <a class="header-anchor" href="#_4ã€åŸºäº-unix-cron-çš„-python-å®ç°-ğŸ•’" aria-label="Permalink to &quot;4ã€åŸºäº Unix Cron çš„ Python å®ç° ğŸ•’&quot;">â€‹</a></h2><h3 id="_4-1-å­¦ä¹ -linux-crontab-è¯­æ³•" tabindex="-1">4.1 å­¦ä¹  Linux Crontab è¯­æ³• <a class="header-anchor" href="#_4-1-å­¦ä¹ -linux-crontab-è¯­æ³•" aria-label="Permalink to &quot;4.1 å­¦ä¹  Linux Crontab è¯­æ³•&quot;">â€‹</a></h3><p>Cron æ˜¯ Unix/Linux ç³»ç»Ÿä¸­ç”¨äºå®šæ—¶æ‰§è¡Œä»»åŠ¡çš„å¼ºå¤§å·¥å…·ã€‚Crontab æ–‡ä»¶åŒ…å«äº†å®šæ—¶ä»»åŠ¡çš„åˆ—è¡¨ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½éµå¾ªä¸€ä¸ªç‰¹å®šçš„è¯­æ³•æ¥å®šä¹‰ä½•æ—¶æ‰§è¡Œã€‚Cron è¯­æ³•ç”±å…­ä¸ªå­—æ®µç»„æˆï¼Œåˆ†åˆ«ä»£è¡¨åˆ†é’Ÿã€å°æ—¶ã€ä¸€å¤©ä¸­çš„å“ªä¸€å¤©ã€æœˆä»½ã€ä¸€å‘¨ä¸­çš„å“ªä¸€å¤©å’Œå‘½ä»¤ã€‚å­—æ®µä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>* * * * * command_to_execute</span></span>
<span class="line"><span>- - - - -</span></span>
<span class="line"><span>| | | | |</span></span>
<span class="line"><span>| | | | +--- æ˜ŸæœŸå‡  (0 - 6) ï¼Œ0 å’Œ 7 éƒ½ä»£è¡¨å‘¨æ—¥</span></span>
<span class="line"><span>| | | +----- æœˆä»½ (1 - 12)</span></span>
<span class="line"><span>| | +------- ä¸€ä¸ªæœˆä¸­çš„å“ªä¸€å¤© (1 - 31)</span></span>
<span class="line"><span>| +--------- å°æ—¶ (0 - 23)</span></span>
<span class="line"><span>+----------- åˆ†é’Ÿ (0 - 59)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ç‰¹æ®Šç¬¦å·å«ä¹‰ï¼š</p><ul><li><code>*</code> è¡¨ç¤ºä»»ä½•å€¼éƒ½åŒ¹é…ï¼Œå¦‚<code>*</code>åœ¨åˆ†é’Ÿå­—æ®µæ„å‘³ç€â€œæ¯åˆ†é’Ÿâ€ã€‚</li><li><code>,</code> ç”¨äºåˆ†éš”å¤šä¸ªå€¼ ï¼Œå¦‚<code>3,15</code>è¡¨ç¤ºç¬¬ 3 åˆ†é’Ÿå’Œç¬¬ 15 åˆ†é’Ÿã€‚</li><li><code>-</code> è¡¨ç¤ºèŒƒå›´ï¼Œå¦‚<code>1-5</code>è¡¨ç¤ºä»ç¬¬ 1 åˆ°ç¬¬ 5 åˆ†é’Ÿã€‚</li><li><code>/</code> è¡¨ç¤ºé—´éš”ï¼Œå¦‚<code>*/2</code>è¡¨ç¤ºæ¯éš” 2 åˆ†é’Ÿã€‚</li></ul><h3 id="_4-2-python-è„šæœ¬ä¸ç³»ç»Ÿ-cron-ç»“åˆ" tabindex="-1">4.2 Python è„šæœ¬ä¸ç³»ç»Ÿ Cron ç»“åˆ <a class="header-anchor" href="#_4-2-python-è„šæœ¬ä¸ç³»ç»Ÿ-cron-ç»“åˆ" aria-label="Permalink to &quot;4.2 Python è„šæœ¬ä¸ç³»ç»Ÿ Cron ç»“åˆ&quot;">â€‹</a></h3><p>å°† Python è„šæœ¬ä¸ Cron ç»“åˆï¼Œå¯ä»¥å®ç°ç³»ç»Ÿçš„å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒ–ã€‚é¦–å…ˆï¼Œä½ éœ€è¦å‡†å¤‡ä¸€ä¸ª Python è„šæœ¬ï¼Œå‡è®¾è„šæœ¬åä¸º<code>my_script.py</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>#!/usr/bin/env python3</span></span>
<span class="line"><span># my_script.py</span></span>
<span class="line"><span>import datetime</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def main():</span></span>
<span class="line"><span>    now = datetime.datetime.now()</span></span>
<span class="line"><span>    print(f&quot;Python script ran at {now}&quot;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if __name__ == &quot;__main__&quot;:</span></span>
<span class="line"><span>    main()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ç¡®ä¿è¯¥è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼Œå¯é€šè¿‡å‘½ä»¤è¡Œèµ‹äºˆï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>chmod +x my_script.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>æ¥ä¸‹æ¥ï¼Œå°†æ­¤è„šæœ¬æ·»åŠ åˆ° Cron è®¡åˆ’ä¸­ã€‚ç¼–è¾‘ä½ çš„ crontab æ–‡ä»¶ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>crontab -e</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>åœ¨æ‰“å¼€çš„æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€è¡Œæ¥å®‰æ’ä»»åŠ¡ï¼Œä¾‹å¦‚æ¯å¤©æ—©ä¸Š 6 ç‚¹æ‰§è¡Œï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>0 6 * * * /path/to/your/my_script.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>è¿™é‡Œ<code>/path/to/your/my_script.py</code>æ˜¯è„šæœ¬çš„ç»å¯¹è·¯å¾„ã€‚ä¿å­˜é€€å‡ºåï¼ŒCron å°†è‡ªåŠ¨åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œè¯¥ Python è„šæœ¬ã€‚è®°å¾—æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ï¼ˆå¦‚<code>/var/log/syslog</code>ï¼‰ä»¥ç¡®è®¤ä»»åŠ¡æ˜¯å¦æŒ‰é¢„æœŸæ‰§è¡Œ ï¼Œä»¥åŠæ˜¯å¦æœ‰ä»»ä½•é”™è¯¯ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¿™ç§ç»“åˆæ–¹å¼ï¼Œä½ å¯ä»¥å……åˆ†åˆ©ç”¨ Cron çš„æˆç†Ÿå®šæ—¶æœºåˆ¶æ¥è°ƒåº¦ Python è„šæœ¬æ‰§è¡Œï¼Œæ— éœ€åœ¨ Python ç¨‹åºå†…éƒ¨å®ç°å¤æ‚çš„å®šæ—¶é€»è¾‘ã€‚</p><h2 id="_5ã€tornado-å¼‚æ­¥å®šæ—¶ä»»åŠ¡-ğŸ”„" tabindex="-1">5ã€Tornado å¼‚æ­¥å®šæ—¶ä»»åŠ¡ ğŸ”„ <a class="header-anchor" href="#_5ã€tornado-å¼‚æ­¥å®šæ—¶ä»»åŠ¡-ğŸ”„" aria-label="Permalink to &quot;5ã€Tornado å¼‚æ­¥å®šæ—¶ä»»åŠ¡ ğŸ”„&quot;">â€‹</a></h2><h3 id="_5-1-tornado-äº‹ä»¶å¾ªç¯åŸºç¡€" tabindex="-1">5.1 Tornado äº‹ä»¶å¾ªç¯åŸºç¡€ <a class="header-anchor" href="#_5-1-tornado-äº‹ä»¶å¾ªç¯åŸºç¡€" aria-label="Permalink to &quot;5.1 Tornado äº‹ä»¶å¾ªç¯åŸºç¡€&quot;">â€‹</a></h3><p>Tornado æ˜¯ä¸€ä¸ª Python ç½‘ç»œåº“ï¼Œä»¥å…¶å¼‚æ­¥éé˜»å¡ IO å’Œé«˜å¹¶å‘èƒ½åŠ›è‘—ç§°ï¼Œç‰¹åˆ«é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ Web æœåŠ¡å’Œå®æ—¶åº”ç”¨ã€‚å…¶æ ¸å¿ƒåœ¨äº<code>IOLoop</code> ï¼Œè¿™æ˜¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ ï¼Œè´Ÿè´£ç›‘å¬å’Œå¤„ç† I/O äº‹ä»¶ï¼Œå¦‚ç½‘ç»œè¿æ¥ã€è¶…æ—¶ã€ä¿¡å·ç­‰ï¼Œä»¥åŠè°ƒåº¦å›è°ƒå‡½æ•°ã€‚</p><p>åœ¨ Tornado ä¸­ï¼Œæ‰€æœ‰çš„å¼‚æ­¥æ“ä½œéƒ½å›´ç»•ç€<code>IOLoop</code>å±•å¼€ã€‚å½“ä½ å¯åŠ¨ä¸€ä¸ª Tornado åº”ç”¨æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨å¯åŠ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯ã€‚é€šè¿‡å°†è€—æ—¶çš„æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ï¼‰å¼‚æ­¥åŒ–ï¼ŒTornado èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å¤§é‡å¹¶å‘è¿æ¥ï¼Œè€Œæ— éœ€ä¸ºæ¯ä¸ªè¿æ¥åˆ†é…å•ç‹¬çš„çº¿ç¨‹æˆ–è¿›ç¨‹ã€‚</p><h3 id="_5-2-åˆ©ç”¨-ioloop-å®‰æ’å®šæ—¶ä»»åŠ¡" tabindex="-1">5.2 åˆ©ç”¨ IOLoop å®‰æ’å®šæ—¶ä»»åŠ¡ <a class="header-anchor" href="#_5-2-åˆ©ç”¨-ioloop-å®‰æ’å®šæ—¶ä»»åŠ¡" aria-label="Permalink to &quot;5.2 åˆ©ç”¨ IOLoop å®‰æ’å®šæ—¶ä»»åŠ¡&quot;">â€‹</a></h3><p>Tornado çš„<code>IOLoop</code>æä¾›äº†<code>call_later</code>ã€<code>call_at</code>ç­‰æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®‰æ’ä¸€æ¬¡æ€§æˆ–å‘¨æœŸæ€§çš„å®šæ—¶ä»»åŠ¡ã€‚è¿™äº›æ–¹æ³•ä¸é˜»å¡ä¸»äº‹ä»¶å¾ªç¯ï¼Œå› æ­¤éå¸¸é€‚åˆåœ¨å¼‚æ­¥ç¯å¢ƒä¸­æ‰§è¡Œå®šæ—¶æ“ä½œã€‚</p><p><strong>ä¸€æ¬¡æ€§å®šæ—¶ä»»åŠ¡ç¤ºä¾‹</strong></p><p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>IOLoop.call_later</code>åœ¨ 5 ç§’åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>import tornado.ioloop</span></span>
<span class="line"><span>import time</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def print_time():</span></span>
<span class="line"><span>    print(&quot;Current time:&quot;, time.ctime())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>tornado.ioloop.IOLoop.current().call_later(5, print_time)  # 5ç§’åæ‰§è¡Œprint_time</span></span>
<span class="line"><span>tornado.ioloop.IOLoop.current().start()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>å‘¨æœŸæ€§å®šæ—¶ä»»åŠ¡ç¤ºä¾‹</strong></p><p>è‹¥è¦å®ç°å‘¨æœŸæ€§æ‰§è¡Œï¼Œå¯ä»¥ç»“åˆ<code>call_later</code>å’Œå‡½æ•°è‡ªèº«è°ƒç”¨æ¥é‡æ–°å®‰æ’ä¸‹ä¸€æ¬¡æ‰§è¡Œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ¯ä¸¤ç§’æ‰“å°æ—¶é—´çš„ç¤ºä¾‹ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>import tornado.ioloop</span></span>
<span class="line"><span>import time</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def periodic_callback():</span></span>
<span class="line"><span>    print(&quot;Current time:&quot;, time.ctime())</span></span>
<span class="line"><span>    tornado.ioloop.IOLoop.current().call_later(2, periodic_callback)  # æ¯2ç§’è°ƒç”¨ä¸€æ¬¡</span></span>
<span class="line"><span></span></span>
<span class="line"><span>tornado.ioloop.IOLoop.current().call_later(2, periodic_callback)  # é¦–æ¬¡è°ƒåº¦</span></span>
<span class="line"><span>tornado.ioloop.IOLoop.current().start()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ ï¼Œå¯ä»¥çœ‹å‡º Tornado çš„<code>IOLoop</code>ä¸ºå¼‚æ­¥å®šæ—¶ä»»åŠ¡æä¾›äº†ä¸€ç§é«˜æ•ˆã€çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼Œå°¤å…¶é€‚åˆé‚£äº›éœ€è¦åœ¨é«˜æ€§èƒ½æœåŠ¡å™¨ç«¯åº”ç”¨ä¸­é›†æˆå®šæ—¶å¤„ç†é€»è¾‘çš„åœºæ™¯ã€‚</p><h2 id="_6ã€celery-åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—-â°" tabindex="-1">6ã€Celery åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ— â° <a class="header-anchor" href="#_6ã€celery-åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—-â°" aria-label="Permalink to &quot;6ã€Celery åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ— â°&quot;">â€‹</a></h2><h3 id="_6-1-celery-ç®€ä»‹ä¸å®‰è£…éƒ¨ç½²" tabindex="-1">6.1 Celery ç®€ä»‹ä¸å®‰è£…éƒ¨ç½² <a class="header-anchor" href="#_6-1-celery-ç®€ä»‹ä¸å®‰è£…éƒ¨ç½²" aria-label="Permalink to &quot;6.1 Celery ç®€ä»‹ä¸å®‰è£…éƒ¨ç½²&quot;">â€‹</a></h3><p>Celery æ˜¯ä¸€æ¬¾å¹¿æ³›ä½¿ç”¨çš„åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿï¼Œé€‚ç”¨äºå¤„ç†å¤§é‡æ¶ˆæ¯å’Œåå°ä»»åŠ¡ï¼Œç‰¹åˆ«æ˜¯é‚£äº›éœ€è¦å¼‚æ­¥å¤„ç†æˆ–å®šæ—¶æ‰§è¡Œçš„ä»»åŠ¡ã€‚å®ƒæ”¯æŒå¤šç§æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆå¦‚ RabbitMQã€Redisï¼‰ä½œä¸ºä»»åŠ¡ä»£ç†ï¼Œç¡®ä¿äº†ä»»åŠ¡çš„å¯é ä¼ é€’ä¸é«˜å¯ç”¨æ€§ã€‚</p><p><strong>å®‰è£…</strong></p><p>é¦–å…ˆï¼Œç¡®ä¿å®‰è£…äº† Python ç¯å¢ƒã€‚æ¥ç€ï¼Œé€šè¿‡ pip å®‰è£… Celery åŠå…¶ä¾èµ–ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install celery[redis]  # ä»¥Redisä¸ºæ¶ˆæ¯ä¸­é—´ä»¶å®‰è£…</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_6-2-å®šæ—¶ä»»åŠ¡è°ƒåº¦ä¸ç›‘æ§" tabindex="-1">6.2 å®šæ—¶ä»»åŠ¡è°ƒåº¦ä¸ç›‘æ§ <a class="header-anchor" href="#_6-2-å®šæ—¶ä»»åŠ¡è°ƒåº¦ä¸ç›‘æ§" aria-label="Permalink to &quot;6.2 å®šæ—¶ä»»åŠ¡è°ƒåº¦ä¸ç›‘æ§&quot;">â€‹</a></h3><p>Celery æä¾›äº†ä¸°å¯Œçš„å®šæ—¶ä»»åŠ¡åŠŸèƒ½ï¼Œä¸»è¦é€šè¿‡<code>beat</code>æœåŠ¡å’Œ<code>crontab</code>é£æ ¼çš„è°ƒåº¦è¡¨è¾¾å¼æ¥å®ç°ã€‚</p><p><strong>å®šæ—¶ä»»åŠ¡é…ç½®</strong></p><p>åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>celery.py</code>æ–‡ä»¶ï¼Œé…ç½®å®šæ—¶ä»»åŠ¡ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from celery import Celery</span></span>
<span class="line"><span>app = Celery(&#39;tasks&#39;, broker=&#39;redis://localhost:6379/0&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>@app.task</span></span>
<span class="line"><span>def send_email_report():</span></span>
<span class="line"><span>    print(&quot;Sending email report...&quot;)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ç„¶åï¼Œåœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­é…ç½®å®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼ˆä¾‹å¦‚åœ¨<code>tasks.py</code>ä¸­ï¼‰ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from celery.schedules import crontab</span></span>
<span class="line"><span>from .celery import app</span></span>
<span class="line"><span></span></span>
<span class="line"><span>app.conf.beat_schedule = {</span></span>
<span class="line"><span>    &#39;send-email-every-day&#39;: {</span></span>
<span class="line"><span>        &#39;task&#39;: &#39;tasks.send_email_report&#39;,</span></span>
<span class="line"><span>        &#39;schedule&#39;: crontab(hour=0, minute=0),  # æ¯å¤©å‡Œæ™¨æ‰§è¡Œ</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>è¿è¡Œ Celery æœåŠ¡</strong></p><p>å¯åŠ¨ Celery worker å¤„ç†ä»»åŠ¡ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>celery -A tasks worker --loglevel=info</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>åŒæ—¶ï¼Œå¯åŠ¨<code>beat</code>æœåŠ¡ä»¥é©±åŠ¨å®šæ—¶ä»»åŠ¡ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>celery beat -A tasks --loglevel=info</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>ç›‘æ§</strong></p><p>Celery æä¾›äº†å®æ—¶ç›‘æ§å·¥å…· Flowerï¼Œå¯ä»¥æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€ã€è¿›åº¦å’Œç»“æœã€‚å®‰è£… Flower å¹¶è¿è¡Œï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install flower</span></span>
<span class="line"><span>flower -A tasks --port=5555</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è®¿é—®<code>http://localhost:5555</code>å³å¯æŸ¥çœ‹ç›‘æ§ç•Œé¢ã€‚</p><p>é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°åœ¨ Python åº”ç”¨ä¸­é›†æˆ Celery å®ç°åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡å¤„ç† ï¼Œä¸ä»…æé«˜äº†ä»»åŠ¡å¤„ç†çš„æ•ˆç‡å’Œå¯é æ€§ï¼Œè¿˜ä¾¿äºç›‘æ§å’Œç®¡ç†ã€‚</p><h2 id="_7ã€ä½¿ç”¨-asyncio-å®ç°å¼‚æ­¥å®šæ—¶-ğŸ”„" tabindex="-1">7ã€ä½¿ç”¨ asyncio å®ç°å¼‚æ­¥å®šæ—¶ ğŸ”„ <a class="header-anchor" href="#_7ã€ä½¿ç”¨-asyncio-å®ç°å¼‚æ­¥å®šæ—¶-ğŸ”„" aria-label="Permalink to &quot;7ã€ä½¿ç”¨ asyncio å®ç°å¼‚æ­¥å®šæ—¶ ğŸ”„&quot;">â€‹</a></h2><h3 id="_7-1-å¼‚æ­¥ç¼–ç¨‹åŸºç¡€å›é¡¾" tabindex="-1">7.1 å¼‚æ­¥ç¼–ç¨‹åŸºç¡€å›é¡¾ <a class="header-anchor" href="#_7-1-å¼‚æ­¥ç¼–ç¨‹åŸºç¡€å›é¡¾" aria-label="Permalink to &quot;7.1 å¼‚æ­¥ç¼–ç¨‹åŸºç¡€å›é¡¾&quot;">â€‹</a></h3><p>åœ¨ Python ä¸­ï¼Œ<code>asyncio</code>æ˜¯ä¸€ä¸ªç”¨äºç¼–å†™å¹¶å‘ä»£ç çš„åº“ï¼Œåˆ©ç”¨åç¨‹(coroutine)ã€äº‹ä»¶å¾ªç¯(event loop)å’Œä»»åŠ¡(task)ç­‰æ¦‚å¿µ ï¼Œå®ç°äº†å¼‚æ­¥ IO æ“ä½œã€‚åç¨‹æ˜¯ä¸€ç§è½»é‡çº§çš„å­ä¾‹ç¨‹ï¼Œå¯ä»¥åœ¨ç­‰å¾… IO æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€ç£ç›˜è¯»å†™ï¼‰æœŸé—´æŒ‚èµ·ï¼Œä»è€Œä½¿å…¶ä»–ä»»åŠ¡å¾—ä»¥æ‰§è¡Œï¼Œæé«˜äº†ç¨‹åºçš„æ•ˆç‡å’Œå“åº”é€Ÿåº¦ã€‚</p><h3 id="_7-2-asyncio-å®ç°å®šæ—¶æ‰§è¡Œæ¡ˆä¾‹" tabindex="-1">7.2 asyncio å®ç°å®šæ—¶æ‰§è¡Œæ¡ˆä¾‹ <a class="header-anchor" href="#_7-2-asyncio-å®ç°å®šæ—¶æ‰§è¡Œæ¡ˆä¾‹" aria-label="Permalink to &quot;7.2 asyncio å®ç°å®šæ—¶æ‰§è¡Œæ¡ˆä¾‹&quot;">â€‹</a></h3><p>è¦ä½¿ç”¨<code>asyncio</code>æ¥å®ç°å®šæ—¶ä»»åŠ¡ï¼Œé€šå¸¸æ¶‰åŠ<code>asyncio.sleep()</code>å‡½æ•°é…åˆäº‹ä»¶å¾ªç¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å®šæ—¶æ‰“å°æ¶ˆæ¯çš„ä¾‹å­ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>import asyncio</span></span>
<span class="line"><span></span></span>
<span class="line"><span>async def print_every_three_seconds():</span></span>
<span class="line"><span>    while True:</span></span>
<span class="line"><span>        print(&quot;This message is printed every three seconds.&quot;)</span></span>
<span class="line"><span>        await asyncio.sleep(3)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>async def main():</span></span>
<span class="line"><span>    # åˆ›å»ºä¸€ä¸ªä»»åŠ¡å¹¶å¯åŠ¨</span></span>
<span class="line"><span>    task = asyncio.create_task(print_every_three_seconds())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # ä¿æŒä¸»ç¨‹åºè¿è¡Œï¼Œå¦åˆ™äº‹ä»¶å¾ªç¯ä¸€æ—¦æ‰§è¡Œå®Œå°±ä¼šç»“æŸ</span></span>
<span class="line"><span>    await asyncio.sleep(10)  # ç¤ºä¾‹ä¸­è®©ä¸»ç¨‹åºç­‰å¾…10ç§’åè‡ªç„¶ç»“æŸ</span></span>
<span class="line"><span></span></span>
<span class="line"><span># è¿è¡Œä¸»å‡½æ•°</span></span>
<span class="line"><span>asyncio.run(main())</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>print_every_three_seconds</code>ï¼Œå®ƒä¼šæ— é™å¾ªç¯æ¯éš” 3 ç§’æ‰“å°ä¸€æ¬¡æ¶ˆæ¯ã€‚<code>main</code>å‡½æ•°ä¸­é€šè¿‡<code>asyncio.create_task</code>åˆ›å»ºäº†è¿™ä¸ªä»»åŠ¡å¹¶åœ¨äº‹ä»¶å¾ªç¯ä¸­å¯åŠ¨ã€‚ä¸ºäº†ä½¿ä¸»ç¨‹åºç»´æŒè¿è¡Œä¸€æ®µæ—¶é—´ä»¥è§‚å¯Ÿè¾“å‡ºæ•ˆæœï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>await asyncio.sleep(10)</code>ã€‚å®é™…ä¸Šï¼Œç”Ÿäº§ç¯å¢ƒä¸­å¯èƒ½éœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´æˆ–é‡‡ç”¨æ›´å¤æ‚çš„æœºåˆ¶æ¥æ§åˆ¶ä¸»å¾ªç¯çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><p>è¯·æ³¨æ„ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦è€ƒè™‘ä»»åŠ¡çš„å–æ¶ˆã€å¼‚å¸¸å¤„ç†ç­‰é«˜çº§ç‰¹æ€§ï¼Œä»¥ç¡®ä¿ç¨‹åºçš„å¥å£®æ€§ã€‚</p><h2 id="_8ã€åŸºäº-django-çš„-cronjobs-ç®¡ç†åå°-ğŸ’»" tabindex="-1">8ã€åŸºäº Django çš„ CronJobs ç®¡ç†åå° ğŸ’» <a class="header-anchor" href="#_8ã€åŸºäº-django-çš„-cronjobs-ç®¡ç†åå°-ğŸ’»" aria-label="Permalink to &quot;8ã€åŸºäº Django çš„ CronJobs ç®¡ç†åå° ğŸ’»&quot;">â€‹</a></h2><h3 id="_8-1-django-cron-ä»‹ç»" tabindex="-1">8.1 Django-Cron ä»‹ç» <a class="header-anchor" href="#_8-1-django-cron-ä»‹ç»" aria-label="Permalink to &quot;8.1 Django-Cron ä»‹ç»&quot;">â€‹</a></h3><p>Django-Cron æ˜¯ä¸“ä¸º Django æ¡†æ¶è®¾è®¡çš„åº“ï¼Œæ—¨åœ¨ç®€åŒ–å®šæ—¶ä»»åŠ¡çš„ç®¡ç†å’Œè°ƒåº¦ ï¼Œç‰¹åˆ«æ˜¯å°†å…¶é›†æˆåˆ° Django çš„ç®¡ç†åå°ã€‚å®ƒå…è®¸å¼€å‘è€…é€šè¿‡ Django çš„ Admin ç•Œé¢æ¥åˆ›å»ºã€ç¼–è¾‘å’Œåˆ é™¤å®šæ—¶ä»»åŠ¡ ï¼Œè€Œæ— éœ€ç›´æ¥æ“ä½œæœåŠ¡å™¨çš„ cron ä½œä¸šã€‚è¿™æ · ï¼Œå®šæ—¶ä»»åŠ¡çš„ç®¡ç†å˜å¾—æ›´åŠ ç›´è§‚å’Œä¾¿æ·ï¼Œç‰¹åˆ«é€‚åˆ Django é¡¹ç›®çš„ç»´æŠ¤å›¢é˜Ÿåä½œã€‚</p><h3 id="_8-2-åå°ç®¡ç†ç³»ç»Ÿæ­å»º" tabindex="-1">8.2 åå°ç®¡ç†ç³»ç»Ÿæ­å»º <a class="header-anchor" href="#_8-2-åå°ç®¡ç†ç³»ç»Ÿæ­å»º" aria-label="Permalink to &quot;8.2 åå°ç®¡ç†ç³»ç»Ÿæ­å»º&quot;">â€‹</a></h3><p><strong>å®‰è£… Django-Cron</strong></p><p>é¦–å…ˆï¼Œé€šè¿‡ pip å®‰è£… Django-cron åº“ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>pip install django-cron</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>é…ç½® Django é¡¹ç›®</strong></p><ol><li><ol><li><strong>æ·»åŠ åˆ° INSTALLED_APPS</strong>ï¼šåœ¨ä½ çš„ Django é¡¹ç›®çš„<code>settings.py</code>æ–‡ä»¶ä¸­ ï¼Œå°†<code>django_cron</code>åŠ å…¥<code>INSTALLED_APPS</code>åˆ—è¡¨ã€‚</li></ol></li></ol><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>INSTALLED_APPS = [</span></span>
<span class="line"><span>    # ...</span></span>
<span class="line"><span>    &#39;django_cron&#39;,</span></span>
<span class="line"><span>    # ...</span></span>
<span class="line"><span>]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol><li><ol><li><strong>é…ç½® CRON_CLASSES</strong>ï¼šåœ¨<code>settings.py</code>ä¸­å®šä¹‰ä½ çš„å®šæ—¶ä»»åŠ¡ç±»åˆ—è¡¨ã€‚</li></ol></li></ol><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>CRON_CLASSES = [</span></span>
<span class="line"><span>    &#39;myapp.crons.MyCronJob&#39;,  # å‡è®¾MyCronJobæ˜¯ä½ è‡ªå®šä¹‰çš„å®šæ—¶ä»»åŠ¡ç±»</span></span>
<span class="line"><span>]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>åˆ›å»ºå®šæ—¶ä»»åŠ¡ç±»</strong></p><p>åœ¨ä½ çš„åº”ç”¨ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code>cron.py</code>çš„æ–‡ä»¶ï¼Œå¹¶å®šä¹‰ä½ çš„å®šæ—¶ä»»åŠ¡ç±»ã€‚è¿™ä¸ªç±»éœ€è¦ç»§æ‰¿è‡ª<code>Cron.JobBase</code>ã€‚</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>from django_cron import CronJobBase, Schedule</span></span>
<span class="line"><span></span></span>
<span class="line"><span>class MyCronJob(CronJobBase):</span></span>
<span class="line"><span>    RUN_EVERY_MINS = 1  # æ¯åˆ†é’Ÿè¿è¡Œä¸€æ¬¡</span></span>
<span class="line"><span>    schedule = Schedule(run_every_mins=RUN_EVERY_MINS)</span></span>
<span class="line"><span>    code = &#39;my_cron.my_cron_job&#39;    # ä»»åŠ¡å”¯ä¸€æ ‡è¯†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    def do(self):</span></span>
<span class="line"><span>        print(&quot;Cron Job Running&quot;)</span></span>
<span class="line"><span>        # åœ¨è¿™é‡Œæ‰§è¡Œä½ çš„ä»»åŠ¡é€»è¾‘</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>åˆ›å»ºç®¡ç†ç•Œé¢</strong></p><ul><li>è¿è¡Œè¿ç§»ç¡®ä¿ Django-Cron çš„æ•°æ®åº“è¡¨è¢«åˆ›å»ºï¼š</li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>python manage.py migrate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>ç™»å½•å…¥ Django ç®¡ç†åå°ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ªåä¸º&quot;Cron&quot;çš„æ–°æ¡ç›®ã€‚åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥æŸ¥çœ‹ã€ç¼–è¾‘æˆ–åˆ é™¤å·²å®šä¹‰çš„å®šæ—¶ä»»åŠ¡ã€‚</li></ul><p><strong>æ³¨æ„äº‹é¡¹</strong></p><ul><li>é€šå¸¸ ï¼ŒDjango-Cron é€šè¿‡ç®¡ç†å‘½ä»¤<code>python manage.py runcrons</code>æ¥æ‰§è¡Œä»»åŠ¡ã€‚ä½ å¯èƒ½éœ€è¦å°†å…¶åŠ å…¥åˆ°ä½ çš„ç³»ç»Ÿ cron ä½œä¸šæˆ–ä½¿ç”¨åƒ Supervisor è¿™æ ·çš„å·¥å…·æ¥ç¡®ä¿å®ƒæŒç»­è¿è¡Œã€‚</li><li>ç¡®ä¿ Django-Cron çš„æ‰§è¡Œç¯å¢ƒä¸ Django é¡¹ç›®ä¸€è‡´ ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–ä¾èµ–å¤–éƒ¨æœåŠ¡æ—¶ã€‚</li></ul><p>é€šè¿‡ Django-Cronï¼Œä½ å¯ä»¥å……åˆ†åˆ©ç”¨ Django çš„ Admin ç•Œé¢ç®¡ç†å®šæ—¶ä»»åŠ¡ï¼Œç®€åŒ–è¿ç»´å·¥ä½œï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼Œç¡®ä¿å®šæ—¶ä»»åŠ¡çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h2 id="ç¬¬-9-ç« -æ€»ç»“ä¸é€‰æ‹©å»ºè®®-ğŸ¯" tabindex="-1">ç¬¬ 9 ç«  æ€»ç»“ä¸é€‰æ‹©å»ºè®® ğŸ¯ <a class="header-anchor" href="#ç¬¬-9-ç« -æ€»ç»“ä¸é€‰æ‹©å»ºè®®-ğŸ¯" aria-label="Permalink to &quot;ç¬¬ 9 ç«  æ€»ç»“ä¸é€‰æ‹©å»ºè®® ğŸ¯&quot;">â€‹</a></h2><p>æŒæ¡å¤šå…ƒå®šæ—¶ä»»åŠ¡ç­–ç•¥ï¼Œä»åŸºç¡€ Thread å®šæ—¶æ‰§è¡Œåˆ° APScheduler çš„çµæ´»æ€§ ï¼Œä¹ƒè‡³ Celery çš„åˆ†å¸ƒå¼å¤„ç†ä¸ asyncio çš„å¼‚æ­¥é«˜æ•ˆ ï¼Œä¹ƒè‡³ Quartz æ€æƒ³åœ¨ Python ä¸­çš„å®ç°ï¼Œæ¯ç§æ–¹æ³•å„æœ‰åƒç§‹ã€‚é€‰æ‹©æ—¶è€ƒè™‘åº”ç”¨åœºæ™¯ã€æ€§èƒ½éœ€æ±‚ä¸èµ„æºä¼˜åŒ–ï¼Œç¡®ä¿ä»»åŠ¡è°ƒåº¦æ—¢é«˜æ•ˆåˆé€‚é…é¡¹ç›®éœ€æ±‚ã€‚</p><h1 id="python-tikaå·¥å…·åŒ…" tabindex="-1">python tikaå·¥å…·åŒ… <a class="header-anchor" href="#python-tikaå·¥å…·åŒ…" aria-label="Permalink to &quot;python tikaå·¥å…·åŒ…&quot;">â€‹</a></h1><p>æå–PDFæ–‡æ¡£å†…å®¹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tika </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> parser</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># è§£æPDFæ–‡ä»¶å¹¶è·å–æ–‡æœ¬å†…å®¹</span></span>
<span class="line"><span style="color:#ABB2BF;">parsed_pdf </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.pdf&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(parsed_pdf[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æå–Wordæ–‡æ¡£ï¼ˆ.docxï¼‰çš„å†…å®¹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">parsed_docx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.docx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(parsed_docx[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æå–HTMLé¡µé¢å…ƒæ•°æ®</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">html_metadata </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.html&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">meta</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(html_metadata[</span><span style="color:#98C379;">&#39;metadata&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æå–ZIPå‹ç¼©åŒ…å†…æ–‡ä»¶çš„æ–‡æœ¬</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">zip_content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;archive.zip&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> file_content </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> zip_content[</span><span style="color:#98C379;">&#39;files&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#56B6C2;">  print</span><span style="color:#ABB2BF;">(file_content[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æ£€æµ‹æ–‡ä»¶ç±»å‹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">file_type </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_buffer</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.jpg&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;rb&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">())[</span><span style="color:#98C379;">&#39;metadata&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;Content-Type&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(file_type)  </span><span style="color:#7F848E;font-style:italic;"># è¾“å‡ºç±»ä¼¼ &quot;image/jpeg&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è¯»å–JSONæ ¼å¼çš„Tikaå“åº”</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">response_json </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">xmlContent</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(response_json[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æå–çº¯æ–‡æœ¬æ–‡ä»¶çš„å…ƒæ•°æ®ä¸å†…å®¹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">txt_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.txt&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(txt_data[</span><span style="color:#98C379;">&#39;metadata&#39;</span><span style="color:#ABB2BF;">])  </span><span style="color:#7F848E;font-style:italic;"># å…ƒæ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(txt_data[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])   </span><span style="color:#7F848E;font-style:italic;"># æ–‡æœ¬å†…å®¹</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è‡ªå®šä¹‰TikaæœåŠ¡å™¨åœ°å€</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> tika </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> parser, ServerEndpoint</span></span>
<span class="line"><span style="color:#ABB2BF;">custom_server </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> ServerEndpoint</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;http://localhost:9998/tika&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">parsed_txt </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.txt&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">serverEndpoint</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">custom_server)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(parsed_txt[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¤„ç†åµŒå¥—æ–‡ä»¶ç»“æ„</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># å‡è®¾ archive.tar.gz åŒ…å«å¤šä¸ªå±‚çº§çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">nested_content </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;archive.tar.gz&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> nested_content[</span><span style="color:#98C379;">&#39;files&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#98C379;"> &#39;content&#39;</span><span style="color:#C678DD;"> in</span><span style="color:#ABB2BF;"> item:</span></span>
<span class="line"><span style="color:#56B6C2;">        print</span><span style="color:#ABB2BF;">(item[</span><span style="color:#98C379;">&#39;filename&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">, item[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">---</span><span style="color:#56B6C2;">\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>æå–Excelè¡¨æ ¼å†…å®¹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">parsed_xlsx </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> parser.</span><span style="color:#61AFEF;">from_file</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;example.xlsx&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(parsed_xlsx[</span><span style="color:#98C379;">&#39;content&#39;</span><span style="color:#ABB2BF;">])  </span><span style="color:#7F848E;font-style:italic;"># æ³¨æ„ï¼šExcelå†…å®¹å¯èƒ½ä»¥XMLå½¢å¼å‘ˆç°</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div></main><footer class="VPDocFooter" data-v-54e61e03 data-v-98758174><!--[--><!--]--><div class="edit-info" data-v-98758174><div class="edit-link" data-v-98758174><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://gitee.com/muyaCode/program-learn-notes/edit/main/docs/Document/Python/Pythonè„šæœ¬å¼€å‘.md" target="_blank" rel="noreferrer" data-v-98758174><!--[--><span class="vpi-square-pen edit-link-icon" data-v-98758174></span> åœ¨ Giteeä¸Šç¼–è¾‘æ­¤é¡µ<!--]--></a></div><div class="last-updated" data-v-98758174><p class="VPLastUpdated" data-v-98758174 data-v-82823703>ä¸Šæ¬¡æ›´æ–°ï¼š: <time datetime="2024-05-26T09:31:03.000Z" data-v-82823703></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-98758174><span class="visually-hidden" id="doc-footer-aria-label" data-v-98758174>Pager</span><div class="pager" data-v-98758174><a class="VPLink link pager-link prev" href="/ProgramLearnNotes/Document/Python/Python%E5%BA%93" data-v-98758174><!--[--><span class="desc" data-v-98758174>ä¸Šä¸€ç¯‡</span><span class="title" data-v-98758174>Pythonåº“</span><!--]--></a></div><div class="pager" data-v-98758174><a class="VPLink link pager-link next" href="/ProgramLearnNotes/Document/Python/Python%E5%AE%9E%E6%88%98%E5%BC%80%E5%8F%91" data-v-98758174><!--[--><span class="desc" data-v-98758174>ä¸‹ä¸€ç¯‡</span><span class="title" data-v-98758174>Pythonå®æˆ˜å¼€å‘</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-41e8be72 data-v-5a830141><div class="container" data-v-5a830141><p class="message" data-v-5a830141>Released under the MIT License.</p><p class="copyright" data-v-5a830141>Copyright Â© 2024  heyu</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"document_aiå¤§è¯­è¨€æ¨¡å‹_aiå¤§è¯­è¨€æ¨¡å‹å­¦ä¹ èµ„æº.md\":\"C3knW0ng\",\"document_c-c___c-c__è¯­è¨€ç›¸å…³å·¥å…·.md\":\"CZAToB5v\",\"document_aiå¤§è¯­è¨€æ¨¡å‹_aiæ¨¡å‹.md\":\"BySjgoc-\",\"document_c-sharp_dotnet_dotnetå…¥é—¨.md\":\"DL8FxHHN\",\"document_c-sharp_c-sharpå­¦ä¹ èµ„æº.md\":\"K71gvgGi\",\"document_c-sharp_dotnet_dotnetç›¸å…³å¼€æºé¡¹ç›®.md\":\"DWuaHJJR\",\"document_c-c___c__æ¡†æ¶.md\":\"DPmAiqgy\",\"document_c-sharp_dotnet_dotnetç›¸å…³ç½‘å€.md\":\"Cwu94Gwv\",\"document_c-c___å¼€æºçš„c-c_åŒ…ç®¡ç†å·¥å…·.md\":\"UGz4w8lm\",\"document_linux_linuxå†…æ ¸.md\":\"Dpgk4Yjq\",\"document_docker_dockeråº”ç”¨_docker-desktopå¼€å¯å†…ç½®çš„k8så¹¶å®‰è£…kuboardè¿›è¡Œå¾®æœåŠ¡ç®¡ç†.md\":\"DsiFd_Ez\",\"document_java_javaå­¦ä¹ èµ„æº.md\":\"DmW8AkE_\",\"document_docker_dockeråº”ç”¨_å¦‚ä½•ä¼˜é›…çš„å˜æ›´docker-desktopçš„é•œåƒå­˜å‚¨è·¯å¾„.md\":\"vJpdImGv\",\"document_lua_luaè¯­è¨€å­¦ä¹ èµ„æº.md\":\"DMBnDqGP\",\"document_docker_nas_é­”äº‘è…¾zeusc1â€”â€”äº‘æ‰‹æœºå½“12ä¸ªæ‰‹æœºç”¨.md\":\"s_-eupZy\",\"document_docker_dockeråº”ç”¨_è‘«èŠ¦å¨ƒå¹³å°è‡ªåŠ¨é¢„çº¦èŒ…å°.md\":\"B-0t2e1G\",\"document_docker_dockeråº”ç”¨_docker åŠ æŒçš„å®‰å“æ‰‹æœºï¼šéšèº«æºå¸¦çš„çŸ¥è¯†åº“.md\":\"Bi78RQh1\",\"document_rust_4.rustæ¡†æ¶ç¯‡.md\":\"Bbls9RGY\",\"document_docker_dockeråº”ç”¨_å‘Šåˆ«dockerfile_æ‹¥æŠ± docker init æ„å»ºdockeré•œåƒ.md\":\"MqwF-Ba-\",\"document_python_pythonå­¦ä¹ çº¿è·¯.md\":\"BOp8Shub\",\"document_zig_zigç›¸å…³å­¦ä¹ èµ„æº.md\":\"z8GmCXxn\",\"document_c-c___c-c__å­¦ä¹ èµ„æº.md\":\"I3oIVDDD\",\"document_æ•°æ®åº“_mysql_mysqlå­¦ä¹ è·¯çº¿.md\":\"DfHXr5sA\",\"document_rust_rustå’Œå…¶ä»–è¯­è¨€ç»“åˆ.md\":\"-Q8Ka806\",\"document_docker_dockerå…¥é—¨.md\":\"CHSUZQAB\",\"document_docker_dockeråº”ç”¨_dockerå¿«é€Ÿå…¥é—¨å’Œéƒ¨ç½²ä½¿ç”¨æ•™ç¨‹.md\":\"Bu9CMY5W\",\"document_docker_dockeråº”ç”¨_å°†dockeré•œåƒç¼–è¯‘æˆç‹¬ç«‹å¯ç§»æ¤äºŒè¿›åˆ¶æ–‡ä»¶.md\":\"CShsnUj1\",\"document_docker_dockeråº”ç”¨_dockerè‡ªå»ºäº‘æ‰‹æœº.md\":\"KUDNKmvE\",\"document_go_goå¼€æºåº”ç”¨.md\":\"DYCaHbul\",\"document_rust_6.rustä¸webassembly.md\":\"BsPACLWz\",\"document_rust_0.rustä»‹ç»å’Œåº”ç”¨.md\":\"oPYT1czw\",\"document_php_phpå­¦ä¹ èµ„æº.md\":\"DW__jo2p\",\"document_python_pythoné¢è¯•é¢˜.md\":\"ysIfgVyy\",\"document_python_pythonçš„condaç®¡ç†è½¯ä»¶å‘½ä»¤.md\":\"BSz7NklF\",\"document_harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘_harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘ç®€ä»‹.md\":\"D6DP1ogK\",\"document_swift_swiftå­¦ä¹ èµ„æº.md\":\"BDPvzfbs\",\"document_docker_nas_ç¡¬ä»¶è®¾å¤‡æ”¹é€ æˆnas.md\":\"CuVPUFp4\",\"document_lua_luaåŸºç¡€å…¥é—¨.md\":\"DPQtoNxS\",\"document_docker_dockeråº”ç”¨_webmanå®æˆ˜æ•™ç¨‹_è½»æ¾ä½¿ç”¨dockeréƒ¨ç½²webmané¡¹ç›®â€”æ‰“é€ ä¸“å±ä½ çš„webåº”ç”¨.md\":\"Cb_mqZ1u\",\"document_lua_luaåŸºç¡€å…¥é—¨_3.è¡¨è¾¾å¼.md\":\"B7nUlcLo\",\"document_java_javaé¢è¯•ç›¸å…³.md\":\"BaDV0Dlo\",\"document_rust_1.rustå¼€å‘ç¯å¢ƒæ­å»º.md\":\"DUIVyRVT\",\"document_python_pythonå…¥é—¨.md\":\"D6j1MSY5\",\"document_å¼€æºç›¸å…³_æ‰“é€ ä¸€ä¸ªèŠ±é‡Œèƒ¡å“¨çš„githubä¸ªäººä¸»é¡µ.md\":\"DbR5qEjH\",\"document_docker_nas_nasç³»ç»Ÿæ¨è.md\":\"CqdptAwD\",\"document_harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘_harmonyå¼€æºé¡¹ç›®.md\":\"DSboXD50\",\"document_æ±‡ç¼–_æ±‡ç¼–å…¥é—¨.md\":\"DgJ1deC8\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_ç½‘ç»œå®‰å…¨é˜²èº«ç§˜ç±.md\":\"9j39cYjY\",\"document_rust_rustå­¦ä¹ è·¯çº¿.md\":\"BuNvsyqP\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_magisk-lsposed è§£å†³æŸéŸ³appæŠ“åŒ…é—®é¢˜.md\":\"Bs6ZiD88\",\"document_æ•°æ®åº“_mysql_mysqlå…¥é—¨.md\":\"Dx_y2qWm\",\"document_æ•°æ®åº“_å¸¸ç”¨æ•°æ®åº“.md\":\"snJgyakB\",\"document_ç½‘ç»œå®‰å…¨_ã€kalilinuxã€‘_kali linuxå®‰å…¨å·¥å…·é›†åˆ.md\":\"DJUSFoJI\",\"document_ç½‘ç»œå®‰å…¨_ã€æ¸—é€æµ‹è¯•å·¥å…·ã€‘_æ¸—é€æµ‹è¯•å·¥å…·.md\":\"BQjD9m-D\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_appæ¸—é€_äººè„¸è¯†åˆ«ç™»å½•ç»•è¿‡.md\":\"VAAjulMh\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_hfish_æ°¸ä¹…å…è´¹â€”å·§è®¾èœœç½è¿·å±€.md\":\"QHsfNfGM\",\"document_ç¼–è¯‘å™¨åŸç†å’Œå®ç°.md\":\"BYn6Z4vK\",\"document_go_goæ¡†æ¶.md\":\"BRN_Jqfb\",\"document_æ ‡å‡†åŒ–apiè®¾è®¡æµç¨‹.md\":\"DYaN04_F\",\"document_docker_dockeråº”ç”¨_å¼€æºlinuxæœåŠ¡å™¨è¿ç»´é¢æ¿1panelæ„å»ºphpå®¹å™¨è¿è¡Œwebmanæ¡†æ¶.md\":\"CHcU4RMi\",\"document_æ•°æ®åº“_sqlite.md\":\"aNLhpwez\",\"document_zig_zigä»‹ç».md\":\"vfCxPtba\",\"document_rust_7.rustè®¾è®¡æ¨¡å¼.md\":\"C1RwmcXU\",\"document_ç½‘ç»œå®‰å…¨_ã€kalilinuxã€‘_æ‰‹æœºå®‰è£…kali linux.md\":\"BD9nOvV-\",\"document_java_javaæ¡†æ¶.md\":\"BPybgXj3\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_ã€å®‰å“é€†å‘ã€‘æ·˜ç³»æŠ“åŒ…æ±‡æ€»(é±¼ éº¦ çŒ« é¥¿ å®).md\":\"axPx-xus\",\"document_ç½‘ç»œå®‰å…¨_ã€æŠ“åŒ…é…ç½®ã€‘_å®‰å“é«˜ç‰ˆæœ¬httpsæŠ“åŒ…ç»ˆæè§£å†³æ–¹æ¡ˆ.md\":\"BkVOdD7Q\",\"document_å¦‚ä½•å†™å‡ºåˆ«äººæ— æ³•ç»´æŠ¤çš„ä»£ç .md\":\"CmYDUraw\",\"document_python_pythonå­¦ä¹ èµ„æº.md\":\"CH-a_Eq5\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_fridaå…¥é—¨ä½¿ç”¨ä»‹ç».md\":\"B5sHHT5s\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_æµè§ˆå™¨æ’ä»¶â€”modheader_åŠ©ä½ ç»•è¿‡å¾®ä¿¡æˆæƒç™»å½•é™åˆ¶.md\":\"CTIyDuDc\",\"document_rust_rustå­¦ä¹ èµ„æº.md\":\"DVyiAR7H\",\"document_docker_dockeråº”ç”¨_ä½¿ç”¨watchtowerè‡ªåŠ¨æ›´æ–°dockeré•œåƒä¸å®¹å™¨.md\":\"PeOH8ekt\",\"document_docker_nas_nasç¡¬ä»¶æ¨è.md\":\"Dkg1e-V8\",\"document_zig_zigå…¥é—¨.md\":\"BBwbAYpm\",\"document_python_pythonçˆ¬è™«.md\":\"CyvkTNf1\",\"document_mojo_mojoè¯­è¨€ç®€ä»‹å’Œèµ„æº.md\":\"CZkpUAH4\",\"document_linux_linuxå‘½ä»¤.md\":\"DVrMUQLA\",\"order_æ–‡æ¡£æŒ‡å—.md\":\"a94ikmvd\",\"document_python_pythonåº“.md\":\"DjUnJt3T\",\"document_python_pythonç‰ˆæœ¬å’Œç¯å¢ƒç®¡ç†.md\":\"4E9wkQUx\",\"document_å‘½ä»¤è¡Œå·¥å…·.md\":\"BaUKirqh\",\"document_ç½‘ç»œå®‰å…¨_é»‘å®¢å¼€æºé¡¹ç›®.md\":\"BUQU5aCO\",\"document_lua_luaåŸºç¡€å…¥é—¨_4.è¯­å¥.md\":\"DBOXAHx1\",\"document_æ•°æ®åº“_mysql_mysqlå­¦ä¹ èµ„æº.md\":\"CbBfoAkF\",\"document_æ‰‹æ“cpu.md\":\"BRK2X017\",\"document_linux_linuxè„šæœ¬.md\":\"D8g9DhNQ\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_å¼€æºé€†å‘å·¥å…·.md\":\"DnRGdoKF\",\"document_rust_11.rusté¢è¯•é¢˜.md\":\"DyiM4Ir5\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_å¯ç›‘å¬vpnçš„é»‘å®¢æŠ€æœ¯.md\":\"2o51PeYs\",\"document_lua_luaåŸºç¡€å…¥é—¨_2.ç±»å‹å’Œå€¼.md\":\"DJvdcYTt\",\"document_docker_dockeråº”ç”¨_nasè‡ªæ‰˜ç®¡åº”ç”¨æœåŠ¡appç«¯.md\":\"BUIinWBG\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_åœ¨å®¶æ‰“å¡çš„æ–¹æ³•.md\":\"DTYMRVcN\",\"document_åŒ…ç®¡ç†å™¨é…ç½®ä»£ç†.md\":\"ku4zPIVk\",\"document_rust_rustå¼€æºé¡¹ç›®.md\":\"DcbwYrQI\",\"document_æ•°æ®åº“_æ•°æ®åº“å·¥å…·.md\":\"DSHpmjZB\",\"document_go_goè¯­è¨€ç›¸å…³ç½‘ç«™èµ„æº.md\":\"BF3DBqfL\",\"document_ç½‘ç»œå®‰å…¨_ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘_å¯†æ¢å·¥å…·é›†guiæ¸—é€ç‰ˆ.md\":\"B5xxXm8t\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_æŠ–éŸ³abogusé€†å‘åˆ†æ.md\":\"gHvYSJSW\",\"document_docker_dockeråº”ç”¨_å¦‚ä½•ä½¿ç”¨ github actions æ„å»º docker é•œåƒ.md\":\"CqJuK6r8\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_è¿½è¸ªæ”»å‡»æºå¤´ ä»ipåœ°å€åˆ°æ”»å‡»è€…èº«ä»½çš„æº¯æºä¹‹æ—….md\":\"Bi1mKGDS\",\"document_ç½‘ç»œå®‰å…¨_ã€é»‘å®¢æŠ€æœ¯ã€‘_åé—¨æŠ€æœ¯.md\":\"CS2q3RC5\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_ç½‘ç»œæ°´å†›.md\":\"BohOJPLZ\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_æ£€æµ‹è‡ªå®¶æ‘„åƒå¤´æ˜¯å¦å­˜åœ¨æ¼æ´.md\":\"Cp919l-M\",\"document_å¼€æºå°æŠ„.md\":\"OhneUQ0s\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_å¦‚ä½•ä½¿ç”¨å¼€æºæƒ…æŠ¥è·Ÿè¸ªä¸€ä¸ªäºº.md\":\"B4HmYhbY\",\"document_æ±‡ç¼–_æ±‡ç¼–ç®€ä»‹å’Œèµ„æº.md\":\"D5WD2PYr\",\"document_rust_10.rustæ€§èƒ½åˆ†æä¸ä¼˜åŒ–å®æˆ˜.md\":\"BO0cEDN9\",\"document_æ±‡ç¼–_æ±‡ç¼–å¼€æºé¡¹ç›®.md\":\"CgCGGJLe\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_appé€†å‘ç ´è§£æ•™ç¨‹.md\":\"DH1vb19X\",\"document_rust_3.rustè¿›é˜¶ç¯‡.md\":\"J3LltAG9\",\"document_æ•°æ®åº“_æ•°æ®åº“å†…æ ¸å®ç°.md\":\"C7mZJvrQ\",\"document_rust_rustç§»åŠ¨ç«¯å¼€å‘ä½“éªŒ.md\":\"BwVBXnxc\",\"document_ç½‘ç»œå®‰å…¨_ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘_venom-crawlerè½¬ä¸ºæ¡æ´è€Œç”Ÿçš„çˆ¬è™«ç¥å™¨.md\":\"CDaSLyXL\",\"document_go_goè¯­è¨€å­¦ä¹ è·¯çº¿.md\":\"B4QfVTKO\",\"document_python_ã€pythonå¾…å®šã€‘_åˆ©ç”¨aardioå’Œpython playwrightå®ç°é«˜æ•ˆçš„ç½‘é¡µè‡ªåŠ¨åŒ–æ“ä½œ.md\":\"fk2-YJYy\",\"document_ç½‘ç»œå®‰å…¨_ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘_aomanå»æŒ‡çº¹æµè§ˆå™¨â€”ä¼ªé€ ä¸€ä¸ªå®‰å…¨çš„æ¸—é€ç¯å¢ƒ.md\":\"CsPnlnpx\",\"document_python_pythonå¼€æºé¡¹ç›®.md\":\"BB3sjYgh\",\"document_ç¼–ç¨‹è¯­è¨€.md\":\"DIJMRaHB\",\"document_mojo_mojoå¼€å‘ç¯å¢ƒæ­å»º.md\":\"Dwmhh2Lg\",\"document_ç½‘ç»œå®‰å…¨_ç½‘ç»œå®‰å…¨ç›¸å…³ç¯å¢ƒ.md\":\"DeLh7KU5\",\"document_æœåŠ¡å™¨ç›¸å…³_nginxé…ç½®.md\":\"6z1HFSnk\",\"document_lua_luaå¼€å‘å®‰å“åº”ç”¨.md\":\"Byg0LYO5\",\"document_ç½‘ç»œå®‰å…¨_ã€é»‘å®¢æŠ€æœ¯ã€‘_åœ¨windowsç³»ç»Ÿä¸‹ææƒçš„8ç§ä¸»è¦å§¿åŠ¿.md\":\"D2HqG9G-\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_electronåº”ç”¨éªŒè¯ç ´è§£.md\":\"CFoCgD9b\",\"document_ç½‘ç»œå®‰å…¨_ç½‘ç»œå®‰å…¨æ•™ç¨‹.md\":\"C0pug7qs\",\"document_ç½‘ç»œå®‰å…¨_ã€kalilinuxã€‘_å®ä½“æœºå®‰è£…kaliæ•™ç¨‹.md\":\"DX1lAULx\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_ä½ æ˜¯å¦åœ¨æ­£ç¡®çš„ä½¿ç”¨vpn.md\":\"C3euvhbp\",\"document_ç½‘ç»œå®‰å…¨_ã€é»‘å®¢æŠ€æœ¯ã€‘_æ•°æ®ç»“æ„ç®—æ³•çš„åº”ç”¨.md\":\"BhTNiUq5\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_jsé€†å‘å·¥å…·æ¸…å•.md\":\"BK6UqU92\",\"document_ç½‘ç»œå®‰å…¨_ã€kalilinuxã€‘_kalilinuxå·¥å…·è„‘å›¾_å®‰å…¨ä¸“å®¶çš„å†›æ¢°åº“.md\":\"Blu-ozP1\",\"index.md\":\"CyVAowrR\",\"document_python_pythonä¸å…¶ä»–è¯­è¨€ç»“åˆ.md\":\"CoLm3zsM\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_ä¸€ç§åˆ©ç”¨åˆæ³•å·¥å…·æ¸—é€çš„æ–°å‹æ–¹æ³•.md\":\"vW7Uz8oi\",\"document_lua_luaåŸºç¡€å…¥é—¨_1.å¼€å§‹.md\":\"CeuCtC1L\",\"document_docker_dockeråº”ç”¨_dockerç©ºé—´ä¼˜åŒ–æŒ‡å—ï¼šé«˜æ•ˆå›æ”¶ç£ç›˜ç©ºé—´çš„å®ç”¨æŠ€å·§.md\":\"BK6z0kK6\",\"document_ç½‘ç»œå®‰å…¨_ã€kalilinuxã€‘_kalilinuxä¸‹ç¼–å†™å®‰å“æœ¨é©¬.md\":\"Bz08grOR\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_ç½‘ç»œå—…æ¢çš„åŸç†å’Œå¸¸ç”¨å·¥å…·.md\":\"DPOu64p-\",\"order_markdownå›¾æ ‡.md\":\"DN3WtMza\",\"document_ç½‘ç»œå®‰å…¨_ç½‘ç»œå®‰å…¨ç¤¾åŒºè®ºå›.md\":\"f0YsIklf\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_ã€å®‰å“é€†å‘ã€‘æŸéŸ³æµ·å¤–ç‰ˆtiktokæŠ“åŒ….md\":\"Qz44K46_\",\"document_rust_5.rusté¡¹ç›®å®æˆ˜ç¯‡.md\":\"BcmtdYa4\",\"document_ç½‘ç»œå®‰å…¨_ã€é»‘å®¢æŠ€æœ¯ã€‘_ä¸åˆ·å›ºä»¶æ­¦è£…å®¶ç”¨è·¯ç”±å™¨.md\":\"CYzBQyA3\",\"document_rust_8.rustæ¸¸æˆå¼€å‘.md\":\"BXiKoidk\",\"document_rust_2.ruståŸºç¡€ç¯‡.md\":\"C1LuwD7h\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_clash_yaktæŠ“åŒ…å¾®ä¿¡å°ç¨‹åº.md\":\"DyPVnU4d\",\"document_rust_9.rustç¨‹åºè°ƒè¯•.md\":\"DEhDARCE\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_ã€è½¦è”ç½‘ã€‘è½¦è½½ android åº”ç”¨æ”»å‡»-é€†å‘å·¥å…·.md\":\"C6wYQwMI\",\"document_lua_luaå®æˆ˜.md\":\"BkZlDt6c\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_apké€†å‘å·¥å…·.md\":\"C4EqxFNi\",\"document_ç½‘ç»œå®‰å…¨_å®‰å…¨ç›¸å…³çš„å¼€æºé¡¹ç›®.md\":\"B9UGAMte\",\"document_ç½‘ç»œå®‰å…¨_ã€é€†å‘ç ´è§£ã€‘_jsé€†å‘.md\":\"xhu7Umpu\",\"document_python_pythonå®æˆ˜å¼€å‘.md\":\"w5Q4s-M2\",\"document_ç½‘ç»œå®‰å…¨_ã€æ€è·¯ã€‘_åŸºäºlinuxå†…æ ¸çš„vpnå·¥å…·.md\":\"C8QW0BOf\",\"document_ç½‘ç»œå®‰å…¨_é»‘å®¢å·¥å…·ç³»åˆ—.md\":\"DMj8Uq6X\",\"document_docker_nas_naså¥½å·¥å…·æ¨è.md\":\"QMaDMraO\",\"document_ç½‘ç»œå®‰å…¨_é»‘å®¢è¾…åŠ©å·¥å…·.md\":\"QvSJizcc\",\"document_docker_dockeråº”ç”¨_dockeråº”ç”¨æ”¶é›†.md\":\"CnCbEg7h\",\"document_python_pythonæ¡†æ¶.md\":\"CCyUcPHr\",\"document_rust_rustæ¡†æ¶å’Œåº“.md\":\"EJ1j5cZQ\",\"document_python_pythonè„šæœ¬å¼€å‘.md\":\"BJWtgfI7\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh\",\"dir\":\"ltr\",\"title\":\"é¹¤å±¿ç¼–ç¨‹å­¦ä¹ ç¬”è®°\",\"description\":\"è½¯ä»¶å¼€å‘è®¡ï¼šå¼€å‘æ–‡æ¡£å’Œå¼€å‘è®¡åˆ’ï¼Œå®ŒæˆåŠŸèƒ½å·¥å…·ï¼Œå’Œå¾…å¼€å‘çš„åŠŸèƒ½å’Œå·¥å…·\",\"base\":\"/ProgramLearnNotes/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/img/buding.svg\",\"siteTitle\":\"é¹¤å±¿ç¼–ç¨‹å­¦ä¹ ç¬”è®°\",\"outlineTitle\":\"âš¡ï¸æ–‡æ¡£å†…å®¹å¤§çº²\",\"outline\":\"deep\",\"search\":{\"provider\":\"local\",\"options\":{\"locales\":{\"root\":{\"translations\":{\"button\":{\"buttonText\":\"æœç´¢æ–‡æ¡£\",\"buttonAriaLabel\":\"æœç´¢æ–‡æ¡£\"},\"modal\":{\"noResultsText\":\"æ— æ³•æ‰¾åˆ°ç›¸å…³ç»“æœ\",\"displayDetails\":\"æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯\",\"resetButtonTitle\":\"æ¸…é™¤æŸ¥è¯¢æ¡ä»¶\",\"backButtonTitle\":\"è¿”å›æœç´¢ç»“æœ\",\"footer\":{\"selectText\":\"é€‰æ‹©\",\"selectKeyAriaLabel\":\"enter\",\"navigateText\":\"åˆ‡æ¢\",\"navigateUpKeyAriaLabel\":\"up arrow\",\"navigateDownKeyAriaLabel\":\"down arrow\",\"closeText\":\"å…³é—­\",\"closeKeyAriaLabel\":\"escape\"}}}}},\"miniSearch\":{\"options\":{},\"searchOptions\":{}}}},\"nav\":[{\"text\":\"ğŸŒæˆ‘çš„ä¸ªäººç½‘ç«™\",\"link\":\"\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/muyaCode/ProgramLearnNotes\"},{\"icon\":{\"svg\":\"<svg t=\\\"1690871772610\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"987\\\" width=\\\"256\\\" height=\\\"256\\\">\\n        <path d=\\\"M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z\\\" fill=\\\"#C71D23\\\" p-id=\\\"988\\\"></path>\\n      </svg>\"},\"link\":\"https://gitee.com/muyaCode/program-learn-notes\"}],\"sidebar\":{\"/\":[{\"text\":\"ğŸŒŸæ–‡æ¡£æŒ‡å—\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"æ–‡æ¡£æŒ‡å—\",\"link\":\"/order/æ–‡æ¡£æŒ‡å—\"},{\"text\":\"markdownå›¾æ ‡\",\"link\":\"/order/markdownå›¾æ ‡\"}]},{\"text\":\"ç¼–ç¨‹è¯­è¨€\",\"link\":\"/Document/ç¼–ç¨‹è¯­è¨€\"},{\"text\":\"ç¼–è¯‘å™¨åŸç†å’Œå®ç°\",\"link\":\"/Document/ç¼–è¯‘å™¨åŸç†å’Œå®ç°\"},{\"text\":\"æ‰‹æ“CPU\",\"link\":\"/Document/æ‰‹æ“CPU\"},{\"text\":\"æ ‡å‡†åŒ–APIè®¾è®¡æµç¨‹\",\"link\":\"/Document/æ ‡å‡†åŒ–APIè®¾è®¡æµç¨‹\"},{\"text\":\"å¼€æºå°æŠ„\",\"link\":\"/Document/å¼€æºå°æŠ„\"},{\"text\":\"å‘½ä»¤è¡Œå·¥å…·\",\"link\":\"/Document/å‘½ä»¤è¡Œå·¥å…·\"},{\"text\":\"åŒ…ç®¡ç†å™¨é…ç½®ä»£ç†\",\"link\":\"/Document/åŒ…ç®¡ç†å™¨é…ç½®ä»£ç†\"},{\"text\":\"å¦‚ä½•å†™å‡ºåˆ«äººæ— æ³•ç»´æŠ¤çš„ä»£ç \",\"link\":\"/Document/å¦‚ä½•å†™å‡ºåˆ«äººæ— æ³•ç»´æŠ¤çš„ä»£ç \"},{\"text\":\"ğŸŒŸæœåŠ¡å™¨ç›¸å…³\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Nginxé…ç½®\",\"link\":\"/Document/æœåŠ¡å™¨ç›¸å…³/Nginxé…ç½®\"},{\"text\":\"\",\"link\":\"/Document/æœåŠ¡å™¨ç›¸å…³/\"},{\"text\":\"\",\"link\":\"/Document/æœåŠ¡å™¨ç›¸å…³/\"}]},{\"text\":\"ğŸŒŸJava\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Javaå­¦ä¹ èµ„æº\",\"link\":\"/Document/Java/Javaå­¦ä¹ èµ„æº\"},{\"text\":\"Javaæ¡†æ¶\",\"link\":\"/Document/Java/Javaæ¡†æ¶\"},{\"text\":\"\",\"link\":\"/Document/Java/\"},{\"text\":\"Javaé¢è¯•ç›¸å…³\",\"link\":\"/Document/Java/Javaé¢è¯•ç›¸å…³\"}]},{\"text\":\"ğŸŒŸC#\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"C-Sharpå­¦ä¹ èµ„æº\",\"link\":\"/Document/C-Sharp/C-Sharpå­¦ä¹ èµ„æº\"},{\"text\":\"\",\"link\":\"/Document/C-Sharp/\"},{\"text\":\"\",\"link\":\"/Document/C-Sharp/\"},{\"text\":\"ğŸŒŸdotnet\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"dotnetå…¥é—¨\",\"link\":\"/Document/C-Sharp/dotnet/dotnetå…¥é—¨\"},{\"text\":\"dotnetç›¸å…³ç½‘å€\",\"link\":\"/Document/C-Sharp/dotnet/dotnetç›¸å…³ç½‘å€\"},{\"text\":\"dotnetç›¸å…³å¼€æºé¡¹ç›®\",\"link\":\"/Document/C-Sharp/dotnet/dotnetç›¸å…³å¼€æºé¡¹ç›®\"}]}]},{\"text\":\"ğŸŒŸGo\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Goè¯­è¨€ç›¸å…³ç½‘ç«™èµ„æº\",\"link\":\"/Document/Go/Goè¯­è¨€ç›¸å…³ç½‘ç«™èµ„æº\"},{\"text\":\"Goå¼€æºåº”ç”¨\",\"link\":\"/Document/Go/Goå¼€æºåº”ç”¨\"},{\"text\":\"Goè¯­è¨€å­¦ä¹ è·¯çº¿\",\"link\":\"/Document/Go/Goè¯­è¨€å­¦ä¹ è·¯çº¿\"},{\"text\":\"Goæ¡†æ¶\",\"link\":\"/Document/Go/Goæ¡†æ¶\"},{\"text\":\"\",\"link\":\"/Document/Go/\"}]},{\"text\":\"ğŸŒŸPython\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Pythonå­¦ä¹ èµ„æº\",\"link\":\"/Document/Python/Pythonå­¦ä¹ èµ„æº\"},{\"text\":\"Pythonå­¦ä¹ çº¿è·¯\",\"link\":\"/Document/Python/Pythonå­¦ä¹ çº¿è·¯\"},{\"text\":\"Pythonç‰ˆæœ¬å’Œç¯å¢ƒç®¡ç†\",\"link\":\"/Document/Python/Pythonç‰ˆæœ¬å’Œç¯å¢ƒç®¡ç†\"},{\"text\":\"Pythonçš„Condaç®¡ç†è½¯ä»¶å‘½ä»¤\",\"link\":\"/Document/Python/Pythonçš„Condaç®¡ç†è½¯ä»¶å‘½ä»¤\"},{\"text\":\"Pythonå…¥é—¨\",\"link\":\"/Document/Python/Pythonå…¥é—¨\"},{\"text\":\"Pythonæ¡†æ¶\",\"link\":\"/Document/Python/Pythonæ¡†æ¶\"},{\"text\":\"Pythonåº“\",\"link\":\"/Document/Python/Pythonåº“\"},{\"text\":\"Pythonè„šæœ¬å¼€å‘\",\"link\":\"/Document/Python/Pythonè„šæœ¬å¼€å‘\"},{\"text\":\"Pythonå®æˆ˜å¼€å‘\",\"link\":\"/Document/Python/Pythonå®æˆ˜å¼€å‘\"},{\"text\":\"Pythonçˆ¬è™«\",\"link\":\"/Document/Python/Pythonçˆ¬è™«\"},{\"text\":\"Pythonå¼€æºé¡¹ç›®\",\"link\":\"/Document/Python/Pythonå¼€æºé¡¹ç›®\"},{\"text\":\"Pythonä¸å…¶ä»–è¯­è¨€ç»“åˆ\",\"link\":\"/Document/Python/Pythonä¸å…¶ä»–è¯­è¨€ç»“åˆ\"},{\"text\":\"Pythoné¢è¯•é¢˜\",\"link\":\"/Document/Python/Pythoné¢è¯•é¢˜\"},{\"text\":\"\",\"link\":\"/Document/Python/\"}]},{\"text\":\"ğŸŒŸMojo\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Mojoè¯­è¨€ç®€ä»‹å’Œèµ„æº\",\"link\":\"/Document/Mojo/Mojoè¯­è¨€ç®€ä»‹å’Œèµ„æº\"},{\"text\":\"Mojoå¼€å‘ç¯å¢ƒæ­å»º\",\"link\":\"/Document/Mojo/Mojoå¼€å‘ç¯å¢ƒæ­å»º\"},{\"text\":\"\",\"link\":\"/Document/Mojo/\"},{\"text\":\"\",\"link\":\"/Document/Mojo/\"}]},{\"text\":\"ğŸŒŸPHP\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"PHPå­¦ä¹ èµ„æº\",\"link\":\"/Document/PHP/PHPå­¦ä¹ èµ„æº\"},{\"text\":\"\",\"link\":\"/Document/PHP/\"}]},{\"text\":\"ğŸŒŸSwift\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Swiftå­¦ä¹ èµ„æº\",\"link\":\"/Document/Swift/Swiftå­¦ä¹ èµ„æº\"},{\"text\":\"\",\"link\":\"/Document/Swift/\"},{\"text\":\"\",\"link\":\"/Document/Swift/\"}]},{\"text\":\"ğŸŒŸC/C++\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"C-C++å­¦ä¹ èµ„æº\",\"link\":\"/Document/C-C++/C-C++å­¦ä¹ èµ„æº\"},{\"text\":\"å¼€æºçš„C-C+åŒ…ç®¡ç†å·¥å…·\",\"link\":\"/Document/C-C++/å¼€æºçš„C-C+åŒ…ç®¡ç†å·¥å…·\"},{\"text\":\"C-C++è¯­è¨€ç›¸å…³å·¥å…·\",\"link\":\"/Document/C-C++/C-C++è¯­è¨€ç›¸å…³å·¥å…·\"},{\"text\":\"\",\"link\":\"/Document/C-C++/\"},{\"text\":\"\",\"link\":\"/Document/C-C++/\"}]},{\"text\":\"ğŸŒŸRust\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Rustå­¦ä¹ èµ„æº\",\"link\":\"/Document/Rust/Rustå­¦ä¹ èµ„æº\"},{\"text\":\"Rustå­¦ä¹ è·¯çº¿\",\"link\":\"/Document/Rust/Rustå­¦ä¹ è·¯çº¿\"},{\"text\":\"0.Rustä»‹ç»å’Œåº”ç”¨\",\"link\":\"/Document/Rust/0.Rustä»‹ç»å’Œåº”ç”¨\"},{\"text\":\"1.Rustå¼€å‘ç¯å¢ƒæ­å»º\",\"link\":\"/Document/Rust/1.Rustå¼€å‘ç¯å¢ƒæ­å»º\"},{\"text\":\"2.RuståŸºç¡€ç¯‡\",\"link\":\"/Document/Rust/2.RuståŸºç¡€ç¯‡\"},{\"text\":\"3.Rustè¿›é˜¶ç¯‡\",\"link\":\"/Document/Rust/3.Rustè¿›é˜¶ç¯‡\"},{\"text\":\"4.Rustæ¡†æ¶ç¯‡\",\"link\":\"/Document/Rust/4.Rustæ¡†æ¶ç¯‡\"},{\"text\":\"5.Rusté¡¹ç›®å®æˆ˜ç¯‡\",\"link\":\"/Document/Rust/5.Rusté¡¹ç›®å®æˆ˜ç¯‡\"},{\"text\":\"6.Rustä¸WebAssembly\",\"link\":\"/Document/Rust/6.Rustä¸WebAssembly\"},{\"text\":\"7.Rustè®¾è®¡æ¨¡å¼\",\"link\":\"/Document/Rust/7.Rustè®¾è®¡æ¨¡å¼\"},{\"text\":\"8.Rustæ¸¸æˆå¼€å‘\",\"link\":\"/Document/Rust/8.Rustæ¸¸æˆå¼€å‘\"},{\"text\":\"9.Rustç¨‹åºè°ƒè¯•\",\"link\":\"/Document/Rust/9.Rustç¨‹åºè°ƒè¯•\"},{\"text\":\"10.Rustæ€§èƒ½åˆ†æä¸ä¼˜åŒ–å®æˆ˜\",\"link\":\"/Document/Rust/10.Rustæ€§èƒ½åˆ†æä¸ä¼˜åŒ–å®æˆ˜\"},{\"text\":\"11.Rusté¢è¯•é¢˜\",\"link\":\"/Document/Rust/11.Rusté¢è¯•é¢˜\"},{\"text\":\"Rustæ¡†æ¶å’Œåº“\",\"link\":\"/Document/Rust/Rustæ¡†æ¶å’Œåº“\"},{\"text\":\"Rustå¼€æºé¡¹ç›®\",\"link\":\"/Document/Rust/Rustå¼€æºé¡¹ç›®\"},{\"text\":\"Rustç§»åŠ¨ç«¯å¼€å‘ä½“éªŒ\",\"link\":\"/Document/Rust/Rustç§»åŠ¨ç«¯å¼€å‘ä½“éªŒ\"},{\"text\":\"Rustå’Œå…¶ä»–è¯­è¨€ç»“åˆ\",\"link\":\"/Document/Rust/Rustå’Œå…¶ä»–è¯­è¨€ç»“åˆ\"}]},{\"text\":\"ğŸŒŸLua\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Luaè¯­è¨€å­¦ä¹ èµ„æº\",\"link\":\"/Document/Lua/Luaè¯­è¨€å­¦ä¹ èµ„æº\"},{\"text\":\"LuaåŸºç¡€å…¥é—¨\",\"link\":\"/Document/Lua/LuaåŸºç¡€å…¥é—¨\"},{\"text\":\"LuaåŸºç¡€è¯­æ³•å…¥é—¨\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"1.å¼€å§‹\",\"link\":\"/Document/Lua/LuaåŸºç¡€å…¥é—¨/1.å¼€å§‹\"},{\"text\":\"2.ç±»å‹å’Œå€¼\",\"link\":\"/Document/Lua/LuaåŸºç¡€å…¥é—¨/2.ç±»å‹å’Œå€¼\"},{\"text\":\"3.è¡¨è¾¾å¼\",\"link\":\"/Document/Lua/LuaåŸºç¡€å…¥é—¨/3.è¡¨è¾¾å¼\"},{\"text\":\"4.è¯­å¥\",\"link\":\"/Document/Lua/LuaåŸºç¡€å…¥é—¨/4.è¯­å¥\"}]},{\"text\":\"Luaå®æˆ˜\",\"link\":\"/Document/Lua/Luaå®æˆ˜\"},{\"text\":\"Luaå¼€å‘å®‰å“åº”ç”¨\",\"link\":\"/Document/Lua/Luaå¼€å‘å®‰å“åº”ç”¨\"},{\"text\":\"\",\"link\":\"/Document/Lua/\"}]},{\"text\":\"ğŸŒŸZig\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Zigä»‹ç»\",\"link\":\"/Document/Zig/Zigä»‹ç»\"},{\"text\":\"Zigç›¸å…³å­¦ä¹ èµ„æº\",\"link\":\"/Document/Zig/Zigç›¸å…³å­¦ä¹ èµ„æº\"},{\"text\":\"Zigå…¥é—¨\",\"link\":\"/Document/Zig/Zigå…¥é—¨\"},{\"text\":\"\",\"link\":\"/Document/Zig/\"}]},{\"text\":\"ğŸŒŸæ±‡ç¼–\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"æ±‡ç¼–ç®€ä»‹å’Œèµ„æº\",\"link\":\"/Document/æ±‡ç¼–/æ±‡ç¼–ç®€ä»‹å’Œèµ„æº\"},{\"text\":\"æ±‡ç¼–å…¥é—¨\",\"link\":\"/Document/æ±‡ç¼–/æ±‡ç¼–å…¥é—¨\"},{\"text\":\"\",\"link\":\"/Document/æ±‡ç¼–/\"},{\"text\":\"æ±‡ç¼–å¼€æºé¡¹ç›®\",\"link\":\"/Document/æ±‡ç¼–/æ±‡ç¼–å¼€æºé¡¹ç›®\"},{\"text\":\"\",\"link\":\"/Document/æ±‡ç¼–/\"}]},{\"text\":\"Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘ç®€ä»‹\",\"link\":\"/Document/Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘/Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘ç®€ä»‹\"},{\"text\":\"Harmonyå¼€æºé¡¹ç›®\",\"link\":\"/Document/Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘/Harmonyå¼€æºé¡¹ç›®\"},{\"text\":\"\",\"link\":\"/Document/Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘/\"},{\"text\":\"\",\"link\":\"/Document/Harmonyé¸¿è’™ç³»ç»Ÿåº”ç”¨å¼€å‘/\"}]},{\"text\":\"AIå¤§è¯­è¨€æ¨¡å‹\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"AIå¤§è¯­è¨€æ¨¡å‹å­¦ä¹ èµ„æº\",\"link\":\"/Document/AIå¤§è¯­è¨€æ¨¡å‹/AIå¤§è¯­è¨€æ¨¡å‹å­¦ä¹ èµ„æº\"},{\"text\":\"AIæ¨¡å‹\",\"link\":\"/Document/AIå¤§è¯­è¨€æ¨¡å‹/AIæ¨¡å‹\"},{\"text\":\"\",\"link\":\"/Document/AIå¤§è¯­è¨€æ¨¡å‹/\"},{\"text\":\"\",\"link\":\"/Document/AIå¤§è¯­è¨€æ¨¡å‹/\"}]},{\"text\":\"æ•°æ®åº“\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"å¸¸ç”¨æ•°æ®åº“\",\"link\":\"/Document/æ•°æ®åº“/å¸¸ç”¨æ•°æ®åº“\"},{\"text\":\"æ•°æ®åº“å·¥å…·\",\"link\":\"/Document/æ•°æ®åº“/æ•°æ®åº“å·¥å…·\"},{\"text\":\"æ•°æ®åº“å·¥å…·\",\"link\":\"/Document/æ•°æ®åº“/æ•°æ®åº“å·¥å…·\"},{\"text\":\"æ•°æ®åº“å†…æ ¸å®ç°\",\"link\":\"/Document/æ•°æ®åº“/æ•°æ®åº“å†…æ ¸å®ç°\"},{\"text\":\"MySQL\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"MySQLå­¦ä¹ èµ„æº\",\"link\":\"/Document/æ•°æ®åº“/MySQL/MySQLå­¦ä¹ èµ„æº\"},{\"text\":\"MySQLå­¦ä¹ è·¯çº¿\",\"link\":\"/Document/æ•°æ®åº“/MySQL/MySQLå­¦ä¹ è·¯çº¿\"},{\"text\":\"MySQLå…¥é—¨\",\"link\":\"/Document/æ•°æ®åº“/MySQL/MySQLå…¥é—¨\"}]},{\"text\":\"SQLite\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"SQLite\",\"link\":\"/Document/æ•°æ®åº“/SQLite\"},{\"text\":\"\",\"link\":\"/Document/æ•°æ®åº“/SQLite/\"},{\"text\":\"\",\"link\":\"/Document/æ•°æ®åº“/SQLite/\"}]},{\"text\":\"\",\"link\":\"/Document/æ•°æ®åº“/\"},{\"text\":\"\",\"link\":\"/Document/æ•°æ®åº“/\"},{\"text\":\"\",\"link\":\"/Document/æ•°æ®åº“/\"}]},{\"text\":\"ğŸŒŸLinux\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Linuxå‘½ä»¤\",\"link\":\"/Document/Linux/Linuxå‘½ä»¤\"},{\"text\":\"Linuxå†…æ ¸\",\"link\":\"/Document/Linux/Linuxå†…æ ¸\"},{\"text\":\"Linuxè„šæœ¬\",\"link\":\"/Document/Linux/Linuxè„šæœ¬\"},{\"text\":\"\",\"link\":\"/Document/Linux/\"}]},{\"text\":\"ğŸŒŸDocker\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Dockerå…¥é—¨\",\"link\":\"/Document/Docker/Dockerå…¥é—¨\"},{\"text\":\"ğŸŒŸDockeråº”ç”¨\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Dockeråº”ç”¨æ”¶é›†\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/Dockeråº”ç”¨æ”¶é›†\"},{\"text\":\"Dockerè‡ªå»ºäº‘æ‰‹æœº\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/Dockerè‡ªå»ºäº‘æ‰‹æœº\"},{\"text\":\"Docker åŠ æŒçš„å®‰å“æ‰‹æœºï¼šéšèº«æºå¸¦çš„çŸ¥è¯†åº“\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/Docker åŠ æŒçš„å®‰å“æ‰‹æœºï¼šéšèº«æºå¸¦çš„çŸ¥è¯†åº“\"},{\"text\":\"NASè‡ªæ‰˜ç®¡åº”ç”¨æœåŠ¡APPç«¯\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/NASè‡ªæ‰˜ç®¡åº”ç”¨æœåŠ¡APPç«¯\"},{\"text\":\"Webmanå®æˆ˜æ•™ç¨‹_è½»æ¾ä½¿ç”¨Dockeréƒ¨ç½²Webmané¡¹ç›®â€”æ‰“é€ ä¸“å±ä½ çš„Webåº”ç”¨\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/Webmanå®æˆ˜æ•™ç¨‹_è½»æ¾ä½¿ç”¨Dockeréƒ¨ç½²Webmané¡¹ç›®â€”æ‰“é€ ä¸“å±ä½ çš„Webåº”ç”¨\"},{\"text\":\"Dockerå¿«é€Ÿå…¥é—¨å’Œéƒ¨ç½²ä½¿ç”¨æ•™ç¨‹\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/Dockerå¿«é€Ÿå…¥é—¨å’Œéƒ¨ç½²ä½¿ç”¨æ•™ç¨‹\"},{\"text\":\"Docker-Desktopå¼€å¯å†…ç½®çš„K8Så¹¶å®‰è£…kuboardè¿›è¡Œå¾®æœåŠ¡ç®¡ç†\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/Docker-Desktopå¼€å¯å†…ç½®çš„K8Så¹¶å®‰è£…kuboardè¿›è¡Œå¾®æœåŠ¡ç®¡ç†\"},{\"text\":\"ä½¿ç”¨Watchtowerè‡ªåŠ¨æ›´æ–°Dockeré•œåƒä¸å®¹å™¨\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/ä½¿ç”¨Watchtowerè‡ªåŠ¨æ›´æ–°Dockeré•œåƒä¸å®¹å™¨\"},{\"text\":\"å¦‚ä½•ä¼˜é›…çš„å˜æ›´Docker-Desktopçš„é•œåƒå­˜å‚¨è·¯å¾„\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/å¦‚ä½•ä¼˜é›…çš„å˜æ›´Docker-Desktopçš„é•œåƒå­˜å‚¨è·¯å¾„\"},{\"text\":\"å¦‚ä½•ä½¿ç”¨ GitHub Actions æ„å»º Docker é•œåƒ\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/å¦‚ä½•ä½¿ç”¨ GitHub Actions æ„å»º Docker é•œåƒ\"},{\"text\":\"å¼€æºLinuxæœåŠ¡å™¨è¿ç»´é¢æ¿1Panelæ„å»ºPHPå®¹å™¨è¿è¡Œwebmanæ¡†æ¶\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/å¼€æºLinuxæœåŠ¡å™¨è¿ç»´é¢æ¿1Panelæ„å»ºPHPå®¹å™¨è¿è¡Œwebmanæ¡†æ¶\"},{\"text\":\"å°†Dockeré•œåƒç¼–è¯‘æˆç‹¬ç«‹å¯ç§»æ¤äºŒè¿›åˆ¶æ–‡ä»¶\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/å°†Dockeré•œåƒç¼–è¯‘æˆç‹¬ç«‹å¯ç§»æ¤äºŒè¿›åˆ¶æ–‡ä»¶\"},{\"text\":\"å‘Šåˆ«Dockerfile,æ‹¥æŠ± docker init æ„å»ºDockeré•œåƒ\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/å‘Šåˆ«Dockerfile,æ‹¥æŠ± docker init æ„å»ºDockeré•œåƒ\"},{\"text\":\"\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/\"},{\"text\":\"è‘«èŠ¦å¨ƒå¹³å°è‡ªåŠ¨é¢„çº¦èŒ…å°\",\"link\":\"/Document/Docker/Dockeråº”ç”¨/è‘«èŠ¦å¨ƒå¹³å°è‡ªåŠ¨é¢„çº¦èŒ…å°\"}]},{\"text\":\"ğŸŒŸNAS\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"NASç¡¬ä»¶æ¨è\",\"link\":\"/Document/Docker/NAS/NASç¡¬ä»¶æ¨è\"},{\"text\":\"NASç³»ç»Ÿæ¨è\",\"link\":\"/Document/Docker/NAS/NASç³»ç»Ÿæ¨è\"},{\"text\":\"NASå¥½å·¥å…·æ¨è\",\"link\":\"/Document/Docker/NAS/NASå¥½å·¥å…·æ¨è\"},{\"text\":\"ç¡¬ä»¶è®¾å¤‡æ”¹é€ æˆNAS\",\"link\":\"/Document/Docker/NAS/ç¡¬ä»¶è®¾å¤‡æ”¹é€ æˆNAS\"},{\"text\":\"é­”äº‘è…¾ZeusC1â€”â€”äº‘æ‰‹æœºå½“12ä¸ªæ‰‹æœºç”¨\",\"link\":\"/Document/Docker/NAS/é­”äº‘è…¾ZeusC1â€”â€”äº‘æ‰‹æœºå½“12ä¸ªæ‰‹æœºç”¨\"},{\"text\":\"\",\"link\":\"/Document/Docker/NAS/\"}]},{\"text\":\"\",\"link\":\"/Document/Docker/\"},{\"text\":\"\",\"link\":\"/Document/Docker/\"}]},{\"text\":\"ğŸŒŸç½‘ç»œå®‰å…¨\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"é»‘å®¢å·¥å…·ç³»åˆ—\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/é»‘å®¢å·¥å…·ç³»åˆ—\"},{\"text\":\"ç½‘ç»œå®‰å…¨ç¤¾åŒºè®ºå›\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ç½‘ç»œå®‰å…¨ç¤¾åŒºè®ºå›\"},{\"text\":\"é»‘å®¢è¾…åŠ©å·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/é»‘å®¢è¾…åŠ©å·¥å…·\"},{\"text\":\"ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Venom-Crawlerè½¬ä¸ºæ¡æ´è€Œç”Ÿçš„çˆ¬è™«ç¥å™¨\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘/Venom-Crawlerè½¬ä¸ºæ¡æ´è€Œç”Ÿçš„çˆ¬è™«ç¥å™¨\"},{\"text\":\"å¯†æ¢å·¥å…·é›†GUIæ¸—é€ç‰ˆ\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘/å¯†æ¢å·¥å…·é›†GUIæ¸—é€ç‰ˆ\"},{\"text\":\"Aomanå»æŒ‡çº¹æµè§ˆå™¨â€”ä¼ªé€ ä¸€ä¸ªå®‰å…¨çš„æ¸—é€ç¯å¢ƒ\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘/Aomanå»æŒ‡çº¹æµè§ˆå™¨â€”ä¼ªé€ ä¸€ä¸ªå®‰å…¨çš„æ¸—é€ç¯å¢ƒ\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€ç½‘ç»œå®‰å…¨å·¥å…·å’Œä½¿ç”¨ã€‘/\"}]},{\"text\":\"æ€è·¯\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"ç½‘ç»œå®‰å…¨é˜²èº«ç§˜ç±\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/ç½‘ç»œå®‰å…¨é˜²èº«ç§˜ç±\"},{\"text\":\"ä¸€ç§åˆ©ç”¨åˆæ³•å·¥å…·æ¸—é€çš„æ–°å‹æ–¹æ³•\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/ä¸€ç§åˆ©ç”¨åˆæ³•å·¥å…·æ¸—é€çš„æ–°å‹æ–¹æ³•\"},{\"text\":\"HFish_æ°¸ä¹…å…è´¹â€”å·§è®¾èœœç½è¿·å±€\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/HFish_æ°¸ä¹…å…è´¹â€”å·§è®¾èœœç½è¿·å±€\"},{\"text\":\"Appæ¸—é€_äººè„¸è¯†åˆ«ç™»å½•ç»•è¿‡\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/Appæ¸—é€_äººè„¸è¯†åˆ«ç™»å½•ç»•è¿‡\"},{\"text\":\"è¿½è¸ªæ”»å‡»æºå¤´ ä»IPåœ°å€åˆ°æ”»å‡»è€…èº«ä»½çš„æº¯æºä¹‹æ—…\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/è¿½è¸ªæ”»å‡»æºå¤´ ä»IPåœ°å€åˆ°æ”»å‡»è€…èº«ä»½çš„æº¯æºä¹‹æ—…\"},{\"text\":\"åœ¨å®¶æ‰“å¡çš„æ–¹æ³•\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/åœ¨å®¶æ‰“å¡çš„æ–¹æ³•\"},{\"text\":\"ç½‘ç»œæ°´å†›\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/ç½‘ç»œæ°´å†›\"},{\"text\":\"å¦‚ä½•ä½¿ç”¨å¼€æºæƒ…æŠ¥è·Ÿè¸ªä¸€ä¸ªäºº\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/å¦‚ä½•ä½¿ç”¨å¼€æºæƒ…æŠ¥è·Ÿè¸ªä¸€ä¸ªäºº\"},{\"text\":\"ä½ æ˜¯å¦åœ¨æ­£ç¡®çš„ä½¿ç”¨vpn\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/ä½ æ˜¯å¦åœ¨æ­£ç¡®çš„ä½¿ç”¨vpn\"},{\"text\":\"å¯ç›‘å¬VPNçš„é»‘å®¢æŠ€æœ¯\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/å¯ç›‘å¬VPNçš„é»‘å®¢æŠ€æœ¯\"},{\"text\":\"åŸºäºLinuxå†…æ ¸çš„VPNå·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/åŸºäºLinuxå†…æ ¸çš„VPNå·¥å…·\"},{\"text\":\"æµè§ˆå™¨æ’ä»¶â€”ModHeader_åŠ©ä½ ç»•è¿‡å¾®ä¿¡æˆæƒç™»å½•é™åˆ¶\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/æµè§ˆå™¨æ’ä»¶â€”ModHeader_åŠ©ä½ ç»•è¿‡å¾®ä¿¡æˆæƒç™»å½•é™åˆ¶\"},{\"text\":\"æ£€æµ‹è‡ªå®¶æ‘„åƒå¤´æ˜¯å¦å­˜åœ¨æ¼æ´\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/æ£€æµ‹è‡ªå®¶æ‘„åƒå¤´æ˜¯å¦å­˜åœ¨æ¼æ´\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ€è·¯ã€‘/\"}]},{\"text\":\"KaliLinux\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"å®ä½“æœºå®‰è£…kaliæ•™ç¨‹\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/å®ä½“æœºå®‰è£…kaliæ•™ç¨‹\"},{\"text\":\"æ‰‹æœºå®‰è£…Kali Linux\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/æ‰‹æœºå®‰è£…Kali Linux\"},{\"text\":\"KaliLinuxå·¥å…·è„‘å›¾_å®‰å…¨ä¸“å®¶çš„å†›æ¢°åº“\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/KaliLinuxå·¥å…·è„‘å›¾_å®‰å…¨ä¸“å®¶çš„å†›æ¢°åº“\"},{\"text\":\"kali Linuxå®‰å…¨å·¥å…·é›†åˆ\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/kali Linuxå®‰å…¨å·¥å…·é›†åˆ\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/\"},{\"text\":\"KaliLinuxä¸‹ç¼–å†™å®‰å“æœ¨é©¬\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/KaliLinuxä¸‹ç¼–å†™å®‰å“æœ¨é©¬\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€KaliLinuxã€‘/\"}]},{\"text\":\"æŠ“åŒ…é…ç½®\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"å®‰å“é«˜ç‰ˆæœ¬HTTPSæŠ“åŒ…ç»ˆæè§£å†³æ–¹æ¡ˆ\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æŠ“åŒ…é…ç½®ã€‘/å®‰å“é«˜ç‰ˆæœ¬HTTPSæŠ“åŒ…ç»ˆæè§£å†³æ–¹æ¡ˆ\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æŠ“åŒ…é…ç½®ã€‘/\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æŠ“åŒ…é…ç½®ã€‘/\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æŠ“åŒ…é…ç½®ã€‘/\"}]},{\"text\":\"æ¸—é€æµ‹è¯•å·¥å…·\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"æ¸—é€æµ‹è¯•å·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€æ¸—é€æµ‹è¯•å·¥å…·ã€‘/æ¸—é€æµ‹è¯•å·¥å…·\"}]},{\"text\":\"é€†å‘ç ´è§£\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"Magisk-Lsposed è§£å†³æŸéŸ³APPæŠ“åŒ…é—®é¢˜\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/Magisk-Lsposed è§£å†³æŸéŸ³APPæŠ“åŒ…é—®é¢˜\"},{\"text\":\"æŠ–éŸ³abogusé€†å‘åˆ†æ\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/æŠ–éŸ³abogusé€†å‘åˆ†æ\"},{\"text\":\"JSé€†å‘å·¥å…·æ¸…å•\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/JSé€†å‘å·¥å…·æ¸…å•\"},{\"text\":\"jsé€†å‘\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/jsé€†å‘\"},{\"text\":\"fridaå…¥é—¨ä½¿ç”¨ä»‹ç»\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/fridaå…¥é—¨ä½¿ç”¨ä»‹ç»\"},{\"text\":\"Electronåº”ç”¨éªŒè¯ç ´è§£\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/Electronåº”ç”¨éªŒè¯ç ´è§£\"},{\"text\":\"clash+yaktæŠ“åŒ…å¾®ä¿¡å°ç¨‹åº\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/clash+yaktæŠ“åŒ…å¾®ä¿¡å°ç¨‹åº\"},{\"text\":\"APPé€†å‘ç ´è§£æ•™ç¨‹\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/APPé€†å‘ç ´è§£æ•™ç¨‹\"},{\"text\":\"APKé€†å‘å·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/APKé€†å‘å·¥å…·\"},{\"text\":\"ç½‘ç»œå—…æ¢çš„åŸç†å’Œå¸¸ç”¨å·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/ç½‘ç»œå—…æ¢çš„åŸç†å’Œå¸¸ç”¨å·¥å…·\"},{\"text\":\"å¼€æºé€†å‘å·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/å¼€æºé€†å‘å·¥å…·\"},{\"text\":\"ã€è½¦è”ç½‘ã€‘è½¦è½½ Android åº”ç”¨æ”»å‡»-é€†å‘å·¥å…·\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/ã€è½¦è”ç½‘ã€‘è½¦è½½ Android åº”ç”¨æ”»å‡»-é€†å‘å·¥å…·\"},{\"text\":\"ã€å®‰å“é€†å‘ã€‘æ·˜ç³»æŠ“åŒ…æ±‡æ€»(é±¼ éº¦ çŒ« é¥¿ å®)\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/ã€å®‰å“é€†å‘ã€‘æ·˜ç³»æŠ“åŒ…æ±‡æ€»(é±¼ éº¦ çŒ« é¥¿ å®)\"},{\"text\":\"ã€å®‰å“é€†å‘ã€‘æŸéŸ³æµ·å¤–ç‰ˆtiktokæŠ“åŒ…\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/ã€å®‰å“é€†å‘ã€‘æŸéŸ³æµ·å¤–ç‰ˆtiktokæŠ“åŒ…\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é€†å‘ç ´è§£ã€‘/\"}]},{\"text\":\"é»‘å®¢æŠ€æœ¯\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"æ•°æ®ç»“æ„ç®—æ³•çš„åº”ç”¨\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é»‘å®¢æŠ€æœ¯ã€‘/æ•°æ®ç»“æ„ç®—æ³•çš„åº”ç”¨\"},{\"text\":\"ä¸åˆ·å›ºä»¶æ­¦è£…å®¶ç”¨è·¯ç”±å™¨\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é»‘å®¢æŠ€æœ¯ã€‘/ä¸åˆ·å›ºä»¶æ­¦è£…å®¶ç”¨è·¯ç”±å™¨\"},{\"text\":\"åé—¨æŠ€æœ¯\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é»‘å®¢æŠ€æœ¯ã€‘/åé—¨æŠ€æœ¯\"},{\"text\":\"åœ¨Windowsç³»ç»Ÿä¸‹ææƒçš„8ç§ä¸»è¦å§¿åŠ¿\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é»‘å®¢æŠ€æœ¯ã€‘/åœ¨Windowsç³»ç»Ÿä¸‹ææƒçš„8ç§ä¸»è¦å§¿åŠ¿\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ã€é»‘å®¢æŠ€æœ¯ã€‘/\"}]},{\"text\":\"ç½‘ç»œå®‰å…¨æ•™ç¨‹\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ç½‘ç»œå®‰å…¨æ•™ç¨‹\"},{\"text\":\"ç½‘ç»œå®‰å…¨ç›¸å…³ç¯å¢ƒ\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/ç½‘ç»œå®‰å…¨ç›¸å…³ç¯å¢ƒ\"},{\"text\":\"é»‘å®¢å¼€æºé¡¹ç›®\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/é»‘å®¢å¼€æºé¡¹ç›®\"},{\"text\":\"å®‰å…¨ç›¸å…³çš„å¼€æºé¡¹ç›®\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/å®‰å…¨ç›¸å…³çš„å¼€æºé¡¹ç›®\"},{\"text\":\"\",\"link\":\"/Document/ç½‘ç»œå®‰å…¨/\"}]},{\"text\":\"å¼€æºç›¸å…³\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"æ‰“é€ ä¸€ä¸ªèŠ±é‡Œèƒ¡å“¨çš„Githubä¸ªäººä¸»é¡µ\",\"link\":\"/Document/å¼€æºç›¸å…³/æ‰“é€ ä¸€ä¸ªèŠ±é‡Œèƒ¡å“¨çš„Githubä¸ªäººä¸»é¡µ\"},{\"text\":\"\",\"link\":\"/Document/å¼€æºç›¸å…³/\"},{\"text\":\"\",\"link\":\"/Document/å¼€æºç›¸å…³/\"},{\"text\":\"\",\"link\":\"/Document/å¼€æºç›¸å…³/\"},{\"text\":\"\",\"link\":\"/Document/å¼€æºç›¸å…³/\"},{\"text\":\"\",\"link\":\"/Document/å¼€æºç›¸å…³/\"}]}]},\"editLink\":{\"pattern\":\"https://gitee.com/muyaCode/program-learn-notes/edit/main/docs/:path\",\"text\":\"åœ¨ Giteeä¸Šç¼–è¾‘æ­¤é¡µ\"},\"lastUpdated\":{\"text\":\"ä¸Šæ¬¡æ›´æ–°ï¼š\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"docFooter\":{\"prev\":\"ä¸Šä¸€ç¯‡\",\"next\":\"ä¸‹ä¸€ç¯‡\"},\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright Â© 2024  heyu\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>