# 5.Rust é¡¹ç›®å®æˆ˜ç¯‡

## å¾…å®šæ–‡ç« 

[Rustè¯­è¨€å®ç°åŸºäº WebSocket å’Œ HTTP2 çš„æµé‡éš§é“ (qq.com)](https://mp.weixin.qq.com/s/7JIlF-kThamprjBryS7faA)

[Rust å®ç°æ–‡ä»¶æ‰¹é‡ä¸‹è½½ (qq.com)](https://mp.weixin.qq.com/s/k7QaXacwJ22hl8S9Yz2Wuw)

## Rust ç¼–ç¨‹çš„åå¤§é¢†åŸŸ

Rust ç»å¸¸è¢«èª‰ä¸ºâ€œåªè¦èƒ½å†™å°±èƒ½åšä»»ä½•äº‹æƒ…çš„è¯­è¨€â€ï¼Œå®ƒç¡®å®æ˜¯ä¸€ç§å…·æœ‰æ— é™å¯èƒ½æ€§çš„é€šç”¨è¯­è¨€ã€‚ä»åµŒå…¥å¼ç³»ç»Ÿåˆ° web æµè§ˆå™¨ï¼ŒRust çš„åº•å±‚èƒ½åŠ›æ˜¯æ— é™çš„ã€‚é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Rust å¼•èµ·è½°åŠ¨çš„åå¤§é¢†åŸŸï¼š

**1ã€åµŒå…¥å¼å¼€å‘ï¼š**å¦‚æœä½ å¯¹ç¡¬ä»¶å’Œç”µå­äº§å“ç€è¿·ï¼Œé‚£ä¹ˆ Rust æ˜¯ä½ çš„é¦–é€‰è¯­è¨€ã€‚æœ‰äº†æ ‘è“æ´¾ç­‰å¹³å°çš„æ”¯æŒï¼Œä½ å¯ä»¥å†’é™©è¿›å…¥ä»¤äººå…´å¥‹çš„é¡¹ç›®ï¼Œä»ç”µæ± /å¤ªé˜³èƒ½æ§åˆ¶ç³»ç»Ÿåˆ°é£è¡Œä»£ç æ¨¡æ‹Ÿã€‚

**2ã€ç½‘ç»œåŸºç¡€è®¾æ–½å·¥å…·ï¼š**Rust é€šè¿‡æ—¥å¿—è·¯ç”±ã€æŒ‡æ ‡åˆ†æã€è´Ÿè½½å¹³è¡¡ç­‰åº”ç”¨ç¨‹åºåœ¨ç½‘ç»œåŸºç¡€è®¾æ–½é¢†åŸŸæ‰¾åˆ°äº†è‡ªå·±çš„ä½ç½®ã€‚å®ƒçš„é«˜æ•ˆç‡å’Œå¥å£®çš„å†…å­˜ç®¡ç†ä½¿å…¶æˆä¸º ssl æµé‡ä»£ç†å’Œæ—¥å¿—è§£æç­‰ä»»åŠ¡çš„é¦–é€‰ã€‚

æœ‰äººåœ¨ç½‘ä¸Šè¿™ä¹ˆè¯´ï¼šâ€œå¦‚æœæœ‰ä»€ä¹ˆä¸œè¥¿å¯ä»¥å†™å‡ºæ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿å°±å¯ä»¥ç”¨ Rust å†™å‡ºæ¥â€

**3ã€åç«¯ç³»ç»Ÿï¼š**Rust çš„å†…å­˜ç®¡ç†åŠŸèƒ½å·²ç»å¼•èµ·äº†å…¨ä¸–ç•Œ C å’Œ C++å¼€å‘äººå‘˜çš„æ³¨æ„ã€‚å®ƒè¶Šæ¥è¶Šå¤šåœ°è¢«ç”¨äºåç«¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬ä¼ ç»Ÿä¸Šç”¨ C ç¼–ç çš„åº•å±‚ç¼“å­˜è½¯ä»¶ã€‚

**4ã€Web æµè§ˆå™¨(WASM)ï¼š**Rust çš„é€Ÿåº¦å’Œç±»å‹æ£€æŸ¥èƒ½åŠ›ä½¿å…¶æˆä¸º WebAssembly (WASM)å¼€å‘çš„ç†æƒ³é€‰æ‹©ã€‚å®ƒçš„ WASM ç”Ÿæ€ç³»ç»Ÿç¡®ä¿äº†é«˜æ•ˆå’Œæ—  bug çš„ç¼–è¯‘ï¼Œä½¿å…¶æˆä¸º web å¼€å‘äººå‘˜çš„æœ€çˆ±ã€‚

**5ã€å›¾å½¢ç”¨æˆ·ç•Œé¢(GUI)ï¼š**éšç€åƒ Tauri è¿™æ ·çš„æ¡†æ¶è¶Šæ¥è¶Šæµè¡Œï¼ŒRust æˆä¸º GUI å¼€å‘çš„ä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„é€‰æ‹©ã€‚ç»“åˆ Next.js æˆ– React.js ç­‰å·¥å…·ï¼ŒRust ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåˆ¶ä½œæ—¶å°šé«˜æ•ˆçš„ GUI åº”ç”¨ç¨‹åºã€‚

**6ã€å‘½ä»¤è¡Œæ¥å£(CLI)å·¥å…·ï¼š**Rust çš„ç®€å•æ€§å’Œæ€§èƒ½ä½¿å…¶æˆä¸ºæ„å»º CLI çš„å®Œç¾å·¥å…·ã€‚æ— è®ºæ˜¯è‡ªåŠ¨åŒ–ä»»åŠ¡è¿˜æ˜¯å¢å¼ºç”¨æˆ·ä½“éªŒï¼Œrust é©±åŠ¨çš„ CLI å·¥å…·éƒ½æä¾›äº†å¯é æ€§å’Œé«˜æ•ˆç‡ã€‚

**7ã€åŒºå—é“¾ï¼š**Rust å·²ç»åœ¨åŒºå—é“¾é¢†åŸŸæ‰¾åˆ°äº†è‡ªå·±çš„å®šä½ï¼Œåƒ Solana è¿™æ ·çš„é¡¹ç›®åˆ©ç”¨äº†å®ƒçš„èƒ½åŠ›ã€‚ä»åŠ å¯†é’±åŒ…åˆ°æ™ºèƒ½åˆçº¦ï¼ŒRust åœ¨æ„å»ºå¥å£®å’Œå®‰å…¨çš„åŒºå—é“¾è§£å†³æ–¹æ¡ˆæ–¹é¢å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚

**8ã€æ¸¸æˆå¼€å‘ï¼š**Rust çš„é€Ÿåº¦å’Œå®‰å…¨æ€§ä½¿å…¶æˆä¸ºæ¸¸æˆå¼€å‘è€…çš„ä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„é€‰æ‹©ã€‚æœ‰äº†åƒ Amethyst è¿™æ ·çš„æ¡†æ¶ï¼ŒRust å¯ä»¥åˆ›å»ºé«˜æ€§èƒ½å’Œé«˜æ‰©å±•æ€§çš„æ¸¸æˆã€‚

**9ã€é‡‘èç§‘æŠ€(FinTech)ï¼š**Rust çš„å¯é æ€§å’Œé«˜æ€§èƒ½ä½¿å…¶éå¸¸é€‚åˆå¼€å‘é‡‘èç§‘æŠ€è§£å†³æ–¹æ¡ˆã€‚å…¶å¼ºå¤§çš„å¹¶å‘æ”¯æŒå’Œå†…å­˜å®‰å…¨ç‰¹æ€§ç¡®ä¿äº†é‡‘èåº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚

**10ã€äº‘è®¡ç®—ï¼š**Rust çš„è½»é‡çº§å ç”¨ç©ºé—´å’Œé«˜æ•ˆçš„èµ„æºç®¡ç†ä½¿å…¶éå¸¸é€‚åˆäº‘è®¡ç®—åº”ç”¨ç¨‹åºã€‚æ— è®ºæ˜¯æ„å»ºå¯æ‰©å±•çš„å¾®æœåŠ¡è¿˜æ˜¯ä¼˜åŒ–äº‘åŸºç¡€è®¾æ–½ï¼ŒRust éƒ½ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åº”å¯¹å¤æ‚çš„æŒ‘æˆ˜ã€‚

# ç”Ÿäº§ç¯å¢ƒï¼šä¸€ä¸ªRusté¡¹ç›®åŒ…å«çš„è¦ç´ 

Rustå› å…¶æ€§èƒ½ã€å®‰å…¨æ€§å’Œå¹¶å‘ç‰¹æ€§è€Œå—åˆ°å¼€å‘è€…çš„é’çã€‚ç„¶è€Œï¼Œå°†Rusté¡¹ç›®æ¨å‘ç”Ÿäº§ç¯å¢ƒï¼Œä¸ä»…ä»…æ˜¯ç¼–å†™ä»£ç é‚£ä¹ˆç®€å•ï¼Œè¿˜æ¶‰åŠä»£ç ä»“åº“çš„ç®¡ç†ã€æµ‹è¯•ä¸æŒç»­é›†æˆã€æ–‡æ¡£ã€ç‰¹æ€§ç®¡ç†ã€ç¼–è¯‘æœŸå¤„ç†ã€æ—¥å¿—å’Œç›‘æ§ç­‰å¤šä¸ªæ–¹é¢ã€‚

### ä»£ç ä»“åº“çš„ç®¡ç†

ä»£ç ä»“åº“çš„ç®¡ç†æ˜¯é¡¹ç›®ç®¡ç†çš„åŸºç¡€ã€‚ä¸€ä¸ªè‰¯å¥½çš„ä»“åº“ç®¡ç†ç­–ç•¥åŒ…æ‹¬ä½†ä¸é™äºï¼š

- ä½¿ç”¨`.gitignore`æ–‡ä»¶æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶å’Œç›®å½•ã€‚
- ä¿æŒæäº¤ä¿¡æ¯çš„æ¸…æ™°å’Œæœ‰æ„ä¹‰ã€‚
- é‡‡ç”¨åˆ†æ”¯ç­–ç•¥ç®¡ç†ä¸åŒçš„å¼€å‘å‘¨æœŸï¼Œå¦‚Git Flowã€‚

### æµ‹è¯•å’ŒæŒç»­é›†æˆ

æµ‹è¯•æ˜¯ä¿è¯ä»£ç è´¨é‡çš„é‡è¦æ‰‹æ®µã€‚Rusté¡¹ç›®é€šå¸¸ä¼šåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œæ–‡æ¡£æµ‹è¯•ã€‚

```rust
#[cfg(test)]
mod tests {
   #[test]
   fn it_works() {
       assert_eq!(2 + 2, 4);
  }
}
```

æŒç»­é›†æˆï¼ˆCIï¼‰é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•å’Œæ„å»ºè¿‡ç¨‹ï¼Œç¡®ä¿ä»£ç çš„å¥å£®æ€§ã€‚å¸¸ç”¨çš„CIå·¥å…·åŒ…æ‹¬GitHub Actionsã€GitLab CI/CDç­‰ã€‚

```yaml
# .github/workflows/rust.yml
name: Rust

on:
push:
  branches: [ main ]
pull_request:
  branches: [ main ]

jobs:
build:
  runs-on: ubuntu-latest

  steps:
  - uses: actions/checkout@v2
  - name: Build
    run: cargo build --verbose
  - name: Run tests
    run: cargo test --verbose
```

### æ–‡æ¡£

æ–‡æ¡£å¯¹äºä»»ä½•é¡¹ç›®éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚Rustæä¾›äº†`cargo doc`å‘½ä»¤æ¥ç”Ÿæˆé¡¹ç›®æ–‡æ¡£ã€‚

```rust
/// å¯¹ä¸¤ä¸ªæ•°æ±‚å’Œ
///
/// # ç¤ºä¾‹
///
/// ```
/// let result = my_crate::add(2, 3);
/// assert_eq!(result, 5);
/// ```
pub fn add(a: i32, b: i32) -> i32 {
   a + b
}
```

### ç‰¹æ€§ç®¡ç†

Rustçš„`features`å…è®¸ä½ åœ¨ç¼–è¯‘æ—¶é€‰æ‹©æ€§åœ°å¯ç”¨æˆ–ç¦ç”¨æŸäº›åŠŸèƒ½ã€‚

```toml
[features]
default = ["sqlite"]
sqlite = []
postgres = []
```

### ç¼–è¯‘æœŸå¤„ç†

ä½¿ç”¨`build.rs`è„šæœ¬å¯ä»¥åœ¨ç¼–è¯‘æ—¶æ‰§è¡Œè‡ªå®šä¹‰çš„æ„å»ºä»»åŠ¡ã€‚

```rust
// build.rs
fn main() {
   println!("cargo:rerun-if-changed=path/to/Cargo.lock");
   // æ›´å¤šæ„å»ºé€»è¾‘...
}
```

### æ—¥å¿—å’Œç›‘æ§

ä¸ºRuståº”ç”¨ç¨‹åºæ·»åŠ æ—¥å¿—éå¸¸ç®€å•ï¼Œå¯ä»¥ä½¿ç”¨`log`å’Œ`env_logger`åº“ã€‚

```rust
use log::{info, warn};

fn main() {
   env_logger::init();
   info!("å¯åŠ¨åº”ç”¨");
   warn!("è¿™æ˜¯ä¸€ä¸ªè­¦å‘Š");
}
```

ç›‘æ§å¯ä»¥ä½¿ç”¨`metrics`åº“æ¥å®ç°ã€‚

### æ§åˆ¶ç¼–è¯‘å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶å¤§å°

Rustç¼–è¯‘å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶å¯èƒ½ä¼šæ¯”è¾ƒå¤§ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•è¿›è¡Œä¼˜åŒ–ï¼š

- ä½¿ç”¨`lto`å’Œ`codegen-units`ä¼˜åŒ–ã€‚
- ç§»é™¤æˆ–å‡å°‘ä¾èµ–ã€‚
- ä½¿ç”¨`strip`å·¥å…·ç§»é™¤è°ƒè¯•ä¿¡æ¯ã€‚

```toml
[profile.release]
lto = true
codegen-units = 1
```

### å°ç»“

æ„å»ºä¸€ä¸ªç”Ÿäº§çº§åˆ«çš„Rusté¡¹ç›®ï¼Œéœ€è¦è€ƒè™‘ä»£ç ç®¡ç†ã€æµ‹è¯•ã€æ–‡æ¡£ã€ç‰¹æ€§ç®¡ç†ã€ç¼–è¯‘æœŸå¤„ç†ã€æ—¥å¿—å’Œç›‘æ§ç­‰å¤šä¸ªæ–¹é¢ã€‚é€šè¿‡åˆç†çš„é¡¹ç›®ç»“æ„å’Œå·¥å…·é€‰æ‹©ï¼Œå¯ä»¥æœ‰æ•ˆæé«˜é¡¹ç›®çš„è´¨é‡å’Œç»´æŠ¤æ€§ã€‚å¸Œæœ›ä¸Šè¿°å†…å®¹èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç®¡ç†å’Œç»´æŠ¤ä½ çš„Rusté¡¹ç›®ã€‚

## å¾…å®šæ–‡ç« 

[Rust é¡¹ç›®å®æˆ˜ç¯‡\_å¹¿é¾™å®‡çš„åšå®¢-CSDN åšå®¢](https://blog.csdn.net/weixin_47754149/category_11915542.html)

[Rust å­¦ä¹ æŒ‡å— - çš„ä¸“æ  - æ˜é‡‘ (juejin.cn)](https://juejin.cn/column/7226181070202699831)

[å…¥é—¨ - Rust ä¸­çš„å‘½ä»¤è¡Œåº”ç”¨ç¨‹åº (rust-cli.github.io)](https://rust-cli.github.io/book/index.html)

[Rust èµ‹èƒ½å‰ç«¯-å¼€å‘ä¸€æ¬¾å±äºä½ çš„å‰ç«¯è„šæ‰‹æ¶ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7320779681674018827)

[Leptos æ¡†æ¶æ·±åº¦è§£æï¼šç”± Rust è¯­è¨€æ‰“é€ çš„å…¨æ ˆ Web æ¡†æ¶ï¼Œç”¨ Rust æ‰“é€ é«˜æ•ˆã€å£°æ˜å¼çš„ Web åº”ç”¨ä¸–ç•Œ (qq.com)](https://mp.weixin.qq.com/s/riZbzLV-hdqQ3rL__MnZ3Q)

[ä½¿ç”¨ Rust æ„å»ºé«˜æ€§èƒ½ Web åº”ç”¨ (qq.com)](https://mp.weixin.qq.com/s/G4BW83SXILNB3JX-LnDliQ)

[æ„å»ºé«˜æ€§èƒ½ Rust çˆ¬è™« (qq.com)](https://mp.weixin.qq.com/s/hQSeSVMRnzA3zmluB353Ew)

[Rust è·¨å¹³å°ç¼–è¯‘ (qq.com)](https://mp.weixin.qq.com/s/mY4cD2uj4yLxa0eoDLUP3g)

[ç”¨ Rust å†™ä¹¦ï¼Ÿè¿™ä¸ªå¼€æºé¡¹ç›®è®© Markdown å¿«é€Ÿç”Ÿæˆç²¾ç¾ç”µå­ä¹¦ï¼ (qq.com)](https://mp.weixin.qq.com/s/VJgw5WmzBZYVV5X1OBTgMA)

[Rust å®ç°æ–‡ä»¶æ‰¹é‡ä¸‹è½½ (qq.com)](https://mp.weixin.qq.com/s?__biz=MzkyMzYxNTUwMw==&mid=2247484423&idx=2&sn=585d5aa6864b19305ce3ac44f9466233&chksm=c1e32c67f694a5717c5ea9ff314ac7fde1eb2193955d98210de5f39e3020726a7aa97e41e65d&scene=21#wechat_redirect)

## Rust å’Œ Python ç›¸ç»“åˆ

[Rust FFI å¼€å‘ Python åº“å…¥é—¨æŒ‡å— (qq.com)](https://mp.weixin.qq.com/s?__biz=MzkyMzYxNTUwMw==&mid=2247484362&idx=2&sn=217c7e5269d334ba5e4b05cfdc7598d7&chksm=c1e32baaf694a2bccefa506080bc602f521dbbbb6dfab8d3c9a3ebd1db1ab860399549d19b93&scene=21#wechat_redirect)

[ç©è½¬ Rust ä¸ Python äº’æ“ä½œï¼špyo3 + maturin å®è·µæŒ‡å— (qq.com)](https://mp.weixin.qq.com/s?__biz=Mzg4ODg2NDQ0NA==&mid=2247484954&idx=1&sn=7e0cb109353b14c87657945a04930936&chksm=cff5edc9f88264dfb054bf937df1de213ac60c66ba48cb31e1ac2a6b944026fffe8255b8b2dc&cur_album_id=2734524635021328385&scene=189#wechat_redirect)

## Rust å¼€å‘ WebAssembly

[ç»™ Web å‰ç«¯å·¥ç¨‹å¸ˆçœ‹çš„ç”¨ Rust å¼€å‘ wasm ç»„ä»¶å®æˆ˜ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7279346413915717687)

[Rust ç¼–è¯‘ä¸º WebAssembly åœ¨å‰ç«¯é¡¹ç›®ä¸­ä½¿ç”¨ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7293122294775316534)

[Game = Rust + WebAssembly + æµè§ˆå™¨ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7309549333694267443)

[ç»™ Web å‰ç«¯å·¥ç¨‹å¸ˆçœ‹çš„ç”¨ Rust å¼€å‘ wasm ç»„ä»¶å®æˆ˜ | äº¬ä¸œäº‘æŠ€æœ¯å›¢é˜Ÿ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7308434321764794378)

[WASM-BINDGEN æ­èµ· Rust ä¸ JavaScript çš„æ¡¥æ¢ (qq.com)](https://mp.weixin.qq.com/s/6CI44wULfQbj-4ez4yPtiQ)

# Rust å‘½ä»¤è¡Œå·¥å…·å¼€å‘

### Rust å¼€å‘ç»ˆç«¯éŸ³ä¹æ’­æ”¾å™¨

ä»£ç åœ°å€ï¼š[forward-step/rust-player: a local audio player tui (github.com)](https://github.com/forward-step/rust-player)

#### æœ€ç»ˆæ•ˆæœå›¾

![image-20240420213706930](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/image-20240420213706930.png)

![image-20240420213725777](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/image-20240420213725777.png)

#### ä¸»è¦æŠ€æœ¯æ ˆ

##### å‘½ä»¤è¡Œ

ç¬¬ä¸‰æ–¹åº“: clap

å®ç°æ•ˆæœ:

```shell
# æŸ¥çœ‹å¸®åŠ©
rust-player -h
# æ‰“å¼€Dç›˜ä¸‹çš„mp3æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å°†æ‰€æœ‰å‘¨æ°ä¼¦å¼€å¤´çš„æ–‡ä»¶æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨ï¼Œå¹¶ä¸”å…¨å±å±•ç¤º
rust-player D://mp3 å‘¨æ°ä¼¦-* -f
```

éƒ¨åˆ†ä»£ç :

```rust
#[derive(Parser, Debug)]
#[command(author, version, about, long_about = None)]
struct Args {
    path: Option<PathBuf>,

    name: Option<String>,

    #[arg(short, long)]
    full: bool,

    #[arg(short, long)]
    info: bool,
}
```

##### ç»ˆç«¯ UI

ç¬¬ä¸‰æ–¹åº“: ratatuiï¼Œå‰èº«æ˜¯ rust ä¸­å¤§åé¼é¼çš„ **tui-rs**, ä¸è¿‡ç”±äºåŸä½œè€…çš„å·¥ä½œç¹å¿™é—®é¢˜æ— æš‡ç»´æŠ¤, å› æ­¤è¯ç”Ÿäº†è¿™ä¸ªç¤¾åŒºç‰ˆçš„, ç§¯æç»´æŠ¤çš„ forkã€‚è€Œä¸”å®˜æ–¹æ–‡æ¡£å¾ˆå‹å¥½ï¼Œæ¨è

éƒ¨åˆ†ä»£ç :

```rust
loop {
    // åˆå§‹åŒ–è„šæœ¬
    self.script.init();
    // ç»˜åˆ¶UI
    self.draw(terminal)?;
    // å¤„ç†äº‹ä»¶
    if crossterm::event::poll(Config::REFRESH_RATE)? {
        if let Event::Key(key) = event::read()? {
            match key.code {
                // å…³é—­åº”ç”¨
                KeyCode::Char('q') | KeyCode::Char('Q') => break,
                // ......
            }
        }
    }
}
```

##### éŸ³é¢‘æ’­æ”¾

ç¬¬ä¸‰æ–¹åº“: rodioã€id3ã€mp3-duration

- rodio: éŸ³é¢‘æ’­æ”¾åº“
- id3: è§£æ mp3 ç­‰åª’ä½“æ–‡ä»¶è‡ªå¸¦çš„ id3 tag ä¿¡æ¯ã€‚tag ä¸­åŒ…å«äº†åª’ä½“æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯å’Œæ­Œè¯ç­‰
- mp3-duration: rodio æ”¯æŒè·å–åª’ä½“çš„æ’­æ”¾æ—¶é•¿ï¼Œä½†æ˜¯ä¸æ”¯æŒè·å– mp3 çš„ï¼Œå› æ­¤ç”¨æ­¤ä»£æ›¿

éƒ¨åˆ†ä»£ç :

```rust
// å°è¯•ä»åª’ä½“æ–‡ä»¶çš„tagä¸­è¯»å–æ­Œè¯
// å¦‚æœå¤±è´¥ï¼Œåˆ™å°è¯•ä»åª’ä½“æ–‡ä»¶æ‰€åœ¨ç›®å½•æŸ¥æ‰¾ä¸åª’ä½“æ–‡ä»¶åŒåçš„.lrcæ­Œè¯æ–‡ä»¶
let tag = Tag::read_from_path(&path).ok();
let lyrics = if let Some(tag) = &tag {
    let mut string = String::default();
    for it in tag.lyrics() {
        string = string + &it.text;
    }
    if string.len() > 0 {
        Lyrics::from_string(string)
    } else {
        Lyrics::from_music_path(&path)
    }
} else {
    Lyrics::from_music_path(&path)
};
```

### joshutoï¼šç”¨ Rust ç¼–å†™çš„ç±»ä¼¼ ranger çš„ç»ˆç«¯æ–‡ä»¶ç®¡ç†å™¨

GitHubï¼š[kamiyaa/joshutoï¼šç”¨ Rust ç¼–å†™çš„ç±»ä¼¼ ranger çš„ç»ˆç«¯æ–‡ä»¶ç®¡ç†å™¨ (github.com)](https://github.com/kamiyaa/joshuto)

åº“ï¼š[joshuto - crates.io: Rust Package Registry](https://crates.io/crates/joshuto)

æ–‡æ¡£ï¼š[joshuto/docs at main Â· kamiyaa/joshuto (github.com)](https://github.com/kamiyaa/joshuto/tree/main/docs)

å®‰è£…ï¼š[kamiyaa/joshuto: ranger-like terminal file manager written in Rust (github.com)](https://github.com/kamiyaa/joshuto#installation)

#### ä½¿ç”¨

##### åŸºç¡€å‘½ä»¤

- å¯¼èˆª å‘ä¸Šç§»åŠ¨ï¼š
  - arrow_up æˆ– k
  - å‘ä¸‹ç§»åŠ¨ï¼šarrow_down æˆ– j
  - ç§»åŠ¨åˆ°ä¸Šçº§ç›®å½•ï¼šarrow_left æˆ– h
  - æ‰“å¼€æ–‡ä»¶æˆ–ç›®å½•ï¼šarrow_right æˆ– l
  - è·³è½¬åˆ°é¡¶éƒ¨ï¼šhome æˆ– g g
  - è·³è½¬åˆ°åº•éƒ¨ï¼šend æˆ– G
  - å‘ä¸Šç¿»é¡µï¼špage_up æˆ– ctrl+u
  - å‘ä¸‹ç¿»é¡µï¼špage_down æˆ– ctrl+d
- é€‰é¡¹å¡ç®¡ç†
  - æ‰“å¼€æ–°é€‰é¡¹å¡ï¼šctrl+t
  - ä½¿ç”¨å½“å‰ç›®å½•æ‰“å¼€æ–°é€‰é¡¹å¡ï¼šT
  - å…³é—­å½“å‰é€‰é¡¹å¡ï¼šW æˆ– ctrl+w
  - åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªé€‰é¡¹å¡ï¼š\t
  - åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªé€‰é¡¹å¡ï¼šbacktab
- æ–‡ä»¶æ“ä½œ
  - é‡å‘½åæ–‡ä»¶ï¼ša è¿›è¡Œè¿½åŠ æˆ– A è¿›è¡Œå‰ç½®
  - åˆ é™¤æ–‡ä»¶ï¼šdelete æˆ– d d
  - å‰ªåˆ‡æ–‡ä»¶ï¼šd d
  - å¤åˆ¶æ–‡ä»¶ï¼šy y
  - ç²˜è´´æ–‡ä»¶ï¼šp p
  - è¦†ç›–ç²˜è´´æ–‡ä»¶ï¼šp o
  - åˆ›å»ºæ–‡ä»¶é“¾æ¥ï¼šp l ä¸ºç»å¯¹è·¯å¾„ï¼Œp L ä¸ºç›¸å¯¹è·¯å¾„

æ›´å¤šå‘½ä»¤å‚è€ƒ[usage](https://github.com/kamiyaa/joshuto?tab=readme-ov-file#usage)

##### è‡ªå®šä¹‰é…ç½®ä¿®æ”¹

Joshuto ä½¿ç”¨ç¯å¢ƒå˜é‡ä»ä»¥ä¸‹ç›®å½•ä¸­è¯»å–é…ç½®ï¼ˆæŒ‰ä¼˜å…ˆé¡ºåºï¼‰ï¼š

- `$JOSHUTO_CONFIG_HOME`
- `$XDG_CONFIG_HOME/joshuto`
- `$HOME/.config/joshuto`

ç›®å‰å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–‡ä»¶å¯¹ Joshuto è¿›è¡Œé…ç½®ï¼š

- [joshuto.toml](https://github.com/kamiyaa/joshuto/blob/main/docs/configuration/joshuto.toml.md): basic/general configurations(åŸºæœ¬/é€šç”¨é…ç½®)
- [keymap.toml](https://github.com/kamiyaa/joshuto/blob/main/docs/configuration/keymap.toml.md): keymapping configurations(æŒ‰é”®æ˜ å°„é…ç½®)
- [mimetype.toml](https://github.com/kamiyaa/joshuto/blob/main/docs/configuration/mimetype.toml.md): mimetype configurations(æ–‡ä»¶ç±»å‹é…ç½®)
- [theme.toml](https://github.com/kamiyaa/joshuto/blob/main/docs/configuration/theme.toml.md): theming configurations(ä¸»é¢˜é…ç½®)
- [icons.toml](https://github.com/kamiyaa/joshuto/blob/main/docs/configuration/icons.toml.md): icons customization(å›¾æ ‡è‡ªå®šä¹‰)

å°†å®˜æ–¹æä¾›çš„ä¾‹å­

```bash
joshuto/config
```

å¤åˆ¶åˆ°

```bash
~/.config/joshuto
```

### Rust å¼€å‘çš„è‚¡ä»·æŸ¥è¯¢ç»ˆç«¯åº”ç”¨: rust-stock

é¡¹ç›®åœ°å€ï¼šhttps://github.com/fdehau/tui-rs

å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.rs/tui/latest/tui/index.html

tui ä»‹ç»ï¼šhttps://www.51cto.com/article/703696.html

å®æ—¶è‚¡ç¥¨æ•°æ®ï¼š https://github.com/tarkah/tickrs

æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼šhttps://github.com/veeso/termscp

ç½‘ç»œç›‘æ§å·¥å…·ï¼šhttps://github.com/imsnif/bandwhich

#### ä½¿ç”¨ Rust å¼€å‘çš„è‚¡ä»·æŸ¥è¯¢ç»ˆç«¯åº”ç”¨

![rust-stock.gif](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/fe56650e433e47e4978c8943de139a1dtplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

#### ä¸»è¦ä½¿ç”¨ tui-rs ä¸€æ¬¾è¶…å¥½ç”¨çš„è·¨å¹³å°å‘½ä»¤è¡Œç•Œé¢åº“

ä½¿ç”¨ tui.rs æä¾›çš„ä»¥ä¸‹æ¨¡å—è¿›è¡Œ UI ç¼–å†™(æ‰€æœ‰ UI å…ƒç´ éƒ½å®ç°äº† Widget æˆ– StatefuWidget Trait)ï¼š

- bakend ç”¨äºç”Ÿæˆç®¡ç†å‘½ä»¤è¡Œçš„åç«¯
- layout ç”¨äºç®¡ç† UI ç»„ä»¶çš„å¸ƒå±€
- style ç”¨äºä¸º UI æ·»åŠ æ ·å¼
- symbols æè¿°ç»˜åˆ¶æ•£ç‚¹å›¾æ—¶æ‰€ç”¨ç‚¹çš„æ ·å¼
- text ç”¨äºæè¿°å¸¦æ ·å¼çš„æ–‡æœ¬
- widgets åŒ…å«é¢„å®šä¹‰çš„ UI ç»„ä»¶

#### ç¼–è¯‘/è¿è¡Œ

```bash
âœ git https://github.com/huangbqsky/rust-stock
âœ cd rust-stock
âœ cargo build
âœ cargo run
```

## tl;dr

- [alacritty](https://github.com/alacritty/alacritty) ä½¿ç”¨ GPU åŠ é€Ÿçš„è·¨å¹³å°ç»ˆç«¯æ¨¡æ‹Ÿå™¨
- [starship](https://github.com/starship/starship) ğŸŒŒ è¶…çº§å¿«ã€æ”¯æŒå„ç§è®¢åˆ¶çš„æç®€å‘½ä»¤è¡Œæç¤ºç¬¦ï¼Œæ”¯æŒä»»æ„ shell
- [exa](https://github.com/ogham/exa) `ls` ç°ä»£ç‰ˆ
- [bat](https://github.com/sharkdp/bat) æ”¯æŒæ›´å¤šç‰¹æ€§çš„ `cat` å…‹éš†
- [delta](https://github.com/dandavison/delta) gitã€diff è¾“å‡ºæŸ¥çœ‹å™¨
- [zoxide](https://github.com/ajeetdsouza/zoxide) æ›´å¿«æ·åœ°æµè§ˆæ–‡ä»¶ç³»ç»Ÿ
- [ripgrep](https://github.com/burntsushi/ripgrep) åŸºäºæ­£åˆ™è¡¨è¾¾å¼é€’å½’æœç´¢ç›®å½•
- [fd](https://github.com/sharkdp/fd) ç®€å•ã€å¿«é€Ÿã€ç”¨æˆ·å‹å¥½çš„ `find` æ›¿ä»£å“
- [bottom](https://github.com/clementtsang/bottom) åˆä¸€ä¸ªè·¨å¹³å°çš„å›¾å½¢åŒ–è¿›ç¨‹/ç³»ç»ŸæŸ¥çœ‹å™¨
- [tldr](https://github.com/tldr-pages/tldr) ğŸ“š ä¼—äººä¸€èµ·ç¼–å†™çš„ç»ˆç«¯å‘½ä»¤é€ŸæŸ¥å¡
- [spotify-tui](https://github.com/rigellute/spotify-tui) Spotify å®¢æˆ·ç«¯å‘½ä»¤è¡Œç‰ˆ ğŸš€
- [gitui](https://github.com/extrawurst/gitui) è¶…çº§ ğŸ’¥ å¿«çš„ git å­—ç¬¦ç•Œé¢å®¢æˆ·ç«¯

## Alacritty

é¦–å…ˆä»‹ç» Alacrittyï¼Œè¿™æ˜¯æœ€å¿«çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒä½¿ç”¨ GPU æ¸²æŸ“ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯è·¨å¹³å°çš„ã€‚

é…è‰²æ–¹æ¡ˆã€å­—ä½“ã€é€æ˜åº¦ã€é”®ç›˜å¿«æ·é”®ç­‰éƒ½èƒ½å®šåˆ¶ã€‚

Alacritty ä¸æ”¯æŒåˆå­—ï¼Œä½†ä½ å¯ä»¥ç”¨è¿™ä¸ªæ”¯æŒåˆå­—çš„[åˆ†æ”¯](https://github.com/zenixls2/alacritty/tree/ligature)ã€‚å¦‚æœä½ ç”¨ Arch çš„è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ [aur](https://aur.archlinux.org/packages/alacritty-ligatures/) å®‰è£…ã€‚

![Alacritty åˆå­—](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/72cd8b2da3a440edb8baae984f0b03a3tplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Starship

æˆ‘ä»¥å‰çš„å‘½ä»¤è¡Œæç¤ºç¬¦ç”¨ zsh + powerlevel9kï¼Œåæ¥è½¬ç”¨ powerlevel10kï¼Œä½†åœ¨å¼€æ–° shell æ—¶æˆ‘éƒ½è§‚å¯Ÿåˆ°äº†å»¶è¿Ÿã€‚starship åˆ™èƒ½ç«‹åˆ»å¯åŠ¨ã€‚

å®ƒå¯ä»¥æ­é…ä»»ä½• shell ä½¿ç”¨ï¼Œæ¯”å¦‚ bashã€zshã€fishï¼Œç”šè‡³ powerShell.

ä¸‹é¢çš„æˆªå›¾æ˜¾ç¤ºäº†æˆ‘å®šåˆ¶çš„æç¤ºç¬¦ã€‚

![Starship æˆªå›¾](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/5c854ed96c9149d98711cfb03f86f4aftplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Exa

exa æ˜¯ `ls` å‘½ä»¤çš„ä¸€ä¸ªå®ç°ï¼Œä½†è‡ªå¸¦è‰²å½©å’Œå›¾æ ‡ï¼Œæ¸²æŸ“ä¹Ÿéå¸¸å¿«ã€‚

æˆ‘å»ºäº†ä¸€ä¸ªåˆ«åï¼Œç”¨ exa ä»£æ›¿ ls.

```sh
if [ "$(command -v exa)" ]; then
    unalias -m 'll'
    unalias -m 'l'
    unalias -m 'la'
    unalias -m 'ls'
    alias ls='exa -G  --color auto --icons -a -s type'
    alias ll='exa -l --color always --icons -a -s type'
fi
```

æˆ‘çš„ `ls` å’Œ `ll` å‘½ä»¤æ˜¾ç¤ºç»“æœï¼š

![exa æˆªå›¾](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/25f6592ab8e8483e82de09dddebcd70atplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Bat

bat æ˜¯ `cat` å‘½ä»¤çš„ä¸€ä¸ªå®ç°ï¼Œä½†åŠ ä¸Šäº†è¯­æ³•é«˜äº®ã€‚

æˆ‘ä¹Ÿç»™å®ƒå»ºäº†ä¸ªåˆ«åï¼ˆæˆ‘ç”¨ Nord ä¸»é¢˜ï¼‰ã€‚

```shell
if [ "$(command -v bat)" ]; then
  unalias -m 'cat'
  alias cat='bat -pp --theme="Nord"'
fi
```

![ä½¿ç”¨ bat æŸ¥çœ‹ TypeScript æ–‡ä»¶](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/8b0ca14f863542da8f480fa094bb91edtplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Delta

delta å¢å¼ºäº† git diff çš„æ˜¾ç¤ºæ•ˆæœï¼ŒåŒ…æ‹¬è¯­æ³•é«˜äº®ã€è¡Œå·ã€åŒæ æ˜¾ç¤ºã€‚

æƒ³ä½¿ç”¨ delta çš„è¯ï¼Œéœ€è¦åœ¨ `.gitconfig` ä¸­åŠ ä¸Šï¼š

```shell
[core]
  pager = delta
[interactive]
  diffFilter = delta --color-only
[delta]
  side-by-side = true
  line-numbers-left-format = ""
  line-numbers-right-format = "â”‚ "
  syntax-theme = Nord
```

åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œ`delta` æˆä¸º git å‘½ä»¤è¾“å‡ºçš„é»˜è®¤ pagerï¼Œå¼€å¯äº†åŒæ æ˜¾ç¤ºï¼Œå¹¶å°†ä¸»é¢˜è®¾ä¸º Nordã€‚ä½ å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ—å‡ºæ‰€æœ‰ä¸»é¢˜ï¼Œå¹¶ä»ä¸­é€‰æ‹©æƒ³ç”¨çš„ä¸»é¢˜ã€‚

```shell
delta --list-syntax-themes
```

![delta æˆªå±](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/3d8cf7cc7b234afe945da48aac337daetplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Zoxide

æˆ‘æ²¡æœ‰ä½¿ç”¨ä»»ä½•æ–‡ä»¶æµè§ˆå™¨ï¼Œåªç”¨ `cd` å’Œ `ls`ã€‚

æ¯”æ–¹è¯´ï¼Œæˆ‘çš„å®¶ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå­˜æ”¾å„ç§é¡¹ç›®çš„ `projects` ç›®å½•ï¼Œå¦‚æœæˆ‘æƒ³è®¿é—®å…¶ä¸­ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘éœ€è¦è¾“å…¥

```shell
cd ~/projects/mahmoudashraf.dev
```

ä½¿ç”¨ zoxide åï¼Œåªæœ‰ç¬¬ä¸€æ¬¡éœ€è¦è¾“å…¥

```shell
z ~/projects/mahmoudashraf.dev
```

ä¹‹åä¸ç®¡å½“å‰ç›®å½•æ˜¯å“ªé‡Œï¼Œç®€å•è¾“å…¥å‡ ä¸ªå­—æ¯å°±å¯ä»¥å†æ¬¡è®¿é—®è¿™ä¸€ç›®å½•

```shell
z mah
```

## Ripgrep

è¿™æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢ç›®å½•ä¸‹çš„æ–‡ä»¶å†…å®¹ã€‚

æ¨èé˜…è¯» [ripgrep is faster than {grep, ag, git grep, ucg, pt, sift} ](https://blog.burntsushi.net/ripgrep/) ä¸€æ–‡ã€‚

ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ï¼š

```shell
# åŸºäºç‰¹å®šæ­£åˆ™è¡¨è¾¾å¼æœç´¢ javascript æ–‡ä»¶
rg tjs "import React"

rg "\.content" -g "*.pug"

# ä¸ä»…å¯ä»¥æŸ¥æ‰¾ï¼Œè¿˜å¯ä»¥æ›¿æ¢ï¼Œç±»ä¼¼ sed å‘½ä»¤çš„æŸ¥æ‰¾æ›¿æ¢åŠŸèƒ½
rg fast README.md --replace FAST
```

![rg æˆªå±](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/7bbd1824cfe44399901d503a545f85c2tplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Fd

æ¯” `find` å‘½ä»¤æ›´å‹å¥½ï¼Œä¹Ÿæ›´å¿«ã€‚

é»˜è®¤æƒ…å†µä¸‹ä¼šå¿½ç•¥ `.gitignore` ä¸­æŒ‡å®šéœ€è¦å¿½ç•¥çš„æ–‡ä»¶ã€‚

æ¯”å¦‚ï¼ŒæŠŠä¸€äº› `png` æ ¼å¼çš„æ–‡ä»¶è½¬æ¢ä¸º `jpeg` æ ¼å¼ï¼š

```shell
fd -e png -x convert {} {.}.jpeg
```

å†æ¯”å¦‚åˆ é™¤æ–‡ä»¶ï¼š

```shell
fd -H '^\.DS_Store$' -tf -X rm
```

## bottom

å®ƒä¸æ˜¯ `top` ğŸ˜€ æ˜¯ `bottom`ã€‚

å®ƒæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç³»ç»Ÿç›‘è§†å™¨ã€‚

![bottom æˆªå±](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/814bcefe06a1421d9f32901da33daeb1tplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## Tldr

tldr ä¸ºå„ç§å‘½ä»¤è¡Œå·¥å…·æä¾›äº†é€ŸæŸ¥å¡ï¼Œå¯ä»¥çœä¸‹é˜…è¯»å®Œæ•´çš„ `man` å¸®åŠ©æ‰‹å†Œçš„æ—¶é—´ã€‚

![tldr æˆªå±](./5.Rusté¡¹ç›®å®æˆ˜ç¯‡.assets/130d5189ccf945fba4f51247fe08fe99tplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

## æ›´å¤šå·¥å…·

- å¦‚æœä½ å«Œ Spotify çš„å®˜æ–¹å®¢æˆ·ç«¯å¤ªç¬¨é‡ï¼Œå¯ä»¥ä½¿ç”¨ `spotify-tui` è¿™ä¸ªè½»é‡çº§æ›¿ä»£å“ã€‚
- å¦‚æœä½ å–œæ¬¢é€šè¿‡ UI ç•Œé¢æ“ä½œ gitï¼Œå¯ä»¥çœ‹ä¸‹ `gitui`ã€‚

ä½¿ç”¨ Rust ç¼–å†™çš„å‘½ä»¤è¡Œå·¥å…·å’Œå…¶ä»–å·¥å…·è¿˜æœ‰å¾ˆå¤šï¼Œè¯¦è§ [Command line utilities â€” list of Rust libraries/crates // Lib.rs](https://lib.rs/command-line-utilities)ã€‚

# Rust å®ç°æ–‡ä»¶æ‰¹é‡ä¸‹è½½

## ç¯å¢ƒå‡†å¤‡

é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£… Rustã€‚å¯ä»¥åˆ° Rust å®˜ç½‘ä¸Šè¿›è¡Œä¸‹è½½å¹¶å®‰è£…ã€‚æ¥ä¸‹æ¥å¼€å§‹é…ç½®ç¼–è¾‘æ–‡æ¡£ã€‚åœ¨æ–°çš„Rusté¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„main.rsæ–‡ä»¶ã€‚è¿™æ˜¯æˆ‘ä»¬çš„ä¸»è¦å·¥ä½œæ–‡ä»¶ã€‚

## åˆ›å»ºä¸»å‡½æ•°

Rustç¨‹åºçš„æ‰§è¡Œä»ä¸»å‡½æ•°å¼€å§‹ã€‚åœ¨é¡¹ç›®ä¸­çš„ä¸»æ–‡ä»¶åˆ›å»ºä¸»å‡½æ•°ï¼š

```rust
fn main() {
   let urls: Vec<String> = vec![
       "http://example.com/file1".to_string(),
       "http://example.com/file2".to_string(),
       ...
   ];
}
```

åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²å‘é‡ `urls` æ¥å­˜å‚¨å¾…ä¸‹è½½çš„æ–‡ä»¶URLã€‚

## å®ç°ä¸‹è½½å‡½æ•°

ä¸‹ä¸€æ­¥æ˜¯å®ç°æ–‡ä»¶ä¸‹è½½çš„å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `reqwest` crate æ¥å®ŒæˆHTTP è¯·æ±‚çš„æ“ä½œï¼Œä½¿ç”¨ `tokio` crate åˆ™å¯ä»¥è¿›è¡Œå¼‚æ­¥æ“ä½œã€‚å…ˆå°†å®ƒä»¬æ·»åŠ åˆ°ä½ çš„Cargo.tomlæ–‡ä»¶ä¸­ã€‚

```bash
[dependencies]
reqwest = { version = "0.11", features = ["json"] }
tokio = { version = "1", features = ["full"] }
```

ç„¶åæ›´æ–°ä¸€ä¸‹ä¾èµ–åº“ï¼š

```bash
$ cargo build
```

åˆ›å»ºä¸‹è½½æ–‡ä»¶çš„å‡½æ•°ï¼š

```rust
async fn download_file(url: &str) -> Result<(), Box<dyn std::error::Error>> {
   let response = reqwest::get(url).await?;

   let path = Path::new("downloads").join(url.split('/').last().unwrap());
   let file = File::create(&path).await?;

   let mut stream = response.bytes_stream();
   while let Some(item) = stream.next().await {
       file.write_all(&item?).await?;
   }

   Ok(())
}
```

è¿™æ®µä»£ç åˆ©ç”¨å¼‚æ­¥I/Oæ¥ä»URLä¸‹è½½æ–‡ä»¶ï¼Œç„¶åä¿å­˜åˆ°downloadsæ–‡ä»¶å¤¹ä¸‹ã€‚

## å¹¶è¡Œä¸‹è½½

ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨ `download_file` å‡½æ•°ã€‚ç”±äºRustæ”¯æŒå¹¶å‘æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`futures`åº“ä¸‹çš„`join_all`å‡½æ•°æ¥å¹¶è¡Œä¸‹è½½è¿™äº›æ–‡ä»¶ï¼š

```rust
fn main() {
   let urls: Vec<String> = vec!["http://example.com/file1".to_string(),...];

   let download_futures: Vec<_> = urls.iter()
       .map(|url| tokio::spawn(download_file(url)))
       .collect();

   let result = tokio::runtime::Builder::new_multi_thread()
       .enable_all()
       .build()
       .unwrap()
       .block_on(futures::future::join_all(download_futures));

   for res in result {
       if let Err(e) = res {
           println!("Error: {}", e);
       }
   }
}
```

`spawn`å‡½æ•°èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„å¼‚æ­¥ä»»åŠ¡å¹¶è¿”å›ä¸€ä¸ª`JoinHandle`ï¼Œå½“è¿™ä¸ª`JoinHandle`è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œå®ƒä¼šè¿”å›å…¶ä»»åŠ¡çš„è¾“å‡ºã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`block_on`æ¥é˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°æä¾›çš„futureå®Œæˆï¼Œ`join_all`åˆ™ä¼šç­‰å¾…æ‰€æœ‰futureå®Œæˆï¼Œä¸ç®¡ä»–ä»¬çš„å®Œæˆé¡ºåºã€‚

# Rust å’Œ Swift

[ç”¨ Rust å’Œ Swift ç»“åˆæ¥å†™ä¸€ä¸ª App (qq.com)](https://mp.weixin.qq.com/s/WCb5oeHrP3KPPgSbqy4Kfw)

# åœ¨Rust ä¸­å¼€å§‹ä½¿ç”¨MongoDB

MongoDB æ˜¯ä¸€ç§æµè¡Œçš„ NoSQL æ•°æ®åº“ï¼Œè¿‘å¹´æ¥è¶Šæ¥è¶Šå—åˆ°å¼€å‘è€…çš„é’çã€‚å®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§çµæ´»ã€å¯æ‰©å±•ä¸”é«˜æ€§èƒ½çš„æ•°æ®åº“è§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äºå¤šç§åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚

å¯¹äº Rust ç¨‹åºå‘˜æ¥è¯´ï¼ŒMongoDB æä¾›äº†ä¸€ä¸ªä¼˜ç§€çš„é€‰é¡¹ï¼Œä»¥å¿«é€Ÿã€é«˜æ•ˆä¸”å¯é çš„æ–¹å¼å­˜å‚¨å’Œæ£€ç´¢æ•°æ®ã€‚Rust æ˜¯ä¸€ç§ç°ä»£çš„ã€é«˜æ€§èƒ½çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œæ—¨åœ¨å®ç°é€Ÿåº¦ã€å®‰å…¨æ€§å’Œå¹¶å‘æ€§ã€‚å®ƒéå¸¸é€‚åˆæ„å»ºé«˜æ€§èƒ½ã€ä½çº§åˆ«çš„è½¯ä»¶ï¼Œå¹¶ä¸”åœ¨å¼€å‘è€…ä¸­è¶Šæ¥è¶Šå—æ¬¢è¿ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ Rust ç¨‹åºå‘˜å¦‚ä½•åˆ©ç”¨ MongoDB æ„å»ºé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä¼šè§£é‡Šå¦‚ä½•è®¾ç½® MongoDB æ•°æ®åº“ï¼Œå¹¶å±•ç¤ºå¦‚ä½•ä½¿ç”¨å®˜æ–¹çš„ MongoDB Rust é©±åŠ¨ç¨‹åºä» Rust ä¸ MongoDB è¿›è¡Œäº¤äº’ã€‚

æ— è®ºä½ æ˜¯ MongoDB çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯å¸Œæœ›åˆ©ç”¨è¿™ä¸ªå¼ºå¤§çš„æ•°æ®åº“æŠ€æœ¯çš„æœ‰ç»éªŒçš„ Rust ç¨‹åºå‘˜ï¼Œæœ¬æ–‡éƒ½å°†ä¸ºä½ æä¾›å¿…è¦çš„çŸ¥è¯†å’ŒæŠ€èƒ½ï¼Œå¸®åŠ©ä½ å…¥é—¨ã€‚

## **ã€Œå…ˆå†³æ¡ä»¶ã€**

è¦è·Ÿéšæœ¬æ–‡ï¼Œä½ åªéœ€è¦ä»¥ä¸‹å‡ é¡¹ï¼š

- Rust çŸ¥è¯†
- ä¸€ä¸ªå¯ä»¥å·¥ä½œçš„ç³»ç»Ÿ
- åœ¨ä½ çš„ç³»ç»Ÿä¸Šå®‰è£… Rust

## è®¾ç½®ä½ çš„é¡¹ç›®

ç°åœ¨ä½ çš„ç³»ç»Ÿä¸Šå·²ç»å®‰è£…äº† MongoDBï¼Œæ˜¯æ—¶å€™è®¾ç½®ä½ çš„ Rust é¡¹ç›®ä»¥ä½¿ç”¨å®˜æ–¹çš„ MongoDB Rust é©±åŠ¨ç¨‹åºäº†ã€‚æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¼€å§‹ï¼š

1. åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®ã€‚
2. æ‰“å¼€ç»ˆç«¯ï¼Œé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®ï¼š

```bash
cargo new myproject
```

è¿™å°†åˆ›å»ºä¸€ä¸ªåä¸º"myproject"çš„æ–° Rust é¡¹ç›®ã€‚

1. å‘ä½ çš„é¡¹ç›®æ·»åŠ  MongoDB Rust é©±åŠ¨ç¨‹åºä¾èµ–é¡¹ã€‚æ‰“å¼€é¡¹ç›®ç›®å½•ä¸­çš„ `Cargo.toml` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä¾èµ–é¡¹ï¼š

```bash
[dependencies]
mongodb = "2.3.1"
```

è¿™å°†å‘ä½ çš„é¡¹ç›®æ·»åŠ  MongoDB Rust é©±åŠ¨ç¨‹åºä¾èµ–é¡¹ã€‚

1. å¯¼å…¥å¿…è¦çš„åº“ã€‚æ‰“å¼€é¡¹ç›®ç›®å½•ä¸­çš„ `src/main.rs` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹è¡Œåˆ°æ–‡ä»¶é¡¶éƒ¨ä»¥å¯¼å…¥å¿…è¦çš„åº“ï¼š

```rust
extern crate mongodb;
use mongodb::bson::doc;
use mongodb::{Client, options::ClientOptions};
```

1. è¿æ¥åˆ°ä½ çš„ MongoDB æœåŠ¡å™¨ã€‚åœ¨ä½ çš„ `main` å‡½æ•°ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥è¿æ¥åˆ°ä½ çš„ MongoDB æœåŠ¡å™¨ï¼š

```rust
let client_options = ClientOptions::parse("mongodb://localhost:27017").await.unwrap();
let client = Client::with_options(client_options).unwrap();
```

è¿™å°†ä½¿ç”¨è¿æ¥å­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ªæ–°çš„ `ClientOptions` å¯¹è±¡ï¼Œç„¶åç”¨ `ClientOptions` å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ `Client` å¯¹è±¡ã€‚

æ­å–œä½ ï¼Œç°åœ¨ä½ çš„ Rust é¡¹ç›®å·²ç»è®¾ç½®å¥½ä½¿ç”¨å®˜æ–¹çš„ MongoDB Rust é©±åŠ¨ç¨‹åºäº†ã€‚

## åˆ›å»ºæ•°æ®åº“

åœ¨ä½¿ç”¨ MongoDB ä¹‹å‰ï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªæ•°æ®åº“æ¥å­˜å‚¨é›†åˆã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ MongoDB Compass åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ã€‚

æ‰“å¼€ MongoDB Compass å¹¶ç‚¹å‡»å±å¹•å·¦ä¸Šè§’çš„"Connect"æŒ‰é’®ã€‚åœ¨ "New Connection"çª—å£ä¸­ï¼Œè¾“å…¥ä½ çš„ MongoDB å®ä¾‹çš„è¿æ¥è¯¦æƒ…ã€‚è¿™åŒ…æ‹¬ä¸»æœºåã€ç«¯å£å·å’Œå¿…è¦çš„è®¤è¯è¯¦æƒ…ã€‚ç‚¹å‡» "Connect"ä»¥å»ºç«‹ä¸ä½ çš„ MongoDB å®ä¾‹çš„è¿æ¥ã€‚åœ¨å·¦ä¾§å¯¼èˆªçª—æ ¼ä¸­ï¼Œç‚¹å‡»"Databases"æŸ¥çœ‹ç°æœ‰æ•°æ®åº“åˆ—è¡¨ã€‚ç‚¹å‡» "Databases"çª—å£å·¦ä¸Šè§’çš„"Create Database"æŒ‰é’®ã€‚è¾“å…¥ä½ çš„æ–°æ•°æ®åº“åç§°ï¼ˆä¾‹å¦‚"mydatabase"ï¼‰å¹¶ç‚¹å‡»"Create"ã€‚

æ­å–œä½ ï¼Œä½ å·²ç»ä½¿ç”¨ MongoDB Compass åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼ç°åœ¨ä½ å¯ä»¥å¼€å§‹åˆ›å»ºé›†åˆå¹¶å‘æ•°æ®åº“æ·»åŠ æ–‡æ¡£äº†ã€‚

## **ã€Œåˆ›å»ºé›†åˆã€**

åœ¨ MongoDB ä¸­ï¼Œæ•°æ®åº“é›†åˆç›¸å½“äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨ã€‚é›†åˆæ˜¯ä¸€ç»„å…·æœ‰å…±åŒç‰¹å¾çš„ MongoDB æ–‡æ¡£ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Rust åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚

åœ¨ä½ çš„ `src/main.rs` æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å°†åœ¨ä½ çš„ MongoDB æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ çš„ `main.rs` æ–‡ä»¶ä¸­ï¼š

```rust
async fn create_collection(client: &Client, db_name: &str, coll_name: &str) {
    let db = client.database(db_name);
    db.create_collection(coll_name, None).await.unwrap();
}
```

è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª `Client` å¯¹è±¡ã€ä¸€ä¸ªæ•°æ®åº“åç§°å’Œä¸€ä¸ªé›†åˆåç§°ä½œä¸ºå‚æ•°ã€‚ç„¶åï¼Œå®ƒåœ¨æŒ‡å®šçš„æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚

åœ¨ä½ çš„ `main` å‡½æ•°ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥è°ƒç”¨ `create_collection` å‡½æ•°å¹¶åœ¨ä½ çš„ MongoDB æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆï¼š

```rust
let client_options = ClientOptions::parse("mongodb://localhost:27017").await.unwrap();
let client = Client::with_options(client_options).unwrap();
let db_name = "mydatabase";
let coll_name = "mycollection";
create_collection(&client, db_name, coll_name).await;
```

è¿™æ®µä»£ç å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ `Client` å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ `create_collection` å‡½æ•°æ¥åœ¨ `mydatabase` æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªåä¸º"mycollection"çš„æ–°é›†åˆã€‚

æ­å–œä½ ï¼Œç°åœ¨ä½ å·²ç»ä½¿ç”¨ Rust åœ¨ä½ çš„ MongoDB æ•°æ®åº“ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„é›†åˆã€‚

## **ã€Œæ’å…¥æ–‡æ¡£ã€**

åœ¨ MongoDB ä¸­ï¼Œè¡Œç›¸å½“äºé›†åˆä¸­çš„æ–‡æ¡£ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Rust å°†æ–°æ–‡æ¡£æ’å…¥åˆ° MongoDB é›†åˆä¸­ã€‚

åœ¨ä½ çš„ `src/main.rs` æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å°†æŠŠä½ çš„ MongoDB æ•°æ®åº“ä¸­çš„æŒ‡å®šé›†åˆæ’å…¥ä¸€ä¸ªæ–°æ–‡æ¡£ã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ çš„ `main.rs` æ–‡ä»¶ä¸­ï¼š

```rust
async fn insert_document(client: &Client, db_name: &str, coll_name: &str) {
    let db = client.database(db_name);
    let coll = db.collection(coll_name);
    let doc = doc! { "name": "John", "age": 30 };
    coll.insert_one(doc, None).await.unwrap();
}
```

è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª `Client` å¯¹è±¡ã€ä¸€ä¸ªæ•°æ®åº“åç§°å’Œä¸€ä¸ªé›†åˆåç§°ä½œä¸ºå‚æ•°ã€‚ç„¶åï¼Œå®ƒä¸ºæŒ‡å®šçš„é›†åˆåˆ›å»ºä¸€ä¸ªæ–°çš„ `Collection` å¯¹è±¡ï¼Œå¹¶æ’å…¥ä¸€ä¸ªæ–°æ–‡æ¡£ã€‚

åœ¨ä½ çš„ `main` å‡½æ•°ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥è°ƒç”¨ `insert_document` å‡½æ•°å¹¶å°†æ–°æ–‡æ¡£æ’å…¥åˆ°ä½ çš„ MongoDB é›†åˆä¸­ï¼š

```rust
let client_options = ClientOptions::parse("mongodb://localhost:27017").await.unwrap();
let client = Client::with_options(client_options).unwrap();
let db_name = "mydatabase";
let coll_name = "mycollection";
insert_document(&client, db_name, coll_name).await;
```

è¿™æ®µä»£ç å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ `Client` å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ `insert_one` æ–¹æ³•å°†ä¸€ä¸ªæ–°æ–‡æ¡£æ’å…¥åˆ° `mycollection` é›†åˆä¸­ï¼Œè¯¥æ–‡æ¡£åŒ…å« `name` å’Œ `age` å­—æ®µã€‚

æ­å–œä½ ï¼Œç°åœ¨ä½ å·²ç»ä½¿ç”¨ Rust å°†æ–°æ–‡æ¡£æ’å…¥åˆ°ä½ çš„ MongoDB é›†åˆä¸­äº†ã€‚

## **ã€Œæ£€ç´¢æ–‡æ¡£ã€**

åœ¨ MongoDB ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ç‰¹å®šè¿‡æ»¤æ¡ä»¶æŸ¥è¯¢é›†åˆæ¥æ£€ç´¢æ–‡æ¡£ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Rust ä» MongoDB é›†åˆä¸­æ£€ç´¢æ–‡æ¡£ã€‚

åœ¨ä½ çš„ `src/main.rs` æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å°†ä»ä½ çš„ MongoDB æ•°æ®åº“ä¸­çš„æŒ‡å®šé›†åˆä¸­æ£€ç´¢ä¸€ä¸ªæ–‡æ¡£ã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ çš„ `main.rs` æ–‡ä»¶ä¸­ï¼š

```rust
fn get_document(client: &Client, db_name: &str, coll_name: &str) {
    let db = client.database(db_name);
    let coll = db.collection(coll_name);
    let filter = doc! {"name": "John"};
    let result = coll.find_one(Some(filter), None).await.unwrap();
    match result {
        Some(doc) => println!("{:?}", doc),
        None => println!("No document found"),
  }
}
```

è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª `Client` å¯¹è±¡ã€ä¸€ä¸ªæ•°æ®åº“åç§°å’Œä¸€ä¸ªé›†åˆåç§°ä½œä¸ºå‚æ•°ã€‚ç„¶åï¼Œå®ƒä¸ºæŒ‡å®šçš„é›†åˆåˆ›å»ºä¸€ä¸ªæ–°çš„ `Collection` å¯¹è±¡ï¼Œå¹¶ä»ä¸­æ£€ç´¢åŒ¹é…æŒ‡å®šè¿‡æ»¤æ¡ä»¶çš„æ–‡æ¡£ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨æ£€ç´¢é›†åˆä¸­å­—æ®µåä¸º "name" ä¸”å€¼ä¸º "John" çš„æ–‡æ¡£ã€‚

åœ¨ä½ çš„ `main` å‡½æ•°ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥è°ƒç”¨ `get_document` å‡½æ•°å¹¶ä»ä½ çš„ MongoDB é›†åˆä¸­æ£€ç´¢æ–‡æ¡£ï¼š

```rust
let client_options = ClientOptions::parse("mongodb://localhost:27017").await.unwrap();
let client = Client::with_options(client_options).unwrap();
let db_name = "mydatabase";
let coll_name = "mycollection";
get_document(&client, db_name, coll_name).await;
```

## **ã€Œåˆ é™¤æ–‡æ¡£ã€**

åœ¨ MongoDB ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªåŒ¹é…æ–‡æ¡£çš„æ¡ä»¶æ¥åˆ é™¤é›†åˆä¸­çš„æ–‡æ¡£ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Rust ä» MongoDB é›†åˆä¸­åˆ é™¤æ–‡æ¡£ã€‚

åœ¨ä½ çš„ `src/main.rs` æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å°†ä»ä½ çš„ MongoDB æ•°æ®åº“ä¸­çš„æŒ‡å®šé›†åˆä¸­åˆ é™¤ä¸€ä¸ªæ–‡æ¡£ã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ çš„ `main.rs` æ–‡ä»¶ä¸­ï¼š

```rust
fn delete_document(client: &Client, db_name: &str, coll_name: &str) {
    let db = client.database(db_name);
    let coll = db.collection(coll_name);
    let filter = doc! {"name": "John"};
    coll.delete_one(filter, None).await.unwrap();
}
```

è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª `Client` å¯¹è±¡ã€ä¸€ä¸ªæ•°æ®åº“åç§°å’Œä¸€ä¸ªé›†åˆåç§°ä½œä¸ºå‚æ•°ã€‚ç„¶åï¼Œå®ƒä¸ºæŒ‡å®šçš„é›†åˆåˆ›å»ºä¸€ä¸ªæ–°çš„ `Collection` å¯¹è±¡ï¼Œå¹¶ä»ä¸­åˆ é™¤åŒ¹é…æŒ‡å®šè¿‡æ»¤æ¡ä»¶çš„æ–‡æ¡£ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨åˆ é™¤é›†åˆä¸­å­—æ®µåä¸º "name" ä¸”å€¼ä¸º "John" çš„æ–‡æ¡£ã€‚

åœ¨ä½ çš„ `main` å‡½æ•°ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥è°ƒç”¨ `delete_document` å‡½æ•°å¹¶ä»ä½ çš„ MongoDB é›†åˆä¸­åˆ é™¤æ–‡æ¡£ï¼š

```rust
let client_options = ClientOptions::parse("mongodb://localhost:27017").await.unwrap();
let client = Client::with_options(client_options).unwrap();
let db_name = "mydatabase";
let coll_name = "mycollection";
delete_document(&client, db_name, coll_name).await;
```

è¿™æ®µä»£ç å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ `Client` å¯¹è±¡ï¼Œå¹¶åˆ é™¤ `mycollection` é›†åˆä¸­åŒ¹é…è¿‡æ»¤æ¡ä»¶çš„æ–‡æ¡£ã€‚

æ­å–œä½ ï¼Œç°åœ¨ä½ å·²ç»ä½¿ç”¨ Rust ä»ä½ çš„ MongoDB é›†åˆä¸­åˆ é™¤äº†æ–‡æ¡£ã€‚

## ä¿®æ”¹æ–‡æ¡£

åœ¨ MongoDB ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æ›´æ–°æ–‡æ¡£ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µæ¥ä¿®æ”¹é›†åˆä¸­çš„æ–‡æ¡£ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Rust ä¿®æ”¹ MongoDB é›†åˆä¸­çš„æ–‡æ¡£ã€‚

åœ¨ä½ çš„ `src/main.rs` æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å°†æ›´æ–°ä½ çš„ MongoDB æ•°æ®åº“ä¸­æŒ‡å®šé›†åˆä¸­çš„æ–‡æ¡£ã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ çš„ `main.rs` æ–‡ä»¶ä¸­ï¼š

```rust
fn update_document(client: &Client, db_name: &str, coll_name: &str) {
    let db = client.database(db_name);
    let coll = db.collection(coll_name);
    let filter = doc! {"name": "John"};
    let update = doc! {"$set": {"age": 35}};
    coll.update_one(filter, update, None).await.unwrap();
}
```

è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª `Client` å¯¹è±¡ã€ä¸€ä¸ªæ•°æ®åº“åç§°å’Œä¸€ä¸ªé›†åˆåç§°ä½œä¸ºå‚æ•°ã€‚ç„¶åï¼Œå®ƒä¸ºæŒ‡å®šçš„é›†åˆåˆ›å»ºä¸€ä¸ªæ–°çš„ `Collection` å¯¹è±¡ï¼Œå¹¶æ›´æ–°å…¶ä¸­åŒ¹é…æŒ‡å®šè¿‡æ»¤æ¡ä»¶çš„æ–‡æ¡£ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨æ›´æ–°é›†åˆä¸­å­—æ®µåä¸º "name" ä¸”å€¼ä¸º "John" çš„æ–‡æ¡£ï¼Œå¹¶å°† "age" å­—æ®µçš„å€¼è®¾ç½®ä¸º "35"ã€‚

åœ¨ä½ çš„ `main` å‡½æ•°ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥è°ƒç”¨ `update_document` å‡½æ•°å¹¶æ›´æ–°ä½ çš„ MongoDB é›†åˆä¸­çš„æ–‡æ¡£ï¼š

```rust
let client_options = ClientOptions::parse("mongodb://localhost:27017").await.unwrap();
let client = Client::with_options(client_options).unwrap();
let db_name = "mydatabase";
let coll_name = "mycollection";
update_document(&client, db_name, coll_name).await;
```

è¿™æ®µä»£ç å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ `Client` å¯¹è±¡ï¼Œå¹¶æ›´æ–° `mycollection` é›†åˆä¸­åŒ¹é…è¿‡æ»¤æ¡ä»¶çš„æ–‡æ¡£ã€‚

æ­å–œä½ ï¼Œç°åœ¨ä½ å·²ç»ä½¿ç”¨ Rust æ›´æ–°äº†ä½ çš„ MongoDB é›†åˆä¸­çš„æ–‡æ¡£ã€‚

## ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å‘ä½ ä»‹ç»äº† MongoDB ä»¥åŠå¦‚ä½•å°†å…¶ä¸ Rust ç»“åˆä½¿ç”¨ã€‚æˆ‘æ¶µç›–äº†è®¾ç½® MongoDB æœåŠ¡å™¨ã€åˆ›å»ºæ•°æ®åº“å’Œåœ¨æ•°æ®åº“ä¸­åˆ›å»ºé›†åˆçš„åŸºç¡€çŸ¥è¯†ã€‚æˆ‘è¿˜å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Rust æ’å…¥ã€æ£€ç´¢ã€ä¿®æ”¹å’Œåˆ é™¤ MongoDB æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚

é€šè¿‡ç»“åˆ Rust ç¼–ç¨‹è¯­è¨€å’Œ MongoDB æ•°æ®åº“ï¼Œä½ å¯ä»¥æ„å»ºèƒ½å¤Ÿå¤„ç†å¤§é‡æ•°æ®çš„å¼ºå¤§ä¸”å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚Rust çš„æ€§èƒ½å’Œå®‰å…¨æ€§ç‰¹æ€§ä½¿å…¶æˆä¸ºä¸ MongoDB ç­‰æ•°æ®åº“åˆä½œçš„æä½³é€‰æ‹©ã€‚
